{"version":3,"sources":["logo.svg","dispatcher.js","stores/ModelStore.js","conf.jsx","actions/MyActions.js","Dict.jsx","components/header/header.jsx","components/events/card.jsx","components/profiles/card.jsx","components/attendances/card.jsx","components/dashboard/index.jsx","components/users/wizard.jsx","components/users/login.jsx","components/events/index.jsx","components/meetings/card.jsx","components/events/calendar.jsx","components/events/info.jsx","components/events/show.jsx","components/events/create.jsx","components/events/attendance.jsx","components/meetings/info.jsx","components/events/detail.jsx","components/meetings/masonry.jsx","components/meetings/index.jsx","socket.js","components/flyers/card.jsx","components/rooms/chat.js","components/meetings/show.jsx","components/meetings/create.jsx","components/meetings/attendance.jsx","components/exhibitions/card.jsx","components/exhibitions/index.jsx","components/questions/card.jsx","components/exhibitions/show.jsx","components/exhibitions/create.jsx","components/discussions/index.jsx","components/uploads/cropper.jsx","components/uploads/create.jsx","components/flyers/create.jsx","components/users/loginJwt.jsx","components/questions/create.jsx","janus.js","components/rooms/janus-tools.js","janus-2021.js","components/rooms/janus-videoroom.js","components/rooms/dish.js","components/rooms/show.jsx","components/attendances/create.jsx","components/profiles/index.jsx","App.js","reportWebVitals.js","index.js"],"names":["Dispatcher","modelStore","list","multipleList","instance","klass","reason","this","i","len","data","length","push","emit","console","log","action","type","listModel","listMultipleModel","showIntance","deleteIntance","setIntance","postFile","setIntanceFailure","EventEmitter","dispatcher","register","handleActions","bind","conf","server","getList","model","page","params","token","queryString","Object","keys","map","key","join","axios","get","headers","then","response","dispatch","catch","error","getMultipleList","getInstance","id","removeInstance","setInstance","post","updateInstance","put","dict","fa","Header","props","logout","state","window","localStorage","getItem","profile","name","initials","ModelStore","on","removeListener","MyActions","history","getIntance","getKlass","setState","obj","removeItem","location","replace","t","className","data-bs-toggle","data-bs-target","href","class","xmlns","width","height","viewBox","stroke-width","stroke","fill","stroke-linecap","stroke-linejoin","d","x1","y1","x2","y2","aria-label","onClick","points","x","y","rx","cx","cy","r","React","Component","moment","locale","useGregorianParser","EventCard","formatGregorianDate","gregorianDate","date","Date","day","getDate","month","getMonth","getFullYear","getHours","getMinutes","cardCover","event","cover","style","backgroundImage","tagsShow","tags","result","tag","margin","title","Fragment","events","col","textAlign","truncated_info","event_type","start_date","format","end_date","eventItems","ProfileCard","src","alt","AttendanceCard","is_admin","attendable_type","attendable_id","createBtn","attendees","attendee","AsyncTypeahead","withAsync","Typeahead","UserWizard","submit","handleChange","email","password","password_confirmation","bio","country","options","setItem","reload","signedUp","notSignedUp","onInput","e","target","value","autocomplete","role","aria-valuenow","aria-valuemin","aria-valuemax","classes","priorityOptions","onChange","val","rows","placeholder","allowNew","multiple","defaultSelected","isLoading","labelKey","onSearch","query","fetch","resp","json","items","tagSelected","renderMenuItemChildren","option","submitProfile","checkSignUp","EventIndex","allTags","q","start_from","start_to","add","$","hide","concat","noEventCard","data-masonry","show","marginTop","changeTags","direction","marginBottom","isGregorian","tagInput","search","verticalAlign","display","cardMasonry","loadMore","MeetingCard","editBtn","meeting","deleteMeeting","meetings","start_time","meetingItems","herf","EventCalendar","ranges","highlightRanges","today","inputFormat","inputJalaaliFormat","dateSelect","EventInfo","marginRight","isPrivateBadge","toggleCalendar","info","EventShow","flyers","quillOne","is_private","calendar","meetingLoaded","selectedMeeting","match","Quill","readOnly","uploads","constructCalendar","advertisable_id","advertisable_type","quill_content","html","setContents","flyer","deleteFlyer","is_default","loadContent","editFlyerBtn","parse","start_day","_d","end_day","s","color","randomColor","start","end","end_time","maxHeight","meetingList","upload","upload_type","cursor","link","editUploadBtn","createFlyerBtn","createUploadBtn","showCalendar","EventCreate","editing","changeType","self","each","checked","prop","tagShow","timePicker","changeDefault","EventAttendance","attendances","users","selectedUser","splited","split","charAt","toUpperCase","slice","getMutipleList","user_id","user","border","addParticipant","attendance","removeParticipant","userItems","attendanceItems","MeetingInfo","avatar","att","sideBlock","item","isEvent","meeting_type","room_id","uuidv4","forceUpdate","EventDetail","selectedTags","el","is","array","index","indexOf","splice","tag_ids","tagCheckbox","filterSearch","MeetingMasonry","MeetingIndex","noMeetingCard","socket","io","connect","transports","secure","reconnect","rejectUnauthorized","FlyerCard","prevProps","socketHandle","msg","parsed","appendChat","c","keydownHandler","keyCode","ctrlKey","send","exist","chats","filter","uuid","scrollChat","stop","animate","scrollTop","scrollHeight","chatItems","chat","content","throttle","now","lastTime","wsSend","sender","userUUID","roomId","MeetingShow","capacity","room","fullname","document","addEventListener","removeEventListener","toString","room_uuid","url","connectSocketRoom","editMeetingBtn","createBigBlue","borderColor","boxShadow","time","MeetingCreate","event_id","MeetingAttendance","ExhibitionCard","exhibition","exhibitions","exhibitionItems","ExhibitionIndex","noExhibitionCard","QuestionCard","questionable_type","questionable_id","questions","question","ExhibitionShow","editExhibitionBtn","addAttendance","ExhibitionCreate","DiscssionIndex","data-toggle","data-target","CropperShow","onCropChange","crop","onCropComplete","croppedArea","croppedAreaPixels","crop_settings","onZoomChange","zoom","showCropper","aspect","uploadable_type","uploadable_id","imageSrc","uploadable_link","cropped","image","min","max","step","aria-labelledby","container","UploadCreate","file","advertisable_link","progressShow","config","onUploadProgress","progressEvent","percentCompleted","Math","round","loaded","total","progress","FormData","append","res","uploadedRecently","err","fileAttacher","files","FlyerCreate","quill","ImageUploader","theme","modules","toolbar","imageUploader","Promise","resolve","reject","formData","delta","oldDelta","source","getContents","getText","LoginJwt","QuestionCreate","questionable_link","RTCRtpTransceiver","Janus","sessions","isExtensionEnabled","navigator","mediaDevices","getDisplayMedia","userAgent","chromever","parseInt","maxver","extension","isInstalled","defaultExtension","extensionId","querySelector","getScreen","callback","pending","setTimeout","Error","cache","postMessage","init","origin","sourceId","clearTimeout","gatewayCallbacks","success","noop","destroyed","initDone","isWebrtcSupported","websockets","ws","wsHandlers","wsKeepaliveTimeoutId","servers","serversIndex","isArray","debug","iceServers","urls","iceTransportPolicy","bundlePolicy","ipv6Support","ipv6","withCredentials","undefined","maxev","max_poll_events","apisecret","destroyOnUnload","keepAlivePeriod","isNaN","longPollTimeout","getMaxBitrates","simulcastMaxBitrates","maxBitrates","high","medium","low","connected","sessionId","pluginHandles","that","retries","transactions","eventHandler","longpoll","getTime","encodeURIComponent","httpAPICall","verb","handleEvent","timeout","textStatus","errorThrown","warn","skipTimeout","pluginHandle","candidate","webrtcStuff","pc","remoteSdp","completed","addIceCandidate","endOfCandidates","candidates","webrtcState","hangup","detached","ondetached","detach","mediaState","slowLink","transaction","reportSuccess","code","plugindata","jsep","onmessage","close","vdebug","keepAlive","request","randomString","JSON","stringify","createSession","callbacks","onopen","onerror","onclose","eventName","newWebSocket","body","sendMessage","handleId","message","sdp","e2ee","rid_order","sendTrickleCandidate","createDataChannel","dclabel","dcprotocol","incoming","pendingData","onDataChannelStateChange","label","protocol","dcState","dataChannel","readyState","ondataopen","dcoptions","ordered","ondata","sendData","text","dataChanDefaultLabel","sendDtmf","dtmfSender","audioSender","getSenders","find","track","kind","dtmf","ontonechange","tone","tones","duration","gap","insertDTMF","destroyHandle","noRequest","cleanupWebrtc","streamsDone","media","stream","stopAllTracks","getAudioTracks","getVideoTracks","addTracks","myStream","update","streamExternal","isAudioSendEnabled","addAudio","replaceAudio","addTrack","unifiedPlan","audioTransceiver","transceivers","getTransceivers","receiver","replaceTrack","isVideoSendEnabled","addVideo","replaceVideo","videoTransceiver","pc_config","webRTCAdapter","browserDetails","browser","version","pc_constraints","optional","rtcConstraints","RTCRtpSender","prototype","createEncodedStreams","createEncodedAudioStreams","createEncodedVideoStreams","senderTransforms","receiverTransforms","RTCPeerConnection","getStats","volume","bitrate","trickle","oniceconnectionstatechange","iceState","iceConnectionState","onicecandidate","iceDone","mySdp","localDescription","sdpSent","sendSDP","sdpMid","sdpMLineIndex","ontrack","streams","remoteStream","onremotestream","onended","receiverStreams","createAudioEncodedStreams","readableStream","writableStream","pipeThrough","pipeTo","readable","writable","trackMutedTimeoutId","ev","removeTrack","onmute","onunmute","simulcast2","getTracks","forEach","tr","addTransceiver","sendEncodings","rid","active","maxBitrate","scaleResolutionDownBy","senderStreams","isDataEnabled","ondatachannel","channel","onlocalstream","setRemoteDescription","customizeSdp","simulcast","mediaConstraints","audioSend","audioRecv","isAudioRecvEnabled","setDirection","removeAudio","videoSend","videoRecv","isVideoRecvEnabled","removeVideo","offerToReceiveAudio","offerToReceiveVideo","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","sendVideo","parameters","getParameters","setParameters","encodings","createAnswer","answer","setLocalDescription","iceRestart","createOffer","offer","lines","video","ssrc","ssrc_fid","cname","msid","mslabel","insertAt","mline","fid","floor","random","endsWith","mungeSdpForSimulcasting","prepareWebrtc","webrtcError","audio","keepAudio","keepVideo","addData","consentDialog","at","ra","asnd","vt","rv","vsnd","isGetUserMediaAvailable","constraints","audioSupport","videoSupport","screenshareFrameRate","frameRate","screenshareHeight","screenshareWidth","captureDesktopAudio","getUserMedia","audioStream","callbackUserMedia","getScreenMedia","gsmCallback","useAudio","googLeakyBucket","maxWidth","screen","minFrameRate","maxFrameRate","chromeMediaSource","googTemporalLayeredScreencast","chromeMediaSourceId","mozMediaSource","mediaSource","currentTime","polly","setInterval","clearInterval","enumerateDevices","devices","audioExist","some","device","videoExist","isScreenSendEnabled","needAudioDevice","failIfNoAudio","isAudioSendRequired","needVideoDevice","failIfNoVideo","isVideoSendRequired","haveAudioDevice","haveVideoDevice","gumConstraints","prepareWebrtcPeer","getVolume","remote","timer","stats","remoteSource","audioLevel","isMuted","enabled","mute","getBitrate","inStats","mediaType","toLowerCase","bytesReceived","googCodecName","bsnow","tsnow","timestamp","bsbefore","tsbefore","timePassed","bitRate","hangupRequest","oncleanup","getServer","isConnected","getSessionId","getInfo","destroy","unload","notifyDestroyed","cleanupHandles","sendBeacon","unbindWebSocket","onUnbindMessage","onUnbindError","session_id","destroySession","attach","plugin","opaqueId","handleToken","session","started","getId","getPlugin","getRemoteVolume","getLocalVolume","isAudioMuted","muteAudio","unmuteAudio","isVideoMuted","muteVideo","unmuteVideo","handleRemoteJsep","sendRequest","createHandle","UseDefaultDependencies","deps","f","p","socketCls","WebSocket","proto","arr","Array","adapter","fetchOptions","method","credentials","fetching","timerId","race","ok","useOldDependencies","jq","jQuery","payload","contentType","xhrFields","ajax","extend","dataType","async","xhr","status","tracks","mst","trace","usedDependencies","dependencies","listDevices","attachMediaStream","element","srcObject","URL","createObjectURL","reattachMediaStream","to","from","platform","oldOBF","safariVp8","getCapabilities","codecs","codec","mimeType","testpc","tempPc","charSet","randomPoz","substring","sessionCreate","janus","mixertest","registerUsername","participantChangeStatus","myid","currentRole","userColor","webrtcUp","echoCancellation","muted","reloadParams","publish","setup","leaving","localStream","getElementById","pin","myId","is_speaker","is_presenter","is_moderator","participants","participant","exisitingParticipant","current","participantId","participantDisplay","exisiting","prevState","talking","participantChangeRoom","participantRoom","toggleMute","css","forceMute","exitAudioRoom","vsessionCreate","sfutest","vregisterUsername","deviceId","myVroomId","vJoined","ionRequestRoom","vAddParticipant","vNewRemoteFeed","feeds","rfid","remoteFeed","shift","unpublished","vStreamDettacher","videoTracks","vparticipants","vStreamAttacher","publishedCamera","slot","bar","getJsonFromUrl","$f7","view","simulcastStarted","subscribe","ptype","feed","private_id","mypvtid","videoCodec","alert","rfdisplay","vremoveParticipant","vChangeUsername","localVideo","createElement","autoplay","vActive","disher","remove","publishCamera","isAdmin","exact","bitrate_cap","unPublishCamera","videoState","toggleVideoDevice","exitVideoRoom","toggleCamera","dishArea","Increment","Count","Width","Height","Margin","w","h","Scenary","offsetWidth","offsetHeight","Cameras","getElementsByClassName","setWidth","exitAll","onresize","onunload","onbeforeunload","secret","vroomId","vuuid","vpin","backgroundColor","microphoneBtn","cameraBtn","presentBtn","settingsBtn","exitBtn","controls","talkingIndicator","showControl","overflowY","speakerList","listenerList","AttendanceCreate","duty","duties","changeDuty","selected","dutyOptions","ProfileIndex","profiles","short_bio","createBrowserHistory","App","listen","path","component","UserLogin","EventEdit","ExhibitionEdit","MeetingEdit","FlyerEdit","RoomShow","DiscussionIndex","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"ujBAAe,I,sCCEA,M,OAAIA,YCmIbC,EAAa,I,kDAhIjB,aAAe,IAAD,8BACZ,gBACKC,KAAO,GACZ,EAAKC,aAAe,GACpB,EAAKC,SAAW,KAChB,EAAKC,MAAO,KACZ,EAAKC,OAAS,KANF,E,6CASd,SAAUJ,GACRK,KAAKL,KAAO,GACZK,KAAKF,MAAQH,EAAKG,MAClB,IAAK,IAAIG,EAAI,EAAGC,EAAMP,EAAKQ,KAAKC,OAAQH,EAAIC,IAAOD,EACjDD,KAAKL,KAAKU,KAAKV,EAAKQ,KAAKF,IACrBA,IAAMC,EAAM,GACdF,KAAKM,KAAK,YAGS,GAApBX,EAAKQ,KAAKC,QACXJ,KAAKM,KAAK,c,+BAMd,SAAkBX,GAChBY,QAAQC,IAAI,QAASb,GACrBK,KAAKJ,aAAeD,EAAKQ,KACzBH,KAAKF,MAAQH,EAAKG,MAClBE,KAAKM,KAAK,uB,yBAGZ,SAAYT,GACVG,KAAKF,MAAQD,EAASC,MACtBE,KAAKH,SAAWA,EAASM,KACzBH,KAAKM,KAAK,kB,wBAGZ,SAAWT,GACTG,KAAKF,MAAQD,EAASC,MACtBE,KAAKH,SAAWA,EAASM,KACzBH,KAAKM,KAAK,kB,2BAIZ,SAAcT,GACZG,KAAKF,MAAQD,EAASC,MACtBE,KAAKH,SAAWA,EAASM,KACzBH,KAAKM,KAAK,sB,sBAGZ,SAAST,GACPU,QAAQC,IAAIX,GACZG,KAAKF,MAAQD,EAASC,MACtBE,KAAKH,SAAWA,EAASM,KACzBH,KAAKM,KAAK,iB,+BAGZ,SAAkBP,GAChBQ,QAAQC,IAAIT,GACZC,KAAKD,OAAS,QACdC,KAAKF,MAAQ,GACbE,KAAKM,KAAK,kB,uBAGZ,WACE,OAAON,KAAKD,S,wBAGd,WACE,OAAOC,KAAKH,W,qBAGd,WACE,OAAOG,KAAKL,O,2BAGd,WACE,MAAO,CAACK,KAAKL,KAAMK,KAAKF,S,4BAI1B,WACE,OAAOE,KAAKJ,e,sBAGd,WACE,OAAOI,KAAKF,Q,2BAGd,SAAcW,GACZ,OAAOA,EAAOC,MACZ,IAAK,qBACHV,KAAKW,UAAUF,EAAOd,MACtB,MAEF,IAAK,8BACHK,KAAKY,kBAAkBH,EAAOd,MAC9B,MAEF,IAAK,uBACHK,KAAKa,YAAYJ,EAAOZ,UACxB,MAEF,IAAK,0BACHG,KAAKc,cAAcL,EAAOZ,UAC1B,MAEF,IAAK,uBACHG,KAAKe,WAAWN,EAAOZ,UACvB,MAEF,IAAK,oBACHG,KAAKgB,SAASP,EAAOZ,UACrB,MAEF,IAAK,uBACHU,QAAQC,IAAIC,GACZT,KAAKiB,kBAAkBR,EAAOV,a,GAvHbmB,iBAkIzBC,EAAWC,SAAS1B,EAAW2B,cAAcC,KAAK5B,IAEnCA,Q,iBCxIF6B,EAEF,MAFEA,EAGK,4BAHLA,EAUG,mCCPVC,EAAQD,EAKP,SAASE,EAAQC,GAAkC,IAA3BC,EAA0B,uDAArB,EAAGC,EAAkB,uDAAX,GAAIC,EAAO,uCACnDC,EAAcC,OAAOC,KAAKJ,GAAQK,KAAI,SAAAC,GAAG,OAAIA,EAAM,IAAMN,EAAOM,MAAMC,KAAK,KAC/EC,IAAMC,IAAIb,EAAS,IAAKE,EAAO,SAASC,EAAK,IAAIG,EAAa,CAAEQ,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KAC1IU,MAAK,SAAUC,GACdrB,EAAWsB,SAAS,CAClB/B,KAAM,qBACNf,KAAM6C,EAASrC,UAGlBuC,OAAM,SAAUC,GACfpC,QAAQC,IAAImC,MAIT,SAASC,EAAgBlB,GAAkC,IAA3BC,EAA0B,uDAArB,EAAGC,EAAkB,uDAAX,GAAIC,EAAO,uCAC3DC,EAAcC,OAAOC,KAAKJ,GAAQK,KAAI,SAAAC,GAAG,OAAIA,EAAM,IAAMN,EAAOM,MAAMC,KAAK,KAC/EC,IAAMC,IAAIb,EAAS,IAAKE,EAAO,SAASC,EAAK,IAAIG,EAAa,CAAEQ,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KAC1IU,MAAK,SAAUC,GACdrB,EAAWsB,SAAS,CAClB/B,KAAM,8BACNf,KAAM6C,EAASrC,UAGlBuC,OAAM,SAAUC,GACfpC,QAAQC,IAAImC,MA0BT,SAASE,EAAYnB,EAAOoB,EAAIjB,GAAgB,IAATF,EAAQ,uDAAH,EACjDS,IAAMC,IAAIb,EAAS,IAAKE,EAAO,IAAIoB,EAAG,SAASnB,EAAM,CAAEW,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KACjIU,MAAK,SAAUC,GACdrB,EAAWsB,SAAS,CAClB/B,KAAM,uBACNb,SAAU2C,EAASrC,UAGtBuC,OAAM,SAAUC,GACfpC,QAAQC,IAAImC,MAIT,SAASI,EAAerB,GAA2B,IAApBE,EAAmB,uDAAZ,GAAIC,EAAQ,uCACnDC,EAAcC,OAAOC,KAAKJ,GAAQK,KAAI,SAAAC,GAAG,OAAIA,EAAM,IAAMN,EAAOM,MAAMC,KAAK,KAC/EC,IAAMC,IAAIb,EAAS,IAAKE,EAAO,WAAWI,EAAa,CAAEQ,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KACnIU,MAAK,SAAUC,GACdrB,EAAWsB,SAAS,CAClB/B,KAAM,0BACNb,SAAU2C,EAASrC,UAGtBuC,OAAM,SAAUC,GACfpC,QAAQC,IAAImC,MAIT,SAASK,EAAYtB,EAAOvB,EAAM0B,GACvCO,IAAMa,KAAKzB,EAAS,IAAKE,EAAO,IAAKvB,EAAM,CAAEmC,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KACvHU,MAAK,SAAUC,GACdrB,EAAWsB,SAAS,CAClB/B,KAAM,uBACNb,SAAU2C,EAASrC,UAGtBuC,OAAM,SAAUC,GACfxB,EAAWsB,SAAS,CAClB/B,KAAM,uBACNb,SAAU8C,EAAM5C,SAElBQ,QAAQC,IAAImC,MAIT,SAASO,EAAexB,EAAOvB,EAAM0B,GAC1CO,IAAMe,IAAI3B,EAAS,IAAKE,EAAO,IAAIvB,EAAK2C,GAAI3C,EAAM,CAAEmC,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KAC9HU,MAAK,SAAUC,GACdrB,EAAWsB,SAAS,CAClB/B,KAAM,uBACNb,SAAU2C,EAASrC,UAGtBuC,OAAM,SAAUC,GACfpC,QAAQC,IAAImC,M,aC/GHS,EAAO,CAClBC,IAAE,GACA,SAAY,8CACZ,OAAU,mDACV,KAAQ,2BACR,SAAY,wCACZ,MAAS,6CAET,aAAe,4EACf,YAAc,sEACd,WAAa,0DACb,WAAa,0DACb,MAAQ,uCACR,aAAe,sEACf,kBAAoB,sEACpB,UAAa,iCACb,OAAU,2BACV,OAAU,uCACV,cAAgB,wHAEhB,aAAe,8CACf,cAAgB,0DAChB,eAAiB,gEACjB,aAAe,8CACf,iBAAoB,0DACpB,sBAAyB,oDACzB,mBAAsB,oDACtB,iBAAoB,0DACpB,iBAAoB,mFACpB,eAAiB,0DACjB,oBAAsB,0DACtB,gBAAmB,gEACnB,gBAAmB,6GAGnB,gBAAkB,qBAClB,kBAAqB,gEACrB,iBAAmB,0FApCnB,iCAqCoB,oFArCpB,cAsCA,oBAAoB,2DAtCpB,cAuCA,yBAAyB,2DAvCzB,cAwCA,cAAe,oDAxCf,cAyCA,WAAY,yCAzCZ,cA0CA,wBAAyB,iGA1CzB,cA4CA,sBAAuB,6LA5CvB,cA6CA,eAAe,uEA7Cf,cA8CA,mBAAoB,gGA9CpB,cAgDA,QAAQ,kCAhDR,cAiDA,eAAe,iEAjDf,cAkDA,aAAa,2DAlDb,cAmDA,cAAc,2DAnDd,cAoDA,eAAe,kEApDf,cAqDA,oBAAoB,kPArDpB,cAuDA,gBAAgB,6EAvDhB,cAwDA,eAAe,2DAxDf,cAyDA,4BAA4B,0JAzD5B,cA0DA,QAAS,4BA1DT,cA2DA,OAAS,4BA3DT,cA4DA,QAAS,kCA5DT,cA6DA,cAAe,iEA7Df,cA8DA,YAAa,kCA9Db,cA+DA,MAAO,sBA/DP,cAiEA,YAAa,yEAjEb,cAkEA,uBAAuB,+CAlEvB,cAmEA,kBAAkB,+CAnElB,cAoEA,mBAAmB,+CApEnB,cAqEA,8BAA8B,yJArE9B,cAsEA,GAAG,IAtEH,cAwEA,QAAS,8CAxET,cAyEA,UAAU,wCAzEV,cA0EA,UAAU,qDA1EV,cA2EA,eAAe,6cA3Ef,cA4EA,cAAc,8GA5Ed,cA6EA,aAAa,kCA7Eb,cA8EA,YAAY,+CA9EZ,cA+EA,kBAAkB,mFA/ElB,cAgFA,kBAAkB,6EAhFlB,cAiFA,gBAAgB,yJAjFhB,cAkFA,uBAAuB,+EAlFvB,cAmFA,sBAAsB,iIAnFtB,cAoFA,oBAAqB,8GApFrB,cAqFA,QAAQ,qDArFR,cAsFA,UAAU,kEAtFV,cAuFA,WAAW,+CAvFX,cAwFA,qBAAqB,iGAxFrB,iBAyFG,IAzFH,cA2FA,MAAM,0FA3FN,cA4FA,OAAO,kCA5FP,cA6FA,YAAY,+CA7FZ,cA8FA,UAAU,+CA9FV,cA+FA,SAAS,4BA/FT,cAgGA,kBAAkB,iFAhGlB,cAiGA,yBAAyB,sIAjGzB,cAkGA,SAAS,wCAlGT,cAmGA,SAAS,sBAnGT,cAoGA,SAAS,+CApGT,cAqGA,qBAAqB,qCArGrB,cAsGA,iBAAkB,qDAtGlB,cAuGA,OAAO,kCAvGP,cAwGA,oBAAoB,wEAxGpB,cAyGA,OAAQ,+CAzGR,cA0GA,aAAa,kCA1Gb,cA2GA,WAAY,uEA3GZ,cA4GA,YAAa,oDA5Gb,cA6GA,YAAa,4BA7Gb,cA8GA,WAAY,wCA9GZ,cA+GA,YAAa,iEA/Gb,cAgHA,UAAW,2DAhHX,cAiHA,WAAW,kCAjHX,cAkHA,aAAc,kEAlHd,cAmHA,0BAA0B,wbAnH1B,I,OCKiBC,E,kDAEjB,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKkC,OAAS,EAAKA,OAAOlC,KAAZ,gBAEd,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCC,QAAS,CAAEC,KAAM,GAAIC,SAAU,KAPpB,E,sDAanB,WACIC,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAGvC,WACImB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGnD,WACO7C,KAAKyD,MAAM5B,OAAS7B,KAAKyD,MAAM5B,MAAMzB,OAAS,GAC7C+D,EAAsB,cAAe,EAAGnE,KAAKyD,MAAM5B,OAEnD7B,KAAKuD,MAAMa,QAAQ/D,KAAK,W,yBAKhC,WACI,IAAIwD,EAAUG,EAAWK,aACrBvE,EAAQkE,EAAWM,WACnBT,GAAqB,YAAV/D,GACXE,KAAKuE,SAAS,CACVV,QAASA,M,0BAOrB,SAAaW,M,oBAIb,WACIxE,KAAKuE,SAAS,CAAE1C,MAAO,OACvB6B,OAAOC,aAAac,WAAW,SAC/Bf,OAAOgB,SAASC,QAAQ,O,oBAM5B,WAAU,IAAD,OACCC,EAAIxB,EAAI,GACd,OACI,wBAAQyB,UAAU,mDAAlB,SACI,sBAAKA,UAAU,eAAf,UACI,wBACIA,UAAU,iBACVnE,KAAK,SACLoE,iBAAe,WACfC,iBAAe,eAJnB,SAMI,sBAAMF,UAAU,0BAEpB,oBAAIA,UAAU,2EAAd,SACI,mBAAGG,KAAK,UAEZ,sBAAKH,UAAU,oCAAf,UACI,qBAAKI,MAAM,iCAAX,SACI,oBAAGD,KAAK,iBAAiBH,UAAU,gBAAnC,UACI,sBAAKK,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,4CAA4C,sBAAMC,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UAAU,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,IAAIC,GAAG,UAAU,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,aAC/Z,sBAAMlB,UAAU,sBAIxB,sBAAKA,UAAU,oBAAf,UACI,oBACIG,KAAK,IACLH,UAAU,sCACVC,iBAAe,WACfkB,aAAW,iBAJf,UAMI,sBAAMnB,UAAU,mBAAhB,SAAoC7E,KAAKyD,MAAMI,QAAQE,WACvD,sBAAKc,UAAU,kBAAf,UACI,8BAAM7E,KAAKyD,MAAMI,QAAQC,OACzB,qBAAKe,UAAU,gCAGvB,qBAAKA,UAAU,sDAAf,SACI,mBAAGoB,QAAS,kBAAM,EAAKzC,UAAUqB,UAAU,gBAA3C,SACKD,EAAC,iBAKlB,qBAAKC,UAAU,2BAA2B/B,GAAG,cAA7C,SACI,qBAAK+B,UAAU,qFAAf,SACI,qBAAIA,UAAU,aAAd,UACI,oBAAIA,UAAU,WAAd,SACI,oBAAGA,UAAU,WAAWG,KAAK,MAA7B,UACI,sBAAMH,UAAU,4CAAhB,SACI,sBACIK,MAAM,6BACNL,UAAU,OACVM,MAAM,KACNC,OAAO,KACPC,QAAQ,YACRC,eAAa,IACbC,OAAO,eACPC,KAAK,OACLC,iBAAe,QACfC,kBAAgB,QAVpB,UAYI,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAC3C,0BAAUU,OAAO,+BACjB,sBAAMP,EAAE,+CACR,sBAAMA,EAAE,mDAGhB,sBAAMd,UAAU,iBAAhB,SAAkCD,EAAC,YAI3C,oBAAIC,UAAU,WAAd,SACI,oBAAGA,UAAU,WAAWG,KAAK,YAA7B,UACI,sBAAMH,UAAU,4CAAhB,SACI,sBAAKK,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMW,EAAE,IAAIC,EAAE,IAAIjB,MAAM,KAAKC,OAAO,KAAKiB,GAAG,MAAM,sBAAMT,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIC,GAAG,MAAM,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMI,EAAE,IAAIC,EAAE,KAAKjB,MAAM,IAAIC,OAAO,WAEjc,sBAAMP,UAAU,iBAAhB,SAAkCD,EAAC,cAI3C,oBAAIC,UAAU,WAAd,SACI,oBAAGA,UAAU,WAAWG,KAAK,cAA7B,UACI,sBAAMH,UAAU,4CAAhB,SACI,sBAAKK,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMJ,EAAE,gDAAgD,sBAAMC,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,6BAE9a,sBAAMd,UAAU,iBAAhB,SAAkCD,EAAC,gBAI3C,oBAAIC,UAAU,WAAd,SACI,oBAAGA,UAAU,WAAWG,KAAK,iBAA7B,UACI,sBAAMH,UAAU,4CAAhB,SACI,sBAAKK,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,sBAAMZ,GAAG,MAAMC,GAAG,IAAIC,GAAG,OAAOC,GAAG,MAAM,sBAAMH,GAAG,MAAMC,GAAG,KAAKC,GAAG,OAAOC,GAAG,OAAO,sBAAMJ,EAAE,6BAA6B,sBAAMA,EAAE,kCAE3Z,sBAAMd,UAAU,iBAAhB,SAAkCD,EAAC,mBAI3C,oBAAIC,UAAU,WAAd,SACI,oBAAGA,UAAU,WAAWG,KAAK,cAA7B,UACI,sBAAMH,UAAU,4CAAhB,SACI,sBAAKK,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,IAAIC,GAAG,IAAIC,EAAE,MAAM,sBAAMb,EAAE,8CAA8C,sBAAMA,EAAE,8BAA8B,sBAAMA,EAAE,sCAE5X,sBAAMd,UAAU,iBAAhB,SAAkCD,EAAC,6B,GAjKvC6B,IAAMC,W,iCCD1CC,IAAOC,OAAO,KAAM,CAAEC,oBAAoB,IAE1C,IAAMjC,EAAIxB,EAAI,GA2FC0D,EAzFG,SAACvD,GAEf,SAASwD,EAAoBC,GACzB,IAAIC,EAAO,IAAIC,KAAKF,GAChBG,EAAMF,EAAKG,UACXC,EAAQJ,EAAKK,WAAa,EAK9B,OAJWL,EAAKM,cAGM,IAAMF,EAAQ,IAAMF,EAAM,IAFpCF,EAAKO,WAE6C,IADhDP,EAAKQ,aAMvB,SAASC,EAAUC,GACf,GAAIA,EAAMC,MACN,OACI,mBAAG5C,KAAM,aAAe2C,EAAM7E,GAA9B,SACI,qBAAKmC,MAAM,mDAAmD4C,MAAO,CAAEC,gBAAiB,OAASH,EAAMC,MAAQ,SAM/H,SAASG,EAASC,GACd,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACtB4H,EAAK/F,KAAI,SAACiG,GACND,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAG3EH,EAoDX,OACI,cAAC,IAAMI,SAAP,UAlDJ,WACI,IAAIJ,EAAS,GA6Cb,OA5CI1E,EAAM+E,QACN/E,EAAM+E,OAAOrG,KAAI,SAAC0F,GACdM,EAAO5H,KAEH,qBAAKwE,UAAWtB,EAAMgF,IAAM,UAAYhF,EAAMgF,IAAM,WAApD,SACI,sBAAK1D,UAAU,OAAf,UACK6C,EAAUC,GACX,sBAAK9C,UAAU,YAAf,UACI,oBAAII,MAAM,aAAV,SACI,mBAAGD,KAAM,aAAe2C,EAAM7E,GAA9B,SACK6E,EAAMS,UAGf,mBAAGP,MAAO,CAAEW,UAAW,WAAvB,SACKb,EAAMc,iBAGX,+BAAK7D,EAAC,WAAN,OACA,qBAAKK,MAAM,kBAAX,SACKL,EAAE+C,EAAMe,cAKb,+BAAK9D,EAAC,mBAAN,OACA,qBAAKK,MAAM,kBAAX,SACK0B,IAAOI,EAAoBY,EAAMgB,aAAaC,OAAO,yBAG1D,+BAAKhE,EAAC,iBAAN,OACA,qBAAKK,MAAM,kBAAX,SACK0B,IAAOI,EAAoBY,EAAMkB,WAAWD,OAAO,sBAGxD,6BAAKhE,EAAC,OACN,qBAAKK,MAAM,kBAAX,SACK8C,EAASJ,EAAMK,oBAQrCC,EAKFa,MCufEC,EAhlBK,SAACxF,GACjB,OACJ,qBAAKsB,UAAU,WAAf,SACgB,sBAAKA,UAAU,OAAOgD,MAAO,CAACzC,OAAQ,SAAtC,UACI,qBAAKP,UAAU,cAAf,8BACF,sBAAKA,UAAU,8EAAf,UACE,qBAAKA,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,kBAAU9D,MAAM,KAAKC,OAAO,SAE9H,sBAAKP,UAAU,MAAf,4BAEE,qBAAKA,UAAU,aAAf,iDAMF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,YAAY9D,MAAM,KAAKC,OAAO,SAEhI,sBAAKP,UAAU,MAAf,sBAEE,qBAAKA,UAAU,aAAf,0BAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,UAAU9D,MAAM,KAAKC,OAAO,SAE9H,sBAAKP,UAAU,MAAf,oBAEE,qBAAKA,UAAU,aAAf,kCAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,iBAAiB9D,MAAM,KAAKC,OAAO,SAErI,sBAAKP,UAAU,MAAf,2BAEE,qBAAKA,UAAU,aAAf,+BAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,cAAc9D,MAAM,KAAKC,OAAO,SAElI,sBAAKP,UAAU,MAAf,wBAEE,qBAAKA,UAAU,aAAf,8BAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,kBAAsB9D,MAAM,KAAKC,OAAO,SAE1I,sBAAKP,UAAU,MAAf,4BAEE,qBAAKA,UAAU,aAAf,yBAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,cAAc9D,MAAM,KAAKC,OAAO,SAElI,sBAAKP,UAAU,MAAf,wBAEE,qBAAKA,UAAU,aAAf,4CAMF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,WAAW9D,MAAM,KAAKC,OAAO,SAE/H,sBAAKP,UAAU,MAAf,qBAEE,qBAAKA,UAAU,aAAf,oCAKF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,eAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,eAAe9D,MAAM,KAAKC,OAAO,SAEnI,sBAAKP,UAAU,MAAf,yBAEE,qBAAKA,UAAU,aAAf,2BAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,gBAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,QAAQ9D,MAAM,KAAKC,OAAO,SAE5H,sBAAKP,UAAU,MAAf,kBAEE,qBAAKA,UAAU,aAAf,4BAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,gBAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,eAAe9D,MAAM,KAAKC,OAAO,SAEnI,sBAAKP,UAAU,MAAf,yBAEE,qBAAKA,UAAU,aAAf,sBAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,yCAQV,qBAAKH,UAAU,kBAAf,SACE,sBAAKA,UAAU,6BAAf,UACE,qBAAKA,UAAU,mBAAf,gBAGA,qBAAKA,UAAU,WAAf,SACE,qBAAKmE,IAAI,+DAA+DnE,UAAU,UAAUoE,IAAI,UAAU9D,MAAM,KAAKC,OAAO,SAE9H,sBAAKP,UAAU,MAAf,oBAEE,qBAAKA,UAAU,aAAf,2BAIF,qBAAKA,UAAU,sBAAf,mBAGA,qBAAKA,UAAU,WAAf,SACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAtB,SACE,yBAAQA,UAAU,cAAcC,iBAAe,cAA/C,UACE,sBAAMD,UAAU,2BAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,0FAEzQ,sBAAMd,UAAU,yBAAhB,SAEE,sBAAKK,MAAM,6BAA6BL,UAAU,mBAAmBM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,iGAK3R,qBAAKd,UAAU,gBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,mBAAGG,KAAK,IAAIH,UAAU,iBAAiBC,iBAAe,WAAtD,SACE,sBAAKI,MAAM,6BAA6BL,UAAU,OAAOM,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA9L,UAAsM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,WAExW,sBAAK3B,UAAU,kCAAf,UACE,mBAAGA,UAAU,gBAAgBG,KAAK,IAAlC,oBAGA,mBAAGH,UAAU,gBAAgBG,KAAK,IAAlC,kDCrhBfkE,EA9CQ,SAAC3F,GACpB,IAAMqB,EAAIxB,EAAI,GAwBd,OAEI,sBAAKyB,UAAU,YAAYgD,MAAOtE,EAAM6B,OAAS,CAAEA,OAAQ7B,EAAM6B,QAAW,CAAEA,OAAQ,QAAtF,UACI,sBAAKP,UAAU,cAAf,UACI,oBAAII,MAAM,aAAV,SAAwBL,EAAC,eACzB,oBAAIK,MAAM,kCAAV,SAjBZ,WACI,GAAI1B,EAAM4F,SACN,OACI,oBAAIlE,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,yBAA2BzB,EAAM6F,gBAAkB,OAAS7F,EAAM8F,cAAhG,SACI,sBAAKnE,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,IAAIC,GAAG,IAAIC,EAAE,MAAM,sBAAMb,EAAE,8CAA8C,sBAAMA,EAAE,4BAarV2D,QAGT,qBAAKzE,UAAU,6DAAf,SAEI,qBAAKI,MAAM,kCAAX,SAlCZ,WACI,IAAIgD,EAAS,GAOb,OANI1E,EAAMgG,WACNhG,EAAMgG,UAAUtH,KAAI,SAACuH,GACjBvB,EAAO5H,KAAK,sBAAM4E,MAAM,kCAAZ,SAAgDuE,EAASzF,eAItEkE,EA2BMsB,W,GCjCkB9C,IAAMC,U,gBCFvC+C,EAAiBC,YAAUC,KAC3BnI,EAASD,EACTqD,EAAIxB,EAAI,GAEOwG,E,kDAEjB,WAAYrG,GAAQ,IAAD,8BACf,cAAMA,IACDsG,OAAS,EAAKA,OAAOvI,KAAZ,gBACd,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCmG,MAAO,KACPjG,KAAM,KACNkG,SAAU,KACVC,sBAAuB,KACvBnH,GAAI,KACJoH,IAAK,KACLC,QAAS,KACTpG,SAAU,KACVqG,QAAS,GACTpC,KAAM,IAlBK,E,sDAyBnB,WACIhE,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAGvC,WACImB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGnD,WACQ7C,KAAKyD,MAAM5B,OAA8B,KAArB7B,KAAKyD,MAAM5B,OAC/BsC,EAAsB,cAAe,IAAKnE,KAAKyD,MAAM5B,S,yBAI7D,WACI,IAAIgC,EAAUG,EAAWK,aACrBvE,EAAQkE,EAAWM,WACnBT,GAAqB,YAAV/D,IACXE,KAAKuE,SAAS,CACVzB,GAAIe,EAAQf,GACZgB,KAAMD,EAAQC,KACdoG,IAAKrG,EAAQqG,IACbC,QAAStG,EAAQsG,QACjBpG,SAAUF,EAAQE,SAClBiE,KAAMnE,EAAQmE,OAElBzH,QAAQC,IAAIqD,EAAQmE,S,0BAK5B,SAAaxD,GACTxE,KAAKuE,SAASC,K,yBAGlB,WACI,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,WAAVvE,IACA4D,OAAOC,aAAa0G,QAAQ,QAAS3I,EAAMG,OAC3C6B,OAAOgB,SAAS4F,UAEN,YAAVxK,GACAE,KAAKuD,MAAMa,QAAQ/D,KAAK,S,oBAKhC,WAEI8D,EAAsB,gBADXnE,KAAKyD,S,2BAIpB,WAEIU,EAAyB,WADdnE,KAAKyD,MAC2BzD,KAAKyD,MAAM5B,S,yBAG1D,SAAYmG,GAAO,IAAD,OACVC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACFA,EAAG,MACHD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGpBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,yBAGjE,WACI,OAAKhI,KAAKyD,MAAM5B,OAA8B,KAArB7B,KAAKyD,MAAM5B,MAGxB7B,KAAKuK,WAFLvK,KAAKwK,gB,yBAMrB,WAAe,IAAD,OACV,OACI,eAAC,IAAMnC,SAAP,WACI,qBAAKpD,MAAM,mBAAX,SACI,mBAAGD,KAAK,IAAR,SAAY,qBAAKgE,IAAI,oBAAoB5D,OAAO,KAAK6D,IAAI,SAE7D,sBAAKhE,MAAM,eAAX,UACI,sBAAKA,MAAM,oCAAX,UACI,qBAAK+D,IAAI,iDAAiD5D,OAAO,MAAMH,MAAM,QAAQgE,IAAI,KACzF,oBAAIhE,MAAM,OAAV,SAAkBL,EAAC,UACnB,mBAAGK,MAAM,aAAT,SAAuBL,EAAC,eACxB,mBAAGK,MAAM,aAAT,SAAuBL,EAAC,sBACxB,mBAAGI,KAAK,WAAWC,MAAM,gCAAzB,SACGL,EAAC,WAGR,qBAAKK,MAAM,2CAAX,SAAuDL,EAAC,cACxD,sBAAKK,MAAM,YAAX,UACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,aAC5B,sBAAKK,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,uBAAOvE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEC,MAAOW,EAAEC,OAAOC,SAAY3F,MAAM,oBAAoB4F,aAAa,WAEhI,qBAAK5F,MAAM,iBAGf,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,YAC5B,sBAAKK,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,uBAAOvE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEhG,KAAM4G,EAAEC,OAAOC,SAAY3F,MAAM,oBAAoB4F,aAAa,WAE/H,qBAAK5F,MAAM,iBAGf,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,kBAC5B,sBAAKK,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,uBAAOvE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEE,SAAUU,EAAEC,OAAOC,SAAY3F,MAAM,oBAAoB4F,aAAa,WAEnI,qBAAK5F,MAAM,YAAX,SAAwBL,EAAC,mBAG7B,sBAAKK,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,kBAC5B,sBAAKK,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,uBAAOvE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEG,sBAAuBS,EAAEC,OAAOC,SAAY3F,MAAM,oBAAoB4F,aAAa,WAEhJ,qBAAK5F,MAAM,uBAIvB,sBAAKA,MAAM,8BAAX,UACI,qBAAKA,MAAM,QAAX,SACI,qBAAKA,MAAM,WAAX,SACI,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,OAAS2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAAzH,SACI,sBAAMhG,MAAM,kBAAZ,gCAIZ,qBAAKA,MAAM,MAAX,SACI,qBAAKA,MAAM,+BAAX,SACI,wBAAQgB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,kBAA5C,SACCL,EAAC,mC,sBAS1B,WAAY,IAAD,OACP,GAAI5E,KAAKyD,MAAMX,GACX,OACI,eAAC,IAAMuF,SAAP,WACI,sBAAKpD,MAAM,eAAX,UACI,sBAAKA,MAAM,oCAAX,UACI,sBAAMA,MAAM,uCAAZ,SAAoDjF,KAAKyD,MAAMM,WAC/D,mBAAGkB,MAAM,aAAT,qDAGJ,qBAAKA,MAAM,2CAAX,mCAEA,sBAAKA,MAAM,YAAX,UACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,0BACA,sBAAKA,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,cAAC,IAAD,CAAiBiG,QAAS,oBAAqBC,gBAAiB,CAAC,KAAM,KAAM,MAAOP,MAAO5K,KAAKyD,MAAM0G,QAASiB,SAAU,SAACC,GAAD,OAAS,EAAKvB,aAAa,CAAEK,QAASkB,aAIvK,sBAAKpG,MAAM,OAAX,UACI,wBAAOA,MAAM,aAAb,gBAA6B,sBAAMA,MAAM,8BACzC,0BACIA,MAAM,eACNnB,KAAK,yBACLwH,KAAK,IACLC,YAAY,4BACZd,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEI,IAAKQ,EAAEC,OAAOC,SACpDA,MAAO5K,KAAKyD,MAAMyG,SAG1B,qBAAKjF,MAAM,OAAX,SACI,cAACwE,EAAD,CACI3G,GAAG,SACH0I,UAAQ,EACRC,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACP,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,EAAS,kBAAoBsK,GAC9BvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACL,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAG7FgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACpB,cAAC,IAAM8E,SAAP,UACI,+BAAOgE,EAAOjE,qBAQtC,sBAAKnD,MAAM,8BAAX,UACI,qBAAKA,MAAM,QAAX,SACI,qBAAKA,MAAM,WAAX,SACI,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,OAAS2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAAzH,SACI,sBAAMhG,MAAM,kBAAZ,gCAIZ,qBAAKA,MAAM,MAAX,SACI,sBAAKA,MAAM,+BAAX,UACI,mBAAGD,KAAK,MAAMC,MAAM,8BAApB,4BAGA,wBAAQgB,QAAS,kBAAM,EAAKqG,iBAAiBrH,MAAM,kBAAnD,mC,oBAY5B,WACI,OACI,qBAAKA,MAAM,mBAAX,SACI,qBAAKA,MAAM,uBAAX,SACKjF,KAAKuM,sB,GA/Qc9F,IAAMC,WCFxC9B,GAFiB8E,YAAUC,KAEvBvG,EAAI,IAEOwG,E,kDAEjB,WAAYrG,GAAQ,IAAD,8BACf,cAAMA,IACDsG,OAAS,EAAKA,OAAOvI,KAAZ,gBACd,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCmG,MAAO,KACPC,SAAU,MATC,E,sDAgBnB,WACIhG,EAAWC,GAAG,eAAgBjE,KAAKgD,e,kCAGvC,WACIgB,EAAWE,eAAe,eAAgBlE,KAAKgD,e,+BAGnD,WACQhD,KAAKyD,MAAM5B,OAAS7B,KAAKyD,MAAM5B,Q,0BAOvC,SAAa2C,GACTxE,KAAKuE,SAASC,K,yBAGlB,WACI,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,UAAVvE,IACA4D,OAAOC,aAAa0G,QAAQ,QAAS3I,EAAMG,OAC3C7B,KAAKuD,MAAMa,QAAQ/D,KAAK,gB,oBAKhC,WAEI8D,EAAsB,cADXnE,KAAKyD,S,oBAIpB,WAAU,IAAD,OACL,OACI,qBAAKwB,MAAM,mBAAX,SACI,qBAAKA,MAAM,uBAAX,SACI,eAAC,IAAMoD,SAAP,WACI,qBAAKpD,MAAM,mBAAX,SACI,mBAAGD,KAAK,IAAR,SAAY,qBAAKgE,IAAI,oBAAoB5D,OAAO,KAAK6D,IAAI,SAE7D,sBAAKhE,MAAM,eAAX,UACI,sBAAKA,MAAM,oCAAX,UACI,qBAAK+D,IAAI,iDAAiD5D,OAAO,MAAMH,MAAM,QAAQgE,IAAI,KACzF,oBAAIhE,MAAM,OAAV,SAAkBL,EAAC,UACnB,mBAAGK,MAAM,aAAT,SAAuBL,EAAC,eACxB,mBAAGK,MAAM,aAAT,SAAuBL,EAAC,oBACxB,mBAAGI,KAAK,YAAYC,MAAM,gCAA1B,SACKL,EAAC,aAGV,qBAAKK,MAAM,2CAAX,SAAuDL,EAAC,YACxD,sBAAKK,MAAM,YAAX,UACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,aAC5B,sBAAKK,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,uBAAOvE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEC,MAAOW,EAAEC,OAAOC,SAAY3F,MAAM,oBAAoB4F,aAAa,WAEhI,qBAAK5F,MAAM,iBAIf,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,WAC5B,sBAAKK,MAAM,+BAAX,UACI,sBAAMA,MAAM,qBACZ,uBAAOvE,KAAK,WAAW+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEE,SAAUU,EAAEC,OAAOC,SAAY3F,MAAM,oBAAoB4F,aAAa,oBAKnJ,sBAAK5F,MAAM,8BAAX,UACI,qBAAKA,MAAM,UAGX,qBAAKA,MAAM,MAAX,SACI,sBAAKA,MAAM,+BAAX,UACI,wBAAQD,KAAK,8FAA8FC,MAAM,kBAAjH,SACKL,EAAC,MAGN,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,kBAA5C,SACKL,EAAC,2B,GAvGF6B,IAAMC,W,qDCAxC+C,GAAiBC,YAAUC,KAC3BnI,GAASD,EAETqD,GAAIxB,EAAI,GAEOoJ,G,kDAEjB,WAAYjJ,GAAQ,IAAD,8BACf,cAAMA,IACD9B,QAAU,EAAKA,QAAQH,KAAb,gBACf,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPE,OAAQ,KACRmE,QAAS,KACTC,EAAG,GACHC,WAAYhG,MACZiG,SAAUjG,MAASkG,IAAI,EAAG,UAC1B7E,KAAM,GACNrG,KAAM,GAdK,E,sDAoBnB,WACIqC,EAAWC,GAAG,WAAYjE,KAAKyB,W,kCAGnC,WACIuC,EAAWE,eAAe,WAAYlE,KAAKyB,W,+BAG/C,WACI0C,EAAkB,SAAUnE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,OAC5DsC,EAAkB,WAAYnE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,S,qBAGlE,WACI,IAAIlC,EAAOqE,EAAWvC,UAClB3B,EAAQkE,EAAWM,WAEnB3E,GAAkB,UAAVG,IACRgN,IAAE,mBAAmBC,OACjBpN,EAAK,IAAMA,EAAK,GAAGgC,MACC,GAAhBhC,EAAK,GAAGgC,KACR3B,KAAKuE,SAAS,CACV+D,OAAQ3I,IAGZK,KAAKuE,SAAS,CACV+D,OAAQtI,KAAKyD,MAAM6E,OAAO0E,OAAOrN,KAGzCK,KAAKuE,SAAS,CAAE5C,KAAMhC,EAAK,GAAGgC,QAE9B3B,KAAKuE,SAAS,CACV+D,OAAQ,KAGhB/H,QAAQC,IAAIb,IAEZA,GAAkB,QAAVG,GACRE,KAAKuE,SAAS,CACVkI,QAAS9M,M,0BAOrB,SAAa6E,GACTxE,KAAKuE,SAASC,K,yBAIlB,c,wBAqBA,WACI,OAAIxE,KAAKyD,MAAM6E,OAEP,eAAC,IAAMD,SAAP,WACI,qBAAKpD,MAAM,QAAX,SACI,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,4BACX,sBAAKJ,UAAU,cAAf,UACI,oBAAII,MAAM,aAAV,SAAwBL,GAAC,SACzB,oBAAIK,MAAM,kCAAV,SACI,oBAAIA,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,mBAA9B,SACI,sBAAKE,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,mBAK7U,qBAAKd,MAAM,YAAX,SACI,qNAMZ,cAAC,EAAD,CAAWqD,OAAQtI,KAAKyD,MAAM6E,OAAQC,IAAK,OAI3CvI,KAAKiN,gB,yBAIrB,WACI,GAAIjN,KAAKyD,MAAM6E,OACX,OACI,qBAAKrD,MAAM,gBAAgBiI,eAAa,6BAAxC,SACI,cAAC,EAAD,CAAW5E,OAAQtI,KAAKyD,MAAM6E,OAAQC,IAAK,Q,oBAM3D,WACIuE,IAAE,mBAAmBK,OACrB,IAAIhN,EAAO,CAAEuM,EAAG1M,KAAKyD,MAAMiJ,EAAGC,WAAY3M,KAAKyD,MAAMkJ,WAAYC,SAAU5M,KAAKyD,MAAMmJ,SAAU5E,KAAMhI,KAAKyD,MAAMuE,MACjH7D,EAAkB,gBAAiBnE,KAAKyD,MAAM9B,KAAMxB,EAAMH,KAAKyD,MAAM5B,OACrE7B,KAAKuE,SAAS,CAAE5C,KAAM,M,yBAG1B,WAAe,IAAD,OACNsG,EAAS,GAab,OAZIjI,KAAKyD,MAAMgJ,SACXzM,KAAKyD,MAAMgJ,QAAQxK,KAAI,SAACiG,GACpBD,EAAO5H,KACH,wBAAO4E,MAAM,aAAb,UACI,uBAAOnC,GAAI,aAAeoF,EAAIpF,GAAImC,MAAM,mBAAmBvE,KAAK,WAAWmH,MAAO,CAAEuF,UAAW,SAAWxC,MAAO1C,EAAIpF,GAAIsI,SAAU,SAACV,GAAD,OAAO,EAAK2C,WAAW3C,MAC1J,sBAAMzF,MAAM,mBAAZ,SACI,sBAAMA,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,iBAM3EH,I,yBAGX,SAAYD,GAAO,IAAD,OACVC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACFA,EAAG,MACHD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGpBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,sBAGjE,WAAY,IAAD,OACP,OACI,qBAAKH,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACI,cAAC,GAAD,CACIzK,GAAG,aACH2I,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACP,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAC9BvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACL,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAG7FgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACpB,cAAC,IAAM8E,SAAP,UACI,+BAAOgE,EAAOjE,iB,sBAStC,WACI,IAAIjI,EAAO,CAAE2C,GAAI9C,KAAKyD,MAAMX,GAAInB,KAAM3B,KAAKyD,MAAM9B,KAAO,EAAG+K,EAAG1M,KAAKyD,MAAMiJ,EAAGC,WAAY3M,KAAKyD,MAAMkJ,WAAYC,SAAU5M,KAAKyD,MAAMmJ,SAAU5E,KAAMhI,KAAKyD,MAAMuE,MAC/J7D,EAAkB,gBAAiBnE,KAAKyD,MAAM9B,KAAMxB,EAAMH,KAAKyD,MAAM5B,S,oBAIzE,WAAU,IAAD,OAEL,OACI,sBAAMgD,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,qBAAKA,UAAU,2BAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,YAEjC,qBAAKK,MAAM,gCAAX,SACI,qBAAKA,MAAM,WAAX,SACI,oBAAGD,KAAM,mBAAoBC,MAAM,kBAAnC,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAY,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UACtUnB,GAAC,2BAO1B,qBAAKC,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKI,MAAM,MAAX,UACI,qBAAKA,MAAM,WAAX,SACI,sBAAKA,MAAM,YAAX,UACI,qBAAKJ,UAAU,cAAf,SACI,qBAAII,MAAM,aAAV,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,kFAC7Pf,GAAC,mBAIV,sBAAKK,MAAM,YAAX,UACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,iBAC5B,sBAAKK,MAAM,kBAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAa3G,GAAC,mBAAwB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE4C,EAAGhC,EAAEC,OAAOC,WAChI,sBAAM3F,MAAM,mBAAZ,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,kBAI/U,sBAAKd,MAAM,OAAO4C,MAAO,CAAE1C,MAAO,QAAlC,UACI,wBAAOF,MAAM,cAAb,UAA4BL,GAAC,UAAc,sBAAMK,MAAM,8BACvD,cAAC,KAAD,CACIuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAEoI,WAAY/B,KACjDA,MAAOjE,IAAO3G,KAAKyD,MAAMkJ,cAE7B,wBAAO1H,MAAM,kBAAb,UAAgCL,GAAC,QAAY,sBAAMK,MAAM,8BACzD,cAAC,KAAD,CACIuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAEqI,SAAUhC,KAC/CA,MAAOjE,IAAO3G,KAAKyD,MAAMmJ,eAIjC,sBAAK3H,MAAM,QAAQnC,GAAG,OAAtB,UACI,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKyN,iBAGd,qBAAKxI,MAAM,YAAX,SAEI,oBAAGgB,QAAS,kBAAM,EAAKyH,UAAUzI,MAAM,wBAAvC,UACI,sBAAM4C,MAAO,CAAE8F,cAAe,QAA9B,SACI,sBAAKzI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,oFAEjQf,GAAC,kBACF,qBAAK9B,GAAG,iBAAiBmC,MAAM,0BAA0B6F,KAAK,SAASjD,MAAO,CAAE+F,QAAS,oBAMzG,sBAAK3I,MAAM,WAAX,UACKjF,KAAK6N,cACN,qBAAK5I,MAAM,UAAX,SACI,oBAAGgB,QAAS,kBAAM,EAAK6H,YAAvB,UACI,sBAAK5I,MAAM,6BAA6BD,MAAM,GAAGE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAAtL,UAA8L,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,sBAAMZ,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UAChYnB,GAAC,gC,GArSV6B,IAAMC,WCVxC9B,I,cAAIxB,EAAI,IAmFC2K,GAjFK,SAACxK,GACjB,SAASwD,EAAoBC,GACzB,IAAIC,EAAO,IAAIC,KAAKF,GAChBG,EAAMF,EAAKG,UACXC,EAAQJ,EAAKK,WAAa,EAK9B,OAJWL,EAAKM,cAGM,IAAMF,EAAQ,IAAMF,EAAM,IAFpCF,EAAKO,WAE6C,IADhDP,EAAKQ,aAKvB,SAASuG,EAAQC,GACb,GAAI1K,EAAM4F,SACN,OACI,sBAAKlE,MAAM,WAAX,UACI,mBAAGD,KAAM,oBAAsBiJ,EAAQnL,GAAImC,MAAM,+BAAjD,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,WAE7Z,mBAAGE,QAAS,kBAAM1C,EAAM2K,cAAcD,EAAQnL,KAAKmC,MAAM,+BAAzD,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,qDAuClc,OACI,qBAAKd,UAAWtB,EAAMgF,IAAM,UAAYhF,EAAMgF,IAAM,WAApD,SACI,sBAAK1D,UAAU,YAAYgD,MAAOtE,EAAM6B,OAAS,CAAEA,OAAQ7B,EAAM6B,QAAW,CAAEA,OAAQ,QAAtF,UACI,sBAAKP,UAAU,cAAf,UACI,oBAAII,MAAM,aAAV,SAAwBL,GAAC,WACzB,oBAAIK,MAAM,kCAAV,SAjBhB,WACI,GAAI1B,EAAM4F,SACN,OACI,oBAAIlE,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,+BAAiCzB,EAAMT,GAArE,SACI,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,cAa5TuD,QAGT,qBAAKrE,MAAM,mDAAX,SAzCZ,WACI,IAAIgD,EAAS,GAgBb,OAfA1E,EAAM4K,SAASlM,KAAI,SAACgM,GAChBhG,EAAO5H,KACH,qBAAK4E,MAAM,kBAAX,SACI,sBAAKA,MAAM,yBAAX,UACI,sBAAKA,MAAM,oBAAX,UACI,mBAAGD,KAAM,eAAiBiJ,EAAQnL,GAAlC,SAAuCmL,EAAQ7F,QAC/C,uBAAOnD,MAAM,yCAAb,SACK0B,IAAOI,EAAoBkH,EAAQG,aAAaxF,OAAO,4BAG/DoF,EAAQC,YAKlBhG,EAyBMoG,KAEL,qBAAKpJ,MAAM,cAAX,SACI,sBAAKA,MAAM,SAAX,UACI,mBAAGqJ,KAAK,GAAGrJ,MAAM,iBACjB,mBAAGD,KAAM,oBAAsBzB,EAAMT,GAAImC,MAAM,UAA/C,SAA0DL,GAAC,iBC9DpE2J,GAdO,SAAChL,GAGnB,OACI,cAAC,YAAD,CACAiL,OAAQjL,EAAMkL,gBACd7D,MAAOrH,EAAMmL,MACblB,aAAa,EACbmB,YAAY,WACZC,mBAAmB,cACnBxD,SAAU,SAAAC,GAAG,OAAI9H,EAAMsL,WAAWxD,OCbpCzG,GAAIxB,EAAI,GAyDC0L,GAvDG,SAACvL,GAYf,OACI,sBAAK0B,MAAM,YAAX,UACI,sBAAKJ,UAAU,yBAAf,UACI,qBAAII,MAAM,aAAV,UAAwB1B,EAAM6E,MAA9B,OACA,qBAAInD,MAAM,kCAAV,UACI,oBAAIA,MAAM,WAAW4C,MAAO,CAAEkH,YAAa,QAA3C,SACKxL,EAAMyL,mBAjB3B,WACI,GAAIzL,EAAM4F,SACN,OACI,oBAAIlE,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,kBAAoBzB,EAAMT,GAAxD,SACI,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,aAc5ZiI,SAGT,mBAAG/H,QAAS,kBAAM1C,EAAM0L,kBAAxB,SACI,sBAAKpK,UAAU,6BAAf,UACI,sBAAKK,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMW,EAAE,IAAIC,EAAE,IAAIjB,MAAM,KAAKC,OAAO,KAAKiB,GAAG,MAAM,sBAAMT,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,IAAIC,GAAG,IAAIC,GAAG,IAAIC,GAAG,MAAM,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UACjenB,GAAC,SACF,oBAAIK,MAAM,kCAAV,SACI,oBAAIA,MAAM,mBAAV,SAEI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,kBAKpX,sBAAKd,MAAM,YAAX,UACI,6BAAKL,GAAC,aACN,qBAAKK,MAAM,kBAAkB4C,MAAO,CAAEW,UAAW,WAAjD,SACKjF,EAAM2L,OAGX,6BAAKtK,GAAC,aACN,qBAAKK,MAAM,kBAAX,SACKL,GAAErB,EAAMmF,cAGb,6BAAK9D,GAAC,OACN,qBAAKK,MAAM,kBAAX,SACK1B,EAAMwE,SAASxE,EAAMyE,e,yCCvCpCpD,GAAIxB,EAAI,GAEO+L,G,kDAEnB,WAAY5L,GAAQ,IAAD,8BACjB,cAAMA,IACDsL,WAAa,EAAKA,WAAWvN,KAAhB,gBAClB,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBACpB,EAAK0N,eAAiB,EAAKA,eAAe1N,KAApB,gBACtB,EAAK2N,eAAiB,EAAKA,eAAe3N,KAApB,gBAEtB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJ4F,WAAY,KACZwG,KAAM,KACNf,SAAU,GACViB,OAAQ,GACRC,SAAU,KACV9F,UAAW,KACXvB,KAAM,GACNsH,YAAY,EACZC,UAAU,EACVb,MAAO/H,MACP8H,gBAAiB,GACjBe,eAAe,EACfC,gBAAiB,GACjBtG,UAAU,GAzBK,E,sDA+BnB,WACEnF,EAAWC,GAAG,eAAgBjE,KAAK6C,aACnCmB,EAAWC,GAAG,mBAAoBjE,KAAK6C,e,kCAGzC,WACEmB,EAAWE,eAAe,eAAgBlE,KAAK6C,aAC/CmB,EAAWE,eAAe,mBAAoBlE,KAAK6C,e,+BAGrD,WACEsB,EAAsB,SAAUnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,OACvE,IAAIwN,EAAW,IAAIM,KAAM,cAAe,CAEtCC,UAAU,IAEZ5P,KAAKuE,SAAS,CAAE8K,SAAUA,M,0BAK5B,SAAa7K,M,yBAIb,WAAe,IAAD,OACR1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,UAAVvE,GACFE,KAAKuE,SAAS,CACZ6D,MAAO1G,EAAM0G,MACbtF,GAAIpB,EAAMoB,GACV4F,WAAYhH,EAAMgH,WAClBwG,KAAMxN,EAAMwN,KACZf,SAAUzM,EAAMyM,SAChBiB,OAAQ1N,EAAM0N,OACd7F,UAAW7H,EAAM6H,UACjBvB,KAAMtG,EAAMsG,KACZsH,WAAY5N,EAAM4N,WAClBO,QAASnO,EAAMmO,QACf1G,SAAUzH,EAAMyH,WACf,WACD,EAAK2G,uBAGTvP,QAAQC,IAAIkB,K,yBAId,SAAYoB,GAEVqB,EAAyB,SADd,CAAErB,GAAIA,EAAIiN,gBAAiB/P,KAAKyD,MAAMX,GAAIkN,kBAAmB,WAC/BhQ,KAAKyD,MAAM5B,S,yBAGtD,SAAYoO,GACVnD,IAAE,YAAYoD,OACdlQ,KAAKyD,MAAM4L,SAASc,YAAYF,K,4BAGlC,WAAkB,IAAD,OACfjQ,KAAKuE,SAAS,CAAEgL,UAAWvP,KAAKyD,MAAM8L,WAAY,WAC5C,EAAK9L,MAAM8L,SACbzC,IAAE,aAAaK,OAEfL,IAAE,aAAaC,Y,0BAOrB,SAAaqD,GAAQ,IAAD,OAClB,GAAIpQ,KAAKyD,MAAM0F,SACb,OACE,sBAAKlE,MAAM,WAAX,UACE,mBAAGD,KAAM,kBAAoBoL,EAAMtN,GAAImC,MAAM,+BAA7C,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,WAE3Z,mBAAGE,QAAS,kBAAM,EAAKoK,YAAYD,EAAMtN,KAAKmC,MAAM,+BAApD,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,uD,oBAOxb,WAAU,IAAD,OACHsC,EAAS,GAmBb,OAlBAjI,KAAKyD,MAAM2L,OAAOnN,KAAI,SAACmO,GACjBA,EAAME,aACRxD,IAAE,YAAYoD,OACd,EAAKzM,MAAM4L,SAASc,YAAYC,EAAMH,mBAG1CjQ,KAAKyD,MAAM2L,OAAOnN,KAAI,SAACmO,GACrBnI,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,qBAAKA,MAAM,oBAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKsK,YAAYH,EAAMH,gBAAgBhL,MAAM,oBAA/D,SAAoFmL,EAAMhI,UAE3F,EAAKoI,aAAaJ,YAKpBnI,I,sBAMT,SAASD,GACP,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACxB4H,EAAK/F,KAAI,SAACiG,GACRD,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAGvEH,I,4BAGT,WACE,GAAIjI,KAAKyD,MAAM6L,WACb,OACE,sBAAMrK,MAAM,kBAAZ,SAA+BL,GAAC,e,wBAKtC,SAAWyG,GACT,IAAIpD,EAAS,GACbjI,KAAKyD,MAAM0K,SAASlM,KAAI,SAACgM,GACnB/G,KAAKuJ,MAAMxC,EAAQyC,YAAcrF,EAAIsF,IAAMzJ,KAAKuJ,MAAMxC,EAAQ2C,UAAYvF,EAAIsF,IAChF1I,EAAO5H,KAAK4N,MAGhBjO,KAAKuE,SAAS,CAAEkL,gBAAiBxH,M,yBAGnC,WAAe,IAAD,OACRA,EAAS,GAgBb,OAfAjI,KAAKyD,MAAMgM,gBAAgBxN,KAAI,SAAC4O,GAC9B5I,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,sBAAKA,MAAM,oBAAX,UACE,mBAAGD,KAAM,eAAiB6L,EAAE/N,GAAImC,MAAM,oBAAtC,SAA2D4L,EAAEzI,QAC7D,uBAAOnD,MAAM,yCAAb,SAAuD4L,EAAE3B,UAE3D,qBAAKjK,MAAM,WAAX,SACG,EAAK8C,SAAS8I,EAAE7I,iBAMpBC,I,+BAGT,WACE,IAAIA,EAAS,GACbjI,KAAKyD,MAAM0K,SAASlM,KAAI,SAACgM,GACvB1N,QAAQC,IAAIyN,GACZhG,EAAO5H,KACL,CACEyQ,MAAOC,OACPC,MAAO/C,EAAQG,WACf6C,IAAKhD,EAAQiD,cAInBlR,KAAKuE,SAAS,CAAEkK,gBAAiBzO,KAAKyD,MAAMgL,gBAAgBzB,OAAO/E,GAASyG,MAAO,KAAMc,eAAe,M,0BAG1G,WACE,GAAIxP,KAAKyD,MAAM0K,UAAYnO,KAAKyD,MAAM0K,SAAS/N,OAAS,GAAKJ,KAAKyD,MAAM+L,cACtE,OACE,sBAAKvK,MAAM,eAAenC,GAAG,WAAW+E,MAAO,CAAE+F,QAAS,QAA1D,UACE,qBAAK3I,MAAM,WAAX,SACE,qBAAKA,MAAM,YAAX,SACE,qBAAKA,MAAM,YAAX,SACE,cAAC,GAAD,CAAewJ,gBAAiBzO,KAAKyD,MAAMgL,gBAAiBC,MAAO1O,KAAKyD,MAAMiL,MAAOG,WAAY7O,KAAK6O,mBAK5G,qBAAK5J,MAAM,WAAX,SACE,sBAAKA,MAAM,YAAX,UACE,qBAAKA,MAAM,cAAX,SACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,aAE3B,qBAAKK,MAAM,4CAA4C4C,MAAO,CAAEsJ,UAAW,SAA3E,SACGnR,KAAKoR,0B,2BASpB,SAAcC,GAAS,IAAD,OACpB,GAAIrR,KAAKyD,MAAM0F,SACb,OACE,qBAAKlE,MAAM,eAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKoK,YAAYgB,EAAOvO,KAAKmC,MAAM,+BAArD,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,sD,qBAOxb,WAAW,IAAD,OACJsC,EAAS,GAiBb,OAhBIjI,KAAKyD,MAAMoM,SACb7P,KAAKyD,MAAMoM,QAAQ5N,KAAI,SAACoP,GACK,UAAvBA,EAAOC,aACTrJ,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,qBAAKA,MAAM,oBAAX,SACE,mBAAG4C,MAAO,CAAE0J,OAAQ,WAAavM,KAAMqM,EAAOG,KAAMvM,MAAM,oBAA1D,SAA+EoM,EAAOjJ,UAEvF,EAAKqJ,cAAcJ,YAOzBpJ,I,4BAGT,WACE,GAAIjI,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,WAAWD,KAAM,6BAA+BhF,KAAKyD,MAAMX,GAApE,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,gB,6BAOvU,WACE,GAAI/F,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,WAAWD,KAAM,8BAAgChF,KAAKyD,MAAMX,GAArE,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,gB,oBASvU,WAEE,OACE,sBAAMlB,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,uBAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,iBAAf,UAEE,sBAAKI,MAAM,WAAX,UAEE,cAAC,GAAD,CACEmD,MAAOpI,KAAKyD,MAAM2E,MAAO8G,KAAMlP,KAAKyD,MAAMyL,KAC1CF,eAAgBhP,KAAKgP,eAAgBjH,SAAU/H,KAAK+H,SACpDW,WAAY1I,KAAKyD,MAAMiF,WAAYV,KAAMhI,KAAKyD,MAAMuE,KACpDiH,eAAgBjP,KAAKiP,eAAgBnM,GAAI9C,KAAKyD,MAAMX,GACpDqG,SAAUnJ,KAAKyD,MAAM0F,WAEvB,cAAC,EAAD,CAAgBI,UAAWvJ,KAAKyD,MAAM8F,UAAWH,gBAAgB,QAAQC,cAAerJ,KAAKyD,MAAMX,GAAIqG,SAAUnJ,KAAKyD,MAAM0F,WAE5H,cAAC,GAAD,CAAagF,SAAUnO,KAAKyD,MAAM0K,SAAU5F,IAAI,KAAKzF,GAAI9C,KAAKyD,MAAMX,GAAIqG,SAAUnJ,KAAKyD,MAAM0F,WAE7F,sBAAKlE,MAAM,YAAX,UACE,sBAAKA,MAAM,cAAX,UACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,QACzB,oBAAIK,MAAM,kCAAV,SACGjF,KAAK0R,sBAGV,qBAAKzM,MAAM,mDAAX,SACGjF,KAAKoP,cAIV,sBAAKnK,MAAM,YAAX,UACE,sBAAKA,MAAM,cAAX,UACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,YACzB,oBAAIK,MAAM,kCAAV,SACGjF,KAAK2R,uBAGV,qBAAK1M,MAAM,mDAAX,SACGjF,KAAK6P,kBAMZ,sBAAK5K,MAAM,WAAX,UACGjF,KAAK4R,eACN,qBAAK3M,MAAM,OAAX,SACE,qBAAKA,MAAM,YAAYnC,GAAG,UAAU+E,MAAO,CAAEM,OAAQ,WAArD,SACE,qBAAKrF,GAAG,yC,GArWO2D,IAAMC,WCLvC+C,GAAiBC,YAAUC,KAC3BnI,GAASD,EACTqD,GAAIxB,EAAI,GAEOyO,G,kDAEnB,WAAYtO,GAAQ,IAAD,8BACjB,cAAMA,IACDsG,OAAS,EAAKA,OAAOvI,KAAZ,gBACd,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJoM,KAAM,KACNxG,WAAY,KACZC,WAAYhC,MACZkC,SAAUlC,MACV2I,YAAY,EACZlF,QAAS,GACTpC,KAAM,IAjBS,E,sDAwBnB,WACEhE,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAIrC,WACEmB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGjD,WACM7C,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAC1BqB,EAAsB,SAAUnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,S,0BAM3E,SAAa2C,GACXxE,KAAKuE,SAASC,K,yBAGhB,WACE,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,UAAVvE,GACFE,KAAKuD,MAAMa,QAAQ/D,KAAK,WAAaqB,EAAMoB,M,yBAI/C,WAAe,IAAD,OACRhD,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACnB3C,GAAmB,UAAV5B,GACXE,KAAKuE,SAAS,CACZzB,GAAIpB,EAAMoB,GACVsF,MAAO1G,EAAM0G,MACb8G,KAAMxN,EAAMwN,KACZxG,WAAYhH,EAAMgH,WAClBV,KAAMtG,EAAMsG,KACZsH,WAAY5N,EAAM4N,WAClB3G,WAAYjH,EAAMiH,WAClBE,SAAUnH,EAAMmH,SAChBiJ,SAAS,IACR,WACDvR,QAAQC,IAAI,EAAKiD,OACjB,EAAKsO,WAAW,EAAKtO,MAAMiF,YAC3B,EAAKyD,YAAY,EAAK1I,MAAMuE,W,oBAKlC,WACE,IAAI7H,EAAOH,KAAKyD,MACXzD,KAAKyD,MAAMqO,QAGd3N,EAAyB,SAAUhE,EAAMH,KAAKyD,MAAM5B,OAFpDsC,EAAsB,SAAUhE,EAAMH,KAAKyD,MAAM5B,S,wBAQrD,SAAW6I,GACT,IAAIsH,EAAOhS,KACX8M,IAAE,2BAA2BmF,MAAK,WAC5BnF,IAAE9M,MAAMqL,QAAUX,GAGhBoC,IAAE9M,MAAMkS,QAFZpF,IAAE9M,MAAMmS,KAAK,WAAW,IAKtBrF,IAAE9M,MAAMmS,KAAK,WAAW,GACxBH,EAAKzN,SAAS,CAAEmE,WAAYgC,U,yBAMpC,SAAY1C,GAAO,IAAD,OACZC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACJA,EAAG,MACLD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGhBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,qBAG/D,WACE,OAAIhI,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAAM9C,KAAKyD,MAAMX,GACnC9C,KAAKyN,WAGVzN,KAAKuD,MAAMmM,MAAM9N,OAAOkB,QAA7B,EACU9C,KAAKyN,a,sBAIjB,WAAY,IAAD,OACT,OACE,qBAAK5F,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACE,cAAC,GAAD,CACEzK,GAAG,YACH0I,UAAQ,EACRC,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACT,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAChCvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACP,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAGvFgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACtB,cAAC,IAAM8E,SAAP,UACE,+BAAOgE,EAAOjE,iB,2BAS1B,SAAcsC,GACR1K,KAAKyD,MAAM6L,WACbtP,KAAKuE,SAAS,CAAE+K,YAAY,IAE5BtP,KAAKuE,SAAS,CAAE+K,YAAY,M,oBAMhC,WAAU,IAAD,OACCA,EAAetP,KAAKyD,MAApB6L,WAER,OACE,sBAAMzK,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,oBACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,iCAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,yBAAf,UACE,qBAAKI,MAAM,WAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,cAAX,SACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,iBAE3B,qBAAKK,MAAM,YAAX,SACE,iCACE,sBAAKA,MAAM,OAAX,UACE,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,cAC5B,uBAAOlE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE1B,MAAOsC,EAAEC,OAAOC,SAAY9H,GAAG,QAAQmC,MAAM,eAAenB,KAAK,aAAayH,YAAa3G,GAAC,gBAAqBgG,MAAO5K,KAAKyD,MAAM2E,WAE9L,sBAAKnD,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,WAAe,sBAAMK,MAAM,8BACvD,0BAAUwF,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEoF,KAAMxE,EAAEC,OAAOC,SAAY3F,MAAM,eAAenC,GAAG,UAAUgB,KAAK,yBAAyBwH,KAAK,IAAIC,YAAa3G,GAAC,gBAAqBgG,MAAO5K,KAAKyD,MAAMyL,UAG3M,sBAAKjK,MAAM,OAAX,UACE,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,aAC5B,sBAAKK,MAAM,mBAAX,UACE,wBAAOA,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,YAAY3F,MAAM,yBAAyBiN,QAAQ,GAAGjM,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UACxI,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,eAEzC,wBAAOK,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,SAAS3F,MAAM,yBAAyBgB,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UAC1H,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,YAEzC,wBAAOK,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,SAAS3F,MAAM,yBAAyBgB,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UAC1H,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,kBAK7C,sBAAKK,MAAM,QAAQnC,GAAG,OAAtB,UACE,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKoS,aAGR,sBAAKnN,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,mBAAuB,sBAAMK,MAAM,8BAC/D,cAAC,KAAD,CACEoN,YAAY,EACZ7E,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAEoE,WAAYiC,KACjDA,MAAOjE,IAAO3G,KAAKyD,MAAMkF,iBAI7B,sBAAK1D,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,mBAAuB,sBAAMK,MAAM,8BAC/D,cAAC,KAAD,CACEoN,YAAY,EACZ7E,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAEsE,SAAU+B,KAC/CA,MAAOjE,IAAO3G,KAAKyD,MAAMoF,eAI7B,sBAAK5D,MAAM,OAAX,UACE,qBAAKA,MAAM,aAAX,SAAyBL,GAAC,aAC1B,wBAAOK,MAAM,yBAAb,UACE,uBAAOA,MAAM,mBAAmBvE,KAAK,WAAWuF,QAAS,SAACyE,GAAD,OAAO,EAAK4H,cAAc5H,EAAEC,OAAOC,QAAQsH,UAAS5C,IAC7G,sBAAMrK,MAAM,mBAAZ,SAAgCL,GAAC,qCAMzC,qBAAKK,MAAM,cAAX,SACE,sBAAKA,MAAM,SAAX,UACE,mBAAGD,KAAK,YAAYC,MAAM,eAA1B,SAA0CL,GAAC,SAC3C,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,0BAA5C,SAAuEL,GAAC,cAG5E,qBAAKK,MAAM,qCAAX,SACE,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,QAAU2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAA1H,SACE,sBAAMhG,MAAM,kBAAZ,mCAMR,qBAAKA,MAAM,QAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,4BACX,sBAAKA,MAAM,YAAX,UACE,oBAAIA,MAAM,aAAV,kBACA,0O,GArRiBwB,IAAMC,W,oBCR1B6L,G,kDAEjB,WAAYhP,GAAQ,IAAD,8BACf,cAAMA,IACDP,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBACpB,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKsB,gBAAkB,EAAKA,gBAAgBtB,KAArB,gBACvB,EAAKoM,OAAS,EAAKA,OAAOpM,KAAZ,gBAGd,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPoK,YAAa,KACbC,MAAO,KACPrJ,gBAAiB,GACjBC,cAAe,EACfqD,EAAG,GACHgG,aAAc,MAjBH,E,sDAqBnB,WACI1O,EAAWC,GAAG,oBAAqBjE,KAAK4C,iBACxCoB,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,mBAAoBjE,KAAK6C,e,kCAG3C,WACImB,EAAWE,eAAe,oBAAqBlE,KAAK4C,iBACpDoB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,mBAAoBlE,KAAK6C,e,+BAGvD,WAAqB,IAAD,OACV+H,EAAQ9I,KAAY2O,MAAMzQ,KAAKuD,MAAMmB,SAASgJ,QAChDtE,EAAkB,GAClBC,EAAgB,EACpBtH,OAAOC,KAAK4I,GAAO3I,KAAI,SAACC,GACpB,IAAIyQ,EAAUzQ,EAAI0Q,MAAM,KACpBD,EAAQ,KACRvJ,EAAkBuJ,EAAQ,GAAGE,OAAO,GAAGC,cAAgBH,EAAQ,GAAGI,MAAM,GACxE1J,EAAgBuB,EAAM1I,OAG9BlC,KAAKuE,SAAS,CAAE6E,gBAAiBA,EAAiBC,cAAeA,IAAiB,WAC9ElF,EAA0B,cAAe,EAAKV,MAAM9B,KAAM,EAAK8B,MAAO,EAAKA,MAAM5B,Y,6BAMzF,WACI,IAAI4J,EAAWzH,EAAWgP,iBACtBlT,EAAQkE,EAAWM,WACvB/D,QAAQC,IAAIiL,GACRA,GAAsB,eAAV3L,GACZE,KAAKuE,SAAS,CACVkO,MAAOhH,EAASgH,MAChBD,YAAa/G,EAAS+G,gB,yBAMlC,WACIrO,EAA0B,cAAenE,KAAKyD,MAAM9B,KAAM3B,KAAKyD,MAAOzD,KAAKyD,MAAM5B,S,0BAKrF,SAAa2C,GACTxE,KAAKuE,SAASC,K,oBAGlB,SAAOkI,GAAI,IAAD,OACFA,EAAEtM,OAAS,EACXJ,KAAKuE,SAAS,CAAEmI,EAAGA,IAAK,kBACpBvI,EAA0B,cAAe,EAAKV,MAAM9B,KAAM,EAAK8B,MAAO,EAAKA,MAAM5B,UAGrF7B,KAAKuE,SAAS,CAAEmI,EAAG,KAAM,kBACzBvI,EAA0B,cAAe,EAAKV,MAAM9B,KAAM,EAAK8B,MAAO,EAAKA,MAAM5B,Y,yBAKzF,WACIsC,EAA0B,cAAenE,KAAKyD,MAAM9B,KAAM3B,KAAKyD,MAAOzD,KAAKyD,MAAM5B,S,4BAGrF,SAAeoR,GACwB,KAA/BjT,KAAKyD,MAAM2F,iBAEXjF,EAAsB,cADX,CAAEkF,cAAerJ,KAAKyD,MAAM4F,cAAeD,gBAAiBpJ,KAAKyD,MAAM2F,gBAAiB6J,QAASA,GACjEjT,KAAKyD,MAAM5B,S,+BAI9D,SAAkBiB,GAEdqB,EAAyB,cADd,CAAErB,GAAIA,EAAIuG,cAAerJ,KAAKyD,MAAM4F,cAAeD,gBAAiBpJ,KAAKyD,MAAM2F,iBAC5CpJ,KAAKyD,MAAM5B,S,uBAG7D,SAAU4Q,GAAQ,IAAD,OACTxK,EAAS,GA4Bb,OA3BIwK,GACAA,EAAMxQ,KAAI,SAACiR,GACPjL,EAAO5H,KACH,qBAAK4E,MAAM,kBAAkB4C,MAAO,CAAEsL,OAAQ,QAA9C,SACI,sBAAKlO,MAAM,yBAAX,UACI,qBAAKA,MAAM,WAAX,SACI,mBAAGgB,QAAS,kBAAM,EAAKmN,eAAeF,EAAKD,UAA3C,SACI,sBAAK/N,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,cAGrU,qBAAKd,MAAM,WAAX,SACI,mBAAGD,KAAK,IAAR,SACI,sBAAMC,MAAM,SAAZ,SAAuBiO,EAAKnP,eAGpC,sBAAKkB,MAAM,oBAAX,UACI,mBAAGD,KAAK,IAAIC,MAAM,oBAAlB,SAAuCiO,EAAKpP,OAC5C,uBAAOmB,MAAM,yCAAb,SAAuDiO,EAAKhJ,SAEhE,qBAAKjF,MAAM,sBAQxBgD,I,6BAGX,SAAgBuK,GAAc,IAAD,OACrBvK,EAAS,GA6Bb,OA5BIuK,GACAA,EAAYvQ,KAAI,SAACoR,GACb,IAAIH,EAAOG,EAAWxP,QACtBoE,EAAO5H,KACH,qBAAK4E,MAAM,kBAAkB4C,MAAO,CAAEsL,OAAQ,QAA9C,SACI,sBAAKlO,MAAM,yBAAX,UACI,qBAAKA,MAAM,WAAX,SACI,mBAAGgB,QAAS,kBAAM,EAAKqN,kBAAkBD,EAAWvQ,KAApD,SACI,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,cAG9R,qBAAKd,MAAM,WAAX,SACI,mBAAGD,KAAK,IAAR,SACI,sBAAMC,MAAM,SAAZ,SAAuBiO,EAAKnP,eAGpC,sBAAKkB,MAAM,oBAAX,UACI,mBAAGD,KAAK,IAAIC,MAAM,oBAAlB,SAAuCiO,EAAKpP,OAC5C,uBAAOmB,MAAM,yCAAb,SAAuDiO,EAAKhJ,SAEhE,qBAAKjF,MAAM,sBAQxBgD,I,oBAIX,WAAU,IAAD,OAEL,OACI,sBAAMpD,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,2BAAf,UACI,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,8BACA,oBAAIA,UAAU,aAAd,SAA4B7E,KAAKyD,MAAM2E,gBAInD,qBAAKvD,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,qBAAKA,UAAU,WAAf,SACI,sBAAKI,MAAM,YAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,yBAEJ,qBAAKA,MAAM,mDAAX,SACI,qBAAKA,MAAM,kBAAX,SACI,sBAAKA,MAAM,cAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAY,eAAUd,QAAS,SAACC,GAAQ,EAAKgD,OAAOhD,EAAEC,OAAOC,UACrG,sBAAM3F,MAAM,mBAAZ,SAEI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,mBAKlV/F,KAAKuT,UAAUvT,KAAKyD,MAAMgP,YAInC,qBAAK5N,UAAU,WAAf,SACI,sBAAKI,MAAM,YAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,4BAEJ,qBAAKA,MAAM,mDAAX,SACKjF,KAAKwT,gBAAgBxT,KAAKyD,MAAM+O,uC,GAvNpC/L,IAAMC,W,UCFnDC,IAAOC,OAAO,KAAM,CAAEC,oBAAoB,IAE1C,IAAMjC,GAAIxB,EAAI,GA+HCqQ,GA5HK,SAAClQ,GAyCjB,SAASmQ,IACL,IAAIzL,EAAS,GAMb,OALI1E,EAAMgG,WACNhG,EAAMgG,UAAUtH,KAAI,SAAC0R,GACjB1L,EAAO5H,KAAK,sBAAM4E,MAAM,kCAAZ,SAAgD0O,EAAI5P,eAGjEkE,EAGX,SAASlB,EAAoBC,GACzB,IAAIC,EAAO,IAAIC,KAAKF,GAChBG,EAAMF,EAAKG,UACXC,EAAQJ,EAAKK,WAAa,EAK9B,OAJWL,EAAKM,cAGM,IAAMF,EAAQ,IAAMF,EAAM,IAFpCF,EAAKO,WAE6C,IADhDP,EAAKQ,aAKvB,SAASmM,EAAUC,EAAMzL,GACrB,GAAI7E,EAAMsQ,GACN,OACI,eAAC,IAAMxL,SAAP,WACI,+BAAKD,EAAL,OACA,qBAAKnD,MAAM,kBAAX,SACK1B,EAAMsQ,QAM3B,OACI,sBAAK5O,MAAM,YAAX,UACI,sBAAKJ,UAAU,cAAf,UACI,oBAAII,MAAM,aAAV,SAAwB1B,EAAM6E,QAC9B,qBAAInD,MAAM,kCAAV,UACI,oBAAIA,MAAM,WAAW4C,MAAO,CAAEkH,YAAa,QAA3C,SACKxL,EAAMyL,mBAEX,oBAAI/J,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,oBAAsBzB,EAAMT,GAA1D,SACI,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,mBAKza,sBAAKd,MAAM,YAAX,UAxFR,WACI,GAAI1B,EAAMoE,MACN,OACI,eAAC,IAAMU,SAAP,WACI,+BAAKzD,GAAC,iBAAN,OACA,qBAAKK,MAAM,kBAAX,SACI,mBAAGD,KAAM,aAAezB,EAAMoE,MAAM7E,GAApC,SAAyCS,EAAMoE,MAAMS,aAmF5D0L,GACAF,EAAU,OAAQhP,GAAC,cACpB,eAAC,IAAMyD,SAAP,WACI,+BAAKzD,GAAC,aAAN,OACA,qBAAKK,MAAM,kBAAX,SACKL,GAAErB,EAAMwQ,mBAGhBH,EAAU,WAAYhP,GAAC,kBACvBgP,EAAU,gBAAiBhP,GAAC,uBAE7B,+BAAKA,GAAC,mBAAN,OACA,qBAAKK,MAAM,kBAAX,SACK0B,IAAOI,EAAoBxD,EAAM6K,aAAaxF,OAAO,yBAG1D,+BAAKhE,GAAC,iBAAN,OACA,qBAAKK,MAAM,kBAAX,SACK0B,IAAOI,EAAoBxD,EAAM2N,WAAWtI,OAAO,sBAGxD,6BAAKhE,GAAC,OACN,qBAAKK,MAAM,kBAAX,SACK1B,EAAMwE,SAASxE,EAAMyE,WAlG9BzE,EAAM5B,MAAsB,WAAd4B,EAAM5B,KAEhB,qBAAKsD,MAAM,cAAX,SACI,qBAAKA,MAAM,OAAX,SACI,mBAAGD,KAAM,YAAczB,EAAMyQ,QAAU,QAAUC,eAAUhO,QAAS1C,EAAM2Q,YAAajP,MAAM,gCAA7F,SACKL,GAAC,iBAMlBrB,EAAM5B,MAAsB,UAAd4B,EAAM5B,KAEhB,qBAAKsD,MAAM,cAAX,SACI,qBAAKA,MAAM,yBAAX,SACI,qBAAKA,MAAM,YAAX,SACI,qBAAKA,MAAM,kCAAX,SACKyO,iBANzB,MCzBF9O,GAAIxB,EAAI,GAEO+Q,G,kDAEnB,WAAY5Q,GAAQ,IAAD,8BACjB,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBACpB,EAAK0N,eAAiB,EAAKA,eAAe1N,KAApB,gBACtB,EAAKG,QAAU,EAAKA,QAAQH,KAAb,gBAEf,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJ4F,WAAY,KACZwG,KAAM,KACNf,SAAU,GACVnG,KAAM,GACNsH,YAAY,EACZ7C,QAAS,GACT2B,WAAYzH,MACZuK,SAAUvK,MACVyN,aAAc,IAnBC,E,sDAyBnB,WACEpQ,EAAWC,GAAG,eAAgBjE,KAAK6C,aACnCmB,EAAWC,GAAG,mBAAoBjE,KAAK6C,aACvCmB,EAAWC,GAAG,WAAYjE,KAAKyB,W,kCAGjC,WACEuC,EAAWE,eAAe,eAAgBlE,KAAK6C,aAC/CmB,EAAWE,eAAe,mBAAoBlE,KAAK6C,aACnDmB,EAAWE,eAAe,WAAYlE,KAAKyB,W,+BAG7C,WACE0C,EAAsB,SAAUnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,OACvEsC,EAAkB,cAAenE,KAAKyD,MAAM9B,KAAM,CAAEmB,GAAI9C,KAAKuD,MAAMmM,MAAM9N,OAAOkB,O,0BAMlF,SAAa0B,M,yBAIb,WACE,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,UAAVvE,GACFE,KAAKuE,SAAS,CACZ6D,MAAO1G,EAAM0G,MACbtF,GAAIpB,EAAMoB,GACV4F,WAAYhH,EAAMgH,WAClBwG,KAAMxN,EAAMwN,KACZf,SAAUzM,EAAMyM,SAChBnG,KAAMtG,EAAMsG,KACZsH,WAAY5N,EAAM4N,aACjB,eAIL/O,QAAQC,IAAIkB,K,qBAGd,WACE,IAAI/B,EAAOqE,EAAWvC,UAClB3B,EAAQkE,EAAWM,WACnB3E,GAAkB,QAAVG,GACVE,KAAKuE,SAAS,CACZkI,QAAS9M,IAGTA,GAAkB,YAAVG,GACVE,KAAKuE,SAAS,CACZ4J,SAAUxO,IAGdY,QAAQC,IAAIb,K,sBASd,SAASqI,GACP,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACxB4H,EAAK/F,KAAI,SAACiG,GACRD,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAGvEH,I,4BAGT,WACE,GAAIjI,KAAKyD,MAAM6L,WACb,OACE,sBAAMrK,MAAM,kBAAZ,SAA+BL,GAAC,e,wBAKtC,SAAW8F,GACT,IAAIsH,EAAOhS,KACPqU,EAAK,cAAgB3J,EAAEC,OAAOC,MAElC,GADArK,QAAQC,IAAIsM,IAAEuH,GAAKvH,IAAEuH,GAAIC,GAAG,aACvBxH,IAAEuH,GAAIC,GAAG,YAWZtC,EAAKzN,SAAS,CAAE6P,aAAcpC,EAAKvO,MAAM2Q,aAAapH,OAAOtC,EAAEC,OAAOC,SAAU,WAC9ErK,QAAQC,IAAIwR,EAAKvO,MAAM2Q,qBAZA,CAEzB,IAAIG,EAAK,aAAOvC,EAAKvO,MAAM2Q,cACvBI,EAAQD,EAAME,QAAQ/J,EAAEC,OAAOC,QACpB,IAAX4J,IACFD,EAAMG,OAAOF,EAAO,GACpBxC,EAAKzN,SAAS,CAAE6P,aAAcG,Q,yBAWpC,WAAe,IAAD,OACRtM,EAAS,GAab,OAZIjI,KAAKyD,MAAMgJ,SACbzM,KAAKyD,MAAMgJ,QAAQxK,KAAI,SAACiG,GACtBD,EAAO5H,KACL,wBAAO4E,MAAM,aAAb,UACE,uBAAOnC,GAAI,aAAeoF,EAAIpF,GAAImC,MAAM,mBAAmBvE,KAAK,WAAWmH,MAAO,CAAEuF,UAAW,SAAWxC,MAAO1C,EAAIpF,GAAIsI,SAAU,SAACV,GAAD,OAAO,EAAK2C,WAAW3C,MAC1J,sBAAMzF,MAAM,mBAAZ,SACE,sBAAMA,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,iBAMjEH,I,uBAGT,c,yBAKA,WAAe,IAAD,OACRA,EAAS,GAcb,OAbAjI,KAAKyD,MAAM0K,SAASlM,KAAI,SAACgM,GAEvBhG,EAAO5H,KAEL,cAAC,GAAD,CACE+H,MAAO6F,EAAQ7F,MAAO8G,KAAMjB,EAAQiB,KAAMd,WAAYH,EAAQG,WAC9D8C,SAAUjD,EAAQiD,SAAUlC,eAAgB,EAAKA,eAAgBjH,SAAU,EAAKA,SAChFgM,aAAc9F,EAAQ8F,aAAc/L,KAAMiG,EAAQjG,KAClDlF,GAAImL,EAAQnL,GAAI6E,MAAOsG,EAAQtG,MAAOhG,KAAK,SAC3C4H,UAAW0E,EAAQ1E,gBAIlBtB,I,0BAGT,WACE9D,EAAkB,kBAAmBnE,KAAKyD,MAAM9B,KAAM,CAAEgT,QAAS3U,KAAKyD,MAAM2Q,aAAchG,WAAYpO,KAAKyD,MAAM2K,WAAY8C,SAAUlR,KAAKyD,MAAMyN,SAAUpO,GAAI9C,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAAM9C,KAAKyD,MAAM5B,S,oBAO3M,WAAU,IAAD,OAEP,OACE,sBAAMgD,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,uBAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,iBAAf,UAEE,qBAAKI,MAAM,WAAX,SACE,sBAAKA,MAAM,YAAX,UACE,qBAAKA,MAAM,cAAX,SACE,oBAAIA,MAAM,aAAV,SACE,mBAAGD,KAAM,aAAehF,KAAKyD,MAAMX,GAAnC,SACG9C,KAAKyD,MAAM2E,YAKlB,qBAAKnD,MAAM,cAAX,SACE,sBAAKA,MAAM,OAAO4C,MAAO,CAAC1C,MAAO,QAAjC,UACE,wBAAOF,MAAM,cAAb,UAA4BL,GAAC,mBAAuB,sBAAMK,MAAM,8BAChE,cAAC,KAAD,CACEuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAE6J,WAAYxD,KACjDA,MAAOjE,IAAO3G,KAAKyD,MAAM2K,cAE3B,wBAAOnJ,MAAM,kBAAb,UAAgCL,GAAC,iBAAqB,sBAAMK,MAAM,8BAClE,cAAC,KAAD,CACEuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAE2M,SAAUtG,KAC/CA,MAAOjE,IAAO3G,KAAKyD,MAAMyN,iBAI/B,qBAAKjM,MAAM,cAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,iBAAX,SACGL,GAAC,OAEJ,8BACG5E,KAAK4U,qBAIZ,qBAAK3P,MAAM,YAAX,SAEE,oBAAGgB,QAAS,kBAAM,EAAK4O,gBAAgB5P,MAAM,wBAA7C,UACE,sBAAM4C,MAAO,CAAE8F,cAAe,QAA9B,SACE,sBAAKzI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,oFAE/Pf,GAAC,iBAOV,qBAAKK,MAAM,oBAAX,SACGjF,KAAKoR,mC,GAzPe3K,IAAMC,WCR/CC,IAAOC,OAAO,KAAM,CAAEC,oBAAoB,IAE1C,IAAMjC,GAAIxB,EAAI,GA2FC0R,GAzFQ,SAACvR,GAEpB,SAASwD,EAAoBC,GACzB,IAAIC,EAAO,IAAIC,KAAKF,GAChBG,EAAMF,EAAKG,UACXC,EAAQJ,EAAKK,WAAa,EAK9B,OAJWL,EAAKM,cAGM,IAAMF,EAAQ,IAAMF,EAAM,IAFpCF,EAAKO,WAE6C,IADhDP,EAAKQ,aAMvB,SAASC,EAAUuG,GACf,GAAIA,EAAQrG,MACR,OACI,mBAAG5C,KAAM,eAAiBiJ,EAAQnL,GAAlC,SACI,qBAAKmC,MAAM,mDAAmD4C,MAAO,CAAEC,gBAAiB,OAASmG,EAAQrG,MAAQ,SAMjI,SAASG,EAASC,GACd,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACtB4H,EAAK/F,KAAI,SAACiG,GACND,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAG3EH,EAoDX,OACI,cAAC,IAAMI,SAAP,UAlDJ,WACI,IAAIJ,EAAS,GA6Cb,OA5CI1E,EAAM4K,UACN5K,EAAM4K,SAASlM,KAAI,SAACgM,GAChBhG,EAAO5H,KAEH,qBAAKwE,UAAWtB,EAAMgF,IAAM,UAAYhF,EAAMgF,IAAM,WAApD,SACI,sBAAK1D,UAAU,OAAf,UACK6C,EAAUuG,GACX,sBAAKpJ,UAAU,YAAf,UACI,oBAAII,MAAM,aAAV,SACI,mBAAGD,KAAM,eAAiBiJ,EAAQnL,GAAlC,SACKmL,EAAQ7F,UAGjB,mBAAGP,MAAO,CAAEW,UAAW,WAAvB,SACKyF,EAAQxF,iBAGb,+BAAK7D,GAAC,aAAN,OACA,qBAAKK,MAAM,kBAAX,SACKL,GAAEqJ,EAAQ8F,gBAKf,+BAAKnP,GAAC,mBAAN,OACA,qBAAKK,MAAM,kBAAX,SACK0B,IAAOI,EAAoBkH,EAAQG,aAAaxF,OAAO,yBAG5D,+BAAKhE,GAAC,iBAAN,OACA,qBAAKK,MAAM,kBAAX,SACK0B,IAAOI,EAAoBkH,EAAQiD,WAAWtI,OAAO,sBAG1D,6BAAKhE,GAAC,OACN,qBAAKK,MAAM,kBAAX,SACK8C,EAASkG,EAAQjG,oBAQvCC,EAKFoG,MCnFP5E,GAAiBC,YAAUC,KAC3BnI,GAASD,EACTqD,GAAIxB,EAAI,GAEO2R,G,kDAEjB,WAAYxR,GAAQ,IAAD,8BACf,cAAMA,IAED9B,QAAU,EAAKA,QAAQH,KAAb,gBACf,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACP+F,SAAU,KACV1B,QAAS,KACTC,EAAG,GACHC,WAAYhG,MACZiG,SAAUjG,MAASkG,IAAI,EAAG,UAC1B7E,KAAM,GACNrG,KAAM,GAfK,E,sDAsBnB,WACIqC,EAAWC,GAAG,WAAYjE,KAAKyB,W,kCAGnC,WACIuC,EAAWE,eAAe,WAAYlE,KAAKyB,W,+BAG/C,WACI0C,EAAkB,WAAYnE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,OAC9DsC,EAAkB,WAAYnE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,S,qBAGlE,WACI,IAAIlC,EAAOqE,EAAWvC,UAClB3B,EAAQkE,EAAWM,WAEnB3E,GAAkB,YAAVG,IACRgN,IAAE,mBAAmBC,OACjBpN,EAAK,IAAMA,EAAK,GAAGgC,MACC,GAAhBhC,EAAK,GAAGgC,KACR3B,KAAKuE,SAAS,CACV4J,SAAUxO,IAGdK,KAAKuE,SAAS,CACV4J,SAAUnO,KAAKyD,MAAM0K,SAASnB,OAAOrN,KAG7CK,KAAKuE,SAAS,CAAE5C,KAAMhC,EAAK,GAAGgC,QAE9B3B,KAAKuE,SAAS,CACV4J,SAAU,KAGlB5N,QAAQC,IAAIb,IAEZA,GAAkB,QAAVG,GACRE,KAAKuE,SAAS,CACVkI,QAAS9M,M,0BAMrB,SAAa6E,GACTxE,KAAKuE,SAASC,K,yBAGlB,c,2BAIA,c,0BAqBA,WACI,OAAIxE,KAAKyD,MAAM0K,SACH,cAAC,GAAD,CAAgBA,SAAUnO,KAAKyD,MAAM0K,SAAU5F,IAAK,KAEpDvI,KAAKgV,kB,yBAIrB,WACI,GAAIhV,KAAKyD,MAAM0K,SACX,OACI,qBAAKlJ,MAAM,gBAAgBiI,eAAa,6BAAxC,SACI,cAAC,GAAD,CAAgBiB,SAAUnO,KAAKyD,MAAM0K,SAAU5F,IAAK,Q,oBAMpE,WACIuE,IAAE,mBAAmBK,OACrB,IAAIhN,EAAO,CAAEuM,EAAG1M,KAAKyD,MAAMiJ,EAAGC,WAAY3M,KAAKyD,MAAMkJ,WAAYC,SAAU5M,KAAKyD,MAAMmJ,SAAU5E,KAAMhI,KAAKyD,MAAMuE,MACjH7D,EAAkB,kBAAmBnE,KAAKyD,MAAM9B,KAAMxB,EAAMH,KAAKyD,MAAM5B,OACvE7B,KAAKuE,SAAS,CAAE5C,KAAM,M,yBAI1B,WAAe,IAAD,OACNsG,EAAS,GAab,OAZIjI,KAAKyD,MAAMgJ,SACXzM,KAAKyD,MAAMgJ,QAAQxK,KAAI,SAACiG,GACpBD,EAAO5H,KACH,wBAAO4E,MAAM,aAAb,UACI,uBAAOnC,GAAI,aAAeoF,EAAIpF,GAAImC,MAAM,mBAAmBvE,KAAK,WAAWmH,MAAO,CAAEuF,UAAW,SAAWxC,MAAO1C,EAAIpF,GAAIsI,SAAU,SAACV,GAAD,OAAO,EAAK2C,WAAW3C,MAC1J,sBAAMzF,MAAM,mBAAZ,SACI,sBAAMA,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,iBAM3EH,I,yBAGX,SAAYD,GAAO,IAAD,OACVC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACFA,EAAG,MACHD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGpBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,sBAGjE,WAAY,IAAD,OACP,OACI,qBAAKH,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACI,cAAC,GAAD,CACIzK,GAAG,aACH2I,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACP,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAC9BvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACL,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAG7FgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACpB,cAAC,IAAM8E,SAAP,UACI,+BAAOgE,EAAOjE,iB,sBAStC,WAEI,IAAIjI,EAAO,CAAE2C,GAAI9C,KAAKyD,MAAMX,GAAInB,KAAM3B,KAAKyD,MAAM9B,KAAO,EAAG+K,EAAG1M,KAAKyD,MAAMiJ,EAAGC,WAAY3M,KAAKyD,MAAMkJ,WAAYC,SAAU5M,KAAKyD,MAAMmJ,SAAU5E,KAAMhI,KAAKyD,MAAMuE,MAC/J7D,EAAkB,kBAAmBnE,KAAKyD,MAAM9B,KAAMxB,EAAMH,KAAKyD,MAAM5B,S,oBAI3E,WAAU,IAAD,OAEL,OACI,sBAAMgD,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,qBAAKA,UAAU,2BAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,cAEjC,qBAAKK,MAAM,gCAAX,SACI,qBAAKA,MAAM,WAAX,SACI,oBAAGD,KAAM,mBAAoBC,MAAM,kBAAnC,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAY,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UACtUnB,GAAC,6BAO1B,qBAAKC,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKI,MAAM,MAAX,UACI,qBAAKA,MAAM,WAAX,SACI,sBAAKA,MAAM,YAAX,UACI,qBAAKJ,UAAU,cAAf,SACI,qBAAII,MAAM,aAAV,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,kFAC7Pf,GAAC,qBAIV,sBAAKK,MAAM,YAAX,UACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,iBAC5B,sBAAKK,MAAM,kBAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAa3G,GAAC,mBAAwB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE4C,EAAGhC,EAAEC,OAAOC,WAChI,sBAAM3F,MAAM,mBAAZ,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,kBAI/U,sBAAKd,MAAM,OAAO4C,MAAO,CAAE1C,MAAO,QAAlC,UACI,wBAAOF,MAAM,cAAb,UAA4BL,GAAC,UAAc,sBAAMK,MAAM,8BACvD,cAAC,KAAD,CACIuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAEoI,WAAY/B,KACjDA,MAAOjE,IAAO3G,KAAKyD,MAAMkJ,cAE7B,wBAAO1H,MAAM,kBAAb,UAAgCL,GAAC,QAAY,sBAAMK,MAAM,8BACzD,cAAC,KAAD,CACIuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAEqI,SAAUhC,KAC/CA,MAAOjE,IAAO3G,KAAKyD,MAAMmJ,eAIjC,sBAAK3H,MAAM,QAAQnC,GAAG,OAAtB,UACI,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKyN,iBAGd,qBAAKxI,MAAM,YAAX,SAEI,oBAAGgB,QAAS,kBAAM,EAAKyH,UAAUzI,MAAM,wBAAvC,UACI,sBAAM4C,MAAO,CAAE8F,cAAe,QAA9B,SACI,sBAAKzI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,oFAEjQf,GAAC,kBACF,qBAAK9B,GAAG,iBAAiBmC,MAAM,0BAA0B6F,KAAK,SAASjD,MAAO,CAAE+F,QAAS,oBAMzG,sBAAK3I,MAAM,WAAX,UACKjF,KAAK6N,cACN,qBAAK5I,MAAM,UAAX,SACI,oBAAGgB,QAAS,kBAAM,EAAK6H,YAAvB,UACI,sBAAK5I,MAAM,6BAA6BD,MAAM,GAAGE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAAtL,UAA8L,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,sBAAMZ,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UAChYnB,GAAC,gC,GAnRR6B,IAAMC,W,UCX1CuO,G,QAASC,EAAGC,QAAQ5T,EACtB,CAAE6T,WAAY,CAAC,aACfC,QAAO,EACPC,WAAW,EACXC,oBAAqB,IC0DVC,G,kDA3DX,WAAYjS,GAAQ,IAAD,8BACf,cAAMA,IAGDE,MAAQ,CACT4L,SAAU,KACVzH,MAAO,MANI,E,sDAUnB,SAAmB6N,GACXA,EAAUxF,gBAAkBjQ,KAAKuD,MAAM0M,eAGvCjQ,KAAKyD,MAAM4L,SAASc,YAAYnQ,KAAKuD,MAAM0M,eAI3CwF,EAAU7N,QAAU5H,KAAKuD,MAAMqE,OAC/B5H,KAAKuE,SAAS,CAAEqD,MAAO5H,KAAKuD,MAAMqE,U,kCAI1C,c,+BAOA,WACI,IAAIyH,EAAW,IAAIM,KAAM,cAAe,CACpCC,UAAU,IAEd5P,KAAKuE,SAAS,CAAE8K,SAAUA,M,uBAG9B,WACI,GAAIrP,KAAKyD,MAAMmE,MACX,OAAQ,qBAAK3C,MAAM,mDAAmD4C,MAAO,CAAEC,gBAAiB,OAAS9H,KAAKyD,MAAMmE,MAAQ,S,oBAMpI,WACI,OAEI,qBAAK3C,MAAM,WAAX,SACI,sBAAKA,MAAM,OAAX,UACKjF,KAAK0H,YACN,qBAAKzC,MAAM,YAAYnC,GAAG,UAA1B,SACI,qBAAKA,GAAG,0B,GArDR4D,aCHjB,SAASgP,GAAaC,GAC3B,IACIC,EAASD,EACb,OAAQC,EAAOlV,MACb,IAAK,OAHIV,KAIF6V,WAAWD,EAAOE,IAKtB,SAASC,GAAerL,GACZ,KAAZA,EAAEsL,SAAgBtL,EAAEuL,SAASjW,KAAKkW,OAGlC,SAASL,GAAWC,GAAI,IAAD,OACxBK,EAAQnW,KAAKyD,MAAM2S,MAAMC,QAAO,SAACxC,GAAD,OAAUA,EAAKyC,OAASR,EAAEQ,QAC1DH,GAA0B,IAAjBA,EAAM/V,SACbJ,KAAKyD,MAAM2S,OAASpW,KAAKyD,MAAM2S,MAAMhW,OAAS,IAChDJ,KAAKuE,SAAS,CAAE6R,MAAOpW,KAAKyD,MAAM2S,MAAMrD,MAAM,GAAG/F,OAAO8I,KAExD9V,KAAKuE,SAAS,CAAE6R,MAAOpW,KAAKyD,MAAM2S,MAAMpJ,OAAO8I,KAAM,WACnD,EAAKS,iBAMN,SAASA,KACZzJ,IAAE,aAAa0J,OAAOC,QAAQ,CAC1BC,UAAW5J,IAAE,aAAa,GAAG6J,eAI9B,SAASC,KACd,IAAI3O,EAAS,GAkBb,OAjBAjI,KAAKyD,MAAM2S,MAAMnU,KAAI,SAAC4U,GACpB5O,EAAO5H,KACL,qBAAK4E,MAAM,0BAA0BnC,GAAI,QAAQ+T,EAAKP,KAAtD,SACE,sBAAKrR,MAAM,MAAX,UACE,qBAAKA,MAAM,WAAX,SACE,mBAAGD,KAAK,IAAR,SACE,sBAAMC,MAAM,mBAAZ,SAAgC4R,EAAK9S,eAGzC,sBAAKkB,MAAM,cAAX,UACC,sBAAMA,MAAM,aAAZ,SAA0B4R,EAAK/S,OAC/B,qBAAKmB,MAAM,kBAAX,SAA8B4R,EAAKC,sBAMrC7O,EAGF,SAAS8O,GAASjB,EAAGlR,GAAI,IAAD,OACzBsC,KAAK8P,MAAQhX,KAAKyD,MAAMwT,SAAW,KACrCjX,KAAKuE,SAAS,CAAE0S,SAAU/P,KAAK8P,QAAS,WACtC,EAAKE,OAAO,CAAExW,KAAMkE,EAAGkR,EAAGA,OAKzB,SAASI,KACZ3V,QAAQC,IAAIR,KAAKyD,MAAMoQ,MACrB7T,KAAKyD,MAAMoQ,OACb7T,KAAK+W,SAAS/W,KAAKyD,MAAMoQ,KAAM,QAC/B7T,KAAK6V,WAAW7V,KAAKyD,MAAMoQ,MAC3B/G,IAAE,cAAczB,IAAI,KAIjB,SAAS6L,GAAOvB,GAAoC,IAA/BwB,EAA8B,uDAArBnX,KAAKyD,MAAM2T,SAC9CzB,EAAG,KAAW3V,KAAKyD,MAAM4T,OACzB1B,EAAG,OAAawB,EAChBlC,GAAO3U,KAAK,UAAWqV,GC9DzBhP,IAAOC,OAAO,KAAM,CAAEC,oBAAoB,IAC1C,IAAMjC,GAAIxB,EAAI,GAEOkU,G,kDAEnB,WAAY/T,GAAQ,IAAD,8BACjB,cAAMA,IACD6L,OAAS,EAAKA,OAAO9N,KAAZ,gBACd,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKoU,aAAeA,GAAapU,KAAb,gBACpB,EAAKuU,WAAaA,GAAWvU,KAAX,gBAClB,EAAKsV,UAAYA,GAAUtV,KAAV,gBACjB,EAAKyV,SAAWA,GAASzV,KAAT,gBAChB,EAAK4U,KAAOA,GAAK5U,KAAL,gBACZ,EAAK4V,OAASA,GAAO5V,KAAP,gBACd,EAAKyU,eAAiBA,GAAezU,KAAf,gBACtB,EAAKiV,WAAaA,GAAWjV,KAAX,gBAElB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPgG,WAAY,KACZ8C,SAAU,KACVhC,KAAM,KACNqI,SAAU,KACVxD,aAAc,KACdpM,MAAO,CAAES,MAAO,GAAItF,GAAI,GACxBsM,OAAQ,GACRC,SAAU,KACV9F,UAAW,KACXvB,KAAM,GACNsH,YAAY,EACZ0E,QAAS,KACTqD,OAAQ,KACRzP,MAAO,KACPuB,UAAU,EACVqO,KAAM,KAEN1T,KAAM,KACN2T,SAAU,KACV1T,SAAU,KACVqT,SAAU,KAEVhB,MAAO,GACPa,SAAU/P,KAAK8P,MACfF,QAAS,KACTjD,KAAM,KACN5D,cAAe,MA7CA,E,sDAoDnB,WACEjM,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,aACnCmB,EAAWC,GAAG,mBAAoBjE,KAAK6C,aACvC6U,SAASC,iBAAiB,UAAW3X,KAAK+V,kB,kCAG5C,WACE/R,EAAWE,eAAe,eAAgBlE,KAAK6C,aAC/CmB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,mBAAoBlE,KAAK6C,aACnD6U,SAASE,oBAAoB,UAAW5X,KAAK+V,kB,+BAG/C,WACE,IAAI/D,EAAOhS,KACXmE,EAAsB,WAAYnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,OAMzEoT,GAAOhR,GAAG,WAAW,WACf+N,EAAKvO,MAAM4T,QACbpC,GAAO3U,KAAK,OAAQ,CAAEkX,KAAMxF,EAAKvO,MAAM4T,OAAOQ,WAAYvB,KAAMtE,EAAKvO,MAAM2T,cAI/EnC,GAAOhR,GAAG,WAAW,SAAU9D,GACzBA,EAAI,SAAe6R,EAAKvO,MAAM2T,UAChCpF,EAAK0D,aAAavV,Q,0BAOxB,SAAaqE,GACXxE,KAAKuE,SAASC,K,yBAGhB,WAAe,IAAD,OACR1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,YAAVvE,GACFE,KAAKuE,SAAS,CACZ6D,MAAO1G,EAAM0G,MACbtF,GAAIpB,EAAMoB,GACVsL,WAAY1M,EAAM0M,WAClB8C,SAAUxP,EAAMwP,SAChBhC,KAAMxN,EAAMwN,KACZqI,SAAU7V,EAAM6V,SAChBxD,aAAcrS,EAAMqS,aACpBpM,MAAOjG,EAAMiG,MACbyH,OAAQ1N,EAAM0N,OACd7F,UAAW7H,EAAM6H,UACjBvB,KAAMtG,EAAMsG,KACZsH,WAAY5N,EAAM4N,WAClB0E,QAAStS,EAAMsS,QACfqD,OAAQ3V,EAAMoW,UACdlQ,MAAOlG,EAAMkG,MACbiI,QAASnO,EAAMmO,QACf1G,SAAUzH,EAAMyH,WACf,WACG,EAAK1F,MAAM5B,OAAS,EAAK4B,MAAM5B,MAAMzB,OAAS,IAChD+D,EAAsB,uBAAwB,GAAI,EAAKV,MAAM5B,OAE3D,EAAK4B,MAAM2L,QAAU,EAAK3L,MAAM2L,OAAO,IACzC,EAAKmB,YAAY,EAAK9M,MAAM2L,OAAO,GAAGa,kBAI9B,eAAVnQ,IAEFS,QAAQC,IAAIkB,GACTA,EAAMqW,MACPxX,QAAQC,IAAIkB,EAAMqW,KAClBjL,IAAE,oBAAoBC,OACtBrJ,OAAOgB,SAASC,QAAQjD,EAAMqW,S,yBAMpC,WAAe,IAAD,OAERjY,EAAQkE,EAAWM,WACnB4O,EAAOlP,EAAWK,aACR,aAAVvE,GACFE,KAAKuE,SAAS,CAAET,KAAMoP,EAAKpP,KAAM2T,SAAUvE,EAAKpP,KAAMC,SAAUmP,EAAKnP,SAAUqT,SAAUlE,EAAKoD,OAAQ,WACpG,EAAK0B,yB,uBAMX,SAAUnE,EAAMzL,GACd,GAAIpI,KAAKyD,MAAMoQ,GACb,OACE,eAAC,IAAMxL,SAAP,WACE,+BAAKD,EAAL,OACA,qBAAKnD,MAAM,kBAAX,SACGjF,KAAKyD,MAAMoQ,U,yBAOtB,SAAY/Q,GAEVqB,EAAyB,SADd,CAAErB,GAAIA,EAAIiN,gBAAiB/P,KAAKyD,MAAMX,GAAIkN,kBAAmB,WAC/BhQ,KAAKyD,MAAM5B,S,0BAGtD,SAAauO,GAAQ,IAAD,OAClB,GAAIpQ,KAAKyD,MAAM0F,SACb,OACE,sBAAKlE,MAAM,eAAX,UACE,mBAAGD,KAAM,kBAAoBoL,EAAMtN,GAAImC,MAAM,+BAA7C,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,WAE3Z,mBAAGE,QAAS,kBAAM,EAAKoK,YAAYD,EAAMtN,KAAKmC,MAAM,+BAApD,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,uD,oBAOxb,WAAU,IAAD,OACHsC,EAAS,GA2Bb,OA1BAjI,KAAKyD,MAAM2L,OAAOnN,KAAI,SAACmO,GACjBA,EAAME,cAOZtQ,KAAKyD,MAAM2L,OAAOnN,KAAI,SAACmO,GACrBnI,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,qBAAKA,MAAM,oBAAX,SACE,mBAAG4C,MAAO,CAAE0J,OAAQ,WAAatL,QAAS,kBAAM,EAAKsK,YAAYH,EAAMH,gBAAgBhL,MAAM,oBAA7F,SAAkHmL,EAAMhI,UAEzH,EAAKoI,aAAaJ,GACnB,qBAAKnL,MAAM,eAAX,SACE,mBAAG4C,MAAO,CAAE0J,OAAQ,UAAWT,MAAO,WAAa7K,QAAS,kBAAM,EAAKsK,YAAYH,EAAMH,gBAAgBhL,MAAM,oBAA/G,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,sBAQzWkC,I,yBAIT,SAAYgI,GAIVjQ,KAAKuE,SAAS,CAAE0L,cAAeA,M,iCAGjC,SAAoBjJ,GAClB,IAAIC,EAAO,IAAIC,KAAKF,GAChBG,EAAMF,EAAKG,UACXC,EAAQJ,EAAKK,WAAa,EAK9B,OAJWL,EAAKM,cAGM,IAAMF,EAAQ,IAAMF,EAAM,IAFpCF,EAAKO,WAE6C,IADhDP,EAAKQ,e,sBAMrB,SAASO,GACP,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACxB4H,EAAK/F,KAAI,SAACiG,GACRD,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAGvEH,I,4BAGT,WACE,GAAIjI,KAAKyD,MAAM6L,WACb,OACE,sBAAMrK,MAAM,kBAAZ,SAA+BL,GAAC,e,uBAKtC,WACE,GAAI5E,KAAKyD,MAAMmE,MACb,OAAQ,qBAAK3C,MAAM,mDAAmD4C,MAAO,CAAEC,gBAAiB,OAAS9H,KAAKyD,MAAMmE,MAAQ,S,2BAIhI,SAAcyJ,GAAS,IAAD,OACpB,GAAIrR,KAAKyD,MAAM0F,SACb,OACE,qBAAKlE,MAAM,eAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKoK,YAAYgB,EAAOvO,KAAKmC,MAAM,+BAArD,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,sD,qBAOxb,WAAW,IAAD,OACJsC,EAAS,GAiBb,OAhBIjI,KAAKyD,MAAMoM,SACb7P,KAAKyD,MAAMoM,QAAQ5N,KAAI,SAACoP,GACK,UAAvBA,EAAOC,aACTrJ,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,qBAAKA,MAAM,oBAAX,SACE,mBAAG4C,MAAO,CAAE0J,OAAQ,WAAavM,KAAMqM,EAAOG,KAAMvM,MAAM,oBAA1D,SAA+EoM,EAAOjJ,UAEvF,EAAKqJ,cAAcJ,YAOzBpJ,I,4BAGT,WACE,GAAIjI,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,WAAWD,KAAM,+BAAiChF,KAAKyD,MAAMX,GAAtE,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,gB,6BAOvU,WACE,GAAI/F,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,WAAWD,KAAM,gCAAkChF,KAAKyD,MAAMX,GAAvE,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,gB,4BAOvU,WACE,GAAI/F,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,eAAeD,KAAM,oBAAsBhF,KAAKyD,MAAMX,GAA/D,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,e,+BAOna,WACM/F,KAAKyD,MAAM2T,UAAYpX,KAAKyD,MAAM4T,QACpCpC,GAAO3U,KAAK,OAAQ,CAAEkX,KAAMxX,KAAKyD,MAAM4T,OAAQf,KAAMtW,KAAKyD,MAAM2T,a,2BAIpE,WACEtK,IAAE,oBAAoBK,OACtBhJ,EAAsB,wBAAyBnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,S,oBAIxF,WAAU,IAAD,OACD+C,EAAIxB,EAAI,GAEd,OACE,sBAAMyB,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,EAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,EAAC,yBAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,iBAAf,UAEE,sBAAKI,MAAM,WAAX,UACE,sBAAKA,MAAM,YAAX,UACE,sBAAKJ,UAAU,yBAAf,UACE,oBAAII,MAAM,aAAV,SAAwBjF,KAAKyD,MAAM2E,QACnC,qBAAInD,MAAM,kCAAV,UACE,oBAAIA,MAAM,WAAW4C,MAAO,CAAEkH,YAAa,QAA3C,SACG/O,KAAKgP,mBAEPhP,KAAKiY,uBAGV,qBAAIhT,MAAM,eAAeH,iBAAe,OAAxC,UACE,oBAAIG,MAAM,WAAV,SACE,oBAAGD,KAAK,eAAeC,MAAM,kBAAkBH,iBAAe,MAA9D,UACE,sBAAKI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,sBAAMZ,GAAG,KAAKC,GAAG,IAAIC,GAAG,QAAQC,GAAG,MAAM,0BAAUG,OAAO,+BAC/UtB,EAAC,aAGN,oBAAIK,MAAM,WAAV,SACE,oBAAGD,KAAK,kBAAkBiB,QAAS,kBAAM,EAAKsQ,cAActR,MAAM,WAAWH,iBAAe,MAA5F,UACE,sBAAKI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,yEAAyE,sBAAMA,EAAE,4DAC9Uf,EAAC,cAMR,sBAAKK,MAAM,cAAX,UACE,sBAAKA,MAAM,uBAAuBnC,GAAG,cAArC,UACE,sBAAKmC,MAAM,YAAX,UACE,+BAAKL,EAAC,iBAAN,OACA,qBAAKK,MAAM,kBAAX,SACE,mBAAGD,KAAM,aAAehF,KAAKyD,MAAMkE,MAAM7E,GAAzC,SAA8C9C,KAAKyD,MAAMkE,MAAMS,UAGhEpI,KAAK4T,UAAU,OAAQhP,EAAC,cACzB,eAAC,IAAMyD,SAAP,WACE,+BAAKzD,EAAC,aAAN,OACA,qBAAKK,MAAM,kBAAX,SACGL,EAAE5E,KAAKyD,MAAMsQ,mBAGjB/T,KAAK4T,UAAU,WAAYhP,EAAC,kBAC5B5E,KAAK4T,UAAU,gBAAiBhP,EAAC,uBAElC,+BAAKA,EAAC,mBAAN,OACA,qBAAKK,MAAM,kBAAX,SACG0B,IAAO3G,KAAK+G,oBAAoB/G,KAAKyD,MAAM2K,aAAaxF,OAAO,yBAGlE,+BAAKhE,EAAC,iBAAN,OACA,qBAAKK,MAAM,kBAAX,SACG0B,IAAO3G,KAAK+G,oBAAoB/G,KAAKyD,MAAMyN,WAAWtI,OAAO,sBAGhE,6BAAKhE,EAAC,OACN,qBAAKK,MAAM,kBAAX,SACGjF,KAAK+H,SAAS/H,KAAKyD,MAAMuE,WAI9B,qBAAK/C,MAAM,cAAX,SACE,sBAAKA,MAAM,SAAX,UACE,mBAAGD,KAAM,YAAchF,KAAKyD,MAAMuQ,QAAU,QAAUC,eAAUhO,QAASjG,KAAKkU,YAAajP,MAAM,kBAAjG,SACGL,EAAC,aAEJ,oBAAGqB,QAAS,kBAAM,EAAKiS,iBAAiBjT,MAAM,yBAA9C,UACGL,EAAC,mBACF,qBAAK9B,GAAG,kBAAkBmC,MAAM,4BAA4B6F,KAAK,SAASjD,MAAO,CAAE+F,QAAS,qBAKpG,qBAAK3I,MAAM,WAAWnC,GAAG,iBAAzB,SACE,sBAAKmC,MAAM,8BAA8B4C,MAAO,CAAEsQ,YAAa,QAASC,UAAW,QAAnF,UACE,qBAAKnT,MAAM,4CAA4CnC,GAAG,WAAW+E,MAAO,CAAEsJ,UAAW,SAAzF,SACGnR,KAAK4W,cAER,qBAAK3R,MAAM,cAAc4C,MAAO,CAAEsQ,YAAa,SAA/C,SACE,sBAAKlT,MAAM,MAAX,UACE,qBAAKA,MAAM,MAAX,SACE,uBAAOnC,GAAG,YAAYpC,KAAK,OAAOuE,MAAM,eAAesG,YAAa3G,EAAC,gBAAqBwG,SAAU,SAACV,GACnG,EAAKZ,aAAa,CAAE+J,KAAM,CAAEiD,QAASpM,EAAEC,OAAOC,MAAO9G,KAAM,EAAKL,MAAMK,KAAMC,SAAU,EAAKN,MAAMM,SAAUsU,KAAMnR,KAAK8P,MAAOV,KAAMrC,uBAGvI,qBAAKhP,MAAM,WAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKiQ,QAAQjR,MAAM,yBAAyBe,aAAW,SAAzE,SACE,sBAAKd,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+KAU9Q,cAAC,EAAD,CAAgBwD,SAAUnJ,KAAKyD,MAAM0F,SAAUI,UAAWvJ,KAAKyD,MAAM8F,UAAWH,gBAAgB,UAAUC,cAAerJ,KAAKyD,MAAMX,KAEpI,sBAAKmC,MAAM,YAAX,UACE,sBAAKA,MAAM,cAAX,UACE,oBAAIA,MAAM,aAAV,SAAwBL,EAAC,QACzB,oBAAIK,MAAM,kCAAV,SACGjF,KAAK0R,sBAGV,qBAAKzM,MAAM,mDAAX,SACGjF,KAAKoP,cAIV,sBAAKnK,MAAM,YAAX,UACE,sBAAKA,MAAM,cAAX,UACE,oBAAIA,MAAM,aAAV,SAAwBL,EAAC,YACzB,oBAAIK,MAAM,kCAAV,SACGjF,KAAK2R,uBAIV,qBAAK1M,MAAM,mDAAX,SACGjF,KAAK6P,kBAKZ,cAAC,GAAD,CAAWI,cAAejQ,KAAKyD,MAAMwM,cAAerI,MAAO5H,KAAKyD,MAAMmE,2B,GAre/CnB,IAAMC,W,qBCNzC+C,GAAiBC,YAAUC,KAC3BnI,GAASD,EACTqD,GAAIxB,EAAI,GAEOkV,G,kDAEnB,WAAY/U,GAAQ,IAAD,8BACjB,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACP8G,KAAM,KACN6E,aAAc,SACd3F,WAAYlH,KAAK8P,MACjB9F,SAAUhK,KAAK8P,MACfuB,SAAU,KACVhB,SAAU,GACVzF,SAAS,EACT1H,QAAS,GACTpC,KAAM,GACNsH,YAAY,GAlBG,E,sDAyBnB,WACEtL,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAGrC,WACEmB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGjD,WAAqB,IAAD,OACZ+H,EAAQ9I,KAAY2O,MAAMzQ,KAAKuD,MAAMmB,SAASgJ,QACpD1N,KAAKuE,SAAS,CAAEgU,SAAU3N,EAAM2N,WAAY,kBAAMhY,QAAQC,IAAI,EAAKiD,MAAM8U,aACrEvY,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAC1BqB,EAAsB,WAAYnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,S,0BAK7E,SAAa2C,GACXxE,KAAKuE,SAASC,K,yBAGhB,WACE,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,YAAVvE,GACFE,KAAKuD,MAAMa,QAAQ/D,KAAK,aAAeqB,EAAMoB,M,yBAIjD,WAAe,IAAD,OACRhD,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACnB3C,GAAmB,YAAV5B,GACXE,KAAKuE,SAAS,CACZzB,GAAIpB,EAAMoB,GACVsF,MAAO1G,EAAM0G,MACb8G,KAAMxN,EAAMwN,KACZ6E,aAAcrS,EAAMqS,aACpB3F,WAAY1M,EAAM0M,WAClB8C,SAAUxP,EAAMwP,SAChBqH,SAAU7W,EAAMiG,MAAM7E,GACtByU,SAAU7V,EAAM6V,SAChBvP,KAAMtG,EAAMsG,KACZsH,WAAY5N,EAAM4N,WAClBwC,SAAS,IACR,WACDvR,QAAQC,IAAI,EAAKiD,OACjB,EAAKsO,WAAW,EAAKtO,MAAMsQ,cAC3B,EAAK5H,YAAY,EAAK1I,MAAMuE,W,oBAKlC,WACE,IAAI7H,EAAOH,KAAKyD,MACXzD,KAAKyD,MAAMqO,QAGd3N,EAAyB,WAAYhE,EAAMH,KAAKyD,MAAM5B,OAFtDsC,EAAsB,WAAYhE,EAAMH,KAAKyD,MAAM5B,S,wBAMvD,SAAW6I,GACT,IAAIsH,EAAOhS,KACX8M,IAAE,2BAA2BmF,MAAK,WAC5BnF,IAAE9M,MAAMqL,QAAUX,GAGhBoC,IAAE9M,MAAMkS,QAFZpF,IAAE9M,MAAMmS,KAAK,WAAW,IAKtBrF,IAAE9M,MAAMmS,KAAK,WAAW,GACxBH,EAAKzN,SAAS,CAAEwP,aAAcrJ,U,yBAMtC,SAAY1C,GAAO,IAAD,OACZC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACJA,EAAG,MACLD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGhBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,qBAG/D,WACE,OAAIhI,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAAM9C,KAAKyD,MAAMX,GACnC9C,KAAKyN,WAGVzN,KAAKuD,MAAMmM,MAAM9N,OAAOkB,QAA7B,EACU9C,KAAKyN,a,sBAIjB,WAAY,IAAD,OACT,OACE,qBAAK5F,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACE,cAAC,GAAD,CACEzK,GAAG,YACH0I,UAAQ,EACRC,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACT,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAChCvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACP,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAGvFgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACtB,cAAC,IAAM8E,SAAP,UACE,+BAAOgE,EAAOjE,iB,2BAQ1B,SAAcsC,GACT1K,KAAKyD,MAAM6L,WACVtP,KAAKuE,SAAS,CAAC+K,YAAY,IAE3BtP,KAAKuE,SAAS,CAAC+K,YAAY,M,4BAIjC,WACE,GAAGtP,KAAKyD,MAAM6L,WACZ,OACE,sBAAMrK,MAAM,kBAAZ,SAA+BL,GAAC,Y,oBAMtC,WAAU,IAAD,OACC0K,EAActP,KAAKyD,MAAnB6L,WACR,OACE,sBAAMzK,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,sBACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,iCAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,yBAAf,UACE,qBAAKI,MAAM,WAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,cAAX,SACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,mBAE3B,qBAAKK,MAAM,YAAX,SACE,iCACE,sBAAKA,MAAM,OAAX,UACE,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,gBAC5B,uBAAOlE,KAAK,OAAOuE,MAAM,eAAenB,KAAK,aAAayH,YAAa3G,GAAC,gBAAqB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE1B,MAAOsC,EAAEC,OAAOC,SAAYA,MAAO5K,KAAKyD,MAAM2E,WAEnL,sBAAKnD,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,aAAiB,sBAAMK,MAAM,8BACzD,0BAAUA,MAAM,eAAenB,KAAK,yBAAyBwH,KAAK,IAAIC,YAAa3G,GAAC,gBAAqB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEoF,KAAMxE,EAAEC,OAAOC,SAAYA,MAAO5K,KAAKyD,MAAMyL,UAG9L,sBAAKjK,MAAM,OAAX,UACE,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,eAC5B,sBAAKK,MAAM,mBAAX,UACE,wBAAOA,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,YAAY3F,MAAM,yBAAyBiN,QAAQ,GAAGjM,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UACxI,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,eAEzC,wBAAOK,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,SAAS3F,MAAM,yBAAyBgB,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UAC1H,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,YAEzC,wBAAOK,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,SAAS3F,MAAM,yBAAyBgB,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UAC1H,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,YAEzC,wBAAOK,MAAM,wBAAb,UACE,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,kBAAkB3F,MAAM,yBAAyBgB,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UACnI,sBAAM3F,MAAM,yBAAZ,SAAsCL,GAAC,2BAK7C,sBAAKK,MAAM,OAAX,UACE,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,mBAC5B,cAAC,KAAD,CACEgG,MAAO5K,KAAKyD,MAAM8T,SAClBnM,SAAU,SAACV,GAAQ,EAAKZ,aAAa,CAAEyN,SAAU7M,EAAEC,OAAOC,cAI9D,sBAAK3F,MAAM,QAAQnC,GAAG,OAAtB,UACE,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKoS,aAIR,sBAAKnN,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,mBAAuB,sBAAMK,MAAM,8BAC/D,cAAC,KAAD,CACEuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAE6J,WAAYxD,KACjDA,MAAOjE,IAAO3G,KAAKyD,MAAM2K,iBAI7B,sBAAKnJ,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,iBAAqB,sBAAMK,MAAM,8BAC7D,cAAC,KAAD,CACEuI,aAAa,EACbpC,SAAU,SAAAR,GAAW,EAAKrG,SAAS,CAAE2M,SAAUtG,KAC/CA,MAAOjE,IAAO3G,KAAKyD,MAAMyN,eAK7B,sBAAKjM,MAAM,OAAX,UACE,qBAAKA,MAAM,aAAX,SAAyBL,GAAC,aAC1B,wBAAOK,MAAM,yBAAb,UACE,uBAAOA,MAAM,mBAAmBvE,KAAK,WAAWuF,QAAS,SAACyE,GAAD,OAAO,EAAK4H,cAAc5H,EAAEC,OAAOC,QAAQsH,UAAS5C,IAC7G,sBAAMrK,MAAM,mBAAZ,SAAgCL,GAAC,qCASzC,qBAAKK,MAAM,cAAX,SACE,sBAAKA,MAAM,SAAX,UACE,mBAAGD,KAAK,cAAcC,MAAM,eAA5B,SAA4CL,GAAC,SAC7C,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,0BAA5C,SAAuEL,GAAC,cAG5E,qBAAKK,MAAM,qCAAX,SACE,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,QAAU2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAA1H,SACE,sBAAMhG,MAAM,kBAAZ,mCAMR,qBAAKA,MAAM,QAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,4BACX,sBAAKA,MAAM,YAAX,UACE,oBAAIA,MAAM,aAAV,kBACA,iD,GA1SmBwB,IAAMC,WCX5B8R,G,kDAEjB,WAAYjV,GAAQ,IAAD,8BACf,cAAMA,IAEDP,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,MARI,E,sDAenB,WACIpE,EAAWC,GAAG,eAAgBjE,KAAKgD,e,kCAIvC,WACIgB,EAAWE,eAAe,eAAgBlE,KAAKgD,e,+BAGnD,c,0BAMA,SAAawB,M,yBAIb,c,oBAKA,WAEI,OACI,sBAAMK,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,2BAAf,UACI,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,sBACA,oBAAIA,UAAU,aAAd,2CAIZ,qBAAKA,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,qBAAKA,UAAU,yBAAf,SAEI,qBAAKA,UAAU,WAAf,SACI,sBAAKI,MAAM,YAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,6BAEJ,sBAAKA,MAAM,mDAAX,UACI,qBAAKA,MAAM,kBAAX,SACI,sBAAKA,MAAM,kBAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAY,iBACpD,sBAAMtG,MAAM,mBAAZ,SAEI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,iBAK/U,qBAAKd,MAAM,kBAAX,SACI,sBAAKA,MAAM,yBAAX,UACI,qBAAKA,MAAM,WAAX,SAAsB,sBAAMA,MAAM,mBAClC,qBAAKA,MAAM,WAAX,SACI,mBAAGD,KAAK,IAAR,SACI,sBAAMC,MAAM,eAGpB,sBAAKA,MAAM,oBAAX,UACI,mBAAGD,KAAK,IAAIC,MAAM,oBAAlB,6BACA,uBAAOA,MAAM,yCAAb,gFAEJ,qBAAKA,MAAM,WAAX,SACI,mBAAGD,KAAK,IAAIC,MAAM,0BAAlB,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,kBAAkBE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAArM,UAA6M,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,oJ,GA3F/Rc,IAAMC,WCDrDC,IAAOC,OAAO,KAAM,CAAEC,oBAAoB,IAE1C,IAAMjC,GAAIxB,EAAI,GA6ECqV,GA3EQ,SAAClV,GAcpB,SAASmE,EAAUgR,GACf,GAAIA,EAAW9Q,MACX,OACI,mBAAG5C,KAAM,kBAAoB0T,EAAW5V,GAAxC,SACI,qBAAKmC,MAAM,mDAAmD4C,MAAO,CAAEC,gBAAiB,OAAS4Q,EAAW9Q,MAAQ,SAMpI,SAASG,EAASC,GACd,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACtB4H,EAAK/F,KAAI,SAACiG,GACND,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAG3EH,EAsCX,OACI,cAAC,IAAMI,SAAP,UApCJ,WACI,IAAIJ,EAAS,GA+Bb,OA9BI1E,EAAMoV,aACNpV,EAAMoV,YAAY1W,KAAI,SAACyW,GACnBzQ,EAAO5H,KAEH,qBAAKwE,UAAWtB,EAAMgF,IAAM,UAAYhF,EAAMgF,IAAM,WAApD,SACI,sBAAK1D,UAAU,OAAf,UACK6C,EAAUgR,GACX,sBAAK7T,UAAU,YAAf,UACI,oBAAII,MAAM,aAAV,SACI,mBAAGD,KAAM,kBAAoB0T,EAAW5V,GAAxC,SACK4V,EAAWtQ,UAGpB,mBAAGP,MAAO,CAAEW,UAAW,WAAvB,SACKkQ,EAAWjQ,iBAMhB,6BAAK7D,GAAC,OACN,qBAAKK,MAAM,kBAAX,SACK8C,EAAS2Q,EAAW1Q,oBAQ1CC,EAKF2Q,MCrEPnP,GAAiBC,YAAUC,KAC3BnI,GAASD,EAETqD,GAAIxB,EAAI,GAEOyV,G,kDAEjB,WAAYtV,GAAQ,IAAD,8BACf,cAAMA,IACD9B,QAAU,EAAKA,QAAQH,KAAb,gBACf,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPuQ,YAAa,KACblM,QAAS,KACTC,EAAG,GACHC,WAAYhG,MACZiG,SAAUjG,MAASkG,IAAI,EAAG,UAC1B7E,KAAM,GACNrG,KAAM,GAdK,E,sDAoBnB,WACIqC,EAAWC,GAAG,WAAYjE,KAAKyB,W,kCAGnC,WACIuC,EAAWE,eAAe,WAAYlE,KAAKyB,W,+BAG/C,WACI0C,EAAkB,cAAenE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,OACjEsC,EAAkB,WAAYnE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,S,qBAGlE,WACI,IAAIlC,EAAOqE,EAAWvC,UAClB3B,EAAQkE,EAAWM,WAEnB3E,GAAkB,eAAVG,IACRgN,IAAE,mBAAmBC,OACjBpN,EAAK,IAAMA,EAAK,GAAGgC,MACC,GAAhBhC,EAAK,GAAGgC,KACR3B,KAAKuE,SAAS,CACVoU,YAAahZ,IAGjBK,KAAKuE,SAAS,CACVoU,YAAa3Y,KAAKyD,MAAMkV,YAAY3L,OAAOrN,KAGnDK,KAAKuE,SAAS,CAAE5C,KAAMhC,EAAK,GAAGgC,QAE9B3B,KAAKuE,SAAS,CACVoU,YAAa,KAGrBpY,QAAQC,IAAIb,IAEZA,GAAkB,QAAVG,GACRE,KAAKuE,SAAS,CACVkI,QAAS9M,M,0BAMrB,SAAa6E,GACTxE,KAAKuE,SAASC,K,8BAKlB,c,6BAqBA,WACI,OAAIxE,KAAKyD,MAAMkV,YAEP,eAAC,IAAMtQ,SAAP,WACI,qBAAKpD,MAAM,QAAX,SACI,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,4BACX,sBAAKJ,UAAU,cAAf,UACI,oBAAII,MAAM,aAAV,SAAwBL,GAAC,cACzB,oBAAIK,MAAM,kCAAV,SACI,oBAAIA,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,wBAA9B,SACI,sBAAKE,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,mBAK7U,qBAAKd,MAAM,YAAX,SACI,qNAMZ,cAAC,GAAD,CAAgB0T,YAAa3Y,KAAKyD,MAAMkV,YAAapQ,IAAK,OAI1DvI,KAAK8Y,qB,yBAIrB,WACI,GAAI9Y,KAAKyD,MAAMkV,YACX,OACI,qBAAK1T,MAAM,gBAAgBiI,eAAa,6BAAxC,SACI,cAAC,GAAD,CAAgByL,YAAa3Y,KAAKyD,MAAMkV,YAAapQ,IAAK,Q,oBAM1E,WACIuE,IAAE,mBAAmBK,OACrB,IAAIhN,EAAO,CAAEuM,EAAG1M,KAAKyD,MAAMiJ,EAAG1E,KAAMhI,KAAKyD,MAAMuE,MAC/C7D,EAAkB,qBAAsBnE,KAAKyD,MAAM9B,KAAMxB,EAAMH,KAAKyD,MAAM5B,OAC1E7B,KAAKuE,SAAS,CAAE5C,KAAM,M,yBAG1B,WAAe,IAAD,OACNsG,EAAS,GAab,OAZIjI,KAAKyD,MAAMgJ,SACXzM,KAAKyD,MAAMgJ,QAAQxK,KAAI,SAACiG,GACpBD,EAAO5H,KACH,wBAAO4E,MAAM,aAAb,UACI,uBAAOnC,GAAI,aAAeoF,EAAIpF,GAAImC,MAAM,mBAAmBvE,KAAK,WAAWmH,MAAO,CAAEuF,UAAW,SAAWxC,MAAO1C,EAAIpF,GAAIsI,SAAU,SAACV,GAAD,OAAO,EAAK2C,WAAW3C,MAC1J,sBAAMzF,MAAM,mBAAZ,SACI,sBAAMA,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,iBAM3EH,I,yBAGX,SAAYD,GAAO,IAAD,OACVC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACFA,EAAG,MACHD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGpBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,sBAGjE,WAAY,IAAD,OACP,OACI,qBAAKH,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACI,cAAC,GAAD,CACIzK,GAAG,aACH2I,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACP,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAC9BvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACL,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAG7FgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACpB,cAAC,IAAM8E,SAAP,UACI,+BAAOgE,EAAOjE,iB,sBAStC,WACI,IAAIjI,EAAO,CAAE2C,GAAI9C,KAAKyD,MAAMX,GAAInB,KAAM3B,KAAKyD,MAAM9B,KAAO,EAAG+K,EAAG1M,KAAKyD,MAAMiJ,EAAG1E,KAAMhI,KAAKyD,MAAMuE,MAC7F7D,EAAkB,qBAAsBnE,KAAKyD,MAAM9B,KAAMxB,EAAMH,KAAKyD,MAAM5B,S,oBAM9E,WAAU,IAAD,OAEL,OACI,sBAAMgD,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,qBAAKA,UAAU,2BAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,iBAEjC,qBAAKK,MAAM,gCAAX,SACI,qBAAKA,MAAM,WAAX,SACI,oBAAGD,KAAM,wBAAyBC,MAAM,kBAAxC,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAY,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UACtUnB,GAAC,gCAO1B,qBAAKC,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKI,MAAM,MAAX,UACI,qBAAKA,MAAM,WAAX,SACI,sBAAKA,MAAM,YAAX,UACI,qBAAKJ,UAAU,cAAf,SACI,qBAAII,MAAM,aAAV,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,kFAC7Pf,GAAC,mBAIV,sBAAKK,MAAM,YAAX,UACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,iBAC5B,sBAAKK,MAAM,kBAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAa3G,GAAC,mBAAwB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE4C,EAAGhC,EAAEC,OAAOC,WAChI,sBAAM3F,MAAM,mBAAZ,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,kBAK/U,sBAAKd,MAAM,QAAQnC,GAAG,OAAtB,UACI,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKyN,iBAGd,qBAAKxI,MAAM,cAAX,SAEI,oBAAGgB,QAAS,kBAAM,EAAKyH,UAAUzI,MAAM,wBAAvC,UACI,sBAAM4C,MAAO,CAAE8F,cAAe,QAA9B,SACI,sBAAKzI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,oFAEjQf,GAAC,kBACF,qBAAK9B,GAAG,iBAAiBmC,MAAM,0BAA0B6F,KAAK,SAASjD,MAAO,CAAE+F,QAAS,oBAMzG,qBAAK3I,MAAM,WAAX,SACKjF,KAAK6N,mC,GArRDpH,IAAMC,WCuCpCqS,GAlDM,SAACxV,GAClB,IAAMqB,EAAIxB,EAAI,GAiCd,OAEI,sBAAKyB,UAAU,YAAYgD,MAAOtE,EAAM6B,OAAS,CAAEA,OAAQ7B,EAAM6B,QAAW,CAAEA,OAAQ,QAAtF,UACI,sBAAKP,UAAU,cAAf,UACI,oBAAII,MAAM,aAAV,SAAwBL,EAAC,YACzB,oBAAIK,MAAM,kCAAV,SAjBZ,WACI,GAAI1B,EAAM4F,SACN,OACI,oBAAIlE,MAAM,mBAAV,SACI,mBAAGA,MAAM,eAAeD,KAAM,uBAAyBzB,EAAMyV,kBAAoB,OAASzV,EAAM0V,gBAAhG,SACI,sBAAK/T,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,cAahUuD,QAGT,qBAAKrE,MAAM,mDAAX,SAzCR,WACI,IAAIgD,EAAS,GAgBb,OAfI1E,EAAM2V,WACN3V,EAAM2V,UAAUjX,KAAI,SAACkX,GACbA,EAASrC,SACT7O,EAAO5H,KACH,qBAAK4E,MAAM,kBAAX,SACI,qBAAKA,MAAM,yBAAX,SACI,qBAAKA,MAAM,oBAAX,SACI,mBAAGgB,QAAQ,GAAGhB,MAAM,oBAApB,SAAyCkU,EAASrC,oBAQvE7O,EAyBEiR,SChCXtU,GAAIxB,EAAI,GAEOgW,G,kDAEnB,WAAY7V,GAAQ,IAAD,8BACjB,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBACpB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBAEnB,EAAKoU,aAAeA,GAAapU,KAAb,gBACpB,EAAKuU,WAAaA,GAAWvU,KAAX,gBAClB,EAAKsV,UAAYA,GAAUtV,KAAV,gBACjB,EAAKyV,SAAWA,GAASzV,KAAT,gBAChB,EAAK4U,KAAOA,GAAK5U,KAAL,gBACZ,EAAK4V,OAASA,GAAO5V,KAAP,gBACd,EAAKyU,eAAiBA,GAAezU,KAAf,gBACtB,EAAKiV,WAAaA,GAAWjV,KAAX,gBAElB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJoM,KAAM,KACNE,OAAQ,GACR8J,UAAW,GACX7J,SAAU,KACVrH,KAAM,GACN6H,QAAS,KACT1G,UAAU,EACVI,UAAW,GACXyK,QAAS,KACTqD,OAAQ,KACRzP,MAAO,KAEP9D,KAAM,KACN2T,SAAU,KACV1T,SAAU,KACVqT,SAAU,KAEVhB,MAAO,GACPa,SAAU/P,KAAK8P,MACfF,QAAS,KACTjD,KAAM,KACN5D,cAAe,MAxCA,E,sDA8CnB,WACEjM,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,aACnCmB,EAAWC,GAAG,mBAAoBjE,KAAK6C,aACvC6U,SAASC,iBAAiB,UAAW3X,KAAK+V,kB,kCAG5C,WACE/R,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,aAC/CmB,EAAWE,eAAe,mBAAoBlE,KAAK6C,aACnD6U,SAASE,oBAAoB,UAAW5X,KAAK+V,kB,+BAG/C,WACE,IAAI/D,EAAOhS,KACXmE,EAAsB,cAAenE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,OAM5EoT,GAAOhR,GAAG,WAAW,WACf+N,EAAKvO,MAAM4T,QACbpC,GAAO3U,KAAK,OAAQ,CAAEkX,KAAMxF,EAAKvO,MAAM4T,OAAOQ,WAAYvB,KAAMtE,EAAKvO,MAAM2T,cAI/EnC,GAAOhR,GAAG,WAAW,SAAU9D,GACzBA,EAAI,SAAe6R,EAAKvO,MAAM2T,UAChCpF,EAAK0D,aAAavV,Q,0BAOxB,SAAaqE,GACXxE,KAAKuE,SAASC,K,yBAGhB,WAAe,IAAD,OACR1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,eAAVvE,GACFE,KAAKuE,SAAS,CACZ6D,MAAO1G,EAAM0G,MACbtF,GAAIpB,EAAMoB,GACVoM,KAAMxN,EAAMwN,KACZE,OAAQ1N,EAAM0N,OACdpH,KAAMtG,EAAMsG,KACZ6H,QAASnO,EAAMmO,QACf1G,SAAUzH,EAAMyH,SAChBI,UAAW7H,EAAM6H,UACjByK,QAAStS,EAAMsS,QACfqD,OAAQ3V,EAAMoW,UACdlQ,MAAOlG,EAAMkG,MACbsR,UAAWxX,EAAMwX,YAChB,WACG,EAAKzV,MAAM5B,OAAS,EAAK4B,MAAM5B,MAAMzB,OAAS,IAChD+D,EAAsB,uBAAwB,GAAI,EAAKV,MAAM5B,OAE3D,EAAK4B,MAAM2L,QAAU,EAAK3L,MAAM2L,OAAO,IACzC,EAAKmB,YAAY,EAAK9M,MAAM2L,OAAO,GAAGa,kBAI5C1P,QAAQC,IAAIkB,K,yBAGd,WAAe,IAAD,OAER5B,EAAQkE,EAAWM,WACnB4O,EAAOlP,EAAWK,aACR,aAAVvE,GACFE,KAAKuE,SAAS,CAAET,KAAMoP,EAAKpP,KAAM2T,SAAUvE,EAAKpP,KAAMC,SAAUmP,EAAKnP,SAAUqT,SAAUlE,EAAKoD,OAAQ,WACpG,EAAK0B,yB,yBAOX,SAAYlV,GAEVqB,EAAyB,SADd,CAAErB,GAAIA,EAAIiN,gBAAiB/P,KAAKyD,MAAMX,GAAIkN,kBAAmB,WAC/BhQ,KAAKyD,MAAM5B,S,yBAGtD,SAAYoO,GACVjQ,KAAKuE,SAAS,CAAE0L,cAAeA,M,0BAGjC,SAAaG,GAAQ,IAAD,OAClB,GAAIpQ,KAAKyD,MAAM0F,SACb,OACE,sBAAKlE,MAAM,WAAX,UACE,mBAAGD,KAAM,kBAAoBoL,EAAMtN,GAAImC,MAAM,+BAA7C,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,WAE3Z,mBAAGE,QAAS,kBAAM,EAAKoK,YAAYD,EAAMtN,KAAKmC,MAAM,+BAApD,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,uD,oBAOxb,WAAU,IAAD,OACHsC,EAAS,GAmBb,OAlBAjI,KAAKyD,MAAM2L,OAAOnN,KAAI,SAACmO,GACjBA,EAAME,cAKZtQ,KAAKyD,MAAM2L,OAAOnN,KAAI,SAACmO,GACrBnI,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,qBAAKA,MAAM,oBAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKsK,YAAYH,EAAMH,gBAAgBhL,MAAM,oBAA/D,SAAoFmL,EAAMhI,UAE3F,EAAKoI,aAAaJ,YAKpBnI,I,sBAGT,SAASD,GACP,IAAIC,EAAS,GAMb,OALID,GAAQA,EAAK5H,OAAS,GACxB4H,EAAK/F,KAAI,SAACiG,GACRD,EAAO5H,KAAK,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAAEM,OAAQ,OAAhD,SAA0DD,EAAIE,YAGvEH,I,2BAGT,SAAcoJ,GAAS,IAAD,OACpB,GAAIrR,KAAKyD,MAAM0F,SACb,OACE,qBAAKlE,MAAM,eAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKoK,YAAYgB,EAAOvO,KAAKmC,MAAM,+BAArD,SACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,mDAAmD,sBAAMA,EAAE,sD,qBAOxb,WAAW,IAAD,OACJsC,EAAS,GAiBb,OAhBIjI,KAAKyD,MAAMoM,SACb7P,KAAKyD,MAAMoM,QAAQ5N,KAAI,SAACoP,GACK,UAAvBA,EAAOC,aACTrJ,EAAO5H,KACL,qBAAK4E,MAAM,kBAAX,SACE,sBAAKA,MAAM,yBAAX,UACE,qBAAKA,MAAM,oBAAX,SACE,mBAAG4C,MAAO,CAAE0J,OAAQ,WAAavM,KAAMqM,EAAOG,KAAMvM,MAAM,oBAA1D,SAA+EoM,EAAOjJ,UAEvF,EAAKqJ,cAAcJ,YAOzBpJ,I,4BAGT,WACE,GAAIjI,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,WAAWD,KAAM,kCAAoChF,KAAKyD,MAAMX,GAAzE,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,gB,6BAOvU,WACE,GAAI/F,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,WAAWD,KAAM,mCAAqChF,KAAKyD,MAAMX,GAA1E,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,gB,+BAOvU,WACE,GAAI/F,KAAKyD,MAAM0F,SACb,OACE,oBAAIlE,MAAM,mBAAV,SACE,mBAAGA,MAAM,eAAeD,KAAM,uBAAyBhF,KAAKyD,MAAMX,GAAlE,SACE,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+DAA+D,sBAAMA,EAAE,oDAAoD,sBAAMC,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,e,2BAOna,WACE,GAAI/F,KAAKyD,MAAM0F,SACb,OACE,cAAC,EAAD,CAAgBA,SAAUnJ,KAAKyD,MAAM0F,SAAUI,UAAWvJ,KAAKyD,MAAM8F,UAAWH,gBAAgB,aAAaC,cAAerJ,KAAKyD,MAAMX,O,+BAM7I,WACM9C,KAAKyD,MAAM2T,UAAYpX,KAAKyD,MAAM4T,QACpCpC,GAAO3U,KAAK,OAAQ,CAAEkX,KAAMxX,KAAKyD,MAAM4T,OAAQf,KAAMtW,KAAKyD,MAAM2T,a,oBAKpE,WAAU,IAAD,OAEP,OACE,sBAAMvS,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,WACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,4BAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,iBAAf,UAEE,sBAAKI,MAAM,WAAX,UACE,sBAAKA,MAAM,YAAX,UACE,sBAAKJ,UAAU,yBAAf,UACE,qBAAII,MAAM,aAAV,UAAwBjF,KAAKyD,MAAM2E,MAAnC,OACA,oBAAInD,MAAM,kCAAV,SACGjF,KAAKqZ,yBAGV,qBAAIpU,MAAM,eAAeH,iBAAe,OAAxC,UACE,oBAAIG,MAAM,WAAV,SACE,oBAAGD,KAAK,eAAeC,MAAM,kBAAkBH,iBAAe,MAA9D,UACE,sBAAKI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,sBAAMZ,GAAG,KAAKC,GAAG,IAAIC,GAAG,QAAQC,GAAG,MAAM,0BAAUG,OAAO,+BAC/UtB,GAAC,aAGN,oBAAIK,MAAM,WAAV,SACE,oBAAGD,KAAK,kBAAkBiB,QAAS,kBAAM,EAAKsQ,cAActR,MAAM,WAAWH,iBAAe,MAA5F,UACE,sBAAKI,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,yEAAyE,sBAAMA,EAAE,4DAC9Uf,GAAC,cAKR,sBAAKK,MAAM,cAAX,UACE,sBAAKA,MAAM,uBAAuBnC,GAAG,cAArC,UAEE,sBAAKmC,MAAM,YAAX,UACE,6BAAKL,GAAC,kBACN,qBAAKK,MAAM,kBAAkB4C,MAAO,CAAEW,UAAW,WAAjD,SACGxI,KAAKyD,MAAMyL,OAId,6BAAKtK,GAAC,OACN,qBAAKK,MAAM,kBAAX,SACGjF,KAAK+H,SAAS/H,KAAKyD,MAAMuE,WAG9B,qBAAK/C,MAAM,cAAX,SACE,qBAAKA,MAAM,OAAX,SACE,oBAAGD,KAAM,YAAchF,KAAKyD,MAAMuQ,QAAU,QAAUC,eAAUhP,MAAM,oCAAtE,UACE,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMW,EAAE,IAAIC,EAAE,IAAIjB,MAAM,KAAKC,OAAO,KAAKiB,GAAG,MAAM,wBAAQC,GAAG,IAAIC,GAAG,KAAKC,EAAE,MAAM,sBAAMZ,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,MAAM,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UACpbnB,GAAC,gCAMV,qBAAKK,MAAM,WAAWnC,GAAG,iBAAzB,SACE,sBAAKmC,MAAM,8BAA8B4C,MAAO,CAAEsQ,YAAa,QAASC,UAAW,QAAnF,UACE,qBAAKnT,MAAM,4CAA4CnC,GAAG,WAAW+E,MAAO,CAAEsJ,UAAW,SAAzF,SACGnR,KAAK4W,cAER,qBAAK3R,MAAM,cAAc4C,MAAO,CAAEsQ,YAAa,SAA/C,SACE,sBAAKlT,MAAM,MAAX,UACE,qBAAKA,MAAM,MAAX,SACE,uBAAOnC,GAAG,YAAYpC,KAAK,OAAOuE,MAAM,eAAesG,YAAa3G,GAAC,gBAAqBwG,SAAU,SAACV,GACnG,EAAKZ,aAAa,CAAE+J,KAAM,CAAEiD,QAASpM,EAAEC,OAAOC,MAAO9G,KAAM,EAAKL,MAAMK,KAAMC,SAAU,EAAKN,MAAMM,SAAUsU,KAAMnR,KAAK8P,MAAOV,KAAMrC,uBAGvI,qBAAKhP,MAAM,WAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKiQ,QAAQjR,MAAM,yBAAyBe,aAAW,SAAzE,SACE,sBAAKd,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,+KAY7Q3F,KAAKsZ,gBAEN,cAAC,GAAD,CAAcnQ,SAAUnJ,KAAKyD,MAAM0F,SAAU+P,UAAWlZ,KAAKyD,MAAMyV,UAAWF,kBAAkB,aAAaC,gBAAiBjZ,KAAKyD,MAAMX,KAEzI,sBAAKmC,MAAM,YAAX,UACE,sBAAKA,MAAM,cAAX,UACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,QACzB,oBAAIK,MAAM,kCAAV,SACGjF,KAAK0R,sBAGV,qBAAKzM,MAAM,mDAAX,SACGjF,KAAKoP,cAIV,sBAAKnK,MAAM,YAAX,UACE,sBAAKA,MAAM,cAAX,UACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,YACzB,oBAAIK,MAAM,kCAAV,SACGjF,KAAK2R,uBAIV,qBAAK1M,MAAM,mDAAX,SACGjF,KAAK6P,kBAMZ,cAAC,GAAD,CAAWI,cAAejQ,KAAKyD,MAAMwM,cAAerI,MAAO5H,KAAKyD,MAAMmE,2B,GA9Y5CnB,IAAMC,WCV5C+C,GAAiBC,YAAUC,KAC3BnI,GAASD,EACTqD,GAAIxB,EAAI,GAEOmW,G,kDAEnB,WAAYhW,GAAQ,IAAD,8BACjB,cAAMA,IACDsG,OAAS,EAAKA,OAAOvI,KAAZ,gBACd,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJoM,KAAM,KACN9E,QAAS,GACTpC,KAAM,IAbS,E,sDAoBnB,WACEhE,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAIrC,WACEmB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGjD,WACM7C,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAC1BqB,EAAsB,cAAenE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,S,0BAMhF,SAAa2C,GACXxE,KAAKuE,SAASC,K,yBAGhB,WACE,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,eAAVvE,GACFE,KAAKuD,MAAMa,QAAQ/D,KAAK,gBAAkBqB,EAAMoB,M,yBAIpD,WAAe,IAAD,OACRhD,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACnB3C,GAAmB,eAAV5B,GACXE,KAAKuE,SAAS,CACZzB,GAAIpB,EAAMoB,GACVsF,MAAO1G,EAAM0G,MACb8G,KAAMxN,EAAMwN,KACZlH,KAAMtG,EAAMsG,KACZ8J,SAAS,IACR,WACDvR,QAAQC,IAAI,EAAKiD,OACjB,EAAK0I,YAAY,EAAK1I,MAAMuE,W,oBAKlC,WACE,IAAI7H,EAAOH,KAAKyD,MACXzD,KAAKyD,MAAMqO,QAGd3N,EAAyB,cAAehE,EAAMH,KAAKyD,MAAM5B,OAFzDsC,EAAsB,cAAehE,EAAMH,KAAKyD,MAAM5B,S,yBAQ1D,SAAYmG,GAAO,IAAD,OACZC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACJA,EAAG,MACLD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGhBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,qBAG/D,WACE,OAAIhI,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAAM9C,KAAKyD,MAAMX,GACnC9C,KAAKyN,WAGVzN,KAAKuD,MAAMmM,MAAM9N,OAAOkB,QAA7B,EACU9C,KAAKyN,a,sBAIjB,WAAY,IAAD,OACT,OACE,qBAAK5F,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACE,cAAC,GAAD,CACEzK,GAAG,iBACH0I,UAAQ,EACRC,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACT,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAChCvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACP,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAGvFgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACtB,cAAC,IAAM8E,SAAP,UACE,+BAAOgE,EAAOjE,iB,2BAS1B,SAAcsC,GACT1K,KAAKyD,MAAM6L,WACVtP,KAAKuE,SAAS,CAAC+K,YAAY,IAE3BtP,KAAKuE,SAAS,CAAC+K,YAAY,M,oBAMjC,WAAU,IAAD,OACetP,KAAKyD,MAAnB6L,WAER,OACE,sBAAMzK,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,yBACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,iCAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,yBAAf,UACE,qBAAKI,MAAM,WAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,cAAX,SACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,sBAE3B,qBAAKK,MAAM,YAAX,SACE,iCACE,sBAAKA,MAAM,OAAX,UACE,uBAAOA,MAAM,aAAb,SAA2BL,GAAC,mBAC5B,uBAAOlE,KAAK,OAAO+J,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE1B,MAAOsC,EAAEC,OAAOC,SAAY9H,GAAG,QAAQmC,MAAM,eAAenB,KAAK,aAAayH,YAAa3G,GAAC,gBAAqBgG,MAAO5K,KAAKyD,MAAM2E,WAE9L,sBAAKnD,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,gBAAoB,sBAAMK,MAAM,8BAC5D,0BAAUwF,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEoF,KAAMxE,EAAEC,OAAOC,SAAY3F,MAAM,eAAenC,GAAG,UAAUgB,KAAK,yBAAyBwH,KAAK,IAAIC,YAAa3G,GAAC,gBAAqBgG,MAAO5K,KAAKyD,MAAMyL,UAI3M,sBAAKjK,MAAM,QAAQnC,GAAG,OAAtB,UACE,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKoS,kBAMZ,qBAAKnN,MAAM,cAAX,SACE,sBAAKA,MAAM,SAAX,UACE,mBAAGD,KAAK,iBAAiBC,MAAM,eAA/B,SAA+CL,GAAC,SAChD,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,0BAA5C,SAAuEL,GAAC,cAG5E,qBAAKK,MAAM,qCAAX,SACE,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,QAAU2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAA1H,SACE,sBAAMhG,MAAM,kBAAZ,mCAMR,qBAAKA,MAAM,QAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,4BACX,sBAAKA,MAAM,YAAX,UACE,oBAAIA,MAAM,aAAV,kBACA,0O,GAhNsBwB,IAAMC,WCP/B8S,G,kDAEjB,WAAYjW,GAAQ,IAAD,8BACf,cAAMA,IAEDP,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,MARI,E,sDAenB,WACIpE,EAAWC,GAAG,eAAgBjE,KAAKgD,e,kCAIvC,WACIgB,EAAWE,eAAe,eAAgBlE,KAAKgD,e,+BAGnD,c,0BAMA,SAAawB,M,yBAIb,c,oBAKA,WAEI,OACI,sBAAMK,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,qBAAKS,UAAU,eAAf,SAEI,qBAAKA,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,qBAAKA,UAAU,yBAAf,SAGI,sBAAKI,MAAM,gBAAX,UACI,sBAAKnC,GAAG,QAAQmC,MAAM,cAAtB,UAEI,sBAAKA,MAAM,kBAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAY,iBACpD,sBAAMtG,MAAM,mBAAZ,SACI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,eAG3U,qBAAId,MAAM,oCAAV,UACI,qBAAIA,MAAM,WAAV,UACI,qBAAK+D,IAAI,qDAAqDC,IAAI,WAClE,sBAAKhE,MAAM,QAAX,UACI,qBAAKA,MAAM,OAAX,4BACA,sBAAKA,MAAM,SAAX,cAAqB,mBAAGA,MAAM,yBAA9B,6BAGR,qBAAIA,MAAM,kBAAV,UACI,qBAAK+D,IAAI,qDAAqDC,IAAI,WAClE,sBAAKhE,MAAM,QAAX,UACI,qBAAKA,MAAM,OAAX,0BACA,sBAAKA,MAAM,SAAX,cAAqB,mBAAGA,MAAM,wBAA9B,oBAGR,qBAAIA,MAAM,WAAV,UACI,qBAAK+D,IAAI,qDAAqDC,IAAI,WAClE,sBAAKhE,MAAM,QAAX,UACI,qBAAKA,MAAM,OAAX,yBACA,sBAAKA,MAAM,SAAX,cAAqB,mBAAGA,MAAM,wBAA9B,oBAGR,qBAAIA,MAAM,WAAV,UACI,qBAAK+D,IAAI,qDAAqDC,IAAI,WAClE,sBAAKhE,MAAM,QAAX,UACI,qBAAKA,MAAM,OAAX,6BACA,sBAAKA,MAAM,SAAX,cAAqB,mBAAGA,MAAM,yBAA9B,+BAGR,qBAAIA,MAAM,WAAV,UACI,qBAAK+D,IAAI,qDAAqDC,IAAI,WAClE,sBAAKhE,MAAM,QAAX,UACI,qBAAKA,MAAM,OAAX,yBACA,sBAAKA,MAAM,SAAX,cAAqB,mBAAGA,MAAM,wBAA9B,oBAGR,qBAAIA,MAAM,WAAV,UACI,qBAAK+D,IAAI,qDAAqDC,IAAI,WAClE,sBAAKhE,MAAM,QAAX,UACI,qBAAKA,MAAM,OAAX,wBACA,sBAAKA,MAAM,SAAX,cAAqB,mBAAGA,MAAM,yBAA9B,wCAKhB,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,uBAAX,SACI,sBAAKA,MAAM,MAAX,UACI,sBAAKA,MAAM,WAAX,UACI,mBAAGD,KAAK,sBAAsByU,cAAY,QAAQC,cAAY,aAA9D,SACI,qBAAK1Q,IAAI,qDAAqDC,IAAI,aAEtE,sBAAKhE,MAAM,aAAX,UACI,oBAAIA,MAAM,QAAV,0BACA,iEAGR,qBAAKA,MAAM,uCAKnB,qBAAKA,MAAM,eAAX,SACI,qBAAIA,MAAM,QAAV,UACI,qBAAIA,MAAM,WAAV,UACI,sBAAKA,MAAM,0BAAX,UACI,sBAAMA,MAAM,oBAAZ,6BACA,qBAAK+D,IAAI,qDAAqDC,IAAI,cAEtE,qBAAKhE,MAAM,oCAAX,0EAEJ,qBAAIA,MAAM,WAAV,UACI,qBAAKA,MAAM,eAAX,SACI,sBAAMA,MAAM,oBAAZ,+BAEJ,qBAAKA,MAAM,qBAAX,sCAEJ,qBAAIA,MAAM,WAAV,UACI,qBAAKA,MAAM,eAAX,SACI,sBAAMA,MAAM,oBAAZ,+BAEJ,qBAAKA,MAAM,qBAAX,uFAIZ,qBAAKA,MAAM,wBAAX,SACI,sBAAKA,MAAM,mBAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAY,oBACpD,wBAAQtG,MAAM,MAAMvE,KAAK,SAAzB,8C,GAvJR+F,IAAMC,W,UCE5C9B,GAAIxB,EAAI,GAEOuW,G,kDACjB,WAAYpW,GAAQ,IAAD,8BACf,cAAMA,IAoDVqW,aAAe,SAACC,GACZ,EAAKtV,SAAS,CAAEsV,UAtDD,EAyDnBC,eAAiB,SAACC,EAAaC,GAC3BzZ,QAAQC,IAAIuZ,EAAaC,GACzB,EAAKzV,SAAS,CAAE0V,cAAeD,KA3DhB,EA+DnBE,aAAe,SAACC,GACZ,EAAK5V,SAAS,CAAE4V,UA9DhB,EAAKtX,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAK8Y,YAAc,EAAKA,YAAY9Y,KAAjB,gBAEnB,EAAKmC,MAAQ,CACToW,KAAM,CAAE1T,EAAG,EAAGC,EAAG,GACjB+T,KAAM,EACNE,OAAQ,IACRC,gBAAiB,KACjBC,cAAe,KACfzX,GAAI,KACJ0X,SAAU,KACVP,cAAe,KACfQ,gBAAiB,MAfN,E,sDAoBnB,WACIzW,EAAWC,GAAG,eAAgBjE,KAAK6C,aACnCmB,EAAWC,GAAG,eAAgBjE,KAAKgD,e,kCAGvC,WACIgB,EAAWE,eAAe,eAAgBlE,KAAK6C,aAC/CmB,EAAWE,eAAe,eAAgBlE,KAAKgD,e,+BAGnD,WACImB,EAAsB,UAAWnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,S,yBAG5E,WACI,IAAI/B,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,eAAVvE,GACAE,KAAKuE,SAAS,CACVzB,GAAIpB,EAAMoB,GACVmX,cAAevY,EAAMmY,KACrBS,gBAAiB5Y,EAAM4Y,gBACvBC,cAAe7Y,EAAM6Y,cACrBC,SAAU9Y,EAAM8P,KAChBiJ,gBAAiB/Y,EAAM+Y,kBACxB,eAIPla,QAAQC,IAAIkB,EAAMgZ,W,oBAkBtB,WACIvW,EAAyB,UAAW,CAACrB,GAAI9C,KAAKyD,MAAMX,GAAImX,cAAeja,KAAKyD,MAAMwW,eAAgBja,KAAKyD,MAAM5B,S,yBAGjH,WACI,IAAI/B,EAAQkE,EAAWM,WACXN,EAAWK,aACT,WAAVvE,GACAE,KAAKuD,MAAMa,QAAQ/D,KAAK,IAAKL,KAAKyD,MAAMgX,mB,yBAIhD,WACI,GAAGza,KAAKyD,MAAM+W,SAEV,OADAja,QAAQC,IAAIR,KAAKyD,MAAM+W,UAEnB,cAAC,KAAD,CACAG,MAAO3a,KAAKyD,MAAM+W,SAClBX,KAAM7Z,KAAKyD,MAAMoW,KACjBM,KAAMna,KAAKyD,MAAM0W,KACjBE,OAAQra,KAAKyD,MAAM4W,OACnBT,aAAc5Z,KAAK4Z,aACnBE,eAAgB9Z,KAAK8Z,eACrBI,aAAcla,KAAKka,iB,oBAM/B,WAAU,IAAD,OACL,OACI,sBAAKrV,UAAU,MAAf,UACI,qBAAKA,UAAU,iBAAf,SACK7E,KAAKoa,gBAEV,qBAAKvV,UAAU,WAAf,SACI,cAAC,KAAD,CACI+F,MAAO5K,KAAKyD,MAAM0W,KAClBS,IAAK,EACLC,IAAK,EACLC,KAAM,GACNC,kBAAgB,OAChB3P,SAAU,SAACV,EAAGyP,GAAJ,OAAa,EAAKD,aAAaC,IACzCjP,QAAS,CAAE8P,UAAW,cAK9B,qBAAKnW,UAAU,YAAf,SACI,mBAAGoB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,kBAAvC,SACKL,GAAC,gB,GAtHe6B,IAAMC,WCE1BuU,G,kDAEjB,WAAY1X,GAAQ,IAAD,8BACf,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJwO,YAAa,KACb4J,KAAM,MAXK,E,sDAkBnB,WACIlX,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAGvC,WACImB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGnD,WACI,IACM+H,EAAQ9I,KAAY2O,MAAMzQ,KAAKuD,MAAMmB,SAASgJ,QAChD4M,EAAkB,GAClBC,EAAgB,EACpBxY,OAAOC,KAAK4I,GAAO3I,KAAI,SAACC,GACpB,IAAIyQ,EAAUzQ,EAAI0Q,MAAM,KACpBD,EAAQ,KACR2H,EAAkB3H,EAAQ,GAAGE,OAAO,GAAGC,cAAgBH,EAAQ,GAAGI,MAAM,GACxEwH,EAAgB3P,EAAM1I,OAG9BlC,KAAKuE,SAAS,CAAE+V,gBAAiBA,EAAiBC,cAAeA,IAC7Dva,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IACxBqB,EAAsB,UAAWnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,S,0BAKhF,SAAa2C,GACTxE,KAAKuE,SAASC,K,yBAGlB,WACI,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,WAAVvE,GACAE,KAAKuD,MAAMa,QAAQ/D,KAAK,IAAMqB,EAAMyZ,qB,yBAI5C,WACI,IAAIrb,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACnB3C,GAAmB,WAAV5B,GACTE,KAAKuE,SAAS,CACVzB,GAAIpB,EAAMoB,GACVsF,MAAO1G,EAAM0G,MACbkS,gBAAiB5Y,EAAM4Y,gBACvBC,cAAe7Y,EAAM6Y,cACrBzI,SAAS,M,2BAMrB,SAAcpH,GACN1K,KAAKyD,MAAM6L,WACXtP,KAAKuE,SAAS,CAAE+K,YAAY,IAE5BtP,KAAKuE,SAAS,CAAE+K,YAAY,M,wBAIpC,SAAW5E,GACI1K,KACNuE,SAAS,CAAE+M,YAAa5G,M,0BAGjC,SAAawQ,GACTlb,KAAKuE,SAAS,CAAC2W,KAAMA,M,oBAGzB,WAAU,IAAD,OACDlJ,EAAOhS,KACXgS,EAAKzN,SAAS,CAAE6W,cAAc,IAAQ,kBAAM7a,QAAQC,IAAI,EAAKiD,MAAM2X,iBACnE,IAAMC,EAAS,CACbC,iBAAkB,SAAUC,GAC1B,IAAIC,EAAmBC,KAAKC,MAA8B,IAAvBH,EAAcI,OAAgBJ,EAAcK,OAC/Erb,QAAQC,IAAIgb,GACZxJ,EAAKzN,SAAS,CAAEsX,SAAUL,KAG5BlZ,QAAS,CAAE,eAAgB,mBAAoB,cAAiB,UAAY0P,EAAKvO,MAAM5B,QAGrF1B,EAAO,IAAI2b,SACf3b,EAAK4b,OAAO,4BAA6B/b,KAAKyD,MAAMyX,MACpD/a,EAAK4b,OAAO,gBAAiB/b,KAAKyD,MAAM2E,OACxCjI,EAAK4b,OAAO,0BAA2B/b,KAAKyD,MAAM6W,iBAClDna,EAAK4b,OAAO,wBAAyB/b,KAAKyD,MAAM8W,eAChDpa,EAAK4b,OAAO,qBAAsB/b,KAAKyD,MAAM6L,YAC7CnP,EAAK4b,OAAO,sBAAuB/b,KAAKyD,MAAM6N,aAE9ClP,IAAMa,KAAK1B,EAAc,WAAYpB,EAAMkb,GACxC9Y,MAAK,SAAAyZ,GACJhK,EAAKzN,SAAS,CAAE6W,cAAc,EAAOa,kBAAkB,IACvD,IAAI5K,EAAS2K,EAAI7b,KAAKA,KACI,UAAvBkR,EAAOC,aACN,EAAK/N,MAAMa,QAAQ/D,KAAK,oBAAsBgR,EAAOiF,SAK1D5T,OAAM,SAAAwZ,GAAG,OAAIlK,EAAKzN,SAAS,CAAE6W,cAAc,S,oBAGlD,WAAU,IAAD,OACG9L,EAAetP,KAAKyD,MAApB6L,WACF1K,EAAIxB,EAAI,GACd,OACI,sBAAMyB,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,2BAAf,UACI,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,SAAgCD,EAAC,gBACjC,oBAAIC,UAAU,aAAd,SAA4BD,EAAC,iCAIzC,qBAAKC,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,qBAAKI,MAAM,WAAX,SACI,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,SAAwBL,EAAC,kBAE7B,qBAAKK,MAAM,YAAX,SACI,iCACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,eAC5B,uBAAOlE,KAAK,OAAOuE,MAAM,eAAenB,KAAK,aAAayH,YAAa3G,EAAC,gBAAqB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE1B,MAAOsC,EAAEC,OAAOC,SAAYA,MAAO5K,KAAKyD,MAAM2E,WAGrL,sBAAKnD,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,eAC5B,sBAAKK,MAAM,mBAAX,UACI,wBAAOA,MAAM,wBAAb,UACI,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,QAAQ3F,MAAM,yBAAyBiN,QAAoC,UAA3BlS,KAAKyD,MAAM6N,YAAwCrL,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UACrL,sBAAM3F,MAAM,yBAAZ,SAAsCL,EAAC,WAE3C,wBAAOK,MAAM,wBAAb,UACI,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,OAAO3F,MAAM,yBAAyBiN,QAAoC,SAA3BlS,KAAKyD,MAAM6N,YAAuCrL,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UACnL,sBAAM3F,MAAM,yBAAZ,SAAsCL,EAAC,UAE3C,wBAAOK,MAAM,wBAAb,UACI,uBAAOvE,KAAK,WAAWoD,KAAK,OAAO8G,MAAM,QAAQ3F,MAAM,yBAAyBiN,QAAoC,UAA3BlS,KAAKyD,MAAM6N,YAAuCrL,QAAS,SAACyE,GAAD,OAAO,EAAKqH,WAAWrH,EAAEC,OAAOC,UACpL,sBAAM3F,MAAM,yBAAZ,SAAsCL,EAAC,iBAKnD,sBAAKK,MAAM,OAAX,UACI,qBAAKA,MAAM,aAAX,SAAyBL,EAAC,cAC1B,uBAAOlE,KAAK,OAAOuE,MAAM,eAAgBwF,QAAS,SAACC,GAAQ,EAAKyR,aAAazR,EAAEC,OAAOyR,MAAM,UAIhG,sBAAKnX,MAAM,OAAX,UACI,qBAAKA,MAAM,aAAX,SAAyBL,EAAC,aAC1B,wBAAOK,MAAM,yBAAb,UACI,uBAAOA,MAAM,mBAAmBvE,KAAK,WAAWuF,QAAS,SAACyE,GAAD,OAAO,EAAK4H,cAAc5H,EAAEC,OAAOC,QAAQsH,UAAS5C,IAC7G,sBAAMrK,MAAM,mBAAZ,SAAgCL,EAAC,uCAUjD,qBAAKK,MAAM,cAAX,SACI,sBAAKA,MAAM,SAAX,UACI,mBAAGD,KAAK,cAAcC,MAAM,eAA5B,SAA4CL,EAAC,SAC7C,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,0BAA5C,SAAuEL,EAAC,cAGhF,qBAAKK,MAAM,qCAAX,SACI,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,QAAU2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAA1H,SACI,sBAAMhG,MAAM,kBAAZ,mCAMhB,qBAAKA,MAAM,QAAX,SACI,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,4BACX,sBAAKA,MAAM,YAAX,UACI,oBAAIA,MAAM,aAAV,kBACA,iD,GAxNNwB,IAAMC,W,UCA1ClF,GAASD,EAEM8a,G,kDAEjB,WAAY9Y,GAAQ,IAAD,8BACf,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPtF,GAAI,KACJgU,QAAS,KACT9G,kBAAmB,KACnBD,gBAAiB,KACjBuM,MAAO,KACPrM,cAAe,GACf6B,SAAS,EACTxB,YAAY,GAhBD,E,sDAuBnB,WACItM,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,e,kCAGvC,WACImB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,eAAgBlE,KAAK6C,e,+BAGnD,WAAqB,IAAD,OACZmP,EAAOhS,KACL4K,EAAQ9I,KAAY2O,MAAMzQ,KAAKuD,MAAMmB,SAASgJ,QAChDsC,EAAoB,GACpBD,EAAkB,EACtBhO,OAAOC,KAAK4I,GAAO3I,KAAI,SAACC,GACpB,IAAIyQ,EAAUzQ,EAAI0Q,MAAM,KACpBD,EAAQ,KACR3C,EAAoB2C,EAAQ,GAAGE,OAAO,GAAGC,cAAgBH,EAAQ,GAAGI,MAAM,GAC1EhD,EAAkBnF,EAAM1I,OAGhClC,KAAKuE,SAAS,CAAEyL,kBAAmBA,EAAmBD,gBAAiBA,IACnE/P,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IACxBqB,EAAsB,SAAUnE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,GAAI9C,KAAKyD,MAAM5B,OAa3E8N,KAAMvO,SAAS,wBAAyBmb,MACxC,IAAIlN,EAAW,IAAIM,KAAM,cAAe,CACpC6M,MAAO,OACPC,QAAS,CACLC,QAfa,CACjB,CAAC,OAAQ,SAAU,YAAa,UAChC,CAAC,CAAE,KAAQ,WAAa,CAAE,KAAQ,WAClC,CAAC,CAAE,OAAU,MAAO,CAAE,OAAU,OAChC,CAAC,CAAE,UAAa,OAAS,CAAE,UAAa,QACxC,CAAC,SACD,CAAC,SACD,CAAC,CAAE,OAAU,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAChC,CAAC,CAAE,MAAS,IAAM,CAAE,WAAc,KAClC,CAAC,CAAE,MAAS,MAORC,cAAe,CACXtL,OAAQ,SAAC6J,GACL,OAAO,IAAI0B,SAAQ,SAACC,EAASC,GACzB,IAAM/E,EAAMvW,GAAS,WACfub,EAAW,IAAIjB,SACrBiB,EAAShB,OAAO,4BAA6Bb,GAE7C,IAAMG,EAAS,CACX/Y,QAAS,CACL,eAAgB,sBAChB,cAAiB,UAAY,EAAKmB,MAAM5B,QAGhDO,IAAMa,KAAK8U,EAAKgF,EAAU1B,GAAQ9Y,MAAK,SAAUC,GAC7Cqa,EAAQra,EAASrC,KAAKA,KAAKqR,SAE1B9O,OAAM,SAAUC,GACbpC,QAAQC,IAAImC,cAQxC0M,EAASpL,GAAG,eAAe,SAAU+Y,EAAOC,EAAUC,GACpC,OAAVA,GAEiB,QAAVA,GACPlL,EAAKzN,SAAS,CAAE0L,cAAeZ,EAAS8N,cAAerG,QAASzH,EAAS+N,eAOjFpd,KAAKuE,SAAS,CAAE+X,MAAOjN,M,0BAI3B,SAAa7K,GACTxE,KAAKuE,SAASC,K,yBAGlB,WACI,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,UAAVvE,GACAE,KAAKuD,MAAMa,QAAQ/D,KAAK,IAAIqB,EAAMyZ,qB,yBAI1C,WAAe,IAAD,OACNrb,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACnB3C,GAAmB,UAAV5B,GACTE,KAAKuE,SAAS,CACVzB,GAAIpB,EAAMoB,GACVsF,MAAO1G,EAAM0G,MACb0O,QAASpV,EAAMoV,QACf9G,kBAAmBtO,EAAMsO,kBACzBD,gBAAiBrO,EAAMqO,gBACvBE,cAAevO,EAAMuO,cACrBK,WAAY5O,EAAM4O,WAClBwB,SAAS,IACV,WACCvR,QAAQC,IAAI,EAAKiD,OACjB,EAAKA,MAAM6Y,MAAMnM,YAAY,EAAK1M,MAAMwM,oB,oBAMpD,WACI,IAAI9P,EAAO,CACP2C,GAAI9C,KAAKyD,MAAMX,GACfsF,MAAOpI,KAAKyD,MAAM2E,MAClB0O,QAAS9W,KAAKyD,MAAMqT,QACpB9G,kBAAmBhQ,KAAKyD,MAAMuM,kBAC9BD,gBAAiB/P,KAAKyD,MAAMsM,gBAC5BE,cAAejQ,KAAKyD,MAAMwM,cAC1BK,WAAatQ,KAAKyD,MAAM6M,YAEvBtQ,KAAKyD,MAAMqO,QAGZ3N,EAAyB,SAAUhE,EAAMH,KAAKyD,MAAM5B,OAFpDsC,EAAsB,SAAUhE,EAAMH,KAAKyD,MAAM5B,S,2BAOzD,SAAc6I,GACVnK,QAAQC,IAAIkK,GAET1K,KAAKyD,MAAM6M,WACVtQ,KAAKuE,SAAS,CAAC+L,YAAY,IAE3BtQ,KAAKuE,SAAS,CAAC+L,YAAY,M,oBAKnC,WAAU,IAAD,OACGA,EAActQ,KAAKyD,MAAnB6M,WACF1L,EAAIxB,EAAI,GACd,OACI,sBAAMyB,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,2BAAf,UACI,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,SAAgCD,EAAC,cACjC,oBAAIC,UAAU,aAAd,SAA4BD,EAAC,iCAIzC,qBAAKC,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,qBAAKI,MAAM,WAAX,SACI,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,SAAwBL,EAAC,gBAE7B,qBAAKK,MAAM,YAAX,SACI,iCACI,sBAAKA,MAAM,OAAX,UACI,uBAAOA,MAAM,aAAb,SAA2BL,EAAC,aAC5B,uBAAOlE,KAAK,OAAOuE,MAAM,eAAenB,KAAK,aAAayH,YAAa3G,EAAC,gBAAqB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAE1B,MAAOsC,EAAEC,OAAOC,SAAYA,MAAO5K,KAAKyD,MAAM2E,WAErL,sBAAKnD,MAAM,OAAX,UACI,wBAAOA,MAAM,aAAb,UAA2BL,EAAC,aAAiB,sBAAMK,MAAM,8BACzD,qBAAKnC,GAAG,kBAEZ,sBAAKmC,MAAM,OAAX,UACI,qBAAKA,MAAM,aAAX,SAAyBL,EAAC,eAC1B,wBAAOK,MAAM,yBAAb,UACI,uBAAOA,MAAM,mBAAmBvE,KAAK,WAAWuF,QAAS,SAACyE,GAAD,OAAO,EAAK4H,cAAc5H,EAAEC,OAAOC,QAAQsH,UAAS5B,IAC7G,sBAAMrL,MAAM,mBAAZ,SAAgCL,EAAC,+BASjD,qBAAKK,MAAM,cAAX,SACI,sBAAKA,MAAM,SAAX,UACI,mBAAGD,KAAK,cAAcC,MAAM,eAA5B,SAA4CL,EAAC,SAC7C,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,0BAA5C,SAAuEL,EAAC,cAGhF,qBAAKK,MAAM,qCAAX,SACI,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,QAAU2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAA1H,SACI,sBAAMhG,MAAM,kBAAZ,mCAMhB,qBAAKA,MAAM,QAAX,SACI,sBAAKA,MAAM,OAAX,UACI,qBAAKA,MAAM,4BACX,sBAAKA,MAAM,YAAX,UACI,oBAAIA,MAAM,aAAV,kBACA,iD,GA5OPwB,IAAMC,WCL1B2W,G,kDAEjB,WAAY9Z,GAAQ,IAAD,8BACf,cAAMA,IACDP,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO,MANI,E,sDAanB,WACImC,EAAWC,GAAG,eAAgBjE,KAAKgD,e,kCAGvC,WACIgB,EAAWE,eAAe,eAAgBlE,KAAKgD,e,+BAGnD,WACImB,EAAsB,uBAAwB,GAAInE,KAAKuD,MAAMmM,MAAM9N,OAAOkB,M,0BAK9E,SAAa0B,GACTxE,KAAKuE,SAASC,K,yBAGlB,WACI,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,aAAVvE,IACA4D,OAAOC,aAAa0G,QAAQ,QAAS3I,EAAMG,OAC3C7B,KAAKuD,MAAMa,QAAQ/D,KAAK,gB,oBAIhC,WACI,OAAQ,S,GA3CsBoG,IAAMC,WCItC+C,GAAiBC,YAAUC,KAC3BnI,GAASD,EACTqD,GAAIxB,EAAI,GAEOka,G,kDAEnB,WAAY/Z,GAAQ,IAAD,8BACjB,cAAMA,IACDP,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACX5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCkT,QAAS,KACT9O,KAAM,GACNsH,YAAY,EACZ0J,kBAAmB,KACnBC,gBAAiB,MAXF,E,sDAkBnB,WACEjV,EAAWC,GAAG,eAAgBjE,KAAKgD,e,kCAGrC,WACEgB,EAAWE,eAAe,eAAgBlE,KAAKgD,e,+BAGjD,WACE,IACM4H,EAAQ9I,KAAY2O,MAAMzQ,KAAKuD,MAAMmB,SAASgJ,QAChDsL,EAAoB,GACpBC,EAAkB,EACtBlX,OAAOC,KAAK4I,GAAO3I,KAAI,SAACC,GACpB,IAAIyQ,EAAUzQ,EAAI0Q,MAAM,KACpBD,EAAQ,KACRqG,EAAoBrG,EAAQ,GAAGE,OAAO,GAAGC,cAAgBH,EAAQ,GAAGI,MAAM,GAC1EkG,EAAkBrO,EAAM1I,OAGhClC,KAAKuE,SAAS,CAAEyU,kBAAmBA,EAAmBC,gBAAiBA,M,0BAIzE,SAAazU,GACXxE,KAAKuE,SAASC,K,yBAGhB,WACE,IAAI1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,aAAVvE,GACAE,KAAKuD,MAAMa,QAAQ/D,KAAK,IAAIqB,EAAM6b,qB,oBAKxC,WACE,IAAIpd,EAAOH,KAAKyD,MACXzD,KAAKyD,MAAMqO,SACd3N,EAAsB,YAAahE,EAAMH,KAAKyD,MAAM5B,S,yBAKxD,SAAYmG,GAAO,IAAD,OACZC,EAAS,GACbD,EAAK/F,KAAI,SAACiG,GACJA,EAAG,MACLD,EAAO5H,KAAK6H,EAAG,OAEfD,EAAO5H,KAAK6H,MAGhBlI,KAAKuE,SAAS,CAAEyD,KAAMC,IAAU,kBAAM1H,QAAQC,IAAI,EAAKiD,MAAMuE,W,qBAG/D,WACE,OAAIhI,KAAKuD,MAAMmM,MAAM9N,OAAOkB,IAAM9C,KAAKyD,MAAMX,GACnC9C,KAAKyN,WAGVzN,KAAKuD,MAAMmM,MAAM9N,OAAOkB,QAA7B,EACU9C,KAAKyN,a,sBAIjB,WAAY,IAAD,OACT,OACE,qBAAK5F,MAAO,CAAEyF,UAAW,MAAOC,aAAc,QAA9C,SACE,cAAC,GAAD,CACEzK,GAAG,YACH0I,UAAQ,EACRC,UAAQ,EACRC,gBAAiB1L,KAAKyD,MAAMuE,KAC5B2D,UAAW3L,KAAKyD,MAAMkI,UACtBC,SAAS,QACTC,SAAU,SAACC,GACT,EAAKvH,SAAS,CAAEoH,WAAW,IAC3BI,MAAMvK,GAAS,kBAAoBsK,GAChCvJ,MAAK,SAACyJ,GAAD,OAAUA,EAAKC,UACpB1J,MAAK,YAAgB,IAAb2J,EAAY,EAAZA,MACP,EAAK3H,SAAS,CAAE6F,QAAS8B,EAAOP,WAAW,IAAS,kBAAMpL,QAAQC,IAAI,EAAKiD,MAAM2G,gBAGvFgB,SAAU,SAACxG,GAAD,OAAO,EAAKuH,YAAYvH,IAClCwF,QAASpK,KAAKyD,MAAM2G,QACpBgC,uBAAwB,SAACC,EAAQ9I,GAAT,OACtB,cAAC,IAAM8E,SAAP,UACE,+BAAOgE,EAAOjE,iB,2BAQ1B,SAAcsC,GACT1K,KAAKyD,MAAM6L,WACVtP,KAAKuE,SAAS,CAAC+K,YAAY,IAE3BtP,KAAKuE,SAAS,CAAC+K,YAAY,M,4BAIjC,WACE,GAAGtP,KAAKyD,MAAM6L,WACZ,OACE,sBAAMrK,MAAM,kBAAZ,SAA+BL,GAAC,Y,oBAMtC,WAAU,IAAD,OACC0K,EAActP,KAAKyD,MAAnB6L,WACR,OACE,sBAAMzK,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,2BAAf,UACE,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,uBACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,iCAInC,qBAAKC,UAAU,YAAf,SACE,qBAAKA,UAAU,eAAf,SACE,sBAAKA,UAAU,yBAAf,UACE,qBAAKI,MAAM,WAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,cAAX,SACE,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,oBAE3B,qBAAKK,MAAM,YAAX,SACE,iCACE,sBAAKA,MAAM,OAAX,UACE,wBAAOA,MAAM,aAAb,UAA2BL,GAAC,iBAAqB,sBAAMK,MAAM,8BAC7D,0BAAUA,MAAM,eAAenB,KAAK,yBAAyBwH,KAAK,IAAIC,YAAa3G,GAAC,gBAAqB6F,QAAS,SAACC,GAAQ,EAAKZ,aAAa,CAAEgN,QAASpM,EAAEC,OAAOC,SAAYA,MAAO5K,KAAKyD,MAAMyL,UAIjM,sBAAKjK,MAAM,QAAQnC,GAAG,OAAtB,UACE,uBAAOmC,MAAM,aAAb,SAA4BL,GAAC,OAC5B5E,KAAKoS,aAKR,sBAAKnN,MAAM,OAAX,UACE,qBAAKA,MAAM,aAAX,SAAyBL,GAAC,aAC1B,wBAAOK,MAAM,yBAAb,UACE,uBAAOA,MAAM,mBAAmBvE,KAAK,WAAWuF,QAAS,SAACyE,GAAD,OAAO,EAAK4H,cAAc5H,EAAEC,OAAOC,QAAQsH,UAAS5C,IAC7G,sBAAMrK,MAAM,mBAAZ,SAAgCL,GAAC,yCASzC,qBAAKK,MAAM,cAAX,SACE,sBAAKA,MAAM,SAAX,UACE,mBAAGD,KAAK,eAAeC,MAAM,eAA7B,SAA6CL,GAAC,SAC9C,wBAAQqB,QAAS,kBAAM,EAAK4D,UAAU5E,MAAM,0BAA5C,SAAuEL,GAAC,cAG5E,qBAAKK,MAAM,qCAAX,SACE,qBAAKA,MAAM,eAAe4C,MAAO,CAAE1C,MAAO,QAAU2F,KAAK,cAAcC,gBAAc,KAAKC,gBAAc,IAAIC,gBAAc,MAA1H,SACE,sBAAMhG,MAAM,kBAAZ,mCAMR,qBAAKA,MAAM,QAAX,SACE,sBAAKA,MAAM,OAAX,UACE,qBAAKA,MAAM,4BACX,sBAAKA,MAAM,YAAX,UACE,oBAAIA,MAAM,aAAV,kBACA,iD,GA7MoBwB,IAAMC,W,kBCW5C8W,GAAoB9Z,OAAO8Z,kBACjCC,GAAMC,SAAW,GAEjBD,GAAME,mBAAqB,WAC1B,GAAGC,UAAUC,cAAgBD,UAAUC,aAAaC,gBAEnD,OAAO,EAER,GAAGpa,OAAOka,UAAUG,UAAUrO,MAAM,UAAW,CAC9C,IAAIsO,EAAYC,SAASva,OAAOka,UAAUG,UAAUrO,MAAM,iBAAiB,GAAI,IAC3EwO,EAAS,GAGb,OAFGxa,OAAOka,UAAUG,UAAUrO,MAAM,WACnCwO,EAAS,IACPF,GAAa,IAAMA,GAAaE,GAI5BT,GAAMU,UAAUC,cAGvB,OAAO,GAIT,IAAIC,GAAmB,CAEtBC,YAAa,mCACbF,YAAa,WAAa,OAAgE,OAAzD1G,SAAS6G,cAAc,+BACxDC,UAAW,SAAUC,GACpB,IAAIC,EAAUhb,OAAOib,YAAW,WAC/B,IAAIhc,EAAQ,IAAIic,MAAM,2BAEtB,OADAjc,EAAMmB,KAAO,2IACN2a,EAAS9b,KACd,KACH3C,KAAK6e,MAAMH,GAAWD,EACtB/a,OAAOob,YAAY,CAAEpe,KAAM,iBAAkBoC,GAAI4b,GAAW,MAE7DK,KAAM,WACL,IAAIF,EAAQ,GACZ7e,KAAK6e,MAAQA,EAEbnb,OAAOiU,iBAAiB,WAAW,SAAUhQ,GAC5C,GAAGA,EAAMqX,QAAUtb,OAAOgB,SAASsa,OAEnC,GAAsB,kBAAnBrX,EAAMxH,KAAKO,MAA4Bme,EAAMlX,EAAMxH,KAAK2C,IAAK,CAC/D,IAAI2b,EAAWI,EAAMlX,EAAMxH,KAAK2C,IAGhC,UAFO+b,EAAMlX,EAAMxH,KAAK2C,IAEI,KAAxB6E,EAAMxH,KAAK8e,SAAiB,CAE/B,IAAItc,EAAQ,IAAIic,MAAM,2BACtBjc,EAAMmB,KAAO,yDACb2a,EAAS9b,QAET8b,EAAS,KAAM9W,EAAMxH,KAAK8e,cAEE,yBAAnBtX,EAAMxH,KAAKO,OACrBH,QAAQC,IAAI,YAAamH,EAAMxH,KAAK2C,IACpCY,OAAOwb,aAAavX,EAAMxH,KAAK2C,UA8VnC,SAAS2a,GAAM0B,GAKd,IAJAA,EAAmBA,GAAoB,IACtBC,QAA8C,mBAA5BD,EAAiBC,QAAyBD,EAAiBC,QAAU3B,GAAM4B,KAC9GF,EAAiBxc,MAA0C,mBAA1Bwc,EAAiBxc,MAAuBwc,EAAiBxc,MAAQ8a,GAAM4B,KACxGF,EAAiBG,UAAkD,mBAA9BH,EAAiBG,UAA2BH,EAAiBG,UAAY7B,GAAM4B,MAChH5B,GAAM8B,SAET,OADAJ,EAAiBxc,MAAM,2BAChB,GAER,IAAI8a,GAAM+B,oBAET,OADAL,EAAiBxc,MAAM,wCAChB,GAGR,GADA8a,GAAMjd,IAAI,wBAA0Bid,GAAM8B,WACtCJ,EAAiB3d,OAEpB,OADA2d,EAAiBxc,MAAM,sBAChB,GAER,IAAI8c,GAAa,EACbC,EAAK,KACLC,EAAa,GACbC,EAAuB,KACvBC,EAAU,KACVC,EAAe,EACfte,EAAS2d,EAAiB3d,OAC3Bic,GAAMsC,QAAQve,IAChBic,GAAMjd,IAAI,8BAAgCgB,EAAOpB,OAAS,oCAC1DoB,EAAS,KACTqe,EAAUV,EAAiB3d,OAC3Bic,GAAMuC,MAAMH,IAEgB,IAAzBre,EAAOiT,QAAQ,OACjBgL,GAAa,EACbhC,GAAMjd,IAAI,sCAAwCgB,KAElDie,GAAa,EACbhC,GAAMjd,IAAI,oCAAsCgB,IAGlD,IAAIye,EAAad,EAAiBc,YAAc,CAAC,CAACC,KAAM,iCACpDC,EAAqBhB,EAAiBgB,mBACtCC,EAAejB,EAAiBiB,aAEhCC,GAAyC,IAA1BlB,EAAiBmB,KAEhCC,GAAkB,OACkBC,IAArCrB,EAAiBoB,iBAAsE,OAArCpB,EAAiBoB,kBACrEA,GAAuD,IAArCpB,EAAiBoB,iBAEpC,IAAIE,EAAQ,QAC4BD,IAArCrB,EAAiBuB,iBAAsE,OAArCvB,EAAiBuB,kBACrED,EAAQtB,EAAiBuB,iBACvBD,EAAQ,IACVA,EAAQ,GAET,IAAI5e,EAAQ,UACkB2e,IAA3BrB,EAAiBtd,OAAkD,OAA3Bsd,EAAiBtd,QAC3DA,EAAQsd,EAAiBtd,OAE1B,IAAI8e,EAAY,UACkBH,IAA/BrB,EAAiBwB,WAA0D,OAA/BxB,EAAiBwB,YAC/DA,EAAYxB,EAAiBwB,WAE9B3gB,KAAK4gB,iBAAkB,OACiBJ,IAArCrB,EAAiByB,iBAAsE,OAArCzB,EAAiByB,kBACrE5gB,KAAK4gB,iBAAwD,IAArCzB,EAAiByB,iBAE1C,IAAIC,EAAkB,UACkBL,IAArCrB,EAAiB0B,iBAAsE,OAArC1B,EAAiB0B,kBACrEA,EAAkB1B,EAAiB0B,iBACjCC,MAAMD,KACRA,EAAkB,MACnB,IAAIE,EAAkB,IAOtB,SAASC,EAAeC,GACvB,IAAIC,EAAc,CACjBC,KAAM,IACNC,OAAQ,IACRC,IAAK,KAYN,YAT6Bb,IAAzBS,GAA+D,OAAzBA,IACrCA,EAAqBE,OACxBD,EAAYC,KAAOF,EAAqBE,MACrCF,EAAqBG,SACxBF,EAAYE,OAASH,EAAqBG,QACvCH,EAAqBI,MACxBH,EAAYG,IAAMJ,EAAqBI,MAGlCH,OAtBgCV,IAArCrB,EAAiB4B,iBAAsE,OAArC5B,EAAiB4B,kBACrEA,EAAkB5B,EAAiB4B,iBACjCD,MAAMC,KACRA,EAAkB,KAsBnB,IAAIO,GAAY,EACZC,EAAY,KACZC,EAAgB,GAChBC,EAAOzhB,KACP0hB,EAAU,EACVC,EAAe,GAkBnB,SAASC,IACR,GAAgB,MAAbL,EAGH,GADA9D,GAAMuC,MAAM,gBACRsB,EAAJ,CAIA,IAAIO,EAAWrgB,EAAS,IAAM+f,EAAY,SAAU,IAAIra,MAAO4a,UAC5DrB,IACFoB,EAAWA,EAAW,UAAYpB,GAChC5e,IACFggB,EAAWA,EAAW,UAAYE,mBAAmBlgB,IACnD8e,IACFkB,EAAWA,EAAW,cAAgBE,mBAAmBpB,IAC1DlD,GAAMuE,YAAYH,EAAU,CAC3BI,KAAM,MACN1B,gBAAiBA,EACjBnB,QAAS8C,EACTC,QAASpB,EACTpe,MAAO,SAASyf,EAAYC,GAG3B,GAFA5E,GAAM9a,MAAMyf,EAAa,IAAKC,KAC9BX,EACa,EAIZ,OAFAJ,GAAY,OACZnC,EAAiBxc,MAAM,+CAGxBif,YAxBDnE,GAAM6E,KAAK,yCA8Bb,SAASJ,EAAYjW,EAAMsW,GAI1B,GAHAb,EAAU,EACNjC,QAA4Be,IAAde,GAAyC,OAAdA,IAAsC,IAAhBgB,GAClEX,IACGnC,IAAchC,GAAMsC,QAAQ9T,GAOhC,GAAqB,cAAlBA,EAAI,MAIA,GAAqB,gBAAlBA,EAAI,MAYP,GAAqB,QAAlBA,EAAI,MAYP,GAAqB,YAAlBA,EAAI,MAYP,GAAqB,YAAlBA,EAAI,MAAyB,CAGtC,KADIkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGb,IAAIyC,EAAYxW,EAAI,UACpBwR,GAAMuC,MAAM,uCAAyCuB,GACrD9D,GAAMuC,MAAMyC,GACZ,IAAIpH,EAASmH,EAAaE,YACvBrH,EAAOsH,IAAMtH,EAAOuH,WAEtBnF,GAAMuC,MAAM,2BAA4ByC,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BxH,EAAOsH,GAAGG,gBAAgBL,GAH1BpH,EAAOsH,GAAGG,gBAAgBrF,GAAMsF,mBAOjCtF,GAAMuC,MAAM,6FACR3E,EAAO2H,aACV3H,EAAO2H,WAAa,IACrB3H,EAAO2H,WAAW3iB,KAAKoiB,GACvBhF,GAAMuC,MAAM3E,EAAO2H,iBAEd,IAAqB,aAAlB/W,EAAI,MAKb,OAHAwR,GAAMuC,MAAM,mCAAqCuB,GACjD9D,GAAMuC,MAAM/T,IACRkL,EAASlL,EAAI,SAKbuW,EAAehB,EAAcrK,SAKjCqL,EAAaS,aAAY,QAHxBxF,GAAMuC,MAAM,oDALZvC,GAAM6E,KAAK,qBAUN,GAAqB,WAAlBrW,EAAI,MAAwB,CAKrC,GAHAwR,GAAMuC,MAAM,iCAAmCuB,GAC/C9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGbwC,EAAaS,aAAY,EAAOhX,EAAI,QACpCuW,EAAaU,cACP,GAAqB,aAAlBjX,EAAI,MAA0B,CAKvC,GAHAwR,GAAMuC,MAAM,mCAAqCuB,GACjD9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,OAEDqL,EAAaW,UAAW,EACxBX,EAAaY,aACbZ,EAAaa,cACP,GAAqB,UAAlBpX,EAAI,MAAuB,CAKpC,GAHAwR,GAAMuC,MAAM,gCAAkCuB,GAC9C9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGbwC,EAAac,WAAWrX,EAAI,KAAUA,EAAI,gBACpC,GAAqB,aAAlBA,EAAI,MAA0B,CAKvC,GAJAwR,GAAMuC,MAAM,mCAAqCuB,GACjD9D,GAAMuC,MAAM/T,KAERkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGbwC,EAAae,SAAStX,EAAI,OAAYA,EAAI,UACpC,IAAqB,UAAlBA,EAAI,MAAuB,CAIpC,IAAIuX,EAECC,EADL,GAHAhG,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QACjE0d,GAAMuC,MAAM/T,GACRuX,EAAcvX,EAAI,aAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UAER0V,EAAa6B,GAErB,OACM,GAAqB,UAAlBvX,EAAI,MAAuB,CAGpC,IAAIkL,EACJ,GAHAsG,GAAMuC,MAAM,iCAAmCuB,GAC/C9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAGZ,IAAIqB,EAAa1X,EAAI,WACrB,IAAI0X,EAEH,YADAlG,GAAM6E,KAAK,yBAGZ7E,GAAMuC,MAAM,6BAA+B7I,EAAS,KAAOwM,EAAU,OAAa,KAClF,IAEInB,EAFAriB,EAAOwjB,EAAU,KAGrB,GAFAlG,GAAMuC,MAAM7f,KACRqiB,EAAehB,EAAcrK,IAGhC,YADAsG,GAAM6E,KAAK,+CAGZ,IAAIsB,EAAO3X,EAAI,KACZ2X,IACFnG,GAAMuC,MAAM,2BACZvC,GAAMuC,MAAM4D,IAEb,IAAInF,EAAW+D,EAAaqB,UACzBpF,GACFhB,GAAMuC,MAAM,4BAEZvB,EAASte,EAAMyjB,IAGfnG,GAAMuC,MAAM,yCAEP,IAAqB,YAAlB/T,EAAI,MAMb,OALAwR,GAAM9a,MAAM,sBAAwB4e,GACpC9D,GAAMuC,MAAM/T,QACRwT,GACHC,EAAGoE,MAAM,KAAM,oBAIhBrG,GAAM6E,KAAK,2BAA6BrW,EAAI,MAAY,gBAAkBsV,GAC1E9D,GAAMuC,MAAM/T,UApLZwR,GAAMuC,MAAM,4BAA8BuB,GAC1C9D,GAAMuC,MAAM/T,IACRuX,EAAcvX,EAAI,gBAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UACR0V,EAAa6B,SAnBrB/F,GAAMuC,MAAM,yBAA2BuB,GACvC9D,GAAMuC,MAAM/T,IACRuX,EAAcvX,EAAI,gBAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UACR0V,EAAa6B,SAnBrB/F,GAAMuC,MAAM,kCACZvC,GAAMuC,MAAM/T,IACRuX,EAAcvX,EAAI,gBAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UACR0V,EAAa6B,SAXrB/F,GAAMsG,OAAO,8BAAgCxC,QAP7C,IAAI,IAAIthB,EAAE,EAAGA,EAAEgM,EAAK7L,OAAQH,IAC3BiiB,EAAYjW,EAAKhM,IAAI,GA2NxB,SAAS+jB,IACR,GAAIxiB,GAAWie,GAAe6B,EAA9B,CAEA1B,EAAuBjB,WAAWqF,EAAWnD,GAC7C,IAAIoD,EAAU,CAAE,MAAS,YAAa,WAAc1C,EAAW,YAAe9D,GAAMyG,aAAa,KAC9FriB,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,GACxBjB,EAAGxJ,KAAKiO,KAAKC,UAAUH,KAIxB,SAASI,EAAcC,GACtB,IAAId,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,SAAU,YAAeT,GAgClD,GA/BGc,EAAS,YAEXhD,GAAY,EACZ2C,EAAO,MAAY,QACnBA,EAAO,WAAiB1C,EAErB7B,IACFA,EAAG6E,OAAS,KACZ7E,EAAG8E,QAAU,KACb9E,EAAG+E,QAAU,KACV7E,IACFV,aAAaU,GACbA,EAAuB,QAIvB/d,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,IACpBnf,GAAUic,GAAMsC,QAAQF,KAGC,KAD5Bre,EAASqe,EAAQC,IACPrL,QAAQ,OACjBgL,GAAa,EACbhC,GAAMjd,IAAI,YAAcsf,EAAa,GAAK,yCAA2Cte,EAAS,OAE9Fie,GAAa,EACbhC,GAAMjd,IAAI,YAAcsf,EAAa,GAAK,uCAAyCte,EAAS,OAG3Fie,EA2DF,IAAI,IAAIiF,KA1DRhF,EAAKjC,GAAMkH,aAAanjB,EAAQ,kBAChCme,EAAa,CACZ,MAAS,WAER,GADAlC,GAAM9a,MAAM,sDAAwDnB,GAChEic,GAAMsC,QAAQF,KAAayE,EAAS,UAEvC,QADAxE,IACqBD,EAAQzf,YAE5BkkB,EAAU3hB,MAAM,+EAIjBnB,EAAS,UACTmd,YAAW,WACV0F,EAAcC,KACZ,MAGJA,EAAU3hB,MAAM,yEAGjB,KAAQ,WAEPgf,EAAa6B,GAAe,SAASvX,GAEpC,GADAwR,GAAMuC,MAAM/T,GACU,YAAlBA,EAAI,MAGP,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUlM,QAG/B6f,EAAuBjB,WAAWqF,EAAWnD,GAC7CS,GAAY,EACZC,EAAYtV,EAAI,WAAiBA,EAAI,WAAiBA,EAAK9L,KAAL,GACnDmkB,EAAS,UACX7G,GAAMjd,IAAI,oBAAsB+gB,GAEhC9D,GAAMjd,IAAI,oBAAsB+gB,GAEjC9D,GAAMC,SAAS6D,GAAaE,EAC5B6C,EAAUlF,WAEXM,EAAGxJ,KAAKiO,KAAKC,UAAUH,KAGxB,QAAW,SAAStc,GACnBua,EAAYiC,KAAK1T,MAAM9I,EAAMxH,QAG9B,MAAS,WACHqB,GAAW8f,IAGhBA,GAAY,EAEZnC,EAAiBxc,MAAM,kDAKxB+c,EAAG/H,iBAAiB+M,EAAW/E,EAAW+E,SAK5CjH,GAAMuE,YAAYxgB,EAAQ,CACzBygB,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GAEjB,GADAwR,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAGN,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUlM,QAG/BuhB,GAAY,EACZC,EAAYtV,EAAI,WAAiBA,EAAI,WAAiBA,EAAK9L,KAAL,GACnDmkB,EAAS,UACX7G,GAAMjd,IAAI,oBAAsB+gB,GAEhC9D,GAAMjd,IAAI,oBAAsB+gB,GAEjC9D,GAAMC,SAAS6D,GAAaE,EAC5BG,IACA0C,EAAUlF,WAEXzc,MAAO,SAASyf,EAAYC,GAE3B,GADA5E,GAAM9a,MAAMyf,EAAa,IAAKC,GAC3B5E,GAAMsC,QAAQF,KAAayE,EAAS,UAEtC,QADAxE,IACoBD,EAAQzf,YAE3BkkB,EAAU3hB,MAAM,+EAIjBnB,EAAS,UACTmd,YAAW,WAAa0F,EAAcC,KAAe,MAGnC,KAAhBjC,EACFiC,EAAU3hB,MAAMyf,EAAa,yBAE7BkC,EAAU3hB,MAAMyf,EAAa,KAAOC,MAuYxC,SAASwC,EAAYC,EAAUR,GAI9B,IAHAA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,MAC/EiC,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAGjB,IAAI6f,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAIoiB,EAAUT,EAAUS,QACpBnB,EAAOU,EAAUV,KACjBJ,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,UAAW,KAAQc,EAAS,YAAevB,GAiBpE,GAhBGhB,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACrBiD,IACFK,EAAQL,KAAO,CACdljB,KAAMkjB,EAAKljB,KACXskB,IAAKpB,EAAKoB,KAERpB,EAAKqB,OACPhB,EAAQL,KAAKqB,MAAO,GACC,QAAnBrB,EAAKsB,WAA0C,QAAnBtB,EAAKsB,YACnCjB,EAAQL,KAAKsB,UAAYtB,EAAKsB,YAEhCzH,GAAMuC,MAAM,qCAAuC8E,EAAW,MAC9DrH,GAAMuC,MAAMiE,GACTxE,EAkCF,OAjCAwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,EACvBnD,EAAa6B,GAAe,SAASvX,GAGpC,GAFAwR,GAAMuC,MAAM,iBACZvC,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAAyB,CAE/B,IAAI0X,EAAa1X,EAAI,WACrB,IAAI0X,EAGH,OAFAlG,GAAM6E,KAAK,qDACXgC,EAAUlF,UAGX3B,GAAMjd,IAAI,uCAAyCmjB,EAAU,OAAa,KAC1E,IAAIxjB,EAAOwjB,EAAU,KAGrB,OAFAlG,GAAMuC,MAAM7f,QACZmkB,EAAUlF,QAAQjf,GAES,QAAlB8L,EAAI,MAYdqY,EAAUlF,UAVNnT,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,UAEzD0d,GAAM9a,MAAM,iBACZ2hB,EAAU3hB,MAAM,wBAOnB+c,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GAGjB,GAFAwR,GAAMuC,MAAM,iBACZvC,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAAyB,CAE/B,IAAI0X,EAAa1X,EAAI,WACrB,IAAI0X,EAGH,OAFAlG,GAAM6E,KAAK,qDACXgC,EAAUlF,UAGX3B,GAAMjd,IAAI,uCAAyCmjB,EAAU,OAAa,KAC1E,IAAIxjB,EAAOwjB,EAAU,KAGrB,OAFAlG,GAAMuC,MAAM7f,QACZmkB,EAAUlF,QAAQjf,GAES,QAAlB8L,EAAI,MAYdqY,EAAUlF,UAVNnT,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,UAEzD0d,GAAM9a,MAAM,iBACZ2hB,EAAU3hB,MAAM,mBAOnBA,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GAC9BiC,EAAU3hB,MAAMyf,EAAa,KAAOC,MAMvC,SAAS8C,EAAqBL,EAAUrC,GACvC,GAAInB,EAAJ,CAIA,IAAIkB,EAAehB,EAAcsD,GACjC,GAAItC,GAAiBA,EAAaE,YAAlC,CAIA,IAAIuB,EAAU,CAAE,MAAS,UAAW,UAAaxB,EAAW,YAAehF,GAAMyG,aAAa,KAO9F,GANG1B,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACxBlD,GAAMsG,OAAO,qCAAuCe,EAAW,MAC/DrH,GAAMsG,OAAOE,GACVxE,EAIF,OAHAwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,OACvBpF,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMsG,OAAO,mBACbtG,GAAMsG,OAAO9X,GACQ,QAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,SAInE4C,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,WA7B/B5E,GAAM6E,KAAK,uBALX7E,GAAM6E,KAAK,yCAwCb,SAAS8C,EAAkBN,EAAUO,EAASC,EAAYC,EAAUC,GACnE,IAAIhD,EAAehB,EAAcsD,GACjC,GAAItC,GAAiBA,EAAaE,YAAlC,CAIA,IAAIrH,EAASmH,EAAaE,YAC1B,GAAIrH,EAAOsH,GAAX,CAIA,IAKI8C,EAA2B,SAAS9d,GACvC8V,GAAMjd,IAAI,yCAA0CmH,GACpD,IAAI+d,EAAQ/d,EAAMgD,OAAO+a,MACrBC,EAAWhe,EAAMgD,OAAOgb,SACxBC,EAAUvK,EAAOwK,YAAYH,GAASrK,EAAOwK,YAAYH,GAAOI,WAAa,OAEjF,GADArI,GAAMjd,IAAI,oBAAsBklB,EAAQ,mBAAqBE,GAC9C,SAAZA,EAAoB,CAEtB,GAAGvK,EAAOwK,YAAYH,GAAOhH,SAAWrD,EAAOwK,YAAYH,GAAOhH,QAAQte,OAAS,EAAG,CACrFqd,GAAMjd,IAAI,gCAAkCklB,EAAQ,KAAMrK,EAAOwK,YAAYH,GAAOhH,QAAQte,QADP,qBAErEib,EAAOwK,YAAYH,GAAOhH,SAF2C,IAErF,IAAI,EAAJ,qBAAmD,CAAC,IAA5Cve,EAA2C,QAClDsd,GAAMjd,IAAI,iCAAmCklB,EAAQ,KACrDjI,GAAMuC,MAAM7f,GACZkb,EAAOwK,YAAYH,GAAOxP,KAAK/V,IALqD,8BAOrFkb,EAAOwK,YAAYH,GAAOhH,QAAU,GAGrC8D,EAAauD,WAAWL,EAAOC,KAOjC,GAAIJ,EAQHlK,EAAOwK,YAAYR,GAAWE,MARjB,CAEb,IAAIS,EAAY,CAAEC,SAAS,GACxBX,IACFU,EAAUL,SAAWL,GACtBjK,EAAOwK,YAAYR,GAAWhK,EAAOsH,GAAGyC,kBAAkBC,EAASW,GAKpE3K,EAAOwK,YAAYR,GAASxB,UAxCD,SAASlc,GACnC8V,GAAMjd,IAAI,oCAAqCmH,GAC/C,IAAI+d,EAAQ/d,EAAMgD,OAAO+a,MACzBlD,EAAa0D,OAAOve,EAAMxH,KAAMulB,IAsCjCrK,EAAOwK,YAAYR,GAASd,OAASkB,EACrCpK,EAAOwK,YAAYR,GAASZ,QAAUgB,EACtCpK,EAAOwK,YAAYR,GAASb,QAjBH,SAAS7hB,GACjC8a,GAAM9a,MAAM,6BAA8BA,IAiB3C0Y,EAAOwK,YAAYR,GAAS3G,QAAU,GACnC8G,GACFnK,EAAOwK,YAAYR,GAAS3G,QAAQre,KAAKmlB,QAjDzC/H,GAAM6E,KAAK,+BALX7E,GAAM6E,KAAK,kBA0Db,SAAS6D,EAASrB,EAAUR,IAC3BA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YACtBviB,EAAOmkB,EAAU8B,MAAQ9B,EAAUnkB,KACvC,IAAIA,EAGH,OAFAsd,GAAM6E,KAAK,qBACXgC,EAAU3hB,MAAM,gBAGjB,IAAI+iB,EAAQpB,EAAUoB,MAAQpB,EAAUoB,MAAQjI,GAAM4I,qBACtD,OAAIhL,EAAOwK,YAAYH,GAMqB,SAAzCrK,EAAOwK,YAAYH,GAAOI,YAC5BzK,EAAOwK,YAAYH,GAAOhH,QAAQre,KAAKF,QACvCmkB,EAAUlF,YAGX3B,GAAMjd,IAAI,iCAAmCklB,EAAQ,KACrDjI,GAAMuC,MAAM7f,GACZkb,EAAOwK,YAAYH,GAAOxP,KAAK/V,QAC/BmkB,EAAUlF,YAZTgG,EAAkBN,EAAUY,EAAOpB,EAAUqB,UAAU,EAAOxlB,EAAMmkB,EAAUqB,eAC9ErB,EAAUlF,WAeZ,SAASkH,EAASxB,EAAUR,IAC3BA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YAC1B,IAAIrH,EAAOkL,WAAY,CAEtB,GAAGlL,EAAOsH,GAAI,CACb,IACI6D,EADUnL,EAAOsH,GAAG8D,aACEC,MAAK,SAASvP,GACvC,OAAOA,EAAOwP,OAA+B,UAAtBxP,EAAOwP,MAAMC,QAErC,IAAIJ,EAGH,OAFA/I,GAAM6E,KAAK,oDACXgC,EAAU3hB,MAAM,+CAGjB0Y,EAAOkL,WAAaC,EAAYK,KAC7BxL,EAAOkL,aACT9I,GAAMjd,IAAI,uBACV6a,EAAOkL,WAAWO,aAAe,SAASC,GAAQtJ,GAAMuC,MAAM,mBAAqB+G,EAAKA,QAG1F,IAAI1L,EAAOkL,WAGV,OAFA9I,GAAM6E,KAAK,mCACXgC,EAAU3hB,MAAM,8BAIlB,IAAIkkB,EAAOvC,EAAUuC,KACrB,IAAIA,EAGH,OAFApJ,GAAM6E,KAAK,gCACXgC,EAAU3hB,MAAM,2BAGjB,IAAIqkB,EAAQH,EAAKG,MACjB,IAAIA,EAGH,OAFAvJ,GAAM6E,KAAK,4BACXgC,EAAU3hB,MAAM,uBAGjB,IAAIskB,EAAqC,kBAAlBJ,EAAKI,SAAyBJ,EAAKI,SAAW,IACjEC,EAA2B,kBAAbL,EAAKK,IAAoBL,EAAKK,IAAM,GACtDzJ,GAAMuC,MAAM,uBAAyBgH,EAAQ,cAAgBC,EAAW,WAAaC,EAAM,OAC3F7L,EAAOkL,WAAWY,WAAWH,EAAOC,EAAUC,GAC9C5C,EAAUlF,UAIX,SAASgI,EAActC,EAAUR,IAChCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAIgI,GAAqC,IAAxB/C,EAAU+C,UAC3B5J,GAAMjd,IAAI,qBAAuBskB,EAAW,kBAAoBuC,EAAY,KAC5EC,EAAcxC,GACd,IAAItC,EAAehB,EAAcsD,GACjC,IAAItC,GAAgBA,EAAaW,SAIhC,cAFO3B,EAAcsD,QACrBR,EAAUlF,UAGX,GAAGiI,EAIF,cAFO7F,EAAcsD,QACrBR,EAAUlF,UAGX,IAAIkC,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAGjB,IAAIshB,EAAU,CAAE,MAAS,SAAU,YAAexG,GAAMyG,aAAa,KAKrE,GAJG1B,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACrBlB,EAMF,OALAwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,EACvBpF,EAAGxJ,KAAKiO,KAAKC,UAAUH,WAChBzC,EAAcsD,QACrBR,EAAUlF,UAGX3B,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMjd,IAAI,qBACVid,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,eAE3DyhB,EAAcsD,GACrBR,EAAUlF,WAEXzc,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,UAEvBb,EAAcsD,GACrBR,EAAUlF,aAMb,SAASmI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,GACtD,IAAIjF,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAOjC,OANAjF,GAAM6E,KAAK,kBAEPgC,EAAUmD,QACbhK,GAAMiK,cAAcD,QAErBnD,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YAC1BjF,GAAMuC,MAAM,eAAgByH,GACzBA,IACFhK,GAAMuC,MAAM,qBAAsByH,EAAOE,kBACzClK,GAAMuC,MAAM,qBAAsByH,EAAOG,mBAG1C,IAAIC,GAAY,EAChB,GAAIxM,EAAOyM,UAAaN,EAAMO,SAAU1M,EAAO2M,eAGxC,CAEN,KAAMR,EAAMO,QAAUE,EAAmBT,IAAYA,EAAMO,SAAWP,EAAMU,UAAYV,EAAMW,gBAC5FV,EAAOE,kBAAoBF,EAAOE,iBAAiBvnB,OAEpD,GADAib,EAAOyM,SAASM,SAASX,EAAOE,iBAAiB,IAC9ClK,GAAM4K,YAAa,CAErB5K,GAAMjd,KAAKgnB,EAAMW,aAAe,YAAc,UAAY,gBAAiBV,EAAOE,iBAAiB,IACnG,IAAIW,EAAmB,KAEvB,IADIC,EAAelN,EAAOsH,GAAG6F,oBACVD,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAC1B,IADO3jB,EAAmB,SACpBuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KAAmB,CACxE0B,EAAmB1jB,EACnB,QALyC,+BASzC0jB,GAAoBA,EAAiBnR,OACvCmR,EAAiBnR,OAAOuR,aAAajB,EAAOE,iBAAiB,IAE7DtM,EAAOsH,GAAGyF,SAASX,EAAOE,iBAAiB,GAAIF,QAGhDhK,GAAMjd,KAAKgnB,EAAMW,aAAe,YAAc,UAAY,gBAAiBV,EAAOE,iBAAiB,IACnGtM,EAAOsH,GAAGyF,SAASX,EAAOE,iBAAiB,GAAIF,GAGjD,KAAMD,EAAMO,QAAUY,EAAmBnB,IAAYA,EAAMO,SAAWP,EAAMoB,UAAYpB,EAAMqB,gBAC5FpB,EAAOG,kBAAoBH,EAAOG,iBAAiBxnB,OAEpD,GADAib,EAAOyM,SAASM,SAASX,EAAOG,iBAAiB,IAC9CnK,GAAM4K,YAAa,CAErB5K,GAAMjd,KAAKgnB,EAAMqB,aAAe,YAAc,UAAY,gBAAiBpB,EAAOG,iBAAiB,IACnG,IACIW,EADAO,EAAmB,KAEvB,IADIP,EAAelN,EAAOsH,GAAG6F,oBACVD,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAAC,IAApB3jB,EACP,IADOA,EAAmB,SACpBuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KAAmB,CACxEkC,EAAmBlkB,EACnB,QALyC,+BASzCkkB,GAAoBA,EAAiB3R,OACvC2R,EAAiB3R,OAAOuR,aAAajB,EAAOG,iBAAiB,IAE7DvM,EAAOsH,GAAGyF,SAASX,EAAOG,iBAAiB,GAAIH,QAGhDhK,GAAMjd,KAAKgnB,EAAMqB,aAAe,YAAc,UAAY,gBAAiBpB,EAAOG,iBAAiB,IACnGvM,EAAOsH,GAAGyF,SAASX,EAAOG,iBAAiB,GAAIH,QAvDjDpM,EAAOyM,SAAWL,EAClBI,GAAY,EA2Db,IAAIxM,EAAOsH,GAAI,CACd,IAAIoG,EAAY,CAAC,WAAc9I,EAAY,mBAAsBE,EAAoB,aAAgBC,GACnD,WAA/C3C,GAAMuL,cAAcC,eAAeC,UAErCH,EAAS,aAAoBtL,GAAMuL,cAAcC,eAAeE,QAAU,GAAM,SAAW,gBAE5F,IAAIC,EAAiB,CACpB,SAAY,CAAC,CAAC,sBAAwB,KAMvC,GAJG/I,GACF+I,EAAeC,SAAShpB,KAAK,CAAC,UAAW,IAGvCikB,EAAUgF,gBAAsD,kBAA7BhF,EAAUgF,eAE/C,IAAI,IAAIrpB,KADRwd,GAAMuC,MAAM,4CAA6CsE,EAAUgF,gBACtDhF,EAAUgF,eACtBF,EAAeC,SAAShpB,KAAKikB,EAAUgF,eAAerpB,IAGN,SAA/Cwd,GAAMuL,cAAcC,eAAeC,UAErCH,EAAU3I,aAAe,cAGvBmJ,eAAiBA,aAAaC,UAAUC,sBACxCF,aAAaC,UAAUE,2BACxBH,aAAaC,UAAUG,6BACtBrF,EAAUsF,kBAAoBtF,EAAUuF,sBAC1CxO,EAAOuO,iBAAmBtF,EAAUsF,iBACpCvO,EAAOwO,mBAAqBvF,EAAUuF,mBACtCd,EAAS,oCAAyC,EAClDA,EAAS,oCAAyC,EAClDA,EAAS,0BAA+B,GAEzCtL,GAAMjd,IAAI,2BACVid,GAAMuC,MAAMoJ,GACZ/N,EAAOsH,GAAK,IAAImH,kBAAkBf,EAAWK,GAC7C3L,GAAMuC,MAAM3E,EAAOsH,IAChBtH,EAAOsH,GAAGoH,WACZ1O,EAAO2O,OAAS,GAChB3O,EAAO4O,QAAQrf,MAAQ,eAExB6S,GAAMjd,IAAI,yDAA2D6a,EAAO6O,QAAU,KACtF7O,EAAOsH,GAAGwH,2BAA6B,SAASzf,GAC5C2Q,EAAOsH,IACTH,EAAa4H,SAAS/O,EAAOsH,GAAG0H,qBAElChP,EAAOsH,GAAG2H,eAAiB,SAAS3iB,GACnC,IAAKA,EAAM8a,WACuC,SAA/ChF,GAAMuL,cAAcC,eAAeC,SAAsBvhB,EAAM8a,UAAUA,UAAUhO,QAAQ,mBAAqB,EAClHgJ,GAAMjd,IAAI,sBACV6a,EAAOkP,SAAU,GACK,IAAnBlP,EAAO6O,QAET/E,EAAqBL,EAAU,CAAC,WAAa,IA8qClD,SAAiBA,EAAUR,IAC1BA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,YADAjF,GAAM6E,KAAK,wCAGZ,IAAIjH,EAASmH,EAAaE,YAE1B,GADAjF,GAAMjd,IAAI,gCACN6a,EAAOmP,MAEV,YADA/M,GAAM6E,KAAK,0DAGZjH,EAAOmP,MAAQ,CACd,KAAQnP,EAAOsH,GAAG8H,iBAAiB/pB,KACnC,IAAO2a,EAAOsH,GAAG8H,iBAAiBzF,MAEb,IAAnB3J,EAAO6O,UACT7O,EAAOmP,MAAP,SAA0B,GAC3B/M,GAAMuC,MAAMsE,GACZjJ,EAAOqP,SAAU,EACjBpG,EAAUlF,QAAQ/D,EAAOmP,OAlsCrBG,CAAQ7F,EAAUR,OAEb,CAGN,IAAI7B,EAAY,CACf,UAAa9a,EAAM8a,UAAUA,UAC7B,OAAU9a,EAAM8a,UAAUmI,OAC1B,cAAiBjjB,EAAM8a,UAAUoI,gBAEZ,IAAnBxP,EAAO6O,SAET/E,EAAqBL,EAAUrC,KAIlCpH,EAAOsH,GAAGmI,QAAU,SAASnjB,GAG5B,GAFA8V,GAAMjd,IAAI,yBACVid,GAAMuC,MAAMrY,GACRA,EAAMojB,UAEV1P,EAAO2P,aAAerjB,EAAMojB,QAAQ,GACpCvI,EAAayI,eAAe5P,EAAO2P,eAChCrjB,EAAMgf,MAAMuE,SAAf,CAEA,GAAG7P,EAAOwO,mBAAoB,CAC7B,IAAIsB,EAAkB,KACnB5B,aAAaC,UAAUC,qBACzB0B,EAAkBxjB,EAAM8gB,SAASgB,wBACxBF,aAAaC,UAAU4B,2BAA6B7B,aAAaC,UAAUG,6BAC5D,UAArBhiB,EAAMgf,MAAMC,MAAoBvL,EAAOwO,mBAAP,MAClCsB,EAAkBxjB,EAAM8gB,SAASiB,4BACH,UAArB/hB,EAAMgf,MAAMC,MAAoBvL,EAAOwO,mBAAP,QACzCsB,EAAkBxjB,EAAM8gB,SAASkB,8BAGhCwB,IACF5qB,QAAQC,IAAI2qB,GACTA,EAAgBE,gBAAkBF,EAAgBG,eACpDH,EAAgBE,eACdE,YAAYlQ,EAAOwO,mBAAmBliB,EAAMgf,MAAMC,OAClD4E,OAAOL,EAAgBG,gBAChBH,EAAgBM,UAAYN,EAAgBO,UACrDP,EAAgBM,SACdF,YAAYlQ,EAAOwO,mBAAmBliB,EAAMgf,MAAMC,OAClD4E,OAAOL,EAAgBO,WAI5B,IAAIC,EAAsB,KAC1BlO,GAAMjd,IAAI,oCAAqCmH,EAAMgf,OACrDhf,EAAMgf,MAAMuE,QAAU,SAASU,GAC9BnO,GAAMjd,IAAI,wBAAyBorB,GAChCvQ,EAAO2P,eACT9L,aAAayM,GACbtQ,EAAO2P,aAAaa,YAAYD,EAAGjhB,QACnC6X,EAAayI,eAAe5P,EAAO2P,gBAGrCrjB,EAAMgf,MAAMmF,OAAS,SAASF,GAC7BnO,GAAMjd,IAAI,sBAAuBorB,GAC9BvQ,EAAO2P,cAAuC,MAAvBW,IACzBA,EAAsBhN,YAAW,WAChClB,GAAMjd,IAAI,yBACN6a,EAAO2P,eACV3P,EAAO2P,aAAaa,YAAYD,EAAGjhB,QACnC6X,EAAayI,eAAe5P,EAAO2P,eAEpCW,EAAsB,OAGpB,QAGLhkB,EAAMgf,MAAMoF,SAAW,SAASH,GAE/B,GADAnO,GAAMjd,IAAI,8BAA+BorB,GACf,MAAvBD,EACFzM,aAAayM,GACbA,EAAsB,UAEtB,IACCtQ,EAAO2P,aAAa5C,SAASwD,EAAGjhB,QAChC6X,EAAayI,eAAe5P,EAAO2P,cAClC,MAAMtgB,GACP+S,GAAM9a,MAAM+H,OAMjB,GAAGmd,GAAaJ,EAAQ,CACvBhK,GAAMjd,IAAI,uBACV,IAAIwrB,GAAuC,IAAzB1H,EAAU0H,WAC5BvE,EAAOwE,YAAYC,SAAQ,SAASvF,GACnClJ,GAAMjd,IAAI,sBAAuBmmB,GACjC,IAAIxP,EAAS,KACb,GAAI6U,GAA6B,UAAfrF,EAAMC,KAEjB,CACNnJ,GAAMjd,IAAI,mCAAoCmmB,GAC9C,IAAIzF,EAAcF,EAAesD,EAAUrD,sBACvCkL,EAAK9Q,EAAOsH,GAAGyJ,eAAezF,EAAO,CACxCrZ,UAAW,WACXyd,QAAS,CAACtD,GACV4E,cAAe/H,EAAU+H,eAAiB,CACzC,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYC,MAClD,CAAEmL,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYE,OAAQqL,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYG,IAAKoL,sBAAuB,MAG7EN,IACFhV,EAASgV,EAAGhV,aAdbA,EAASkE,EAAOsH,GAAGyF,SAASzB,EAAOc,GAiBpC,GAAGtQ,GAAUkE,EAAOuO,iBAAkB,CACrC,IAAI8C,EAAgB,KACjBnD,aAAaC,UAAUC,qBACzBiD,EAAgBvV,EAAOsS,wBACdF,aAAaC,UAAU4B,2BAA6B7B,aAAaC,UAAUG,6BAC3D,UAAtBxS,EAAOwP,MAAMC,MAAoBvL,EAAOuO,iBAAP,MACnC8C,EAAgBvV,EAAOuS,4BACQ,UAAtBvS,EAAOwP,MAAMC,MAAoBvL,EAAOuO,iBAAP,QAC1C8C,EAAgBvV,EAAOwS,8BAGtB+C,IACFnsB,QAAQC,IAAIksB,GACTA,EAAcrB,gBAAkBqB,EAAcpB,eAChDoB,EAAcrB,eACZE,YAAYlQ,EAAOuO,iBAAiBzS,EAAOwP,MAAMC,OACjD4E,OAAOkB,EAAcpB,gBACdoB,EAAcjB,UAAYiB,EAAchB,UACjDgB,EAAcjB,SACZF,YAAYlQ,EAAOuO,iBAAiBzS,EAAOwP,MAAMC,OACjD4E,OAAOkB,EAAchB,gBAulD7B,SAAuBlE,GAEtB,GADA/J,GAAMuC,MAAM,iBAAkBwH,GACoB,SAA/C/J,GAAMuL,cAAcC,eAAeC,QAErC,OADAzL,GAAM6E,KAAK,2CACJ,EAER,YAAa9B,IAAVgH,GAAiC,OAAVA,IAEH,IAAfA,EAAMrnB,MAxlDXwsB,CAAcnF,KAAWnM,EAAOwK,YAAYpI,GAAM4I,wBACpD5I,GAAMjd,IAAI,iCACV4kB,EAAkBN,EAAUrH,GAAM4I,qBAAsB,MAAM,GAC9DhL,EAAOsH,GAAGiK,cAAgB,SAASjlB,GAClC8V,GAAMjd,IAAI,iCAAkCmH,GAC5Cyd,EAAkBN,EAAUnd,EAAMklB,QAAQnH,MAAO/d,EAAMklB,QAAQlH,SAAUhe,EAAMklB,WAI9ExR,EAAOyM,UACTtF,EAAasK,cAAczR,EAAOyM,UAG/BlE,EAGHvI,EAAOsH,GAAGoK,qBAAqBnJ,GAC7BrhB,MAAK,WAIL,GAHAkb,GAAMjd,IAAI,gCACV6a,EAAOuH,UAAYgB,EAAKoB,IAErB3J,EAAO2H,YAAc3H,EAAO2H,WAAW5iB,OAAS,EAAG,CACrD,IAAI,IAAIH,EAAI,EAAGA,EAAGob,EAAO2H,WAAW5iB,OAAQH,IAAK,CAChD,IAAIwiB,EAAYpH,EAAO2H,WAAW/iB,GAClCwd,GAAMuC,MAAM,2BAA4ByC,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BxH,EAAOsH,GAAGG,gBAAgBL,GAH1BpH,EAAOsH,GAAGG,gBAAgBrF,GAAMsF,iBAMlC1H,EAAO2H,WAAa,IA4wBzB,SAAsB8B,EAAU0C,EAAOlD,IACtCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAU0I,aAAiD,mBAA1B1I,EAAU0I,aAA8B1I,EAAU0I,aAAevP,GAAM4B,KACxG,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YACtBuK,GAAqC,IAAxB3I,EAAU2I,UACvBA,EAGHxP,GAAMjd,IAAI,4BAA8B6a,EAAOkP,QAAU,eAAiB0C,EAAY,KAFtFxP,GAAMjd,IAAI,4BAA8B6a,EAAOkP,QAAU,KAI1D,IAAI2C,EAAmB,KACvB,GAAGzP,GAAM4K,YAAa,CAErB6E,EAAmB,GACnB,IAAI5E,EAAmB,KAAMQ,EAAmB,KAC5CP,EAAelN,EAAOsH,GAAG6F,kBAC7B,GAAGD,GAAgBA,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAAC,IAApB3jB,EAAmB,QACtBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KACjD0B,IACHA,EAAmB1jB,IAGjBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,QACjDkC,IACHA,EAAmBlkB,KAXqB,+BAiB5C,IAAIuoB,EAAYlF,EAAmBT,GAC/B4F,EAAYC,EAAmB7F,GACnC,GAAI2F,GAAcC,GAgBjB,GAAGD,GAAaC,GACf,GAAG9E,EACF,IACKA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,GACnD,MAAM5d,GACP+S,GAAM9a,MAAM+H,SAGR,GAAGyiB,IAAcC,EACvB,IACI9E,IACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,IAEpD,MAAM5d,GACP+S,GAAM9a,MAAM+H,QAEP,IAAIyiB,GAAaC,EACvB,GAAG9E,EACF,IACKA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,GACnD,MAAM5d,GACP+S,GAAM9a,MAAM+H,QAIb4d,EAAmBjN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsC8nB,QAvDlD,GAAGd,EAAM+F,aAAejF,EACvB,IACKA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,GACnD,MAAM5d,GACP+S,GAAM9a,MAAM+H,GAmDf,IAAI8iB,EAAY7E,EAAmBnB,GAC/BiG,EAAYC,EAAmBlG,GACnC,GAAIgG,GAAcC,GAgBjB,GAAGD,GAAaC,GACf,GAAG3E,EACF,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,SAGR,GAAG8iB,IAAcC,GACvB,GAAG3E,EACF,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,SAGR,IAAI8iB,GAAaC,EACvB,GAAG3E,EACF,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,QAIboe,EAAmBzN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsCsoB,QAvDlD,GAAGtB,EAAMmG,aAAe7E,EACvB,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,SAoDdwiB,EADiD,YAA/CzP,GAAMuL,cAAcC,eAAeC,SAAwE,SAA/CzL,GAAMuL,cAAcC,eAAeC,QAC9E,CAClB0E,oBAAqBP,EAAmB7F,GACxCqG,oBAAqBH,EAAmBlG,IAGtB,CAClBsG,UAAW,CACVC,oBAAqBV,EAAmB7F,GACxCwG,oBAAqBN,EAAmBlG,KAK5C/J,GAAMuC,MAAMkN,GAEZ,IAAIe,EAAYtF,EAAmBnB,GACnC,GAAGyG,GAAahB,GAA4D,YAA/CxP,GAAMuL,cAAcC,eAAeC,QAAuB,CAEtFzL,GAAMjd,IAAI,2CACV,IAAI2W,EAASkE,EAAOsH,GAAG8D,aAAa,GACpChJ,GAAMjd,IAAI2W,GACV,IAAI+W,EAAa/W,EAAOgX,gBACxB1Q,GAAMjd,IAAI0tB,GAEV,IAAIhN,EAAcF,EAAesD,EAAUrD,sBAC3C9J,EAAOiX,cAAc,CAACC,UAAW/J,EAAU+H,eAAiB,CAC3D,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYC,MAClD,CAAEmL,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYE,OAAQqL,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYG,IAAKoL,sBAAuB,MAGhFpR,EAAOsH,GAAG2L,aAAapB,GACrB3qB,MAAK,SAASgsB,GACd9Q,GAAMuC,MAAMuO,GAGZ,IAAI3K,EAAO,CACV,KAAQ2K,EAAO7tB,KACf,IAAO6tB,EAAOvJ,KAEfV,EAAU0I,aAAapJ,GACvB2K,EAAOvJ,IAAMpB,EAAKoB,IAClBvH,GAAMjd,IAAI,6BACPytB,GAAahB,IAEmC,WAA/CxP,GAAMuL,cAAcC,eAAeC,QAIrCzL,GAAM6E,KAAK,qFAC6C,YAA/C7E,GAAMuL,cAAcC,eAAeC,SAC5CzL,GAAM6E,KAAK,iEAGbjH,EAAOmP,MAAQ+D,EAAOvJ,IACtB3J,EAAOsH,GAAG6L,oBAAoBD,GAC5B7rB,MAAM4hB,EAAU3hB,OAClB0Y,EAAO6R,iBAAmBA,EACtB7R,EAAOkP,SAAYlP,EAAO6O,UAM3B7O,EAAOuO,kBAAoBvO,EAAOwO,sBACpC0E,EAAM,MAAW,GAElBjK,EAAUlF,QAAQmP,IAPjB9Q,GAAMjd,IAAI,mCAQT8jB,EAAU3hB,OAv/BX2rB,CAAaxJ,EAAU0C,EAAOlD,KAC5BA,EAAU3hB,OA0jBhB,SAAqBmiB,EAAU0C,EAAOlD,IACrCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAU0I,aAAiD,mBAA1B1I,EAAU0I,aAA8B1I,EAAU0I,aAAevP,GAAM4B,KACxG,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YACtBuK,GAAqC,IAAxB3I,EAAU2I,UACvBA,EAGHxP,GAAMjd,IAAI,2BAA6B6a,EAAOkP,QAAU,eAAiB0C,EAAY,KAFrFxP,GAAMjd,IAAI,2BAA6B6a,EAAOkP,QAAU,KAKzD,IAAI2C,EAAmB,GACvB,GAAGzP,GAAM4K,YAAa,CAErB,IAAIC,EAAmB,KAAMQ,EAAmB,KAC5CP,EAAelN,EAAOsH,GAAG6F,kBAC7B,GAAGD,GAAgBA,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAAC,IAApB3jB,EAAmB,QACtBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KACjD0B,IACHA,EAAmB1jB,IAIjBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,QACjDkC,IACHA,EAAmBlkB,KAZqB,+BAmB5C,IAAIuoB,EAAYlF,EAAmBT,GAC/B4F,EAAYC,EAAmB7F,GAC/B2F,GAAcC,EAYdD,GAAaC,EACZ9E,IACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,IAE5C6E,IAAcC,EACpB9E,IACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,KAE3C6E,GAAaC,IACpB9E,GACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,KAGpDA,EAAmBjN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsC8nB,KAvC/Cd,EAAM+F,aAAejF,IACnBA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,IAsCtD,IAAIkF,EAAY7E,EAAmBnB,GAC/BiG,EAAYC,EAAmBlG,GAC/BgG,GAAcC,EAYdD,GAAaC,EACZ3E,IACEA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,IAE5C0E,IAAcC,EACpB3E,IACEA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,KAE3C0E,GAAaC,IACpB3E,GACEA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,KAGpDA,EAAmBzN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsCsoB,KAvC/CtB,EAAMmG,aAAe7E,IACnBA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,SAsCtDoE,EAAgB,oBAA0BG,EAAmB7F,GAC7D0F,EAAgB,oBAA0BQ,EAAmBlG,IAEnB,IAAzBlD,EAAUmK,aAE3BvB,EAAgB,YAAiB,GAElCzP,GAAMuC,MAAMkN,GAEZ,IAAIe,EAAYtF,EAAmBnB,GACnC,GAAGyG,GAAahB,GAA4D,YAA/CxP,GAAMuL,cAAcC,eAAeC,QAAuB,CAEtFzL,GAAMjd,IAAI,2CACV,IAAI2W,EAASkE,EAAOsH,GAAG8D,aAAaC,MAAK,SAAS7V,GAAI,MAAwB,UAAjBA,EAAE8V,MAAMC,QACrE,GAAGzP,EAAQ,CACV,IAAI+W,EAAa/W,EAAOgX,gBACpBD,IACHA,EAAa,IAEd,IAAIhN,EAAcF,EAAesD,EAAUrD,sBAC3CiN,EAAWG,UAAY/J,EAAU+H,eAAiB,CACjD,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYC,MAClD,CAAEmL,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYE,OAAQqL,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYG,IAAKoL,sBAAuB,IAE/EtV,EAAOiX,cAAcF,IAGvB7S,EAAOsH,GAAG+L,YAAYxB,GACpB3qB,MAAK,SAASosB,GACdlR,GAAMuC,MAAM2O,GAGZ,IAAI/K,EAAO,CACV,KAAQ+K,EAAMjuB,KACd,IAAOiuB,EAAM3J,KAEdV,EAAU0I,aAAapJ,GACvB+K,EAAM3J,IAAMpB,EAAKoB,IACjBvH,GAAMjd,IAAI,6BACPytB,GAAahB,IAEmC,WAA/CxP,GAAMuL,cAAcC,eAAeC,SACW,WAA/CzL,GAAMuL,cAAcC,eAAeC,SACpCzL,GAAMjd,IAAI,kDACVmuB,EAAM3J,IA8hBX,SAAiCA,GAQhC,IALA,IAAI4J,EAAQ5J,EAAIpS,MAAM,QAClBic,GAAQ,EACRC,EAAO,EAAG,GAAKC,EAAW,EAAG,GAC7BC,EAAQ,KAAMC,EAAO,KAAMC,EAAU,KAAMxJ,EAAQ,KACnDyJ,GAAY,EACRlvB,EAAE,EAAGA,EAAE2uB,EAAMxuB,OAAQH,IAAK,CAEjC,GADImvB,EAAQR,EAAM3uB,GAAGyP,MAAM,cAG1B,GAAc,UADD0f,EAAM,GACI,CAEtB,KAAGN,EAAK,GAAK,GAEN,CAENK,EAAWlvB,EACX,MAJA4uB,GAAQ,OAQT,GAAGC,EAAK,IAAM,EAAG,CAEhBK,EAAWlvB,EACX,YAKH,GAAI4uB,EAAJ,CAEA,IAAIQ,EAAMT,EAAM3uB,GAAGyP,MAAM,gCACzB,GAAG2f,EACFP,EAAK,GAAKO,EAAI,GACdN,EAAS,GAAKM,EAAI,GAClBT,EAAMla,OAAOzU,EAAG,GAAIA,QAHrB,CAMA,GAAG6uB,EAAK,GAAI,CAiBX,IAhBIpf,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAEhDE,EAAQtf,EAAM,KAEfA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,iBAE5CG,EAAOvf,EAAM,KAEdA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,oBAE5CI,EAAUxf,EAAM,KAEjBA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAE5CpJ,EAAQhW,EAAM,IAEkC,IAA9Ckf,EAAM3uB,GAAGwU,QAAQ,UAAYsa,EAAS,IAAW,CACnDH,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,SAED,GAA6C,IAA1C2uB,EAAM3uB,GAAGwU,QAAQ,UAAYqa,EAAK,IAAW,CAC/CF,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,UAGoB,GAAnB2uB,EAAM3uB,GAAGG,SACXwuB,EAAMla,OAAOzU,EAAG,GAAIA,OAItB,GAAG6uB,EAAK,GAAK,EAAG,CAEfK,GAAY,EACZN,GAAQ,EACR,IAAQ5uB,EAAE,EAAGA,EAAE2uB,EAAMxuB,OAAQH,IAAK,CACjC,IAAImvB,EACJ,GADIA,EAAQR,EAAM3uB,GAAGyP,MAAM,cAG1B,GAAc,UADD0f,EAAM,GACI,CAEtB,KAAGN,EAAK,GAAK,GAEN,CAENK,EAAWlvB,EACX,MAJA4uB,GAAQ,OAQT,GAAGC,EAAK,IAAM,EAAG,CAEhBK,EAAWlvB,EACX,YAKH,GAAI4uB,EAAJ,CAEA,GAAGC,EAAK,GAAK,EAAG,CACf,IAAIlkB,EAAQgkB,EAAM3uB,GAAGyP,MAAM,gBAC3B,GAAG9E,EAAO,CACTkkB,EAAK,GAAKlkB,EAAM,GAChBgkB,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,cAEK,CACN,IAAIyP,EAgBJ,IAhBIA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAEhDE,EAAQtf,EAAM,KAEfA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,iBAE5CG,EAAOvf,EAAM,KAEdA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,oBAE5CI,EAAUxf,EAAM,KAEjBA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAE5CpJ,EAAQhW,EAAM,IAEkC,IAA9Ckf,EAAM3uB,GAAGwU,QAAQ,UAAYsa,EAAS,IAAW,CACnDH,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,SAED,GAA6C,IAA1C2uB,EAAM3uB,GAAGwU,QAAQ,UAAYqa,EAAK,IAAW,CAC/CF,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,UAGqB,IAApB2uB,EAAM3uB,GAAGG,SACXwuB,EAAMla,OAAOzU,EAAG,GAAIA,OAKvB,GAAG6uB,EAAK,GAAK,EAGZ,OADArR,GAAM6E,KAAK,0DACJ0C,EAELmK,EAAW,IAEbA,EAAWP,EAAMxuB,QAIlB0uB,EAAK,GAAKrT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAC1BT,EAAK,GAAKrT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAC1BR,EAAS,GAAKtT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAC9BR,EAAS,GAAKtT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAE9B,IAAQtvB,EAAE,EAAGA,EAAE6uB,EAAK1uB,OAAQH,IACxB+uB,IACFJ,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,UAAY+uB,GAC5DG,KAEEF,IACFL,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,SAAWgvB,GAC3DE,KAEED,IACFN,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,YAAcivB,GAC9DC,KAEEzJ,IACFkJ,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,UAAYylB,GAC5DyJ,KAGEH,IACFJ,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,UAAY+uB,GAChEG,KAEEF,IACFL,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,SAAWgvB,GAC/DE,KAEED,IACFN,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,YAAcivB,GAClEC,KAEEzJ,IACFkJ,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,UAAYylB,GAChEyJ,KAGFP,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEH,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEH,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEH,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMA,EAAK,GAAK,IAAMA,EAAK,KACrF9J,EAAM4J,EAAMzsB,KAAK,SACTqtB,SAAS,UAChBxK,GAAO,QACR,OAAOA,EAnuBSyK,CAAwBd,EAAM3J,MACc,YAA/CvH,GAAMuL,cAAcC,eAAeC,SAC5CzL,GAAM6E,KAAK,iEAGbjH,EAAOmP,MAAQmE,EAAM3J,IACrB3J,EAAOsH,GAAG6L,oBAAoBG,GAC5BjsB,MAAM4hB,EAAU3hB,OAClB0Y,EAAO6R,iBAAmBA,EACtB7R,EAAOkP,SAAYlP,EAAO6O,UAM3B7O,EAAOuO,kBAAoBvO,EAAOwO,sBACpC8E,EAAK,MAAW,GAEjBrK,EAAUlF,QAAQuP,IAPjBlR,GAAMjd,IAAI,mCAQT8jB,EAAU3hB,OA5xBb+rB,CAAY5J,EAAU0C,EAAOlD,GA2B/B,SAASoL,EAAc5K,EAAU6J,EAAOrK,IACvCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQgtB,EAC7E,IAAI/L,EAAOU,EAAUV,KACrB,GAAG+K,GAAS/K,EAGX,OAFAnG,GAAM9a,MAAM,yCACZ2hB,EAAU3hB,MAAM,oCAEV,IAAIgsB,KAAW/K,IAASA,EAAKljB,OAASkjB,EAAKoB,KAGjD,OAFAvH,GAAM9a,MAAM,kDACZ2hB,EAAU3hB,MAAM,6CAIjB2hB,EAAUkD,MAAoC,kBAApBlD,EAAUkD,OAAsBlD,EAAUkD,MAASlD,EAAUkD,MAAQ,CAAEoI,OAAO,EAAMf,OAAO,GACrH,IAAIrH,EAAQlD,EAAUkD,MAClBhF,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IA2hDyBunB,EA3hDrB7O,EAASmH,EAAaE,YAG1B,GAFArH,EAAO6O,SA0hDkBA,EA1hDS5F,EAAU4F,QA2hD5CzM,GAAMuC,MAAM,oBAAqBkK,IACb,IAAZA,GA1hDJ7O,EAAOsH,GAKJ,CAKN,GAJAlF,GAAMjd,IAAI,mCACVgnB,EAAMO,QAAS,EAGZzD,EAAUmD,OAETnD,EAAUmD,SAAWpM,EAAOyM,UAC9BrK,GAAMjd,IAAI,oDAEL,CAEN,GAAGgnB,EAAMU,UAKR,GAJAV,EAAMqI,WAAY,EAClBrI,EAAMW,cAAe,EACrBX,EAAM+F,aAAc,EACpB/F,EAAM2F,WAAY,EACf9R,EAAOyM,UAAYzM,EAAOyM,SAASH,kBAAoBtM,EAAOyM,SAASH,iBAAiBvnB,OAG1F,OAFAqd,GAAM9a,MAAM,qDACZ2hB,EAAU3hB,MAAM,qDAGR6kB,EAAM+F,aACf/F,EAAMqI,WAAY,EAClBrI,EAAMW,cAAe,EACrBX,EAAMU,UAAW,EACjBV,EAAM2F,WAAY,GACT3F,EAAMW,eACfX,EAAMqI,WAAY,EAClBrI,EAAMU,UAAW,EACjBV,EAAM+F,aAAc,EACpB/F,EAAM2F,WAAY,GAoCnB,GAlCI9R,EAAOyM,UAaNzM,EAAOyM,SAASH,kBAAgE,IAA5CtM,EAAOyM,SAASH,iBAAiBvnB,QAcrE6nB,EAAmBT,IACnBA,EAAM+F,aAAgB/F,EAAMW,eAC9BX,EAAMqI,WAAY,IA3BjBrI,EAAMW,eACRX,EAAMqI,WAAY,EAClBrI,EAAMW,cAAe,EACrBX,EAAMU,UAAW,EACjBV,EAAM2F,WAAY,GAEhBlF,EAAmBT,KACrBA,EAAMqI,WAAY,EAClBrI,EAAMU,UAAW,IAwBhBV,EAAMoB,UAKR,GAJApB,EAAMsI,WAAY,EAClBtI,EAAMqB,cAAe,EACrBrB,EAAMmG,aAAc,EACpBnG,EAAMgG,WAAY,EACfnS,EAAOyM,UAAYzM,EAAOyM,SAASF,kBAAoBvM,EAAOyM,SAASF,iBAAiBxnB,OAG1F,OAFAqd,GAAM9a,MAAM,qDACZ2hB,EAAU3hB,MAAM,qDAGR6kB,EAAMmG,aACfnG,EAAMsI,WAAY,EAClBtI,EAAMqB,cAAe,EACrBrB,EAAMoB,UAAW,EACjBpB,EAAMgG,WAAY,GACThG,EAAMqB,eACfrB,EAAMsI,WAAY,EAClBtI,EAAMoB,UAAW,EACjBpB,EAAMmG,aAAc,EACpBnG,EAAMgG,WAAY,GAEfnS,EAAOyM,UAaNzM,EAAOyM,SAASF,kBAAgE,IAA5CvM,EAAOyM,SAASF,iBAAiBxnB,QAcrEuoB,EAAmBnB,IAAWA,EAAMmG,aAAgBnG,EAAMqB,eAC5DrB,EAAMsI,WAAY,IA1BjBtI,EAAMqB,eACRrB,EAAMsI,WAAY,EAClBtI,EAAMqB,cAAe,EACrBrB,EAAMoB,UAAW,EACjBpB,EAAMgG,WAAY,GAEhB7E,EAAmBnB,KACrBA,EAAMsI,WAAY,EAClBtI,EAAMoB,UAAW,IAuBhBpB,EAAMuI,UACRvI,EAAMrnB,MAAO,GAIf,GAAI8nB,EAAmBT,IAAUA,EAAMqI,WACpClH,EAAmBnB,IAAUA,EAAMsI,UAGrC,OAFAtN,EAAawN,eAAc,QAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWjJ,EAAOyM,eApItDN,EAAMO,QAAS,EACfP,EAAMqI,WAAY,EAClBrI,EAAMsI,WAAY,EAuInB,GAAGtI,EAAMO,SAAW1M,EAAO2M,eAAgB,CAC1C,GAAGR,EAAM+F,aAAe/F,EAAMW,aAAc,CAC3C,GAAG9M,EAAOyM,UAAYzM,EAAOyM,SAASH,kBAAoBtM,EAAOyM,SAASH,iBAAiBvnB,OAAQ,CAClG,IAAI6vB,EAAK5U,EAAOyM,SAASH,iBAAiB,GAC1ClK,GAAMjd,IAAI,wBAAyByvB,GACnC5U,EAAOyM,SAAS+D,YAAYoE,GAC5B,IACCA,EAAGzZ,OACF,MAAM9L,KAET,GAAG2Q,EAAOsH,GAAG8D,cAAgBpL,EAAOsH,GAAG8D,aAAarmB,OAAQ,CAC3D,IAAI8vB,GAAK,EAKT,GAJG1I,EAAMW,cAAgB1K,GAAM4K,cAE9B6H,GAAK,GAEHA,EAAI,CAAC,IAAD,iBACU7U,EAAOsH,GAAG8D,cADpB,IACN,IAAI,EAAJ,qBAAwC,CAAC,IAAjC0J,EAAgC,QACpCA,GAAQA,EAAKxJ,OAA6B,UAApBwJ,EAAKxJ,MAAMC,OACnCnJ,GAAMjd,IAAI,yBAA0B2vB,GACpC9U,EAAOsH,GAAGkJ,YAAYsE,KAJlB,iCAUT,GAAG3I,EAAMmG,aAAenG,EAAMqB,aAAc,CAC3C,GAAGxN,EAAOyM,UAAYzM,EAAOyM,SAASF,kBAAoBvM,EAAOyM,SAASF,iBAAiBxnB,OAAQ,CAClG,IAAIgwB,EAAK/U,EAAOyM,SAASF,iBAAiB,GAC1CnK,GAAMjd,IAAI,wBAAyB4vB,GACnC/U,EAAOyM,SAAS+D,YAAYuE,GAC5B,IACCA,EAAG5Z,OACF,MAAM9L,KAET,GAAG2Q,EAAOsH,GAAG8D,cAAgBpL,EAAOsH,GAAG8D,aAAarmB,OAAQ,CAC3D,IAAIiwB,GAAK,EAKT,GAJG7I,EAAMqB,cAAgBpL,GAAM4K,cAE9BgI,GAAK,GAEHA,EAAI,CAAC,IAAD,iBACUhV,EAAOsH,GAAG8D,cADpB,IACN,IAAI,EAAJ,qBAAwC,CAAC,IAAjC6J,EAAgC,QACpCA,GAAQA,EAAK3J,OAA6B,UAApB2J,EAAK3J,MAAMC,OACnCnJ,GAAMjd,IAAI,yBAA0B8vB,GACpCjV,EAAOsH,GAAGkJ,YAAYyE,KAJlB,kCAYV,GAAGhM,EAAUmD,OAAQ,CACpB,IAAIA,EAASnD,EAAUmD,OAevB,OAdAhK,GAAMjd,IAAI,2CACVid,GAAMuC,MAAMyH,GAETD,EAAMO,QACL1M,EAAOyM,UAAYzM,EAAOyM,WAAaxD,EAAUmD,SAAWpM,EAAO2M,iBAErEvK,GAAMiK,cAAcrM,EAAOyM,UAC3BzM,EAAOyM,SAAW,MAIpBzM,EAAO2M,gBAAiB,EACxBxF,EAAawN,eAAc,QAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,GAG/C,GAAGQ,EAAmBT,IAAUmB,EAAmBnB,GAAQ,CAC1D,IAAI/J,GAAM8S,0BAET,YADAjM,EAAU3hB,MAAM,8BAGjB,IAAI6tB,EAAc,CAAE1C,UAAW,GAAIzE,SAAU,IAC7C7G,EAAawN,eAAc,GAC3B,IAAIS,EAAexI,EAAmBT,GACnCiJ,GAAgBjJ,GAAgC,kBAAhBA,EAAMoI,QACxCa,EAAejJ,EAAMoI,OACtB,IAAIc,EAAe/H,EAAmBnB,GACtC,GAAGkJ,GAAgBlJ,EAAO,CACzB,IAAIyF,GAAqC,IAAxB3I,EAAU2I,UACvBjB,GAAuC,IAAzB1H,EAAU0H,WAG5B,IAFIiB,IAAajB,GAAgBpI,GAAS4D,EAAMqH,QAC/CrH,EAAMqH,MAAQ,SACZrH,EAAMqH,OAAwB,UAAfrH,EAAMqH,OAAoC,UAAfrH,EAAMqH,MAClD,GAA0B,kBAAhBrH,EAAMqH,MACf6B,EAAelJ,EAAMqH,UACf,CACN,IAAI1pB,EAAQ,EACRC,EAAS,EACM,WAAhBoiB,EAAMqH,OAERzpB,EAAS,IACG,IACZD,EAAQ,KACiB,gBAAhBqiB,EAAMqH,OAEfzpB,EAAS,IACG,IACZD,EAAQ,KACiB,UAAhBqiB,EAAMqH,OAAqC,eAAhBrH,EAAMqH,OAA0C,UAAhBrH,EAAMqH,OAE1EzpB,EAAS,IACG,IACZD,EAAQ,MACiB,WAAhBqiB,EAAMqH,OAEfzpB,EAAS,KACG,KACZD,EAAQ,MACiB,UAAhBqiB,EAAMqH,OAEfzpB,EAAS,KACG,KACZD,EAAQ,MACiB,WAAhBqiB,EAAMqH,OAEfzpB,EAAS,IACG,IACZD,EAAQ,KACiB,gBAAhBqiB,EAAMqH,OAEfzpB,EAAS,IACG,IACZD,EAAQ,MAERsY,GAAMjd,IAAI,uCACV4E,EAAS,IACG,IACZD,EAAQ,KAETsY,GAAMjd,IAAI,2BAA4BgnB,EAAMqH,OAC5C6B,EAAe,CACd,OAAU,CAAC,MAAStrB,GACpB,MAAS,CAAC,MAASD,IAEpBsY,GAAMjd,IAAI,2BAA4BkwB,QAEjC,GAAmB,WAAhBlJ,EAAMqH,OAAsC,WAAhBrH,EAAMqH,MAAoB,CAC/D,GAAGjR,UAAUC,cAAgBD,UAAUC,aAAaC,gBA+BnD,OA3BA0S,EAAY3B,MAAQ,GACjBrH,EAAMmJ,uBACRH,EAAY3B,MAAM+B,UAAYpJ,EAAMmJ,sBAElCnJ,EAAMqJ,oBACRL,EAAY3B,MAAMzpB,OAASoiB,EAAMqJ,mBAE/BrJ,EAAMsJ,mBACRN,EAAY3B,MAAM1pB,MAAQqiB,EAAMsJ,kBAEjCN,EAAYZ,MAAQpI,EAAMuJ,yBAC1BnT,UAAUC,aAAaC,gBAAgB0S,GACrCjuB,MAAK,SAASklB,GACdjF,EAAawN,eAAc,GACxB/H,EAAmBT,KAAWA,EAAMqI,UACtCjS,UAAUC,aAAamT,aAAa,CAAEpB,OAAO,EAAMf,OAAO,IACzDtsB,MAAK,SAAU0uB,GACfxJ,EAAOW,SAAS6I,EAAYtJ,iBAAiB,IAC7CJ,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,MAG/CF,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,MAE7C,SAAU9kB,GACZ6f,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAMA,MAMnB,SAASuuB,EAAmBvuB,EAAO8kB,GAClCjF,EAAawN,eAAc,GACxBrtB,EACF2hB,EAAU3hB,MAAMA,GAEhB4kB,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,GAGhD,SAAS0J,EAAeX,EAAaY,EAAaC,GACjD5T,GAAMjd,IAAI,4CACVid,GAAMuC,MAAMwQ,GACZ5S,UAAUC,aAAamT,aAAaR,GAClCjuB,MAAK,SAASklB,GACX4J,EACFzT,UAAUC,aAAamT,aAAa,CAAEpB,OAAO,EAAMf,OAAO,IACzDtsB,MAAK,SAAU0uB,GACfxJ,EAAOW,SAAS6I,EAAYtJ,iBAAiB,IAC7CyJ,EAAY,KAAM3J,MAGnB2J,EAAY,KAAM3J,MAGnB/kB,OAAM,SAASC,GAAS6f,EAAawN,eAAc,GAAQoB,EAAYzuB,MAE1E,GAAkD,WAA/C8a,GAAMuL,cAAcC,eAAeC,QAAsB,CAC3D,IAAIlL,EAAYP,GAAMuL,cAAcC,eAAeE,QAC/CjL,EAAS,GACVxa,OAAOka,UAAUG,UAAUrO,MAAM,WACnCwO,EAAS,IACPF,GAAa,IAAMA,GAAaE,EAelCiT,EAbAX,EAAc,CACb3B,MAAO,CACNf,UAAW,CACVwD,iBAAiB,EACjBC,SAAU7tB,OAAO8tB,OAAOrsB,MACxBgM,UAAWzN,OAAO8tB,OAAOpsB,OACzBqsB,aAAcjK,EAAMmJ,qBACpBe,aAAclK,EAAMmJ,qBACpBgB,kBAAmB,WAGrB/B,MAAO3H,EAAmBT,KAAWA,EAAMqI,WAEhBqB,GAG5BzT,GAAMU,UAAUK,WAAU,SAAU7b,EAAOsc,GAC1C,GAAItc,EAEH,OADA6f,EAAawN,eAAc,GACpB1L,EAAU3hB,MAAMA,IAExB6tB,EAAc,CACbZ,OAAO,EACPf,MAAO,CACNf,UAAW,CACV6D,kBAAmB,UACnBJ,SAAU7tB,OAAO8tB,OAAOrsB,MACxBgM,UAAWzN,OAAO8tB,OAAOpsB,OACzBqsB,aAAcjK,EAAMmJ,qBACpBe,aAAclK,EAAMmJ,sBAErBtH,SAAU,CACT,CAACiI,iBAAiB,GAClB,CAACM,+BAA+B,OAIvB/C,MAAMf,UAAU+D,oBAAsB5S,EAClDkS,EAAeX,EAAaU,EAC3BjJ,EAAmBT,KAAWA,EAAMqI,mBAGjC,GAAkD,YAA/CpS,GAAMuL,cAAcC,eAAeC,QAAuB,CACnE,KAAGzL,GAAMuL,cAAcC,eAAeE,SAAW,IA2B1C,CACN,IAAIxmB,EAAQ,IAAIic,MAAM,2BAItB,OAHAjc,EAAMmB,KAAO,+GACb0e,EAAawN,eAAc,QAC3B1L,EAAU3hB,MAAMA,GAtBhBwuB,EAPAX,EAAc,CACb3B,MAAO,CACNiD,eAAgBtK,EAAMqH,MACtBkD,YAAavK,EAAMqH,OAEpBe,MAAO3H,EAAmBT,KAAWA,EAAMqI,YAEhB,SAAU3T,EAAKuL,GAG1C,GAFAyJ,EAAkBhV,EAAKuL,IAElBvL,EACJ,IAAIjF,EAAWwQ,EAAOuK,YAClBC,EAAQvuB,OAAOwuB,aAAY,WAC1BzK,GACH/jB,OAAOyuB,cAAcF,GACnBxK,EAAOuK,aAAe/a,IACxBvT,OAAOyuB,cAAcF,GAClBxK,EAAOyD,SACTzD,EAAOyD,WAGTjU,EAAWwQ,EAAOuK,cAChB,QAWP,QAIExK,GAAyB,WAAhBA,EAAMqH,OAElBjR,UAAUC,aAAauU,mBAAmB7vB,MAAK,SAAS8vB,GACvD,IAAIC,EAAaD,EAAQE,MAAK,SAASC,GACtC,MAAuB,eAAhBA,EAAO5L,QAEf6L,EAykCJ,SAA6BjL,GAE5B,GADA/J,GAAMuC,MAAM,uBAAwBwH,IAC/BA,EACJ,OAAO,EACR,GAA2B,kBAAhBA,EAAMqH,OAAuD,kBAA1BrH,EAAMqH,MAAMf,UACzD,OAAO,EACR,IAAI0C,EAAchJ,EAAMqH,MAAMf,UAC9B,GAAI0C,EAAYmB,kBACf,MAAyC,YAAlCnB,EAAYmB,mBAAqE,WAAlCnB,EAAYmB,kBAC9D,GAAInB,EAAYsB,eACpB,MAAsC,WAA/BtB,EAAYsB,gBAA8D,WAA/BtB,EAAYsB,eAC1D,GAAItB,EAAYuB,YACpB,MAAmC,WAA5BvB,EAAYuB,aAAwD,WAA5BvB,EAAYuB,YAC5D,OAAO,EAtlCSW,CAAoBlL,IAAU6K,EAAQE,MAAK,SAASC,GAChE,MAAuB,eAAhBA,EAAO5L,QAIXuG,EAAYlF,EAAmBT,GAC/BgG,EAAY7E,EAAmBnB,GAC/BmL,EA2gCR,SAA6BnL,GAE5B,OADA/J,GAAMuC,MAAM,uBAAwBwH,KAChCA,KAEe,IAAhBA,EAAMoI,QAAuC,IAApBpI,EAAM2F,iBAEP3M,IAAxBgH,EAAMoL,eAAuD,OAAxBpL,EAAMoL,gBAEd,IAAxBpL,EAAMoL,gBAnhCWC,CAAoBrL,GACtCsL,EA2iCR,SAA6BtL,GAE5B,OADA/J,GAAMuC,MAAM,uBAAwBwH,KAChCA,KAEe,IAAhBA,EAAMqH,QAAuC,IAApBrH,EAAMgG,iBAEPhN,IAAxBgH,EAAMuL,eAAuD,OAAxBvL,EAAMuL,gBAEd,IAAxBvL,EAAMuL,gBAnjCWC,CAAoBxL,GAC1C,GAAG2F,GAAaK,GAAamF,GAAmBG,EAAiB,CAEhE,IAAIG,IAAkB9F,GAAYmF,EAC9BY,IAAkB1F,GAAYiF,EAClC,IAAIQ,IAAoBC,EAIvB,OAFA1Q,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,4BACT,EACD,IAAIswB,GAAmBN,EAG7B,OAFAnQ,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,2DACT,EACD,IAAIuwB,GAAmBJ,EAG7B,OAFAtQ,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,2DACT,EAIT,IAAIwwB,EAAiB,CACpBvD,SAAQ0C,GAAe9K,EAAMqI,YAAaY,EAC1C5B,SAAQ4D,GAAejL,EAAMsI,YAAaY,GAE3CjT,GAAMuC,MAAM,2BAA4BmT,GACnCA,EAAevD,OAAUuD,EAAetE,MAI5CjR,UAAUC,aAAamT,aAAamC,GAClC5wB,MAAK,SAASklB,GACdjF,EAAawN,eAAc,GAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,MAC5C/kB,OAAM,SAASC,GACjB6f,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,CAAC+gB,KAAM/gB,EAAM+gB,KAAM5f,KAAMnB,EAAMmB,KAAMihB,QAASpiB,EAAMoiB,cATtEvC,EAAawN,eAAc,GAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,OAY/C/kB,OAAM,SAASC,GACf6f,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAMA,WAKlB4kB,EAAYzC,EAAUlB,EAAM4D,EAAOlD,GAIrC,SAAS8O,EAAkBtO,EAAUR,IACpCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQgtB,EAC7E,IAAI/L,EAAOU,EAAUV,KACjBpB,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YAC1B,GAAGkB,EAAM,CACR,IAAIvI,EAAOsH,GAGV,OAFAlF,GAAM6E,KAAK,kGACXgC,EAAU3hB,MAAM,sFAGjB0Y,EAAOsH,GAAGoK,qBAAqBnJ,GAC7BrhB,MAAK,WAIL,GAHAkb,GAAMjd,IAAI,gCACV6a,EAAOuH,UAAYgB,EAAKoB,IAErB3J,EAAO2H,YAAc3H,EAAO2H,WAAW5iB,OAAS,EAAG,CACrD,IAAI,IAAIH,EAAI,EAAGA,EAAGob,EAAO2H,WAAW5iB,OAAQH,IAAK,CAChD,IAAIwiB,EAAYpH,EAAO2H,WAAW/iB,GAClCwd,GAAMuC,MAAM,2BAA4ByC,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BxH,EAAOsH,GAAGG,gBAAgBL,GAH1BpH,EAAOsH,GAAGG,gBAAgBrF,GAAMsF,iBAMlC1H,EAAO2H,WAAa,GAGrBsB,EAAUlF,YACRkF,EAAU3hB,YAEd2hB,EAAU3hB,MAAM,gBA6dlB,SAAS0wB,EAAUvO,EAAUwO,GAC5B,IAAI9Q,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,kBACJ,EAER,IAAImF,EAAS6L,EAAS,SAAW,QAC7BjY,EAASmH,EAAaE,YAK1B,OAJIrH,EAAO2O,OAAOvC,KACjBpM,EAAO2O,OAAOvC,GAAU,CAAE7c,MAAO,KAG/ByQ,EAAOsH,GAAGoH,UAA4D,WAA/CtM,GAAMuL,cAAcC,eAAeC,SACZ,WAA/CzL,GAAMuL,cAAcC,eAAeC,SA4BpCzL,GAAM6E,KAAK,eAAiBmF,EAAS,kCAC9B,GA5BJ6L,IAAWjY,EAAO2P,cACpBvN,GAAM6E,KAAK,6BACJ,GACGgR,GAAWjY,EAAOyM,SAIzBzM,EAAO2O,OAAOvC,GAAQ8L,MAgBnBlY,EAAO2O,OAAOvC,GAAQ7c,OAf5B6S,GAAMjd,IAAI,YAAcinB,EAAS,mBACjCpM,EAAO2O,OAAOvC,GAAQ8L,MAAQrB,aAAY,WACzC7W,EAAOsH,GAAGoH,WACRxnB,MAAK,SAASixB,GACdA,EAAMtH,SAAQ,SAAUlQ,GACnBA,GAAoB,UAAbA,EAAI4K,OAEX0M,IAAWtX,EAAIyX,eAAmBH,GAAuB,iBAAbtX,EAAItb,OAEpD2a,EAAO2O,OAAOvC,GAAQ7c,MAASoR,EAAI0X,WAAa1X,EAAI0X,WAAa,YAGlE,KACI,IAjBPjW,GAAM6E,KAAK,4BACJ,GA2BV,SAASqR,EAAQ7O,EAAU+J,GAC1B,IAAIrM,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,mBACJ,EAER,IAAIjH,EAASmH,EAAaE,YAC1B,OAAIrH,EAAOsH,GAIPtH,EAAOyM,SAIR+G,EAEExT,EAAOyM,SAASF,kBAAgE,IAA5CvM,EAAOyM,SAASF,iBAAiBxnB,QAIjEib,EAAOyM,SAASF,iBAAiB,GAAGgM,SAH3CnW,GAAM6E,KAAK,mBACJ,GAKJjH,EAAOyM,SAASH,kBAAgE,IAA5CtM,EAAOyM,SAASH,iBAAiBvnB,QAIjEib,EAAOyM,SAASH,iBAAiB,GAAGiM,SAH3CnW,GAAM6E,KAAK,mBACJ,IAdR7E,GAAM6E,KAAK,8BACJ,IALP7E,GAAM6E,KAAK,2BACJ,GAuBT,SAASuR,EAAK/O,EAAU+J,EAAOgF,GAC9B,IAAIrR,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,mBACJ,EAER,IAAIjH,EAASmH,EAAaE,YAC1B,OAAIrH,EAAOsH,GAIPtH,EAAOyM,SAIR+G,EAEExT,EAAOyM,SAASF,kBAAgE,IAA5CvM,EAAOyM,SAASF,iBAAiBxnB,QAIzEib,EAAOyM,SAASF,iBAAiB,GAAGgM,SAAWC,GACxC,IAJNpW,GAAM6E,KAAK,mBACJ,GAMJjH,EAAOyM,SAASH,kBAAgE,IAA5CtM,EAAOyM,SAASH,iBAAiBvnB,QAIzEib,EAAOyM,SAASH,iBAAiB,GAAGiM,SAAWC,GACxC,IAJNpW,GAAM6E,KAAK,mBACJ,IAfR7E,GAAM6E,KAAK,8BACJ,IALP7E,GAAM6E,KAAK,2BACJ,GAyBT,SAASwR,EAAWhP,GACnB,IAAItC,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,kBACJ,iBAER,IAAIjH,EAASmH,EAAaE,YAC1B,OAAIrH,EAAOsH,GAGRtH,EAAOsH,GAAGoH,SACR1O,EAAO4O,QAAQsJ,MA8CZlY,EAAO4O,QAAQrf,OA7CrB6S,GAAMjd,IAAI,yCACV6a,EAAO4O,QAAQsJ,MAAQrB,aAAY,WAClC7W,EAAOsH,GAAGoH,WACRxnB,MAAK,SAASixB,GACdA,EAAMtH,SAAQ,SAAUlQ,GACvB,GAAIA,EAAJ,CAEA,IAAI+X,GAAU,EAYd,IAVsB,UAAlB/X,EAAIgY,WAAyBhY,EAAIlZ,GAAGmxB,cAAcxf,QAAQ,UAAY,IAC3D,gBAAbuH,EAAItb,MAA0Bsb,EAAIlZ,GAAG2R,QAAQ,QAAU,EAExDsf,GAAU,EACW,QAAZ/X,EAAItb,OAAkBsb,EAAIkY,eACX,QAAtBlY,EAAImY,eAAiD,KAAtBnY,EAAImY,gBAErCJ,GAAU,GAGRA,EAGF,GAFA1Y,EAAO4O,QAAQmK,MAAQpY,EAAIkY,cAC3B7Y,EAAO4O,QAAQoK,MAAQrY,EAAIsY,UACI,OAA5BjZ,EAAO4O,QAAQsK,UAAiD,OAA5BlZ,EAAO4O,QAAQuK,SAErDnZ,EAAO4O,QAAQsK,SAAWlZ,EAAO4O,QAAQmK,MACzC/Y,EAAO4O,QAAQuK,SAAWnZ,EAAO4O,QAAQoK,UACnC,CAEN,IAAII,EAAapZ,EAAO4O,QAAQoK,MAAQhZ,EAAO4O,QAAQuK,SACL,WAA/C/W,GAAMuL,cAAcC,eAAeC,UACrCuL,GAAwB,KACzB,IAAIC,EAAUjZ,KAAKC,MAAyD,GAAlDL,EAAO4O,QAAQmK,MAAQ/Y,EAAO4O,QAAQsK,UAAgBE,GAC9B,WAA/ChX,GAAMuL,cAAcC,eAAeC,UACrCwL,EAAUzW,SAASyW,EAAQ,MAC5BrZ,EAAO4O,QAAQrf,MAAQ8pB,EAAU,aAEjCrZ,EAAO4O,QAAQsK,SAAWlZ,EAAO4O,QAAQmK,MACzC/Y,EAAO4O,QAAQuK,SAAWnZ,EAAO4O,QAAQoK,gBAK5C,KACI,gBAIR5W,GAAM6E,KAAK,oDACJ,kCApDA,yBAwDT,SAASqN,EAAYhtB,GACpB8a,GAAM9a,MAAM,gBAAiBA,GAG9B,SAAS2kB,EAAcxC,EAAU6P,GAChClX,GAAMjd,IAAI,yBACV,IAAIgiB,EAAehB,EAAcsD,GACjC,GAAItC,EAAJ,CAIA,IAAInH,EAASmH,EAAaE,YAC1B,GAAGrH,EAAQ,CACV,IAAqB,IAAlBsZ,EAAwB,CAE1B,IAAI1Q,EAAU,CAAE,MAAS,SAAU,YAAexG,GAAMyG,aAAa,KAClE1B,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACxBlD,GAAMuC,MAAM,kCAAoC8E,EAAW,MAC3DrH,GAAMuC,MAAMiE,GACTxE,GACFwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,EACvBpF,EAAGxJ,KAAKiO,KAAKC,UAAUH,KAEvBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,IAKT5I,EAAO2P,aAAe,KACnB3P,EAAO2O,SACN3O,EAAO2O,OAAP,OAA0B3O,EAAO2O,OAAP,MAAuBuJ,OACnDpB,cAAc9W,EAAO2O,OAAP,MAAuBuJ,OACnClY,EAAO2O,OAAP,QAA2B3O,EAAO2O,OAAP,OAAwBuJ,OACrDpB,cAAc9W,EAAO2O,OAAP,OAAwBuJ,QAExClY,EAAO2O,OAAS,GACb3O,EAAO4O,QAAQsJ,OACjBpB,cAAc9W,EAAO4O,QAAQsJ,OAC9BlY,EAAO4O,QAAQsJ,MAAQ,KACvBlY,EAAO4O,QAAQmK,MAAQ,KACvB/Y,EAAO4O,QAAQsK,SAAW,KAC1BlZ,EAAO4O,QAAQoK,MAAQ,KACvBhZ,EAAO4O,QAAQuK,SAAW,KAC1BnZ,EAAO4O,QAAQrf,MAAQ,MACnByQ,EAAO2M,gBAAkB3M,EAAOyM,WACnCrK,GAAMjd,IAAI,gCACVid,GAAMiK,cAAcrM,EAAOyM,WAE5BzM,EAAO2M,gBAAiB,EACxB3M,EAAOyM,SAAW,KAElB,IACCzM,EAAOsH,GAAGmB,QACT,MAAMpZ,IAGR2Q,EAAOsH,GAAK,KACZtH,EAAO2H,WAAa,KACpB3H,EAAOmP,MAAQ,KACfnP,EAAOuH,UAAY,KACnBvH,EAAOkP,SAAU,EACjBlP,EAAOwK,YAAc,GACrBxK,EAAOkL,WAAa,KACpBlL,EAAOuO,iBAAmB,KAC1BvO,EAAOwO,mBAAqB,KAE7BrH,EAAaoS,aA6Md,SAAS3M,EAAmBT,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMoI,aAEcpP,IAApBgH,EAAM2F,WAA+C,OAApB3F,EAAM2F,YAEd,IAApB3F,EAAM2F,WAcf,SAASE,EAAmB7F,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMoI,aAEcpP,IAApBgH,EAAM4F,WAA+C,OAApB5F,EAAM4F,YAEd,IAApB5F,EAAM4F,WAGf,SAASzE,EAAmBnB,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMqH,aAEcrO,IAApBgH,EAAMgG,WAA+C,OAApBhG,EAAMgG,YAEd,IAApBhG,EAAMgG,WAcf,SAASE,EAAmBlG,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMqH,aAEcrO,IAApBgH,EAAMiG,WAA+C,OAApBjG,EAAMiG,YAEd,IAApBjG,EAAMiG,WAv/FfpJ,EAAclF,GAGdnf,KAAK60B,UAAY,WAAa,OAAOrzB,GACrCxB,KAAK80B,YAAc,WAAa,OAAOxT,GACvCthB,KAAKsV,UAAY,SAASgP,IACzBA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAS,WAAgB,EACzBD,EAAcC,IAEftkB,KAAK+0B,aAAe,WAAa,OAAOxT,GACxCvhB,KAAKg1B,QAAU,SAAS1Q,IAsaxB,SAAiBA,GAMhB,IALAA,EAAYA,GAAa,IAEflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF5B,GAAMjd,IAAI,mCACN8gB,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAIjB,IAAI6gB,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,OAAQ,YAAeT,GAC7C3hB,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,GACxB,GAAGlB,EAUF,OATAkC,EAAa6B,GAAe,SAASvX,GACpCwR,GAAMjd,IAAI,gBACVid,GAAMuC,MAAM/T,GACS,gBAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAElEukB,EAAUlF,QAAQnT,SAEnByT,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAQ,CACzBygB,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMjd,IAAI,gBACVid,GAAMuC,MAAM/T,GACS,gBAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAElEukB,EAAUlF,QAAQnT,IAEnBtJ,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GACX,KAAhBA,EACFiC,EAAU3hB,MAAMyf,EAAa,yBAE7BkC,EAAU3hB,MAAMyf,EAAa,KAAOC,MArdH2S,CAAQ1Q,IAC7CtkB,KAAKi1B,QAAU,SAAS3Q,IA0dxB,SAAwBA,IACvBA,EAAYA,GAAa,IAEflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAI6V,GAA+B,IAArB5Q,EAAU4Q,OACpBC,GAAkB,OACW3U,IAA9B8D,EAAU6Q,iBAA+D,OAA9B7Q,EAAU6Q,kBACvDA,GAAiD,IAA9B7Q,EAAU6Q,iBAC9B,IAAIC,GAA+C,IAA7B9Q,EAAU8Q,eAEhC,GADA3X,GAAMjd,IAAI,sBAAwB+gB,EAAY,YAAc2T,EAAS,MACjE3T,EAKH,OAJA9D,GAAM6E,KAAK,yBACXgC,EAAUlF,eACP+V,GACFhW,EAAiBG,aAGnB,GAAG8V,EACF,IAAI,IAAItQ,KAAYtD,EACnB4F,EAActC,EAAU,CAAEuC,WAAW,IAEvC,IAAI/F,EAIH,OAHA7D,GAAM6E,KAAK,yCACXf,EAAY,UACZ+C,EAAUlF,UAIX,IAAI6E,EAAU,CAAE,MAAS,UAAW,YAAexG,GAAMyG,aAAa,KACnEriB,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,GACxB,GAAGuU,EAgBF,OAbGzV,GACFC,EAAG+E,QAAU,KACb/E,EAAGoE,QACHpE,EAAK,MAEL9B,UAAUyX,WAAW7zB,EAAS,IAAM+f,EAAW4C,KAAKC,UAAUH,IAE/DxG,GAAMjd,IAAI,sBACV+gB,EAAY,KACZD,GAAY,EACZgD,EAAUlF,eACP+V,GACFhW,EAAiBG,aAGnB,GAAGG,EAAY,CACdwE,EAAO,WAAiB1C,EAExB,IAAI+T,EAAkB,WACrB,IAAI,IAAI5Q,KAAa/E,EACpBD,EAAG9H,oBAAoB8M,EAAW/E,EAAW+E,IAE9ChF,EAAG9H,oBAAoB,UAAW2d,GAClC7V,EAAG9H,oBAAoB,QAAS4d,GAC7B5V,GACFV,aAAaU,GAEdF,EAAGoE,SAGAyR,EAAkB,SAAS5tB,GAC9B,IAAIxH,EAAOgkB,KAAK1T,MAAM9I,EAAMxH,MACzBA,EAAKs1B,YAAcxR,EAAQwR,YAAct1B,EAAKqjB,aAAeS,EAAQT,cACvE8R,IACAhR,EAAUlF,UACP+V,GACFhW,EAAiBG,cAGhBkW,EAAgB,SAAS7tB,GAC5B2tB,IACAhR,EAAU3hB,MAAM,qDACbwyB,GACFhW,EAAiBG,aAYnB,OATAI,EAAG/H,iBAAiB,UAAW4d,GAC/B7V,EAAG/H,iBAAiB,QAAS6d,QAEP,IAAlB9V,EAAGoG,WACNpG,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAEvBuR,KAKF/X,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAW,CAC3CU,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMjd,IAAI,sBACVid,GAAMuC,MAAM/T,GACZsV,EAAY,KACZD,GAAY,EACS,YAAlBrV,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAElEukB,EAAUlF,UACP+V,GACFhW,EAAiBG,aAEnB3c,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GAE9Bd,EAAY,KACZD,GAAY,EACZgD,EAAUlF,UACP+V,GACFhW,EAAiBG,eA/kBgBoW,CAAepR,IACpDtkB,KAAK21B,OAAS,SAASrR,IAolBvB,SAAsBA,GAgBrB,IAfAA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAU0L,cAAmD,mBAA3B1L,EAAU0L,cAA+B1L,EAAU0L,cAAgBvS,GAAM4B,KAC3GiF,EAAU8F,SAAyC,mBAAtB9F,EAAU8F,SAA0B9F,EAAU8F,SAAW3M,GAAM4B,KAC5FiF,EAAUhB,WAA6C,mBAAxBgB,EAAUhB,WAA4BgB,EAAUhB,WAAa7F,GAAM4B,KAClGiF,EAAUrB,YAA+C,mBAAzBqB,EAAUrB,YAA6BqB,EAAUrB,YAAcxF,GAAM4B,KACrGiF,EAAUf,SAAyC,mBAAtBe,EAAUf,SAA0Be,EAAUf,SAAW9F,GAAM4B,KAC5FiF,EAAUT,UAA2C,mBAAvBS,EAAUT,UAA2BS,EAAUT,UAAYpG,GAAM4B,KAC/FiF,EAAUwI,cAAmD,mBAA3BxI,EAAUwI,cAA+BxI,EAAUwI,cAAgBrP,GAAM4B,KAC3GiF,EAAU2G,eAAqD,mBAA5B3G,EAAU2G,eAAgC3G,EAAU2G,eAAiBxN,GAAM4B,KAC9GiF,EAAU4B,OAAqC,mBAApB5B,EAAU4B,OAAwB5B,EAAU4B,OAASzI,GAAM4B,KACtFiF,EAAUyB,WAA6C,mBAAxBzB,EAAUyB,WAA4BzB,EAAUyB,WAAatI,GAAM4B,KAClGiF,EAAUsQ,UAA2C,mBAAvBtQ,EAAUsQ,UAA2BtQ,EAAUsQ,UAAYnX,GAAM4B,KAC/FiF,EAAUlB,WAA6C,mBAAxBkB,EAAUlB,WAA4BkB,EAAUlB,WAAa3F,GAAM4B,MAC9FiC,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAGjB,IAAIizB,EAAStR,EAAUsR,OACvB,IAAIA,EAGH,OAFAnY,GAAM9a,MAAM,uBACZ2hB,EAAU3hB,MAAM,kBAGjB,IAAIkzB,EAAWvR,EAAUuR,SACrBC,EAAcxR,EAAUziB,MAAQyiB,EAAUziB,MAAQA,EAClD2hB,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,SAAU,OAAU2R,EAAQ,UAAaC,EAAU,YAAerS,GACxFsS,IACF7R,EAAO,MAAY6R,GACjBnV,IACFsD,EAAO,UAAgBtD,GACxB,GAAGlB,EAgFF,OA/EAkC,EAAa6B,GAAe,SAASvX,GAEpC,GADAwR,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAGN,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAGtE,IAAI+kB,EAAW7Y,EAAK9L,KAAL,GACfsd,GAAMjd,IAAI,mBAAqBskB,GAC/B,IAAItC,EACH,CACCuT,QAAUtU,EACVmU,OAASA,EACT9yB,GAAKgiB,EACLjjB,MAAQi0B,EACR3S,UAAW,EACXT,YAAc,CACbsT,SAAU,EACVlO,SAAW,KACXE,gBAAiB,EACjBgD,aAAe,KACfR,MAAQ,KACR0C,iBAAmB,KACnBvK,GAAK,KACLkD,YAAc,GACdU,WAAa,KACb2D,SAAU,EACVK,SAAU,EACVP,OAAS,CACRpf,MAAQ,KACR2oB,MAAQ,MAETtJ,QAAU,CACTrf,MAAQ,KACRwpB,MAAQ,KACRG,SAAW,KACXF,MAAQ,KACRG,SAAW,KACXjB,MAAQ,OAGV0C,MAAQ,WAAa,OAAOnR,GAC5BoR,UAAY,WAAa,OAAON,GAChCvC,UAAY,WAAa,OAAOA,EAAUvO,GAAU,IACpDqR,gBAAkB,WAAa,OAAO9C,EAAUvO,GAAU,IAC1DsR,eAAiB,WAAa,OAAO/C,EAAUvO,GAAU,IACzDuR,aAAe,WAAa,OAAO1C,EAAQ7O,GAAU,IACrDwR,UAAY,WAAa,OAAOzC,EAAK/O,GAAU,GAAO,IACtDyR,YAAc,WAAa,OAAO1C,EAAK/O,GAAU,GAAO,IACxD0R,aAAe,WAAa,OAAO7C,EAAQ7O,GAAU,IACrD2R,UAAY,WAAa,OAAO5C,EAAK/O,GAAU,GAAM,IACrD4R,YAAc,WAAa,OAAO7C,EAAK/O,GAAU,GAAM,IACvDgP,WAAa,WAAa,OAAOA,EAAWhP,IAC5C5O,KAAO,SAASoO,GAAaO,EAAYC,EAAUR,IACnDnkB,KAAO,SAASmkB,GAAa6B,EAASrB,EAAUR,IAChDuC,KAAO,SAASvC,GAAagC,EAASxB,EAAUR,IAChD0L,cAAgB1L,EAAU0L,cAC1B5F,SAAW9F,EAAU8F,SACrB9G,WAAagB,EAAUhB,WACvBL,YAAcqB,EAAUrB,YACxBM,SAAWe,EAAUf,SACrBM,UAAYS,EAAUT,UACtB6K,YAAc,SAASpK,GAAaoL,EAAc5K,GAAU,EAAMR,IAClEgK,aAAe,SAAShK,GAAaoL,EAAc5K,GAAU,EAAOR,IACpEqS,iBAAmB,SAASrS,GAAa8O,EAAkBtO,EAAUR,IACrEwI,cAAgBxI,EAAUwI,cAC1B7B,eAAiB3G,EAAU2G,eAC3B/E,OAAS5B,EAAU4B,OACnBH,WAAazB,EAAUyB,WACvB6O,UAAYtQ,EAAUsQ,UACtBxR,WAAakB,EAAUlB,WACvBF,OAAS,SAAS0T,GAAetP,EAAcxC,GAA0B,IAAhB8R,IACzDvT,OAAS,SAASiB,GAAa8C,EAActC,EAAUR,KAEzD9C,EAAcsD,GAAYtC,EAC1B8B,EAAUlF,QAAQoD,IAEnByB,EAAO,WAAiB1C,OACxB7B,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAW,CAC3CU,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GAEjB,GADAwR,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAGN,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAGtE,IAAI+kB,EAAW7Y,EAAK9L,KAAL,GACfsd,GAAMjd,IAAI,mBAAqBskB,GAC/B,IAAItC,EACH,CACCuT,QAAUtU,EACVmU,OAASA,EACT9yB,GAAKgiB,EACLjjB,MAAQi0B,EACR3S,UAAW,EACXT,YAAc,CACbsT,SAAU,EACVlO,SAAW,KACXE,gBAAiB,EACjBgD,aAAe,KACfR,MAAQ,KACR0C,iBAAmB,KACnBvK,GAAK,KACLkD,YAAc,GACdU,WAAa,KACb2D,SAAU,EACVK,SAAU,EACVP,OAAS,CACRpf,MAAQ,KACR2oB,MAAQ,MAETtJ,QAAU,CACTrf,MAAQ,KACRwpB,MAAQ,KACRG,SAAW,KACXF,MAAQ,KACRG,SAAW,KACXjB,MAAQ,OAGV0C,MAAQ,WAAa,OAAOnR,GAC5BoR,UAAY,WAAa,OAAON,GAChCvC,UAAY,WAAa,OAAOA,EAAUvO,GAAU,IACpDqR,gBAAkB,WAAa,OAAO9C,EAAUvO,GAAU,IAC1DsR,eAAiB,WAAa,OAAO/C,EAAUvO,GAAU,IACzDuR,aAAe,WAAa,OAAO1C,EAAQ7O,GAAU,IACrDwR,UAAY,WAAa,OAAOzC,EAAK/O,GAAU,GAAO,IACtDyR,YAAc,WAAa,OAAO1C,EAAK/O,GAAU,GAAO,IACxD0R,aAAe,WAAa,OAAO7C,EAAQ7O,GAAU,IACrD2R,UAAY,WAAa,OAAO5C,EAAK/O,GAAU,GAAM,IACrD4R,YAAc,WAAa,OAAO7C,EAAK/O,GAAU,GAAM,IACvDgP,WAAa,WAAa,OAAOA,EAAWhP,IAC5C5O,KAAO,SAASoO,GAAaO,EAAYC,EAAUR,IACnDnkB,KAAO,SAASmkB,GAAa6B,EAASrB,EAAUR,IAChDuC,KAAO,SAASvC,GAAagC,EAASxB,EAAUR,IAChD0L,cAAgB1L,EAAU0L,cAC1B5F,SAAW9F,EAAU8F,SACrB9G,WAAagB,EAAUhB,WACvBL,YAAcqB,EAAUrB,YACxBM,SAAWe,EAAUf,SACrBM,UAAYS,EAAUT,UACtB6K,YAAc,SAASpK,GAAaoL,EAAc5K,GAAU,EAAMR,IAClEgK,aAAe,SAAShK,GAAaoL,EAAc5K,GAAU,EAAOR,IACpEqS,iBAAmB,SAASrS,GAAa8O,EAAkBtO,EAAUR,IACrEwI,cAAgBxI,EAAUwI,cAC1B7B,eAAiB3G,EAAU2G,eAC3B/E,OAAS5B,EAAU4B,OACnBH,WAAazB,EAAUyB,WACvB6O,UAAYtQ,EAAUsQ,UACtBxR,WAAakB,EAAUlB,WACvBF,OAAS,SAAS0T,GAAetP,EAAcxC,GAA0B,IAAhB8R,IACzDvT,OAAS,SAASiB,GAAa8C,EAActC,EAAUR,KAEzD9C,EAAcsD,GAAYtC,EAC1B8B,EAAUlF,QAAQoD,IAEnB7f,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GACX,KAAhBA,EACFiC,EAAU3hB,MAAMyf,EAAa,yBAE7BkC,EAAU3hB,MAAMyf,EAAa,KAAOC,MA/xBJwU,CAAavS,IA/clD7G,GAAMqZ,uBAAyB,SAAUC,GACxC,IAAIC,EAAKD,GAAQA,EAAKhrB,OAAUA,MAC5BkrB,EAAKF,GAAQA,EAAKna,SAAYA,QAC9Bsa,EAAaH,GAAQA,EAAKI,WAAcA,UAE5C,MAAO,CACNxS,aAAc,SAASnjB,EAAQ41B,GAAS,OAAO,IAAIF,EAAU11B,EAAQ41B,IACrEjZ,UAAY4Y,GAAQA,EAAK5Y,WAAcE,GACvC0B,QAAS,SAASsX,GAAO,OAAOC,MAAMvX,QAAQsX,IAC9CrO,cAAgB+N,GAAQA,EAAKQ,SAAYA,KACzCvV,YAAa,SAASjK,EAAK3N,GAC1B,IAAIotB,EAAe,CAClBC,OAAQrtB,EAAQ6X,KAChB3f,QAAS,CACR,OAAU,qCAEXuc,MAAO,YAEY,SAAjBzU,EAAQ6X,OACVuV,EAAal1B,QAAQ,gBAAkB,yBAETke,IAA5BpW,EAAQmW,kBACViX,EAAaE,aAA0C,IAA5BttB,EAAQmW,gBAA2B,UAAanW,EAAQmW,gBAAkBnW,EAAQmW,gBAAkB,QAE7HnW,EAAQwa,OACV4S,EAAa5S,KAAOT,KAAKC,UAAUha,EAAQwa,OAG5C,IAAI+S,EAAWX,EAAEjf,EAAKyf,GAAc90B,OAAM,SAASC,GAClD,OAAOs0B,EAAEna,OAAO,CAACiI,QAAS,gDAAiDpiB,MAAOA,OAQnF,GAAGyH,EAAQ+X,QAAS,CACnB,IAAIA,EAAU,IAAI8U,GAAE,SAASpa,EAASC,GACrC,IAAI8a,EAAUjZ,YAAW,WAExB,OADAO,aAAa0Y,GACN9a,EAAO,CAACiI,QAAS,oBAAqB5C,QAAS/X,EAAQ+X,YAC5D/X,EAAQ+X,YAEZwV,EAAWV,EAAEY,KAAK,CAACF,EAAUxV,IAsB9B,OAnBAwV,EAASp1B,MAAK,SAASC,GACtB,OAAGA,EAASs1B,UACD1tB,EAAQgV,iBAAoB3B,GAAM4B,KACpC7c,EAASyJ,OAAO1J,MAAK,SAASqT,GACpCxL,EAAQgV,QAAQxJ,MACdlT,OAAM,SAASC,GACjB,OAAOs0B,EAAEna,OAAO,CAACiI,QAAS,gCAAiCpiB,MAAOA,EAAOH,SAAUA,YAJrF,EASOy0B,EAAEna,OAAO,CAACiI,QAAS,kBAAmBviB,SAAUA,OAEtDE,OAAM,SAASC,UACPyH,EAAQzH,eAAkB8a,GAAM4B,MACzCjV,EAAQzH,MAAMA,EAAMoiB,SAAW,uBAAwBpiB,MAIlDg1B,KAKVla,GAAMsa,mBAAqB,SAAUhB,GACpC,IAAIiB,EAAMjB,GAAQA,EAAKkB,QAAWA,IAC9Bf,EAAaH,GAAQA,EAAKI,WAAcA,UAC5C,MAAO,CACNxS,aAAc,SAASnjB,EAAQ41B,GAAS,OAAO,IAAIF,EAAU11B,EAAQ41B,IACrErX,QAAS,SAASsX,GAAO,OAAOW,EAAGjY,QAAQsX,IAC3ClZ,UAAY4Y,GAAQA,EAAK5Y,WAAcE,GACvC2K,cAAgB+N,GAAQA,EAAKQ,SAAYA,KACzCvV,YAAa,SAASjK,EAAK3N,GAC1B,IAAI8tB,OAA2B1X,IAAjBpW,EAAQwa,KAAqB,CAC1CuT,YAAa,mBACbh4B,KAAMgkB,KAAKC,UAAUha,EAAQwa,OAC1B,GACA8S,OAA0ClX,IAA5BpW,EAAQmW,gBAAgC,CAAC6X,UAAW,CAAC7X,gBAAiBnW,EAAQmW,kBAAoB,GAEpH,OAAOyX,EAAGK,KAAKL,EAAGM,OAAOJ,EAASR,EAAa,CAC9C3f,IAAKA,EACLrX,KAAM0J,EAAQ6X,KACdpD,OAAO,EACP0Z,SAAU,OACVC,MAAOpuB,EAAQouB,MACfrW,QAAS/X,EAAQ+X,QACjB/C,QAAS,SAASnX,UACPmC,EAAQgV,iBAAoB3B,GAAM4B,MAC3CjV,EAAQgV,QAAQnX,IAGlBtF,MAAO,SAAS81B,EAAKC,EAAQxc,UAClB9R,EAAQzH,eAAkB8a,GAAM4B,MACzCjV,EAAQzH,MAAM+1B,EAAQxc,UAQ5BuB,GAAM4B,KAAO,aAEb5B,GAAM4I,qBAAuB,mBAI7B5I,GAAMsF,gBAAkB,KAGxBtF,GAAMiK,cAAgB,SAASD,GAC9B,IAEC,IAFG,EAECkR,EAASlR,EAAOwE,YAFjB,eAGY0M,GAHZ,IAGH,IAAI,EAAJ,qBAAuB,CAAC,IAAhBC,EAAe,QACtBnb,GAAMjd,IAAIo4B,GACPA,GACFA,EAAIpiB,QANH,+BASF,MAAM9L,MAMT+S,GAAMsB,KAAO,SAAS3U,GAGrB,IAFAA,EAAUA,GAAW,IACbqU,SAAuC,mBAApBrU,EAAQqU,SAA0BrU,EAAQqU,SAAWhB,GAAM4B,KACnF5B,GAAM8B,SAERnV,EAAQqU,eACF,CAWN,GAVqB,oBAAXle,SAAgD,oBAAfA,QAAQC,MAClDD,QAAU,CAAEC,IAAK,eAGlBid,GAAMob,MAAQpb,GAAM4B,KACpB5B,GAAMuC,MAAQvC,GAAM4B,KACpB5B,GAAMsG,OAAStG,GAAM4B,KACrB5B,GAAMjd,IAAMid,GAAM4B,KAClB5B,GAAM6E,KAAO7E,GAAM4B,KACnB5B,GAAM9a,MAAQ8a,GAAM4B,MACC,IAAlBjV,EAAQ4V,OAAoC,QAAlB5V,EAAQ4V,MAEpCvC,GAAMob,MAAQt4B,QAAQs4B,MAAMv3B,KAAKf,SACjCkd,GAAMuC,MAAQzf,QAAQyf,MAAM1e,KAAKf,SACjCkd,GAAMsG,OAASxjB,QAAQyf,MAAM1e,KAAKf,SAClCkd,GAAMjd,IAAMD,QAAQC,IAAIc,KAAKf,SAC7Bkd,GAAM6E,KAAO/hB,QAAQ+hB,KAAKhhB,KAAKf,SAC/Bkd,GAAM9a,MAAQpC,QAAQoC,MAAMrB,KAAKf,cAC3B,GAAG+2B,MAAMvX,QAAQ3V,EAAQ4V,OAAQ,CAAC,IAAD,iBAC1B5V,EAAQ4V,OADkB,IACvC,IAAI,EAAJ,qBAA4B,CAAC,IAArBra,EAAoB,QAC3B,OAAOA,GACN,IAAK,QACJ8X,GAAMob,MAAQt4B,QAAQs4B,MAAMv3B,KAAKf,SACjC,MACD,IAAK,QACJkd,GAAMuC,MAAQzf,QAAQyf,MAAM1e,KAAKf,SACjC,MACD,IAAK,SACJkd,GAAMsG,OAASxjB,QAAQyf,MAAM1e,KAAKf,SAClC,MACD,IAAK,MACJkd,GAAMjd,IAAMD,QAAQC,IAAIc,KAAKf,SAC7B,MACD,IAAK,OACJkd,GAAM6E,KAAO/hB,QAAQ+hB,KAAKhhB,KAAKf,SAC/B,MACD,IAAK,QACJkd,GAAM9a,MAAQpC,QAAQoC,MAAMrB,KAAKf,SACjC,MACD,QACCA,QAAQoC,MAAM,6BAA+BgD,EAAI,sEAtBb,+BA2BxC8X,GAAMjd,IAAI,wBAEV,IAAIs4B,EAAmB1uB,EAAQ2uB,cAAgBtb,GAAMqZ,yBACrDrZ,GAAMsC,QAAU+Y,EAAiB/Y,QACjCtC,GAAMuL,cAAgB8P,EAAiB9P,cACvCvL,GAAMuE,YAAc8W,EAAiB9W,YACrCvE,GAAMkH,aAAemU,EAAiBnU,aACtClH,GAAMU,UAAY2a,EAAiB3a,UACnCV,GAAMU,UAAUY,OAGhBtB,GAAMub,YAAc,SAASva,EAAUpD,GACtCoD,EAA+B,mBAAZA,EAA0BA,EAAWhB,GAAM4B,KAChD,MAAVhE,IAAgBA,EAAS,CAAEuU,OAAO,EAAMf,OAAO,IAChDpR,GAAM8S,0BACR3S,UAAUC,aAAamT,aAAa3V,GACnC9Y,MAAK,SAASklB,GACd7J,UAAUC,aAAauU,mBAAmB7vB,MAAK,SAAS8vB,GACvD5U,GAAMuC,MAAMqS,GACZ5T,EAAS4T,GAET5U,GAAMiK,cAAcD,SAGrB/kB,OAAM,SAASwZ,GACfuB,GAAM9a,MAAMuZ,GACZuC,EAAS,QAGVhB,GAAM6E,KAAK,sCACX7D,EAAS,MAIXhB,GAAMwb,kBAAoB,SAASC,EAASzR,GAC3C,IACCyR,EAAQC,UAAY1R,EACnB,MAAO/c,GACR,IACCwuB,EAAQlwB,IAAMowB,IAAIC,gBAAgB5R,GACjC,MAAO/c,GACR+S,GAAM9a,MAAM,wCAIf8a,GAAM6b,oBAAsB,SAASC,EAAIC,GACxC,IACCD,EAAGJ,UAAYK,EAAKL,UACnB,MAAOzuB,GACR,IACC6uB,EAAGvwB,IAAMwwB,EAAKxwB,IACb,MAAO0B,GACR+S,GAAM9a,MAAM,0CAOf,IACI+hB,EADM,CAAC,OAAQ,SAAU,QAAQjQ,QAAQmJ,UAAU6b,WAAa,EAC9C,WAAa,eAC/BC,EAASh2B,OAAO,KAAOghB,GAe3B,GAdAhhB,OAAOiU,iBAAiB+M,GAAW,SAAS/c,GAE3C,IAAI,IAAIkJ,KADR4M,GAAMjd,IAAI,kBACGid,GAAMC,SACfD,GAAMC,SAAS7M,IAAM4M,GAAMC,SAAS7M,GAAG+P,kBACzCnD,GAAMjd,IAAI,sBAAwBqQ,GAClC4M,GAAMC,SAAS7M,GAAGokB,QAAQ,CAACC,QAAQ,EAAMC,iBAAiB,KAGzDuE,GAA2B,mBAAVA,GACnBA,OAIFjc,GAAMkc,WAAY,EACgC,WAA/Clc,GAAMuL,cAAcC,eAAeC,SACpCzL,GAAMuL,cAAcC,eAAeE,SAAW,IAE/C,GAAGI,cAAgBA,aAAaqQ,iBAAmBrQ,aAAaqQ,gBAAgB,UAC9ErQ,aAAaqQ,gBAAgB,SAASC,QAAUtQ,aAAaqQ,gBAAgB,SAASC,OAAOz5B,OAAQ,CAAC,IAAD,iBACrFmpB,aAAaqQ,gBAAgB,SAASC,QAD+C,IACtG,IAAI,EAAJ,qBAA+D,CAAC,IAAxDC,EAAuD,QAC9D,GAAGA,GAASA,EAAMC,UAA6C,cAAjCD,EAAMC,SAAS9F,cAA+B,CAC3ExW,GAAMkc,WAAY,EAClB,QAJoG,8BAOnGlc,GAAMkc,UACRlc,GAAMjd,IAAI,uCAEVid,GAAM6E,KAAK,kLAGN,CAGN,IAAI0X,EAAS,IAAIlQ,kBAAkB,IACnCkQ,EAAOtL,YAAY,CAACb,qBAAqB,IAAOtrB,MAAK,SAASosB,GAC7DlR,GAAMkc,WAA0C,IAA9BhL,EAAM3J,IAAIvQ,QAAQ,OACjCgJ,GAAMkc,UACRlc,GAAMjd,IAAI,uCAEVid,GAAM6E,KAAK,8KAGZ0X,EAAOlW,QACPkW,EAAS,QAOZ,GADAvc,GAAM4K,aAAc,EAC8B,YAA/C5K,GAAMuL,cAAcC,eAAeC,SACpCzL,GAAMuL,cAAcC,eAAeE,SAAW,GAE/C1L,GAAM4K,aAAc,OACd,GAAkD,WAA/C5K,GAAMuL,cAAcC,eAAeC,SAC3CzL,GAAMuL,cAAcC,eAAeE,SAAW,GAE/C1L,GAAM4K,aAAc,OACd,GAAI3kB,OAAO8Z,mBAAuB,qBAAsBA,GAAkBgM,UAI1E,CAEN,IAAIyQ,EAAS,IAAInQ,kBACjB,IACCmQ,EAAO7N,eAAe,SACtB3O,GAAM4K,aAAc,EACnB,MAAO3d,IACTuvB,EAAOnW,aARPrG,GAAM4K,aAAc,EAUrB5K,GAAM8B,UAAW,EACjBnV,EAAQqU,aAKVhB,GAAM+B,kBAAoB,WACzB,QAAS9b,OAAOomB,mBAGjBrM,GAAM8S,wBAA0B,WAC/B,OAAO3S,UAAUC,cAAgBD,UAAUC,aAAamT,cAIzDvT,GAAMyG,aAAe,SAAShkB,GAG7B,IAFA,IAAIg6B,EAAU,iEACVhW,EAAe,GACVjkB,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC7B,IAAIk6B,EAAY1e,KAAK6T,MAAM7T,KAAK8T,SAAW2K,EAAQ95B,QACnD8jB,GAAgBgW,EAAQE,UAAUD,EAAUA,EAAU,GAEvD,OAAOjW,GAsoGOzG,U,SCrjHR,SAAS4c,GAAc7iB,GAC5B,IAAIxF,EAAOhS,KACXO,QAAQC,IAAI,uBAAwBgX,GACpCiG,GAAMsB,KAAK,CACTiB,MAAO,MACPvB,SAAU,WACR,IAAI6b,EAAQ,IAAI7c,GAAM,CACpBjc,OAAQwQ,EAAKvO,MAAMjC,OACnB4d,QAAS,WAEPkb,EAAM3E,OAAO,CACXC,OAAQ,2BACRC,SAAU7jB,EAAKvO,MAAMoyB,SACrBzW,QAAS,SAAUoD,GACjBxQ,EAAKzN,SAAS,CAAEg2B,UAAW/X,EAAe8X,MAAOA,IACjD7c,GAAMjd,IACJ,qBACEwR,EAAKvO,MAAM82B,UAAUrE,YACrB,QACAlkB,EAAKvO,MAAM82B,UAAUtE,QACrB,KAEJjkB,EAAKwoB,iBAAiBhjB,IAExB7U,MAAO,SAAUA,GACf8a,GAAM9a,MAAM,iCAAkCA,IAEhDqtB,cAAe,SAAU/rB,GACvBwZ,GAAMuC,MACJ,6BAA+B/b,EAAK,KAAO,OAAS,SAGxDmmB,SAAU,SAAU3mB,GAClBga,GAAMjd,IAAI,wBAA0BiD,IAEtC6f,WAAY,SAAUlC,EAAQnd,GAC5BwZ,GAAMjd,IACJ,UACGyD,EAAK,UAAY,WAClB,kBACAmd,IAGN6B,YAAa,SAAUhf,GACrBwZ,GAAMjd,IACJ,4CACGyD,EAAK,KAAO,QACb,SAGN4f,UAAW,SAAUlO,EAAKiO,GACxBnG,GAAMuC,MAAM,yBAA0BrK,GACtC,IAAIhO,EAAQgO,EAAG,YAEf,GADA8H,GAAMuC,MAAM,UAAYrY,GACpBA,EAQF,GANa,WAATA,GACFqK,EAAKyoB,wBAAwB9kB,EAAG,IAAQ,GAE7B,mBAAThO,GACFqK,EAAKyoB,wBAAwB9kB,EAAG,IAAQ,GAE5B,WAAVhO,EAAoB,CAEtB,GAAIgO,EAAG,GAAQ,CACb3D,EAAKzN,SAAS,CACZm2B,KAAM/kB,EAAG,KAEX8H,GAAMjd,IACJ,4BACEmV,EAAG,KACH,YACA3D,EAAKvO,MAAMi3B,KACX,aACA1oB,EAAK2oB,eAET,IAAI7vB,EAAOkH,EAAK2oB,cAChB3oB,EAAKoB,eACHuC,EAAG,GACH3D,EAAKvO,MAAMgU,SACT,OACAzF,EAAKvO,MAAM2T,SACX,OACApF,EAAKvO,MAAMm3B,UACX,OACA5oB,EAAKvO,MAAMM,SACX,OACA+G,GAGCkH,EAAKvO,MAAMo3B,WACd7oB,EAAKzN,SAAS,CAAEs2B,UAAU,IAE1B7oB,EAAKvO,MAAM82B,UAAU7L,YAAY,CAC/BlH,MAAO,CACLqH,OAAO,EACPe,MAAO,CAAEkL,kBAAkB,IAE7B1b,QAAS,SAAUwE,GACjBnG,GAAMuC,MAAM,WAAY4D,GACxB,IAAImX,GAAQ,EAEV/oB,EAAKvO,MAAMu3B,cACXhpB,EAAKvO,MAAMu3B,aAAX,MAEAD,GAAQ,GAEV,IAAIE,EAAU,CAAEhX,QAAS,YAAa8W,MAAOA,GAC7C/oB,EAAKvO,MAAM82B,UAAUrkB,KAAK,CACxB6O,QAASkW,EACTrX,KAAMA,KAGVjhB,MAAO,SAAUA,GACf8a,GAAM9a,MAAM,gBAAiBA,OAMrC,GAAIgT,EAAG,aAAkB,CACvB,IAAIhW,EAAOgW,EAAG,aAEd,IAAK,IAAIqhB,KADTvZ,GAAMuC,MAAM,8BAA+BrgB,GAC7BA,EAAM,CAClB,IAAImD,EAAKnD,EAAKq3B,GAAL,GACLppB,EAAUjO,EAAKq3B,GAAL,QACVkE,EAAQv7B,EAAKq3B,GAAL,MACR+D,EAAQp7B,EAAKq3B,GAAL,MACZhlB,EAAKoB,eAAezT,EAAKq3B,GAAL,GAAer3B,EAAKq3B,GAAL,gBAGlC,GAAc,gBAAVrvB,GAWT,GATAqK,EAAKzN,SAAS,CACZm2B,KAAM/kB,EAAG,KAEX8H,GAAMjd,IACJ,iBACEmV,EAAG,KACH,aACA3D,EAAKvO,MAAMi3B,MAEX/kB,EAAG,aAAkB,CACnBhW,EAAOgW,EAAG,aAGd,IAAK,IAAIqhB,KAFTz2B,QAAQC,IAAI,mBACZD,QAAQC,IAAI,8BAA+Bb,GAC7BA,EAAM,CACdmD,EAAKnD,EAAKq3B,GAAL,GACLppB,EAAUjO,EAAKq3B,GAAL,QACVkE,EAAQv7B,EAAKq3B,GAAL,MACR+D,EAAQp7B,EAAKq3B,GAAL,MACRlsB,EAAOkH,EAAK2oB,cAChB3oB,EAAKoB,eACHuC,EAAG,GACH3D,EAAKvO,MAAMgU,SACT,OACAzF,EAAKvO,MAAM2T,SACX,OACApF,EAAKvO,MAAMm3B,UACX,OACA5oB,EAAKvO,MAAMM,SACX,OACA+G,GAGJ2S,GAAMuC,MACJ,SACEld,EACA,KACA8K,EACA,WACAstB,EACA,WACAH,EACA,YAIH,GAAc,cAAVpzB,EAET8V,GAAM6E,KAAK,qCACN,GAAc,UAAV3a,EAAmB,CAC5B,GAAIgO,EAAG,aAAkB,CACnBhW,EAAOgW,EAAG,aAEd,IAAK,IAAIqhB,KADTvZ,GAAMuC,MAAM,8BAA+BrgB,GAC7BA,EAAM,CACdmD,EAAKnD,EAAKq3B,GAAL,GACLppB,EAAUjO,EAAKq3B,GAAL,QACVkE,EAAQv7B,EAAKq3B,GAAL,MACR+D,EAAQp7B,EAAKq3B,GAAL,MACEr3B,EAAKq3B,GAAL,QACdvZ,GAAMuC,MACJ,SACEld,EACA,KACA8K,EACA,WACAstB,EACA,WACAH,EACA,KAMAA,GACF/oB,EAAKyoB,wBAAwB96B,EAAKq3B,GAAL,IAAe,GAE9ChlB,EAAKoB,eAAezT,EAAKq3B,GAAL,GAAer3B,EAAKq3B,GAAL,eAEhC,GAAIrhB,EAAG,MAKZ,YAJIA,EAAG,WAOT,GAAIA,EAAG,QAAa,CAElB,IAAIwlB,EAAUxlB,EAAG,QACjB3D,EAAKsB,kBAAkB6nB,GACvB1d,GAAMjd,IACJ,qBACE26B,EACA,wBACAA,EACA,MAMNvX,IACFnG,GAAMuC,MAAM,0BAA2B4D,GACvC5R,EAAKvO,MAAM82B,UAAU5D,iBAAiB,CAAE/S,KAAMA,MAGlDkJ,cAAe,SAAUrF,GACvBhK,GAAMuC,MAAM,8BAA+ByH,GAC3CzV,EAAKzN,SAAS,CAAE62B,YAAa3T,KAE/BwD,eAAgB,SAAUxD,GACO,IAA3B3a,IAAE,cAAc1M,SAClB0M,IAAE,eAAeiP,OACf,wFAEF0B,GAAMwb,kBACJvhB,SAAS2jB,eAAe,aACxB5T,GAEFzV,EAAKzN,SAAS,CAAEymB,aAAcvD,MAGlCmN,UAAW,WACTnX,GAAMjd,IAAI,2CAIhBmC,MAAO,SAAUA,KACjB2c,UAAW,WACT5b,OAAOgB,SAAS4F,eAOnB,SAASkwB,GAAiBhjB,GAC/B,IAAIxF,EAAOhS,KACP8K,EAAO9K,KAAK26B,cACZv5B,EAAW,CACb6iB,QAAS,OACTzM,KAAMyG,SAASzG,GACf8jB,IAAKtpB,EAAKvO,MAAM63B,IAEhB1tB,QACEoE,EAAKvO,MAAMgU,SACX,QACAzF,EAAKvO,MAAM2T,SACX,OACApF,EAAKvO,MAAMm3B,UACX,OACA5oB,EAAKvO,MAAMM,SACX,OACA+G,GAEJkH,EAAKvO,MAAM82B,UAAUrkB,KAAK,CAAE6O,QAAS3jB,IACrC4Q,EAAKzN,SAAS,CAAEg3B,KAAMvpB,EAAKvO,MAAM82B,UAAUz3B,GAAIgI,KAAMA,IAGhD,SAAS6vB,KACd,IAAI7vB,EAAO,WAUX,OATI9K,KAAKyD,MAAM+3B,aACb1wB,EAAO,WAEL9K,KAAKyD,MAAMg4B,eACb3wB,EAAO,aAEL9K,KAAKyD,MAAMi4B,eACb5wB,EAAO,aAEFA,EAGF,SAASwI,GAAkBxQ,GACrB9C,KACNuE,SAAS,CACZo3B,aAFS37B,KAEUyD,MAAMk4B,aAAatlB,QAAO,SAACxC,GAAD,OAAUA,EAAK/Q,KAAOA,OAIhE,SAASsQ,GAAetQ,EAAIm0B,GACjC,IACI2E,EAAc3E,EAAErkB,MAAM,QACtBgpB,EAAYx7B,OAAS,GAAKJ,KAAK67B,qBAAqBD,EAAY,KAFzD57B,KAGJuE,SAAS,CACZo3B,aAJO37B,KAIYyD,MAAMk4B,aAAa3uB,OAAO,CAC3ClK,GAAIA,EACJ8K,QAASguB,EAAY,GACrBtlB,KAAMslB,EAAY,GAClBhB,UAAWgB,EAAY,GACvB73B,SAAU63B,EAAY,GACtB9wB,KAAM8wB,EAAY,GAClBE,QAAS,sBAIfv7B,QAAQC,IAAI,0BAA2Bo7B,EAAY,GAAIA,EAAY,IAG9D,SAASC,GAAqBE,GAKnC,OAAyB,IAJd/7B,KACUyD,MAAMk4B,aAAatlB,QACtC,SAACxC,GAAD,OAAUA,EAAKyC,OAASylB,KAEZ37B,OAOT,SAAS47B,GAAmBD,GACjC,IACIE,EADOj8B,KACUyD,MAAMk4B,aAAatlB,QACtC,SAACxC,GAAD,OAAUA,EAAKyC,OAASylB,KAE1B,OAAyB,IAArBE,EAAU77B,OACL,GAEA67B,EAAU,GAAGruB,QAIjB,SAAS6sB,GAAwBsB,EAAerD,GACrD14B,KAAKuE,UAAS,SAAC23B,GAAD,MAAgB,CAC5BC,QAAQ,6BACHD,EAAUC,SADR,kBAEJJ,EAAgBrD,QAKhB,SAAS0D,GAAsBL,EAAevkB,GACnDxX,KAAKuE,UAAS,SAAC23B,GAAD,MAAgB,CAC5BG,gBAAgB,6BACXH,EAAUG,iBADA,kBAEZN,EAAgBvkB,QAKhB,SAAS8kB,KAAc,IAAD,OACvBtqB,EAAOhS,KAEXA,KAAKuE,SAAS,CAAEw2B,OAAQ/6B,KAAKyD,MAAMs3B,QAAS,WAC1C/oB,EAAKvO,MAAM82B,UAAUrkB,KAAK,CACxB6O,QAAS,CAAEd,QAAS,YAAa8W,MAAO/oB,EAAKvO,MAAMs3B,SAEjD,EAAKt3B,MAAMs3B,OACbjuB,IAAE,kBAAkBK,OACpBL,IAAE,mBAAmBC,OACrBD,IAAE,mBAAmByvB,IAAI,QAAS,aAElCzvB,IAAE,mBAAmBK,OACrBL,IAAE,mBAAmByvB,IAAI,QAAS,SAClCzvB,IAAE,kBAAkBC,QAEtBxM,QAAQC,IAAI,QAAS,EAAKiD,MAAMs3B,MAAO,EAAKt3B,MAAM83B,SAIpDvpB,EAAKyoB,wBAAwBz6B,KAAKyD,MAAM83B,MAAM,GAIzC,SAASiB,KAGdx8B,KAAKyD,MAAM82B,UAAUrkB,KAAK,CACxB6O,QAAS,CAAEd,QAAS,YAAa8W,OAAO,KAH/B/6B,KAKNy6B,wBAAwBz6B,KAAKyD,MAAM83B,MAAM,GAGzC,SAASkB,KAEdl8B,QAAQC,IAAI,iBACRR,KAAKyD,MAAM82B,YACbh6B,QAAQC,IAAI,iBACZR,KAAKyD,MAAM82B,UAAUrkB,KAAK,CAAE6O,QAAS,CAAEd,QAAS,YCnYpD,IAAMzG,GAAoB9Z,OAAO8Z,kBACjCC,GAAMC,SAAW,GAEjBD,GAAME,mBAAqB,WAC1B,GAAGC,UAAUC,cAAgBD,UAAUC,aAAaC,gBAEnD,OAAO,EAER,GAAGpa,OAAOka,UAAUG,UAAUrO,MAAM,UAAW,CAC9C,IAAIsO,EAAYC,SAASva,OAAOka,UAAUG,UAAUrO,MAAM,iBAAiB,GAAI,IAC3EwO,EAAS,GAGb,OAFGxa,OAAOka,UAAUG,UAAUrO,MAAM,WACnCwO,EAAS,IACPF,GAAa,IAAMA,GAAaE,GAI5BT,GAAMU,UAAUC,cAGvB,OAAO,GAIT,IAAIC,GAAmB,CAEtBC,YAAa,mCACbF,YAAa,WAAa,OAAgE,OAAzD1G,SAAS6G,cAAc,+BACxDC,UAAW,SAAUC,GACpB,IAAIC,EAAUhb,OAAOib,YAAW,WAC/B,IAAIhc,EAAQ,IAAIic,MAAM,2BAEtB,OADAjc,EAAMmB,KAAO,2IACN2a,EAAS9b,KACd,KACH3C,KAAK6e,MAAMH,GAAWD,EACtB/a,OAAOob,YAAY,CAAEpe,KAAM,iBAAkBoC,GAAI4b,GAAW,MAE7DK,KAAM,WACL,IAAIF,EAAQ,GACZ7e,KAAK6e,MAAQA,EAEbnb,OAAOiU,iBAAiB,WAAW,SAAUhQ,GAC5C,GAAGA,EAAMqX,QAAUtb,OAAOgB,SAASsa,OAEnC,GAAsB,kBAAnBrX,EAAMxH,KAAKO,MAA4Bme,EAAMlX,EAAMxH,KAAK2C,IAAK,CAC/D,IAAI2b,EAAWI,EAAMlX,EAAMxH,KAAK2C,IAGhC,UAFO+b,EAAMlX,EAAMxH,KAAK2C,IAEI,KAAxB6E,EAAMxH,KAAK8e,SAAiB,CAE/B,IAAItc,EAAQ,IAAIic,MAAM,2BACtBjc,EAAMmB,KAAO,yDACb2a,EAAS9b,QAET8b,EAAS,KAAM9W,EAAMxH,KAAK8e,cAEE,yBAAnBtX,EAAMxH,KAAKO,OACrBH,QAAQC,IAAI,YAAamH,EAAMxH,KAAK2C,IACpCY,OAAOwb,aAAavX,EAAMxH,KAAK2C,UAkWnC,SAAS2a,GAAM0B,GAKd,IAJAA,EAAmBA,GAAoB,IACtBC,QAA8C,mBAA5BD,EAAiBC,QAAyBD,EAAiBC,QAAU3B,GAAM4B,KAC9GF,EAAiBxc,MAA0C,mBAA1Bwc,EAAiBxc,MAAuBwc,EAAiBxc,MAAQ8a,GAAM4B,KACxGF,EAAiBG,UAAkD,mBAA9BH,EAAiBG,UAA2BH,EAAiBG,UAAY7B,GAAM4B,MAChH5B,GAAM8B,SAET,OADAJ,EAAiBxc,MAAM,2BAChB,GAER,IAAI8a,GAAM+B,oBAET,OADAL,EAAiBxc,MAAM,wCAChB,GAGR,GADA8a,GAAMjd,IAAI,wBAA0Bid,GAAM8B,WACtCJ,EAAiB3d,OAEpB,OADA2d,EAAiBxc,MAAM,sBAChB,GAER,IAAI8c,GAAa,EACbC,EAAK,KACLC,EAAa,GACbC,EAAuB,KACvBC,EAAU,KACVC,EAAe,EACfte,EAAS2d,EAAiB3d,OAC3Bic,GAAMsC,QAAQve,IAChBic,GAAMjd,IAAI,8BAAgCgB,EAAOpB,OAAS,oCAC1DoB,EAAS,KACTqe,EAAUV,EAAiB3d,OAC3Bic,GAAMuC,MAAMH,IAEgB,IAAzBre,EAAOiT,QAAQ,OACjBgL,GAAa,EACbhC,GAAMjd,IAAI,sCAAwCgB,KAElDie,GAAa,EACbhC,GAAMjd,IAAI,oCAAsCgB,IAGlD,IAAIye,EAAad,EAAiBc,YAAc,CAAC,CAACC,KAAM,iCACpDC,EAAqBhB,EAAiBgB,mBACtCC,EAAejB,EAAiBiB,aAEhCC,GAAyC,IAA1BlB,EAAiBmB,KAEhCC,GAAkB,OACkBC,IAArCrB,EAAiBoB,iBAAsE,OAArCpB,EAAiBoB,kBACrEA,GAAuD,IAArCpB,EAAiBoB,iBAEpC,IAAIE,EAAQ,QAC4BD,IAArCrB,EAAiBuB,iBAAsE,OAArCvB,EAAiBuB,kBACrED,EAAQtB,EAAiBuB,iBACvBD,EAAQ,IACVA,EAAQ,GAET,IAAI5e,EAAQ,UACkB2e,IAA3BrB,EAAiBtd,OAAkD,OAA3Bsd,EAAiBtd,QAC3DA,EAAQsd,EAAiBtd,OAE1B,IAAI8e,EAAY,UACkBH,IAA/BrB,EAAiBwB,WAA0D,OAA/BxB,EAAiBwB,YAC/DA,EAAYxB,EAAiBwB,WAE9B3gB,KAAK4gB,iBAAkB,OACiBJ,IAArCrB,EAAiByB,iBAAsE,OAArCzB,EAAiByB,kBACrE5gB,KAAK4gB,iBAAwD,IAArCzB,EAAiByB,iBAE1C,IAAIC,EAAkB,UACkBL,IAArCrB,EAAiB0B,iBAAsE,OAArC1B,EAAiB0B,kBACrEA,EAAkB1B,EAAiB0B,iBACjCC,MAAMD,KACRA,EAAkB,MACnB,IAAIE,EAAkB,IAOtB,SAASC,EAAeC,GACvB,IAAIC,EAAc,CACjBC,KAAM,IACNC,OAAQ,IACRC,IAAK,KAYN,YAT6Bb,IAAzBS,GAA+D,OAAzBA,IACrCA,EAAqBE,OACxBD,EAAYC,KAAOF,EAAqBE,MACrCF,EAAqBG,SACxBF,EAAYE,OAASH,EAAqBG,QACvCH,EAAqBI,MACxBH,EAAYG,IAAMJ,EAAqBI,MAGlCH,OAtBgCV,IAArCrB,EAAiB4B,iBAAsE,OAArC5B,EAAiB4B,kBACrEA,EAAkB5B,EAAiB4B,iBACjCD,MAAMC,KACRA,EAAkB,KAsBnB,IAAIO,GAAY,EACZC,EAAY,KACZC,EAAgB,GAChBC,EAAOzhB,KACP0hB,EAAU,EACVC,EAAe,GAkBnB,SAASC,IACR,GAAgB,MAAbL,EAGH,GADA9D,GAAMuC,MAAM,gBACRsB,EAAJ,CAIA,IAAIO,EAAWrgB,EAAS,IAAM+f,EAAY,SAAU,IAAIra,MAAO4a,UAC5DrB,IACFoB,EAAWA,EAAW,UAAYpB,GAChC5e,IACFggB,EAAWA,EAAW,UAAYE,mBAAmBlgB,IACnD8e,IACFkB,EAAWA,EAAW,cAAgBE,mBAAmBpB,IAC1DlD,GAAMuE,YAAYH,EAAU,CAC3BI,KAAM,MACN1B,gBAAiBA,EACjBnB,QAAS8C,EACTC,QAASpB,EACTpe,MAAO,SAASyf,EAAYC,GAG3B,GAFA5E,GAAM9a,MAAMyf,EAAa,IAAKC,KAC9BX,EACa,EAIZ,OAFAJ,GAAY,OACZnC,EAAiBxc,MAAM,+CAGxBif,YAxBDnE,GAAM6E,KAAK,yCA8Bb,SAASJ,EAAYjW,EAAMsW,GAI1B,GAHAb,EAAU,EACNjC,QAA4Be,IAAde,GAAyC,OAAdA,IAAsC,IAAhBgB,GAClEX,IACGnC,IAAchC,GAAMsC,QAAQ9T,GAOhC,GAAqB,cAAlBA,EAAI,MAIA,GAAqB,gBAAlBA,EAAI,MAYP,GAAqB,QAAlBA,EAAI,MAYP,GAAqB,YAAlBA,EAAI,MAYP,GAAqB,YAAlBA,EAAI,MAAyB,CAGtC,KADIkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGb,IAAIyC,EAAYxW,EAAI,UACpBwR,GAAMuC,MAAM,uCAAyCuB,GACrD9D,GAAMuC,MAAMyC,GACZ,IAAIpH,EAASmH,EAAaE,YACvBrH,EAAOsH,IAAMtH,EAAOuH,WAEtBnF,GAAMuC,MAAM,2BAA4ByC,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BxH,EAAOsH,GAAGG,gBAAgBL,GAH1BpH,EAAOsH,GAAGG,gBAAgBrF,GAAMsF,mBAOjCtF,GAAMuC,MAAM,6FACR3E,EAAO2H,aACV3H,EAAO2H,WAAa,IACrB3H,EAAO2H,WAAW3iB,KAAKoiB,GACvBhF,GAAMuC,MAAM3E,EAAO2H,iBAEd,IAAqB,aAAlB/W,EAAI,MAKb,OAHAwR,GAAMuC,MAAM,mCAAqCuB,GACjD9D,GAAMuC,MAAM/T,IACRkL,EAASlL,EAAI,SAKbuW,EAAehB,EAAcrK,SAKjCqL,EAAaS,aAAY,QAHxBxF,GAAMuC,MAAM,oDALZvC,GAAM6E,KAAK,qBAUN,GAAqB,WAAlBrW,EAAI,MAAwB,CAKrC,GAHAwR,GAAMuC,MAAM,iCAAmCuB,GAC/C9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGbwC,EAAaS,aAAY,EAAOhX,EAAI,QACpCuW,EAAaU,cACP,GAAqB,aAAlBjX,EAAI,MAA0B,CAKvC,GAHAwR,GAAMuC,MAAM,mCAAqCuB,GACjD9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,OAEDqL,EAAaY,aACbZ,EAAaa,cACP,GAAqB,UAAlBpX,EAAI,MAAuB,CAKpC,GAHAwR,GAAMuC,MAAM,gCAAkCuB,GAC9C9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGbwC,EAAac,WAAWrX,EAAI,KAAUA,EAAI,gBACpC,GAAqB,aAAlBA,EAAI,MAA0B,CAKvC,GAJAwR,GAAMuC,MAAM,mCAAqCuB,GACjD9D,GAAMuC,MAAM/T,KAERkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAIZ,KADIE,EAAehB,EAAcrK,IAGhC,YADAsG,GAAMuC,MAAM,+CAGbwC,EAAae,SAAStX,EAAI,OAAYA,EAAI,UACpC,IAAqB,UAAlBA,EAAI,MAAuB,CAIpC,IAAIuX,EAECC,EADL,GAHAhG,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QACjE0d,GAAMuC,MAAM/T,GACRuX,EAAcvX,EAAI,aAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UAER0V,EAAa6B,GAErB,OACM,GAAqB,UAAlBvX,EAAI,MAAuB,CAGpC,IAAIkL,EACJ,GAHAsG,GAAMuC,MAAM,iCAAmCuB,GAC/C9D,GAAMuC,MAAM/T,KACRkL,EAASlL,EAAI,QAGhB,YADAwR,GAAM6E,KAAK,qBAGZ,IAAIqB,EAAa1X,EAAI,WACrB,IAAI0X,EAEH,YADAlG,GAAM6E,KAAK,yBAGZ7E,GAAMuC,MAAM,6BAA+B7I,EAAS,KAAOwM,EAAU,OAAa,KAClF,IAEInB,EAFAriB,EAAOwjB,EAAU,KAGrB,GAFAlG,GAAMuC,MAAM7f,KACRqiB,EAAehB,EAAcrK,IAGhC,YADAsG,GAAM6E,KAAK,+CAGZ,IAAIsB,EAAO3X,EAAI,KACZ2X,IACFnG,GAAMuC,MAAM,2BACZvC,GAAMuC,MAAM4D,IAEb,IAAInF,EAAW+D,EAAaqB,UACzBpF,GACFhB,GAAMuC,MAAM,4BAEZvB,EAASte,EAAMyjB,IAGfnG,GAAMuC,MAAM,yCAEP,IAAqB,YAAlB/T,EAAI,MAMb,OALAwR,GAAM9a,MAAM,sBAAwB4e,GACpC9D,GAAMuC,MAAM/T,QACRwT,GACHC,EAAGoE,MAAM,KAAM,oBAIhBrG,GAAM6E,KAAK,2BAA6BrW,EAAI,MAAY,gBAAkBsV,GAC1E9D,GAAMuC,MAAM/T,UAnLZwR,GAAMuC,MAAM,4BAA8BuB,GAC1C9D,GAAMuC,MAAM/T,IACRuX,EAAcvX,EAAI,gBAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UACR0V,EAAa6B,SAnBrB/F,GAAMuC,MAAM,yBAA2BuB,GACvC9D,GAAMuC,MAAM/T,IACRuX,EAAcvX,EAAI,gBAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UACR0V,EAAa6B,SAnBrB/F,GAAMuC,MAAM,kCACZvC,GAAMuC,MAAM/T,IACRuX,EAAcvX,EAAI,gBAEjBwX,EAAgB9B,EAAa6B,KAEhCC,EAAcxX,UACR0V,EAAa6B,SAXrB/F,GAAMsG,OAAO,8BAAgCxC,QAP7C,IAAI,IAAIthB,EAAE,EAAGA,EAAEgM,EAAK7L,OAAQH,IAC3BiiB,EAAYjW,EAAKhM,IAAI,GA0NxB,SAAS+jB,IACR,GAAIxiB,GAAWie,GAAe6B,EAA9B,CAEA1B,EAAuBjB,WAAWqF,EAAWnD,GAC7C,IAAIoD,EAAU,CAAE,MAAS,YAAa,WAAc1C,EAAW,YAAe9D,GAAMyG,aAAa,KAC9FriB,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,GACxBjB,EAAGxJ,KAAKiO,KAAKC,UAAUH,KAIxB,SAASI,EAAcC,GACtB,IAAId,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,SAAU,YAAeT,GAgClD,GA/BGc,EAAS,YAEXhD,GAAY,EACZ2C,EAAO,MAAY,QACnBA,EAAO,WAAiB1C,EAErB7B,IACFA,EAAG6E,OAAS,KACZ7E,EAAG8E,QAAU,KACb9E,EAAG+E,QAAU,KACV7E,IACFV,aAAaU,GACbA,EAAuB,QAIvB/d,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,IACpBnf,GAAUic,GAAMsC,QAAQF,KAGC,KAD5Bre,EAASqe,EAAQC,IACPrL,QAAQ,OACjBgL,GAAa,EACbhC,GAAMjd,IAAI,YAAcsf,EAAa,GAAK,yCAA2Cte,EAAS,OAE9Fie,GAAa,EACbhC,GAAMjd,IAAI,YAAcsf,EAAa,GAAK,uCAAyCte,EAAS,OAG3Fie,EA2DF,IAAI,IAAIiF,KA1DRhF,EAAKjC,GAAMkH,aAAanjB,EAAQ,kBAChCme,EAAa,CACZ,MAAS,WAER,GADAlC,GAAM9a,MAAM,sDAAwDnB,GAChEic,GAAMsC,QAAQF,KAAayE,EAAS,UAEvC,QADAxE,IACqBD,EAAQzf,YAE5BkkB,EAAU3hB,MAAM,+EAIjBnB,EAAS,UACTmd,YAAW,WACV0F,EAAcC,KACZ,MAGJA,EAAU3hB,MAAM,yEAGjB,KAAQ,WAEPgf,EAAa6B,GAAe,SAASvX,GAEpC,GADAwR,GAAMuC,MAAM/T,GACU,YAAlBA,EAAI,MAGP,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUlM,QAG/B6f,EAAuBjB,WAAWqF,EAAWnD,GAC7CS,GAAY,EACZC,EAAYtV,EAAI,WAAiBA,EAAI,WAAiBA,EAAK9L,KAAL,GACnDmkB,EAAS,UACX7G,GAAMjd,IAAI,oBAAsB+gB,GAEhC9D,GAAMjd,IAAI,oBAAsB+gB,GAEjC9D,GAAMC,SAAS6D,GAAaE,EAC5B6C,EAAUlF,WAEXM,EAAGxJ,KAAKiO,KAAKC,UAAUH,KAGxB,QAAW,SAAStc,GACnBua,EAAYiC,KAAK1T,MAAM9I,EAAMxH,QAG9B,MAAS,WACHqB,GAAW8f,IAGhBA,GAAY,EAEZnC,EAAiBxc,MAAM,kDAKxB+c,EAAG/H,iBAAiB+M,EAAW/E,EAAW+E,SAK5CjH,GAAMuE,YAAYxgB,EAAQ,CACzBygB,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GAEjB,GADAwR,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAGN,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUlM,QAG/BuhB,GAAY,EACZC,EAAYtV,EAAI,WAAiBA,EAAI,WAAiBA,EAAK9L,KAAL,GACnDmkB,EAAS,UACX7G,GAAMjd,IAAI,oBAAsB+gB,GAEhC9D,GAAMjd,IAAI,oBAAsB+gB,GAEjC9D,GAAMC,SAAS6D,GAAaE,EAC5BG,IACA0C,EAAUlF,WAEXzc,MAAO,SAASyf,EAAYC,GAE3B,GADA5E,GAAM9a,MAAMyf,EAAa,IAAKC,GAC3B5E,GAAMsC,QAAQF,KAAayE,EAAS,UAEtC,QADAxE,IACoBD,EAAQzf,YAE3BkkB,EAAU3hB,MAAM,+EAIjBnB,EAAS,UACTmd,YAAW,WAAa0F,EAAcC,KAAe,MAGnC,KAAhBjC,EACFiC,EAAU3hB,MAAMyf,EAAa,yBAE7BkC,EAAU3hB,MAAMyf,EAAa,KAAOC,MAuYxC,SAASwC,EAAYC,EAAUR,GAI9B,IAHAA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,MAC/EiC,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAGjB,IAAI6f,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAIoiB,EAAUT,EAAUS,QACpBnB,EAAOU,EAAUV,KACjBJ,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,UAAW,KAAQc,EAAS,YAAevB,GAiBpE,GAhBGhB,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACrBiD,IACFK,EAAQL,KAAO,CACdljB,KAAMkjB,EAAKljB,KACXskB,IAAKpB,EAAKoB,KAERpB,EAAKqB,OACPhB,EAAQL,KAAKqB,MAAO,GACC,QAAnBrB,EAAKsB,WAA0C,QAAnBtB,EAAKsB,YACnCjB,EAAQL,KAAKsB,UAAYtB,EAAKsB,YAEhCzH,GAAMuC,MAAM,qCAAuC8E,EAAW,MAC9DrH,GAAMuC,MAAMiE,GACTxE,EAkCF,OAjCAwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,EACvBnD,EAAa6B,GAAe,SAASvX,GAGpC,GAFAwR,GAAMuC,MAAM,iBACZvC,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAAyB,CAE/B,IAAI0X,EAAa1X,EAAI,WACrB,IAAI0X,EAGH,OAFAlG,GAAM6E,KAAK,qDACXgC,EAAUlF,UAGX3B,GAAMjd,IAAI,uCAAyCmjB,EAAU,OAAa,KAC1E,IAAIxjB,EAAOwjB,EAAU,KAGrB,OAFAlG,GAAMuC,MAAM7f,QACZmkB,EAAUlF,QAAQjf,GAES,QAAlB8L,EAAI,MAYdqY,EAAUlF,UAVNnT,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,UAEzD0d,GAAM9a,MAAM,iBACZ2hB,EAAU3hB,MAAM,wBAOnB+c,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GAGjB,GAFAwR,GAAMuC,MAAM,iBACZvC,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAAyB,CAE/B,IAAI0X,EAAa1X,EAAI,WACrB,IAAI0X,EAGH,OAFAlG,GAAM6E,KAAK,qDACXgC,EAAUlF,UAGX3B,GAAMjd,IAAI,uCAAyCmjB,EAAU,OAAa,KAC1E,IAAIxjB,EAAOwjB,EAAU,KAGrB,OAFAlG,GAAMuC,MAAM7f,QACZmkB,EAAUlF,QAAQjf,GAES,QAAlB8L,EAAI,MAYdqY,EAAUlF,UAVNnT,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QACjEukB,EAAU3hB,MAAMsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,UAEzD0d,GAAM9a,MAAM,iBACZ2hB,EAAU3hB,MAAM,mBAOnBA,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GAC9BiC,EAAU3hB,MAAMyf,EAAa,KAAOC,MAMvC,SAAS8C,EAAqBL,EAAUrC,GACvC,GAAInB,EAAJ,CAIA,IAAIkB,EAAehB,EAAcsD,GACjC,GAAItC,GAAiBA,EAAaE,YAAlC,CAIA,IAAIuB,EAAU,CAAE,MAAS,UAAW,UAAaxB,EAAW,YAAehF,GAAMyG,aAAa,KAO9F,GANG1B,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACxBlD,GAAMsG,OAAO,qCAAuCe,EAAW,MAC/DrH,GAAMsG,OAAOE,GACVxE,EAIF,OAHAwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,OACvBpF,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMsG,OAAO,mBACbtG,GAAMsG,OAAO9X,GACQ,QAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,SAInE4C,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,WA7B/B5E,GAAM6E,KAAK,uBALX7E,GAAM6E,KAAK,yCAwCb,SAAS8C,EAAkBN,EAAUO,EAASC,EAAYC,EAAUC,GACnE,IAAIhD,EAAehB,EAAcsD,GACjC,GAAItC,GAAiBA,EAAaE,YAAlC,CAIA,IAAIrH,EAASmH,EAAaE,YAC1B,GAAIrH,EAAOsH,GAAX,CAIA,IAKI8C,EAA2B,SAAS9d,GACvC8V,GAAMjd,IAAI,yCAA0CmH,GACpD,IAAI+d,EAAQ/d,EAAMgD,OAAO+a,MACrBC,EAAWhe,EAAMgD,OAAOgb,SACxBC,EAAUvK,EAAOwK,YAAYH,GAASrK,EAAOwK,YAAYH,GAAOI,WAAa,OAEjF,GADArI,GAAMjd,IAAI,oBAAsBklB,EAAQ,mBAAqBE,GAC9C,SAAZA,EAAoB,CAEtB,GAAGvK,EAAOwK,YAAYH,GAAOhH,SAAWrD,EAAOwK,YAAYH,GAAOhH,QAAQte,OAAS,EAAG,CACrFqd,GAAMjd,IAAI,gCAAkCklB,EAAQ,KAAMrK,EAAOwK,YAAYH,GAAOhH,QAAQte,QADP,qBAErEib,EAAOwK,YAAYH,GAAOhH,SAF2C,IAErF,IAAI,EAAJ,qBAAmD,CAAC,IAA5Cve,EAA2C,QAClDsd,GAAMjd,IAAI,iCAAmCklB,EAAQ,KACrDjI,GAAMuC,MAAM7f,GACZkb,EAAOwK,YAAYH,GAAOxP,KAAK/V,IALqD,8BAOrFkb,EAAOwK,YAAYH,GAAOhH,QAAU,GAGrC8D,EAAauD,WAAWL,EAAOC,KAOjC,GAAIJ,EAQHlK,EAAOwK,YAAYR,GAAWE,MARjB,CAEb,IAAIS,EAAY,CAAEC,SAAS,GACxBX,IACFU,EAAUL,SAAWL,GACtBjK,EAAOwK,YAAYR,GAAWhK,EAAOsH,GAAGyC,kBAAkBC,EAASW,GAKpE3K,EAAOwK,YAAYR,GAASxB,UAxCD,SAASlc,GACnC8V,GAAMjd,IAAI,oCAAqCmH,GAC/C,IAAI+d,EAAQ/d,EAAMgD,OAAO+a,MACzBlD,EAAa0D,OAAOve,EAAMxH,KAAMulB,IAsCjCrK,EAAOwK,YAAYR,GAASd,OAASkB,EACrCpK,EAAOwK,YAAYR,GAASZ,QAAUgB,EACtCpK,EAAOwK,YAAYR,GAASb,QAjBH,SAAS7hB,GACjC8a,GAAM9a,MAAM,6BAA8BA,IAiB3C0Y,EAAOwK,YAAYR,GAAS3G,QAAU,GACnC8G,GACFnK,EAAOwK,YAAYR,GAAS3G,QAAQre,KAAKmlB,QAjDzC/H,GAAM6E,KAAK,+BALX7E,GAAM6E,KAAK,kBA0Db,SAAS6D,EAASrB,EAAUR,IAC3BA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YACtBviB,EAAOmkB,EAAU8B,MAAQ9B,EAAUnkB,KACvC,IAAIA,EAGH,OAFAsd,GAAM6E,KAAK,qBACXgC,EAAU3hB,MAAM,gBAGjB,IAAI+iB,EAAQpB,EAAUoB,MAAQpB,EAAUoB,MAAQjI,GAAM4I,qBACtD,OAAIhL,EAAOwK,YAAYH,GAMqB,SAAzCrK,EAAOwK,YAAYH,GAAOI,YAC5BzK,EAAOwK,YAAYH,GAAOhH,QAAQre,KAAKF,QACvCmkB,EAAUlF,YAGX3B,GAAMjd,IAAI,iCAAmCklB,EAAQ,KACrDjI,GAAMuC,MAAM7f,GACZkb,EAAOwK,YAAYH,GAAOxP,KAAK/V,QAC/BmkB,EAAUlF,YAZTgG,EAAkBN,EAAUY,EAAOpB,EAAUqB,UAAU,EAAOxlB,EAAMmkB,EAAUqB,eAC9ErB,EAAUlF,WAeZ,SAASkH,EAASxB,EAAUR,IAC3BA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YAC1B,IAAIrH,EAAOkL,WAAY,CAEtB,GAAGlL,EAAOsH,GAAI,CACb,IACI6D,EADUnL,EAAOsH,GAAG8D,aACEC,MAAK,SAASvP,GACvC,OAAOA,EAAOwP,OAA+B,UAAtBxP,EAAOwP,MAAMC,QAErC,IAAIJ,EAGH,OAFA/I,GAAM6E,KAAK,oDACXgC,EAAU3hB,MAAM,+CAGjB0Y,EAAOkL,WAAaC,EAAYK,KAC7BxL,EAAOkL,aACT9I,GAAMjd,IAAI,uBACV6a,EAAOkL,WAAWO,aAAe,SAASC,GAAQtJ,GAAMuC,MAAM,mBAAqB+G,EAAKA,QAG1F,IAAI1L,EAAOkL,WAGV,OAFA9I,GAAM6E,KAAK,mCACXgC,EAAU3hB,MAAM,8BAIlB,IAAIkkB,EAAOvC,EAAUuC,KACrB,IAAIA,EAGH,OAFApJ,GAAM6E,KAAK,gCACXgC,EAAU3hB,MAAM,2BAGjB,IAAIqkB,EAAQH,EAAKG,MACjB,IAAIA,EAGH,OAFAvJ,GAAM6E,KAAK,4BACXgC,EAAU3hB,MAAM,uBAGjB,IAAIskB,EAAqC,kBAAlBJ,EAAKI,SAAyBJ,EAAKI,SAAW,IACjEC,EAA2B,kBAAbL,EAAKK,IAAoBL,EAAKK,IAAM,GACtDzJ,GAAMuC,MAAM,uBAAyBgH,EAAQ,cAAgBC,EAAW,WAAaC,EAAM,OAC3F7L,EAAOkL,WAAWY,WAAWH,EAAOC,EAAUC,GAC9C5C,EAAUlF,UAIX,SAASgI,EAActC,EAAUR,IAChCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAIgI,GAAqC,IAAxB/C,EAAU+C,UAC3B5J,GAAMjd,IAAI,qBAAuBskB,EAAW,kBAAoBuC,EAAY,KAC5EC,EAAcxC,GACd,IAAItC,EAAehB,EAAcsD,GACjC,IAAItC,GAAgBA,EAAaW,SAIhC,cAFO3B,EAAcsD,QACrBR,EAAUlF,UAIX,GADAoD,EAAaW,UAAW,EACrBkE,EAIF,cAFO7F,EAAcsD,QACrBR,EAAUlF,UAGX,IAAIkC,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAGjB,IAAIshB,EAAU,CAAE,MAAS,SAAU,YAAexG,GAAMyG,aAAa,KAKrE,GAJG1B,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACrBlB,EAMF,OALAwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,EACvBpF,EAAGxJ,KAAKiO,KAAKC,UAAUH,WAChBzC,EAAcsD,QACrBR,EAAUlF,UAGX3B,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMjd,IAAI,qBACVid,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,eAE3DyhB,EAAcsD,GACrBR,EAAUlF,WAEXzc,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,UAEvBb,EAAcsD,GACrBR,EAAUlF,aAMb,SAASmI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,GACtD,IAAIjF,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAOjC,OANAjF,GAAM6E,KAAK,kBAEPgC,EAAUmD,QACbhK,GAAMiK,cAAcD,QAErBnD,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YAC1BjF,GAAMuC,MAAM,eAAgByH,GACzBA,IACFhK,GAAMuC,MAAM,qBAAsByH,EAAOE,kBACzClK,GAAMuC,MAAM,qBAAsByH,EAAOG,mBAG1C,IAAIC,GAAY,EAChB,GAAIxM,EAAOyM,UAAaN,EAAMO,UAAW1M,EAAO2M,gBAAmBR,EAAMW,cAAiBX,EAAMqB,cAGzF,CAEN,KAAMrB,EAAMO,QAAUE,EAAmBT,IAAYA,EAAMO,SAAWP,EAAMU,UAAYV,EAAMW,gBAC5FV,EAAOE,kBAAoBF,EAAOE,iBAAiBvnB,OAEpD,GADAib,EAAOyM,SAASM,SAASX,EAAOE,iBAAiB,IAC9ClK,GAAM4K,YAAa,CAErB5K,GAAMjd,KAAKgnB,EAAMW,aAAe,YAAc,UAAY,gBAAiBV,EAAOE,iBAAiB,IACnG,IAAIW,EAAmB,KAEvB,IADIC,EAAelN,EAAOsH,GAAG6F,oBACVD,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAC1B,IADO3jB,EAAmB,SACpBuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KAAmB,CACxE0B,EAAmB1jB,EACnB,QALyC,+BASzC0jB,GAAoBA,EAAiBnR,OACvCmR,EAAiBnR,OAAOuR,aAAajB,EAAOE,iBAAiB,IAE7DtM,EAAOsH,GAAGyF,SAASX,EAAOE,iBAAiB,GAAIF,QAGhDhK,GAAMjd,KAAKgnB,EAAMW,aAAe,YAAc,UAAY,gBAAiBV,EAAOE,iBAAiB,IACnGtM,EAAOsH,GAAGyF,SAASX,EAAOE,iBAAiB,GAAIF,GAGjD,KAAMD,EAAMO,QAAUY,EAAmBnB,IAAYA,EAAMO,SAAWP,EAAMoB,UAAYpB,EAAMqB,gBAC5FpB,EAAOG,kBAAoBH,EAAOG,iBAAiBxnB,OAEpD,GADAib,EAAOyM,SAASM,SAASX,EAAOG,iBAAiB,IAC9CnK,GAAM4K,YAAa,CAErB5K,GAAMjd,KAAKgnB,EAAMqB,aAAe,YAAc,UAAY,gBAAiBpB,EAAOG,iBAAiB,IACnG,IACIW,EADAO,EAAmB,KAEvB,IADIP,EAAelN,EAAOsH,GAAG6F,oBACVD,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAAC,IAApB3jB,EACP,IADOA,EAAmB,SACpBuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KAAmB,CACxEkC,EAAmBlkB,EACnB,QALyC,+BASzCkkB,GAAoBA,EAAiB3R,OACvC2R,EAAiB3R,OAAOuR,aAAajB,EAAOG,iBAAiB,IAE7DvM,EAAOsH,GAAGyF,SAASX,EAAOG,iBAAiB,GAAIH,QAGhDhK,GAAMjd,KAAKgnB,EAAMqB,aAAe,YAAc,UAAY,gBAAiBpB,EAAOG,iBAAiB,IACnGvM,EAAOsH,GAAGyF,SAASX,EAAOG,iBAAiB,GAAIH,QAvDjDpM,EAAOyM,SAAWL,EAClBI,GAAY,EA2Db,IAAIxM,EAAOsH,GAAI,CACd,IAAIoG,EAAY,CAAC,WAAc9I,EAAY,mBAAsBE,EAAoB,aAAgBC,GACnD,WAA/C3C,GAAMuL,cAAcC,eAAeC,UAErCH,EAAS,aAAoBtL,GAAMuL,cAAcC,eAAeE,QAAU,GAAM,SAAW,gBAE5F,IAAIC,EAAiB,CACpB,SAAY,CAAC,CAAC,sBAAwB,KAMvC,GAJG/I,GACF+I,EAAeC,SAAShpB,KAAK,CAAC,UAAW,IAGvCikB,EAAUgF,gBAAsD,kBAA7BhF,EAAUgF,eAE/C,IAAI,IAAIrpB,KADRwd,GAAMuC,MAAM,4CAA6CsE,EAAUgF,gBACtDhF,EAAUgF,eACtBF,EAAeC,SAAShpB,KAAKikB,EAAUgF,eAAerpB,IAGN,SAA/Cwd,GAAMuL,cAAcC,eAAeC,UAErCH,EAAU3I,aAAe,cAGvBmJ,eAAiBA,aAAaC,UAAUC,sBACxCF,aAAaC,UAAUE,2BACxBH,aAAaC,UAAUG,6BACtBrF,EAAUsF,kBAAoBtF,EAAUuF,sBAC1CxO,EAAOuO,iBAAmBtF,EAAUsF,iBACpCvO,EAAOwO,mBAAqBvF,EAAUuF,mBACtCd,EAAS,oCAAyC,EAClDA,EAAS,oCAAyC,EAClDA,EAAS,0BAA+B,GAEzCtL,GAAMjd,IAAI,2BACVid,GAAMuC,MAAMoJ,GACZ/N,EAAOsH,GAAK,IAAImH,kBAAkBf,EAAWK,GAC7C3L,GAAMuC,MAAM3E,EAAOsH,IAChBtH,EAAOsH,GAAGoH,WACZ1O,EAAO2O,OAAS,GAChB3O,EAAO4O,QAAQrf,MAAQ,eAExB6S,GAAMjd,IAAI,yDAA2D6a,EAAO6O,QAAU,KACtF7O,EAAOsH,GAAGwH,2BAA6B,SAASzf,GAC5C2Q,EAAOsH,IACTH,EAAa4H,SAAS/O,EAAOsH,GAAG0H,qBAElChP,EAAOsH,GAAG2H,eAAiB,SAAS3iB,GACnC,IAAKA,EAAM8a,WACuC,SAA/ChF,GAAMuL,cAAcC,eAAeC,SAAsBvhB,EAAM8a,UAAUA,UAAUhO,QAAQ,mBAAqB,EAClHgJ,GAAMjd,IAAI,sBACV6a,EAAOkP,SAAU,GACK,IAAnBlP,EAAO6O,QAET/E,EAAqBL,EAAU,CAAC,WAAa,IAorClD,SAAiBA,EAAUR,IAC1BA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,YADAjF,GAAM6E,KAAK,wCAGZ,IAAIjH,EAASmH,EAAaE,YAE1B,GADAjF,GAAMjd,IAAI,gCACN6a,EAAOmP,MAEV,YADA/M,GAAM6E,KAAK,0DAGZjH,EAAOmP,MAAQ,CACd,KAAQnP,EAAOsH,GAAG8H,iBAAiB/pB,KACnC,IAAO2a,EAAOsH,GAAG8H,iBAAiBzF,MAEb,IAAnB3J,EAAO6O,UACT7O,EAAOmP,MAAP,SAA0B,GAC3B/M,GAAMuC,MAAMsE,GACZjJ,EAAOqP,SAAU,EACjBpG,EAAUlF,QAAQ/D,EAAOmP,OAxsCrBG,CAAQ7F,EAAUR,OAEb,CAGN,IAAI7B,EAAY,CACf,UAAa9a,EAAM8a,UAAUA,UAC7B,OAAU9a,EAAM8a,UAAUmI,OAC1B,cAAiBjjB,EAAM8a,UAAUoI,gBAEZ,IAAnBxP,EAAO6O,SAET/E,EAAqBL,EAAUrC,KAIlCpH,EAAOsH,GAAGmI,QAAU,SAASnjB,GAG5B,GAFA8V,GAAMjd,IAAI,yBACVid,GAAMuC,MAAMrY,GACRA,EAAMojB,UAEV1P,EAAO2P,aAAerjB,EAAMojB,QAAQ,GACpCvI,EAAayI,eAAe5P,EAAO2P,eAChCrjB,EAAMgf,MAAMuE,SAAf,CAEA,GAAG7P,EAAOwO,mBAAoB,CAC7B,IAAIsB,EAAkB,KACnB5B,aAAaC,UAAUC,qBACzB0B,EAAkBxjB,EAAM8gB,SAASgB,wBACxBF,aAAaC,UAAU4B,2BAA6B7B,aAAaC,UAAUG,6BAC5D,UAArBhiB,EAAMgf,MAAMC,MAAoBvL,EAAOwO,mBAAP,MAClCsB,EAAkBxjB,EAAM8gB,SAASiB,4BACH,UAArB/hB,EAAMgf,MAAMC,MAAoBvL,EAAOwO,mBAAP,QACzCsB,EAAkBxjB,EAAM8gB,SAASkB,8BAGhCwB,IACF5qB,QAAQC,IAAI2qB,GACTA,EAAgBE,gBAAkBF,EAAgBG,eACpDH,EAAgBE,eACdE,YAAYlQ,EAAOwO,mBAAmBliB,EAAMgf,MAAMC,OAClD4E,OAAOL,EAAgBG,gBAChBH,EAAgBM,UAAYN,EAAgBO,UACrDP,EAAgBM,SACdF,YAAYlQ,EAAOwO,mBAAmBliB,EAAMgf,MAAMC,OAClD4E,OAAOL,EAAgBO,WAI5B,IAAIC,EAAsB,KAC1BlO,GAAMjd,IAAI,oCAAqCmH,EAAMgf,OACrDhf,EAAMgf,MAAMuE,QAAU,SAASU,GAC9BnO,GAAMjd,IAAI,wBAAyBorB,GAChCvQ,EAAO2P,eACT9L,aAAayM,GACbtQ,EAAO2P,aAAaa,YAAYD,EAAGjhB,QACnC6X,EAAayI,eAAe5P,EAAO2P,gBAGrCrjB,EAAMgf,MAAMmF,OAAS,SAASF,GAC7BnO,GAAMjd,IAAI,sBAAuBorB,GAC9BvQ,EAAO2P,cAAuC,MAAvBW,IACzBA,EAAsBhN,YAAW,WAChClB,GAAMjd,IAAI,yBACN6a,EAAO2P,eACV3P,EAAO2P,aAAaa,YAAYD,EAAGjhB,QACnC6X,EAAayI,eAAe5P,EAAO2P,eAEpCW,EAAsB,OAGpB,QAGLhkB,EAAMgf,MAAMoF,SAAW,SAASH,GAE/B,GADAnO,GAAMjd,IAAI,8BAA+BorB,GACf,MAAvBD,EACFzM,aAAayM,GACbA,EAAsB,UAEtB,IACCtQ,EAAO2P,aAAa5C,SAASwD,EAAGjhB,QAChC6X,EAAayI,eAAe5P,EAAO2P,cAClC,MAAMtgB,GACP+S,GAAM9a,MAAM+H,OAMjB,GAAGmd,GAAaJ,EAAQ,CACvBhK,GAAMjd,IAAI,uBACV,IAAIwrB,GAAuC,IAAzB1H,EAAU0H,WAC5BvE,EAAOwE,YAAYC,SAAQ,SAASvF,GACnClJ,GAAMjd,IAAI,sBAAuBmmB,GACjC,IAAIxP,EAAS,KACb,GAAI6U,GAA6B,UAAfrF,EAAMC,KAEjB,CACNnJ,GAAMjd,IAAI,mCAAoCmmB,GAC9C,IAAIzF,EAAcF,EAAesD,EAAUrD,sBACvCkL,EAAK9Q,EAAOsH,GAAGyJ,eAAezF,EAAO,CACxCrZ,UAAW,WACXyd,QAAS,CAACtD,GACV4E,cAAe/H,EAAU+H,eAAiB,CACzC,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYC,MAClD,CAAEmL,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYE,OAAQqL,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYG,IAAKoL,sBAAuB,MAG7EN,IACFhV,EAASgV,EAAGhV,aAdbA,EAASkE,EAAOsH,GAAGyF,SAASzB,EAAOc,GAiBpC,GAAGtQ,GAAUkE,EAAOuO,iBAAkB,CACrC,IAAI8C,EAAgB,KACjBnD,aAAaC,UAAUC,qBACzBiD,EAAgBvV,EAAOsS,wBACdF,aAAaC,UAAU4B,2BAA6B7B,aAAaC,UAAUG,6BAC3D,UAAtBxS,EAAOwP,MAAMC,MAAoBvL,EAAOuO,iBAAP,MACnC8C,EAAgBvV,EAAOuS,4BACQ,UAAtBvS,EAAOwP,MAAMC,MAAoBvL,EAAOuO,iBAAP,QAC1C8C,EAAgBvV,EAAOwS,8BAGtB+C,IACFnsB,QAAQC,IAAIksB,GACTA,EAAcrB,gBAAkBqB,EAAcpB,eAChDoB,EAAcrB,eACZE,YAAYlQ,EAAOuO,iBAAiBzS,EAAOwP,MAAMC,OACjD4E,OAAOkB,EAAcpB,gBACdoB,EAAcjB,UAAYiB,EAAchB,UACjDgB,EAAcjB,SACZF,YAAYlQ,EAAOuO,iBAAiBzS,EAAOwP,MAAMC,OACjD4E,OAAOkB,EAAchB,gBAkmD7B,SAAuBlE,GAEtB,GADA/J,GAAMuC,MAAM,iBAAkBwH,GACoB,SAA/C/J,GAAMuL,cAAcC,eAAeC,QAErC,OADAzL,GAAM6E,KAAK,2CACJ,EAER,YAAa9B,IAAVgH,GAAiC,OAAVA,IAEH,IAAfA,EAAMrnB,MAnmDXwsB,CAAcnF,KAAWnM,EAAOwK,YAAYpI,GAAM4I,wBACpD5I,GAAMjd,IAAI,iCACV4kB,EAAkBN,EAAUrH,GAAM4I,qBAAsB,MAAM,GAC9DhL,EAAOsH,GAAGiK,cAAgB,SAASjlB,GAClC8V,GAAMjd,IAAI,iCAAkCmH,GAC5Cyd,EAAkBN,EAAUnd,EAAMklB,QAAQnH,MAAO/d,EAAMklB,QAAQlH,SAAUhe,EAAMklB,WAI9ExR,EAAOyM,UACTtF,EAAasK,cAAczR,EAAOyM,UAG/BlE,EAGHvI,EAAOsH,GAAGoK,qBAAqBnJ,GAC7BrhB,MAAK,WAIL,GAHAkb,GAAMjd,IAAI,gCACV6a,EAAOuH,UAAYgB,EAAKoB,IAErB3J,EAAO2H,YAAc3H,EAAO2H,WAAW5iB,OAAS,EAAG,CACrD,IAAI,IAAIH,EAAI,EAAGA,EAAGob,EAAO2H,WAAW5iB,OAAQH,IAAK,CAChD,IAAIwiB,EAAYpH,EAAO2H,WAAW/iB,GAClCwd,GAAMuC,MAAM,2BAA4ByC,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BxH,EAAOsH,GAAGG,gBAAgBL,GAH1BpH,EAAOsH,GAAGG,gBAAgBrF,GAAMsF,iBAMlC1H,EAAO2H,WAAa,IA+wBzB,SAAsB8B,EAAU0C,EAAOlD,IACtCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAU0I,aAAiD,mBAA1B1I,EAAU0I,aAA8B1I,EAAU0I,aAAevP,GAAM4B,KACxG,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YACtBuK,GAAqC,IAAxB3I,EAAU2I,UACvBA,EAGHxP,GAAMjd,IAAI,4BAA8B6a,EAAOkP,QAAU,eAAiB0C,EAAY,KAFtFxP,GAAMjd,IAAI,4BAA8B6a,EAAOkP,QAAU,KAI1D,IAAI2C,EAAmB,KACvB,GAAGzP,GAAM4K,YAAa,CAErB6E,EAAmB,GACnB,IAAI5E,EAAmB,KAAMQ,EAAmB,KAC5CP,EAAelN,EAAOsH,GAAG6F,kBAC7B,GAAGD,GAAgBA,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAAC,IAApB3jB,EAAmB,QACtBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KACjD0B,IACHA,EAAmB1jB,IAGjBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,QACjDkC,IACHA,EAAmBlkB,KAXqB,+BAiB5C,IAAIuoB,EAAYlF,EAAmBT,GAC/B4F,EAAYC,EAAmB7F,GACnC,GAAI2F,GAAcC,GAgBjB,GAAGD,GAAaC,GACf,GAAG9E,EACF,IACKA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,GACnD,MAAM5d,GACP+S,GAAM9a,MAAM+H,SAGR,GAAGyiB,IAAcC,EACvB,IACI9E,IACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,IAEpD,MAAM5d,GACP+S,GAAM9a,MAAM+H,QAEP,IAAIyiB,GAAaC,EACvB,GAAG9E,EACF,IACKA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,GACnD,MAAM5d,GACP+S,GAAM9a,MAAM+H,QAIb4d,EAAmBjN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsC8nB,QAvDlD,GAAGd,EAAM+F,aAAejF,EACvB,IACKA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,GACnD,MAAM5d,GACP+S,GAAM9a,MAAM+H,GAmDf,IAAI8iB,EAAY7E,EAAmBnB,GAC/BiG,EAAYC,EAAmBlG,GACnC,GAAIgG,GAAcC,GAgBjB,GAAGD,GAAaC,GACf,GAAG3E,EACF,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,SAGR,GAAG8iB,IAAcC,GACvB,GAAG3E,EACF,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,SAGR,IAAI8iB,GAAaC,EACvB,GAAG3E,EACF,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,QAIboe,EAAmBzN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsCsoB,QAvDlD,GAAGtB,EAAMmG,aAAe7E,EACvB,IACKA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,GACnD,MAAMpe,GACP+S,GAAM9a,MAAM+H,SAoDdwiB,EADiD,YAA/CzP,GAAMuL,cAAcC,eAAeC,SAAwE,SAA/CzL,GAAMuL,cAAcC,eAAeC,QAC9E,CAClB0E,oBAAqBP,EAAmB7F,GACxCqG,oBAAqBH,EAAmBlG,IAGtB,CAClBsG,UAAW,CACVC,oBAAqBV,EAAmB7F,GACxCwG,oBAAqBN,EAAmBlG,KAK5C/J,GAAMuC,MAAMkN,GAEZ,IAAIe,EAAYtF,EAAmBnB,GACnC,GAAGyG,GAAahB,GAA4D,YAA/CxP,GAAMuL,cAAcC,eAAeC,QAAuB,CAEtFzL,GAAMjd,IAAI,2CACV,IAAI2W,EAASkE,EAAOsH,GAAG8D,aAAa,GACpChJ,GAAMjd,IAAI2W,GACV,IAAI+W,EAAa/W,EAAOgX,gBACxB1Q,GAAMjd,IAAI0tB,GAEV,IAAIhN,EAAcF,EAAesD,EAAUrD,sBAC3C9J,EAAOiX,cAAc,CAACC,UAAW/J,EAAU+H,eAAiB,CAC3D,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYC,MAClD,CAAEmL,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYE,OAAQqL,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYG,IAAKoL,sBAAuB,MAGhFpR,EAAOsH,GAAG2L,aAAapB,GACrB3qB,MAAK,SAASgsB,GACd9Q,GAAMuC,MAAMuO,GAGZ,IAAI3K,EAAO,CACV,KAAQ2K,EAAO7tB,KACf,IAAO6tB,EAAOvJ,KAEfV,EAAU0I,aAAapJ,GACvB2K,EAAOvJ,IAAMpB,EAAKoB,IAClBvH,GAAMjd,IAAI,6BACPytB,GAAahB,IAEmC,WAA/CxP,GAAMuL,cAAcC,eAAeC,QAIrCzL,GAAM6E,KAAK,qFAC6C,YAA/C7E,GAAMuL,cAAcC,eAAeC,SAC5CzL,GAAM6E,KAAK,iEAGbjH,EAAOmP,MAAQ,CACd9pB,KAAM,SACNskB,IAAKuJ,EAAOvJ,KAEb3J,EAAOsH,GAAG6L,oBAAoBD,GAC5B7rB,MAAM4hB,EAAU3hB,OAClB0Y,EAAO6R,iBAAmBA,EACtB7R,EAAOkP,SAAYlP,EAAO6O,UAM3B7O,EAAOuO,kBAAoBvO,EAAOwO,sBACpC0E,EAAM,MAAW,GAElBjK,EAAUlF,QAAQmP,IAPjB9Q,GAAMjd,IAAI,mCAQT8jB,EAAU3hB,OA7/BX2rB,CAAaxJ,EAAU0C,EAAOlD,KAC5BA,EAAU3hB,OA0jBhB,SAAqBmiB,EAAU0C,EAAOlD,IACrCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAU0I,aAAiD,mBAA1B1I,EAAU0I,aAA8B1I,EAAU0I,aAAevP,GAAM4B,KACxG,IAAImD,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YACtBuK,GAAqC,IAAxB3I,EAAU2I,UACvBA,EAGHxP,GAAMjd,IAAI,2BAA6B6a,EAAOkP,QAAU,eAAiB0C,EAAY,KAFrFxP,GAAMjd,IAAI,2BAA6B6a,EAAOkP,QAAU,KAKzD,IAAI2C,EAAmB,GACvB,GAAGzP,GAAM4K,YAAa,CAErB,IAAIC,EAAmB,KAAMQ,EAAmB,KAC5CP,EAAelN,EAAOsH,GAAG6F,kBAC7B,GAAGD,GAAgBA,EAAanoB,OAAS,EAAG,CAAC,IAAD,iBAC9BmoB,GAD8B,IAC3C,IAAI,EAAJ,qBAA2B,CAAC,IAApB3jB,EAAmB,QACtBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,KACjD0B,IACHA,EAAmB1jB,IAIjBA,EAAEuS,QAAUvS,EAAEuS,OAAOwP,OAAiC,UAAxB/hB,EAAEuS,OAAOwP,MAAMC,MAC9ChiB,EAAE6jB,UAAY7jB,EAAE6jB,SAAS9B,OAAmC,UAA1B/hB,EAAE6jB,SAAS9B,MAAMC,QACjDkC,IACHA,EAAmBlkB,KAZqB,+BAmB5C,IAAIuoB,EAAYlF,EAAmBT,GAC/B4F,EAAYC,EAAmB7F,GAC/B2F,GAAcC,EAYdD,GAAaC,EACZ9E,IACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,IAE5C6E,IAAcC,EACpB9E,IACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,KAE3C6E,GAAaC,IACpB9E,GACEA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,KAGpDA,EAAmBjN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsC8nB,KAvC/Cd,EAAM+F,aAAejF,IACnBA,EAAiBgF,aACpBhF,EAAiBgF,aAAa,YAE9BhF,EAAiBhb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0C8nB,IAsCtD,IAAIkF,EAAY7E,EAAmBnB,GAC/BiG,EAAYC,EAAmBlG,GAC/BgG,GAAcC,EAYdD,GAAaC,EACZ3E,IACEA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,IAE5C0E,IAAcC,EACpB3E,IACEA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,KAE3C0E,GAAaC,IACpB3E,GACEA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,KAGpDA,EAAmBzN,EAAOsH,GAAGyJ,eAAe,QAAS,CAAE9e,UAAW,aAClEmQ,GAAMjd,IAAI,qCAAsCsoB,KAvC/CtB,EAAMmG,aAAe7E,IACnBA,EAAiBwE,aACpBxE,EAAiBwE,aAAa,YAE9BxE,EAAiBxb,UAAY,WAE9BmQ,GAAMjd,IAAI,yCAA0CsoB,SAsCtDoE,EAAgB,oBAA0BG,EAAmB7F,GAC7D0F,EAAgB,oBAA0BQ,EAAmBlG,IAEnB,IAAzBlD,EAAUmK,aAE3BvB,EAAgB,YAAiB,GAElCzP,GAAMuC,MAAMkN,GAEZ,IAAIe,EAAYtF,EAAmBnB,GACnC,GAAGyG,GAAahB,GAA4D,YAA/CxP,GAAMuL,cAAcC,eAAeC,QAAuB,CAEtFzL,GAAMjd,IAAI,2CACV,IAAI2W,EAASkE,EAAOsH,GAAG8D,aAAaC,MAAK,SAAS7V,GAAI,OAAOA,EAAE8V,OAA0B,UAAjB9V,EAAE8V,MAAMC,QAChF,GAAGzP,EAAQ,CACV,IAAI+W,EAAa/W,EAAOgX,gBACpBD,IACHA,EAAa,IAEd,IAAIhN,EAAcF,EAAesD,EAAUrD,sBAC3CiN,EAAWG,UAAY/J,EAAU+H,eAAiB,CACjD,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYC,MAClD,CAAEmL,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYE,OAAQqL,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAYtL,EAAYG,IAAKoL,sBAAuB,IAE/EtV,EAAOiX,cAAcF,IAGvB7S,EAAOsH,GAAG+L,YAAYxB,GACpB3qB,MAAK,SAASosB,GACdlR,GAAMuC,MAAM2O,GAGZ,IAAI/K,EAAO,CACV,KAAQ+K,EAAMjuB,KACd,IAAOiuB,EAAM3J,KAEdV,EAAU0I,aAAapJ,GACvB+K,EAAM3J,IAAMpB,EAAKoB,IACjBvH,GAAMjd,IAAI,6BACPytB,GAAahB,IAEmC,WAA/CxP,GAAMuL,cAAcC,eAAeC,SACW,WAA/CzL,GAAMuL,cAAcC,eAAeC,SACpCzL,GAAMjd,IAAI,kDACVmuB,EAAM3J,IAoiBX,SAAiCA,GAQhC,IALA,IAAI4J,EAAQ5J,EAAIpS,MAAM,QAClBic,GAAQ,EACRC,EAAO,EAAG,GAAKC,EAAW,EAAG,GAC7BC,EAAQ,KAAMC,EAAO,KAAMC,EAAU,KAAMxJ,EAAQ,KACnDyJ,GAAY,EACRlvB,EAAE,EAAGA,EAAE2uB,EAAMxuB,OAAQH,IAAK,CAEjC,GADImvB,EAAQR,EAAM3uB,GAAGyP,MAAM,cAG1B,GAAc,UADD0f,EAAM,GACI,CAEtB,KAAGN,EAAK,GAAK,GAEN,CAENK,EAAWlvB,EACX,MAJA4uB,GAAQ,OAQT,GAAGC,EAAK,IAAM,EAAG,CAEhBK,EAAWlvB,EACX,YAKH,GAAI4uB,EAAJ,CAGA,GADUD,EAAM3uB,GAAGyP,MAAM,sCAGxB,OADA+N,GAAM6E,KAAK,qEACJ0C,EAER,IAAIqK,EAAMT,EAAM3uB,GAAGyP,MAAM,gCACzB,GAAG2f,EACFP,EAAK,GAAKO,EAAI,GACdN,EAAS,GAAKM,EAAI,GAClBT,EAAMla,OAAOzU,EAAG,GAAIA,QAHrB,CAMA,GAAG6uB,EAAK,GAAI,CAiBX,IAhBIpf,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAEhDE,EAAQtf,EAAM,KAEfA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,iBAE5CG,EAAOvf,EAAM,KAEdA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,oBAE5CI,EAAUxf,EAAM,KAEjBA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAE5CpJ,EAAQhW,EAAM,IAEkC,IAA9Ckf,EAAM3uB,GAAGwU,QAAQ,UAAYsa,EAAS,IAAW,CACnDH,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,SAED,GAA6C,IAA1C2uB,EAAM3uB,GAAGwU,QAAQ,UAAYqa,EAAK,IAAW,CAC/CF,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,UAGoB,GAAnB2uB,EAAM3uB,GAAGG,SACXwuB,EAAMla,OAAOzU,EAAG,GAAIA,OAItB,GAAG6uB,EAAK,GAAK,EAAG,CAEfK,GAAY,EACZN,GAAQ,EACR,IAAQ5uB,EAAE,EAAGA,EAAE2uB,EAAMxuB,OAAQH,IAAK,CACjC,IAAImvB,EACJ,GADIA,EAAQR,EAAM3uB,GAAGyP,MAAM,cAG1B,GAAc,UADD0f,EAAM,GACI,CAEtB,KAAGN,EAAK,GAAK,GAEN,CAENK,EAAWlvB,EACX,MAJA4uB,GAAQ,OAQT,GAAGC,EAAK,IAAM,EAAG,CAEhBK,EAAWlvB,EACX,YAKH,GAAI4uB,EAAJ,CAEA,GAAGC,EAAK,GAAK,EAAG,CACf,IAAIlkB,EAAQgkB,EAAM3uB,GAAGyP,MAAM,gBAC3B,GAAG9E,EAAO,CACTkkB,EAAK,GAAKlkB,EAAM,GAChBgkB,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,cAEK,CACN,IAAIyP,EAgBJ,IAhBIA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAEhDE,EAAQtf,EAAM,KAEfA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,iBAE5CG,EAAOvf,EAAM,KAEdA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,oBAE5CI,EAAUxf,EAAM,KAEjBA,EAAQkf,EAAM3uB,GAAGyP,MAAM,UAAYof,EAAK,GAAK,kBAE5CpJ,EAAQhW,EAAM,IAEkC,IAA9Ckf,EAAM3uB,GAAGwU,QAAQ,UAAYsa,EAAS,IAAW,CACnDH,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,SAED,GAA6C,IAA1C2uB,EAAM3uB,GAAGwU,QAAQ,UAAYqa,EAAK,IAAW,CAC/CF,EAAMla,OAAOzU,EAAG,GAAIA,IACpB,UAGqB,IAApB2uB,EAAM3uB,GAAGG,SACXwuB,EAAMla,OAAOzU,EAAG,GAAIA,OAKvB,GAAG6uB,EAAK,GAAK,EAGZ,OADArR,GAAM6E,KAAK,0DACJ0C,EAELmK,EAAW,IAEbA,EAAWP,EAAMxuB,QAIlB0uB,EAAK,GAAKrT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAC1BT,EAAK,GAAKrT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAC1BR,EAAS,GAAKtT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAC9BR,EAAS,GAAKtT,KAAK6T,MAAoB,WAAd7T,KAAK8T,UAE9B,IAAQtvB,EAAE,EAAGA,EAAE6uB,EAAK1uB,OAAQH,IACxB+uB,IACFJ,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,UAAY+uB,GAC5DG,KAEEF,IACFL,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,SAAWgvB,GAC3DE,KAEED,IACFN,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,YAAcivB,GAC9DC,KAEEzJ,IACFkJ,EAAMla,OAAOya,EAAU,EAAG,UAAYL,EAAK7uB,GAAK,UAAYylB,GAC5DyJ,KAGEH,IACFJ,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,UAAY+uB,GAChEG,KAEEF,IACFL,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,SAAWgvB,GAC/DE,KAEED,IACFN,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,YAAcivB,GAClEC,KAEEzJ,IACFkJ,EAAMla,OAAOya,EAAU,EAAG,UAAYJ,EAAS9uB,GAAK,UAAYylB,GAChEyJ,KAGFP,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEH,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEH,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEH,EAAMla,OAAOya,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMA,EAAK,GAAK,IAAMA,EAAK,KACrF9J,EAAM4J,EAAMzsB,KAAK,SACTqtB,SAAS,UAChBxK,GAAO,QACR,OAAOA,EA9uBSyK,CAAwBd,EAAM3J,MACc,YAA/CvH,GAAMuL,cAAcC,eAAeC,SAC5CzL,GAAM6E,KAAK,iEAGbjH,EAAOmP,MAAQ,CACd9pB,KAAM,QACNskB,IAAK2J,EAAM3J,KAEZ3J,EAAOsH,GAAG6L,oBAAoBG,GAC5BjsB,MAAM4hB,EAAU3hB,OAClB0Y,EAAO6R,iBAAmBA,EACtB7R,EAAOkP,SAAYlP,EAAO6O,UAM3B7O,EAAOuO,kBAAoBvO,EAAOwO,sBACpC8E,EAAK,MAAW,GAEjBrK,EAAUlF,QAAQuP,IAPjBlR,GAAMjd,IAAI,mCAQT8jB,EAAU3hB,OA/xBb+rB,CAAY5J,EAAU0C,EAAOlD,GA2B/B,SAASoL,EAAc5K,EAAU6J,EAAOrK,IACvCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQgtB,EAC7E,IAAI/L,EAAOU,EAAUV,KACrB,GAAG+K,GAAS/K,EAGX,OAFAnG,GAAM9a,MAAM,yCACZ2hB,EAAU3hB,MAAM,oCAEV,IAAIgsB,KAAW/K,IAASA,EAAKljB,OAASkjB,EAAKoB,KAGjD,OAFAvH,GAAM9a,MAAM,kDACZ2hB,EAAU3hB,MAAM,6CAIjB2hB,EAAUkD,MAAoC,kBAApBlD,EAAUkD,OAAsBlD,EAAUkD,MAASlD,EAAUkD,MAAQ,CAAEoI,OAAO,EAAMf,OAAO,GACrH,IAAIrH,EAAQlD,EAAUkD,MAClBhF,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAsiDyBunB,EAtiDrB7O,EAASmH,EAAaE,YAG1B,GAFArH,EAAO6O,SAqiDkBA,EAriDS5F,EAAU4F,QAsiD5CzM,GAAMuC,MAAM,oBAAqBkK,IACb,IAAZA,GAriDJ7O,EAAOsH,GAKJ,CAKN,GAJAlF,GAAMjd,IAAI,mCACVgnB,EAAMO,QAAS,EAGZzD,EAAUmD,OAETnD,EAAUmD,SAAWpM,EAAOyM,UAC9BrK,GAAMjd,IAAI,oDAEL,CAEN,GAAGgnB,EAAMU,UAKR,GAJAV,EAAMqI,WAAY,EAClBrI,EAAMW,cAAe,EACrBX,EAAM+F,aAAc,EACpB/F,EAAM2F,WAAY,EACf9R,EAAOyM,UAAYzM,EAAOyM,SAASH,kBAAoBtM,EAAOyM,SAASH,iBAAiBvnB,OAG1F,OAFAqd,GAAM9a,MAAM,qDACZ2hB,EAAU3hB,MAAM,qDAGR6kB,EAAM+F,aACf/F,EAAMqI,WAAY,EAClBrI,EAAMW,cAAe,EACrBX,EAAMU,UAAW,EACjBV,EAAM2F,WAAY,GACT3F,EAAMW,eACfX,EAAMqI,WAAY,EAClBrI,EAAMU,UAAW,EACjBV,EAAM+F,aAAc,EACpB/F,EAAM2F,WAAY,GAoCnB,GAlCI9R,EAAOyM,UAaNzM,EAAOyM,SAASH,kBAAgE,IAA5CtM,EAAOyM,SAASH,iBAAiBvnB,QAcrE6nB,EAAmBT,IACnBA,EAAM+F,aAAgB/F,EAAMW,eAC9BX,EAAMqI,WAAY,IA3BjBrI,EAAMW,eACRX,EAAMqI,WAAY,EAClBrI,EAAMW,cAAe,EACrBX,EAAMU,UAAW,EACjBV,EAAM2F,WAAY,GAEhBlF,EAAmBT,KACrBA,EAAMqI,WAAY,EAClBrI,EAAMU,UAAW,IAwBhBV,EAAMoB,UAKR,GAJApB,EAAMsI,WAAY,EAClBtI,EAAMqB,cAAe,EACrBrB,EAAMmG,aAAc,EACpBnG,EAAMgG,WAAY,EACfnS,EAAOyM,UAAYzM,EAAOyM,SAASF,kBAAoBvM,EAAOyM,SAASF,iBAAiBxnB,OAG1F,OAFAqd,GAAM9a,MAAM,qDACZ2hB,EAAU3hB,MAAM,qDAGR6kB,EAAMmG,aACfnG,EAAMsI,WAAY,EAClBtI,EAAMqB,cAAe,EACrBrB,EAAMoB,UAAW,EACjBpB,EAAMgG,WAAY,GACThG,EAAMqB,eACfrB,EAAMsI,WAAY,EAClBtI,EAAMoB,UAAW,EACjBpB,EAAMmG,aAAc,EACpBnG,EAAMgG,WAAY,GAEfnS,EAAOyM,UAaNzM,EAAOyM,SAASF,kBAAgE,IAA5CvM,EAAOyM,SAASF,iBAAiBxnB,QAcrEuoB,EAAmBnB,IAAWA,EAAMmG,aAAgBnG,EAAMqB,eAC5DrB,EAAMsI,WAAY,IA1BjBtI,EAAMqB,eACRrB,EAAMsI,WAAY,EAClBtI,EAAMqB,cAAe,EACrBrB,EAAMoB,UAAW,EACjBpB,EAAMgG,WAAY,GAEhB7E,EAAmBnB,KACrBA,EAAMsI,WAAY,EAClBtI,EAAMoB,UAAW,IAuBhBpB,EAAMuI,UACRvI,EAAMrnB,MAAO,GAIf,GAAI8nB,EAAmBT,IAAUA,EAAMqI,WACpClH,EAAmBnB,IAAUA,EAAMsI,UAGrC,OAFAtN,EAAawN,eAAc,QAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWjJ,EAAOyM,eApItDN,EAAMO,QAAS,EACfP,EAAMqI,WAAY,EAClBrI,EAAMsI,WAAY,EAuInB,GAAGtI,EAAMO,UAAY1M,EAAO2M,gBAAmB3M,EAAO2M,iBAAmBR,EAAMW,cAAgBX,EAAMqB,eAAiB,CACrH,GAAGrB,EAAM+F,aAAe/F,EAAMW,aAAc,CAC3C,GAAG9M,EAAOyM,UAAYzM,EAAOyM,SAASH,kBAAoBtM,EAAOyM,SAASH,iBAAiBvnB,OAAQ,CAClG,IAAI6vB,EAAK5U,EAAOyM,SAASH,iBAAiB,GAC1ClK,GAAMjd,IAAI,wBAAyByvB,GACnC5U,EAAOyM,SAAS+D,YAAYoE,GAC5B,IACCA,EAAGzZ,OACF,MAAM9L,KAET,GAAG2Q,EAAOsH,GAAG8D,cAAgBpL,EAAOsH,GAAG8D,aAAarmB,OAAQ,CAC3D,IAAI8vB,GAAK,EAKT,GAJG1I,EAAMW,cAAgB1K,GAAM4K,cAE9B6H,GAAK,GAEHA,EAAI,CAAC,IAAD,iBACU7U,EAAOsH,GAAG8D,cADpB,IACN,IAAI,EAAJ,qBAAwC,CAAC,IAAjC0J,EAAgC,QACpCA,GAAQA,EAAKxJ,OAA6B,UAApBwJ,EAAKxJ,MAAMC,OACnCnJ,GAAMjd,IAAI,yBAA0B2vB,GACpC9U,EAAOsH,GAAGkJ,YAAYsE,KAJlB,iCAUT,GAAG3I,EAAMmG,aAAenG,EAAMqB,aAAc,CAC3C,GAAGxN,EAAOyM,UAAYzM,EAAOyM,SAASF,kBAAoBvM,EAAOyM,SAASF,iBAAiBxnB,OAAQ,CAClG,IAAIgwB,EAAK/U,EAAOyM,SAASF,iBAAiB,GAC1CnK,GAAMjd,IAAI,wBAAyB4vB,GACnC/U,EAAOyM,SAAS+D,YAAYuE,GAC5B,IACCA,EAAG5Z,OACF,MAAM9L,KAET,GAAG2Q,EAAOsH,GAAG8D,cAAgBpL,EAAOsH,GAAG8D,aAAarmB,OAAQ,CAC3D,IAAIiwB,GAAK,EAKT,GAJG7I,EAAMqB,cAAgBpL,GAAM4K,cAE9BgI,GAAK,GAEHA,EAAI,CAAC,IAAD,iBACUhV,EAAOsH,GAAG8D,cADpB,IACN,IAAI,EAAJ,qBAAwC,CAAC,IAAjC6J,EAAgC,QACpCA,GAAQA,EAAK3J,OAA6B,UAApB2J,EAAK3J,MAAMC,OACnCnJ,GAAMjd,IAAI,yBAA0B8vB,GACpCjV,EAAOsH,GAAGkJ,YAAYyE,KAJlB,kCAYV,GAAGhM,EAAUmD,OAAQ,CACpB,IAAIA,EAASnD,EAAUmD,OAavB,OAZAhK,GAAMjd,IAAI,2CACVid,GAAMuC,MAAMyH,IAETD,EAAMO,SAAU1M,EAAOyM,UAAYzM,EAAOyM,WAAaxD,EAAUmD,QAAWpM,EAAO2M,gBAAmBR,EAAMW,cAAiBX,EAAMqB,eAErIpL,GAAMiK,cAAcrM,EAAOyM,UAC3BzM,EAAOyM,SAAW,MAGnBzM,EAAO2M,gBAAiB,EACxBxF,EAAawN,eAAc,QAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,GAG/C,GAAGQ,EAAmBT,IAAUmB,EAAmBnB,GAAQ,CAC1D,IAAI/J,GAAM8S,0BAET,YADAjM,EAAU3hB,MAAM,8BAGjB,IAAI6tB,EAAc,CAAE1C,UAAW,GAAIzE,SAAU,IAC7C7G,EAAawN,eAAc,GAC3B,IAAIS,EAAexI,EAAmBT,GACnCiJ,GAAgBjJ,GAAgC,kBAAhBA,EAAMoI,QACxCa,EAAejJ,EAAMoI,OACtB,IAAIc,EAAe/H,EAAmBnB,GACtC,GAAGkJ,GAAgBlJ,EAAO,CACzB,IAAIyF,GAAqC,IAAxB3I,EAAU2I,UACvBjB,GAAuC,IAAzB1H,EAAU0H,WAG5B,IAFIiB,IAAajB,GAAgBpI,GAAS4D,EAAMqH,QAC/CrH,EAAMqH,MAAQ,SACZrH,EAAMqH,OAAwB,UAAfrH,EAAMqH,OAAoC,UAAfrH,EAAMqH,MAClD,GAA0B,kBAAhBrH,EAAMqH,MACf6B,EAAelJ,EAAMqH,UACf,CACN,IAAI1pB,EAAQ,EACRC,EAAS,EACM,WAAhBoiB,EAAMqH,OAERzpB,EAAS,IACG,IACZD,EAAQ,KACiB,gBAAhBqiB,EAAMqH,OAEfzpB,EAAS,IACG,IACZD,EAAQ,KACiB,UAAhBqiB,EAAMqH,OAAqC,eAAhBrH,EAAMqH,OAA0C,UAAhBrH,EAAMqH,OAE1EzpB,EAAS,IACG,IACZD,EAAQ,MACiB,WAAhBqiB,EAAMqH,OAEfzpB,EAAS,KACG,KACZD,EAAQ,MACiB,UAAhBqiB,EAAMqH,OAEfzpB,EAAS,KACG,KACZD,EAAQ,MACiB,WAAhBqiB,EAAMqH,OAEfzpB,EAAS,IACG,IACZD,EAAQ,KACiB,gBAAhBqiB,EAAMqH,OAEfzpB,EAAS,IACG,IACZD,EAAQ,MAERsY,GAAMjd,IAAI,uCACV4E,EAAS,IACG,IACZD,EAAQ,KAETsY,GAAMjd,IAAI,2BAA4BgnB,EAAMqH,OAC5C6B,EAAe,CACd,OAAU,CAAC,MAAStrB,GACpB,MAAS,CAAC,MAASD,IAEpBsY,GAAMjd,IAAI,2BAA4BkwB,QAEjC,GAAmB,WAAhBlJ,EAAMqH,OAAsC,WAAhBrH,EAAMqH,MAAoB,CAC/D,GAAGjR,UAAUC,cAAgBD,UAAUC,aAAaC,gBA+BnD,OA3BA0S,EAAY3B,MAAQ,GACjBrH,EAAMmJ,uBACRH,EAAY3B,MAAM+B,UAAYpJ,EAAMmJ,sBAElCnJ,EAAMqJ,oBACRL,EAAY3B,MAAMzpB,OAASoiB,EAAMqJ,mBAE/BrJ,EAAMsJ,mBACRN,EAAY3B,MAAM1pB,MAAQqiB,EAAMsJ,kBAEjCN,EAAYZ,MAAQpI,EAAMuJ,yBAC1BnT,UAAUC,aAAaC,gBAAgB0S,GACrCjuB,MAAK,SAASklB,GACdjF,EAAawN,eAAc,GACxB/H,EAAmBT,KAAWA,EAAMqI,UACtCjS,UAAUC,aAAamT,aAAa,CAAEpB,OAAO,EAAMf,OAAO,IACzDtsB,MAAK,SAAU0uB,GACfxJ,EAAOW,SAAS6I,EAAYtJ,iBAAiB,IAC7CJ,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,MAG/CF,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,MAE7C,SAAU9kB,GACZ6f,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAMA,MAMnB,SAASuuB,EAAmBvuB,EAAO8kB,GAClCjF,EAAawN,eAAc,GACxBrtB,EACF2hB,EAAU3hB,MAAMA,GAEhB4kB,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,GAGhD,SAAS0J,EAAeX,EAAaY,EAAaC,GACjD5T,GAAMjd,IAAI,4CACVid,GAAMuC,MAAMwQ,GACZ5S,UAAUC,aAAamT,aAAaR,GAClCjuB,MAAK,SAASklB,GACX4J,EACFzT,UAAUC,aAAamT,aAAa,CAAEpB,OAAO,EAAMf,OAAO,IACzDtsB,MAAK,SAAU0uB,GACfxJ,EAAOW,SAAS6I,EAAYtJ,iBAAiB,IAC7CyJ,EAAY,KAAM3J,MAGnB2J,EAAY,KAAM3J,MAGnB/kB,OAAM,SAASC,GAAS6f,EAAawN,eAAc,GAAQoB,EAAYzuB,MAE1E,GAAkD,WAA/C8a,GAAMuL,cAAcC,eAAeC,QAAsB,CAC3D,IAAIlL,EAAYP,GAAMuL,cAAcC,eAAeE,QAC/CjL,EAAS,GACVxa,OAAOka,UAAUG,UAAUrO,MAAM,WACnCwO,EAAS,IACPF,GAAa,IAAMA,GAAaE,EAelCiT,EAbAX,EAAc,CACb3B,MAAO,CACNf,UAAW,CACVwD,iBAAiB,EACjBC,SAAU7tB,OAAO8tB,OAAOrsB,MACxBgM,UAAWzN,OAAO8tB,OAAOpsB,OACzBqsB,aAAcjK,EAAMmJ,qBACpBe,aAAclK,EAAMmJ,qBACpBgB,kBAAmB,WAGrB/B,MAAO3H,EAAmBT,KAAWA,EAAMqI,WAEhBqB,GAG5BzT,GAAMU,UAAUK,WAAU,SAAU7b,EAAOsc,GAC1C,GAAItc,EAEH,OADA6f,EAAawN,eAAc,GACpB1L,EAAU3hB,MAAMA,IAExB6tB,EAAc,CACbZ,OAAO,EACPf,MAAO,CACNf,UAAW,CACV6D,kBAAmB,UACnBJ,SAAU7tB,OAAO8tB,OAAOrsB,MACxBgM,UAAWzN,OAAO8tB,OAAOpsB,OACzBqsB,aAAcjK,EAAMmJ,qBACpBe,aAAclK,EAAMmJ,sBAErBtH,SAAU,CACT,CAACiI,iBAAiB,GAClB,CAACM,+BAA+B,OAIvB/C,MAAMf,UAAU+D,oBAAsB5S,EAClDkS,EAAeX,EAAaU,EAC3BjJ,EAAmBT,KAAWA,EAAMqI,mBAGjC,GAAkD,YAA/CpS,GAAMuL,cAAcC,eAAeC,QAAuB,CACnE,KAAGzL,GAAMuL,cAAcC,eAAeE,SAAW,IA2B1C,CACN,IAAIxmB,EAAQ,IAAIic,MAAM,2BAItB,OAHAjc,EAAMmB,KAAO,+GACb0e,EAAawN,eAAc,QAC3B1L,EAAU3hB,MAAMA,GAtBhBwuB,EAPAX,EAAc,CACb3B,MAAO,CACNiD,eAAgBtK,EAAMqH,MACtBkD,YAAavK,EAAMqH,OAEpBe,MAAO3H,EAAmBT,KAAWA,EAAMqI,YAEhB,SAAU3T,EAAKuL,GAG1C,GAFAyJ,EAAkBhV,EAAKuL,IAElBvL,EACJ,IAAIjF,EAAWwQ,EAAOuK,YAClBC,EAAQvuB,OAAOwuB,aAAY,WAC1BzK,GACH/jB,OAAOyuB,cAAcF,GACnBxK,EAAOuK,aAAe/a,IACxBvT,OAAOyuB,cAAcF,GAClBxK,EAAOyD,SACTzD,EAAOyD,WAGTjU,EAAWwQ,EAAOuK,cAChB,QAWP,QAIExK,GAAyB,WAAhBA,EAAMqH,OAElBjR,UAAUC,aAAauU,mBAAmB7vB,MAAK,SAAS8vB,GACvD,IAAIC,EAAaD,EAAQE,MAAK,SAASC,GACtC,MAAuB,eAAhBA,EAAO5L,QAEf6L,EAslCJ,SAA6BjL,GAE5B,GADA/J,GAAMuC,MAAM,uBAAwBwH,IAC/BA,EACJ,OAAO,EACR,GAA2B,kBAAhBA,EAAMqH,OAAuD,kBAA1BrH,EAAMqH,MAAMf,UACzD,OAAO,EACR,IAAI0C,EAAchJ,EAAMqH,MAAMf,UAC9B,GAAI0C,EAAYmB,kBACf,MAAyC,YAAlCnB,EAAYmB,mBAAqE,WAAlCnB,EAAYmB,kBAC9D,GAAInB,EAAYsB,eACpB,MAAsC,WAA/BtB,EAAYsB,gBAA8D,WAA/BtB,EAAYsB,eAC1D,GAAItB,EAAYuB,YACpB,MAAmC,WAA5BvB,EAAYuB,aAAwD,WAA5BvB,EAAYuB,YAC5D,OAAO,EAnmCSW,CAAoBlL,IAAU6K,EAAQE,MAAK,SAASC,GAChE,MAAuB,eAAhBA,EAAO5L,QAIXuG,EAAYlF,EAAmBT,GAC/BgG,EAAY7E,EAAmBnB,GAC/BmL,EAwhCR,SAA6BnL,GAE5B,OADA/J,GAAMuC,MAAM,uBAAwBwH,KAChCA,KAEe,IAAhBA,EAAMoI,QAAuC,IAApBpI,EAAM2F,iBAEP3M,IAAxBgH,EAAMoL,eAAuD,OAAxBpL,EAAMoL,gBAEd,IAAxBpL,EAAMoL,gBAhiCWC,CAAoBrL,GACtCsL,EAwjCR,SAA6BtL,GAE5B,OADA/J,GAAMuC,MAAM,uBAAwBwH,KAChCA,KAEe,IAAhBA,EAAMqH,QAAuC,IAApBrH,EAAMgG,iBAEPhN,IAAxBgH,EAAMuL,eAAuD,OAAxBvL,EAAMuL,gBAEd,IAAxBvL,EAAMuL,gBAhkCWC,CAAoBxL,GAC1C,GAAG2F,GAAaK,GAAamF,GAAmBG,EAAiB,CAEhE,IAAIG,IAAkB9F,GAAYmF,EAC9BY,IAAkB1F,GAAYiF,EAClC,IAAIQ,IAAoBC,EAIvB,OAFA1Q,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,4BACT,EACD,IAAIswB,GAAmBN,EAG7B,OAFAnQ,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,2DACT,EACD,IAAIuwB,GAAmBJ,EAG7B,OAFAtQ,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,2DACT,EAIT,IAAIwwB,EAAiB,CACpBvD,SAAQ0C,GAAe9K,EAAMqI,YAAaY,EAC1C5B,SAAQ4D,GAAejL,EAAMsI,YAAaY,GAE3CjT,GAAMuC,MAAM,2BAA4BmT,GACnCA,EAAevD,OAAUuD,EAAetE,MAI5CjR,UAAUC,aAAamT,aAAamC,GAClC5wB,MAAK,SAASklB,GACdjF,EAAawN,eAAc,GAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,MAC5C/kB,OAAM,SAASC,GACjB6f,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAM,CAAC+gB,KAAM/gB,EAAM+gB,KAAM5f,KAAMnB,EAAMmB,KAAMihB,QAASpiB,EAAMoiB,cATtEvC,EAAawN,eAAc,GAC3BzI,EAAYzC,EAAUlB,EAAM4D,EAAOlD,EAAWmD,OAY/C/kB,OAAM,SAASC,GACf6f,EAAawN,eAAc,GAC3B1L,EAAU3hB,MAAMA,WAKlB4kB,EAAYzC,EAAUlB,EAAM4D,EAAOlD,GAIrC,SAAS8O,EAAkBtO,EAAUR,IACpCA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQgtB,EAC7ErL,EAAU0I,aAAiD,mBAA1B1I,EAAU0I,aAA8B1I,EAAU0I,aAAevP,GAAM4B,KACxG,IAAIuE,EAAOU,EAAUV,KACjBpB,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAGjC,OAFAjF,GAAM6E,KAAK,uBACXgC,EAAU3hB,MAAM,kBAGjB,IAAI0Y,EAASmH,EAAaE,YAC1B,GAAGkB,EAAM,CACR,IAAIvI,EAAOsH,GAGV,OAFAlF,GAAM6E,KAAK,kGACXgC,EAAU3hB,MAAM,sFAGjB2hB,EAAU0I,aAAapJ,GACvBvI,EAAOsH,GAAGoK,qBAAqBnJ,GAC7BrhB,MAAK,WAIL,GAHAkb,GAAMjd,IAAI,gCACV6a,EAAOuH,UAAYgB,EAAKoB,IAErB3J,EAAO2H,YAAc3H,EAAO2H,WAAW5iB,OAAS,EAAG,CACrD,IAAI,IAAIH,EAAI,EAAGA,EAAGob,EAAO2H,WAAW5iB,OAAQH,IAAK,CAChD,IAAIwiB,EAAYpH,EAAO2H,WAAW/iB,GAClCwd,GAAMuC,MAAM,2BAA4ByC,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BxH,EAAOsH,GAAGG,gBAAgBL,GAH1BpH,EAAOsH,GAAGG,gBAAgBrF,GAAMsF,iBAMlC1H,EAAO2H,WAAa,GAGrBsB,EAAUlF,YACRkF,EAAU3hB,YAEd2hB,EAAU3hB,MAAM,gBAmelB,SAAS0wB,EAAUvO,EAAUwO,GAC5B,IAAI9Q,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,kBACJ,EAER,IAAImF,EAAS6L,EAAS,SAAW,QAC7BjY,EAASmH,EAAaE,YAK1B,OAJIrH,EAAO2O,OAAOvC,KACjBpM,EAAO2O,OAAOvC,GAAU,CAAE7c,MAAO,KAG/ByQ,EAAOsH,GAAGoH,UAA4D,WAA/CtM,GAAMuL,cAAcC,eAAeC,SACZ,WAA/CzL,GAAMuL,cAAcC,eAAeC,SA4BpCzL,GAAM6E,KAAK,eAAiBmF,EAAS,kCAC9B,GA5BJ6L,IAAWjY,EAAO2P,cACpBvN,GAAM6E,KAAK,6BACJ,GACGgR,GAAWjY,EAAOyM,SAIzBzM,EAAO2O,OAAOvC,GAAQ8L,MAgBnBlY,EAAO2O,OAAOvC,GAAQ7c,OAf5B6S,GAAMjd,IAAI,YAAcinB,EAAS,mBACjCpM,EAAO2O,OAAOvC,GAAQ8L,MAAQrB,aAAY,WACzC7W,EAAOsH,GAAGoH,WACRxnB,MAAK,SAASixB,GACdA,EAAMtH,SAAQ,SAAUlQ,GACnBA,GAAoB,UAAbA,EAAI4K,OAEX0M,IAAWtX,EAAIyX,eAAmBH,GAAuB,iBAAbtX,EAAItb,OAEpD2a,EAAO2O,OAAOvC,GAAQ7c,MAASoR,EAAI0X,WAAa1X,EAAI0X,WAAa,YAGlE,KACI,IAjBPjW,GAAM6E,KAAK,4BACJ,GA2BV,SAASqR,EAAQ7O,EAAU+J,GAC1B,IAAIrM,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,mBACJ,EAER,IAAIjH,EAASmH,EAAaE,YAC1B,OAAIrH,EAAOsH,GAIPtH,EAAOyM,SAIR+G,EAEExT,EAAOyM,SAASF,kBAAgE,IAA5CvM,EAAOyM,SAASF,iBAAiBxnB,QAIjEib,EAAOyM,SAASF,iBAAiB,GAAGgM,SAH3CnW,GAAM6E,KAAK,mBACJ,GAKJjH,EAAOyM,SAASH,kBAAgE,IAA5CtM,EAAOyM,SAASH,iBAAiBvnB,QAIjEib,EAAOyM,SAASH,iBAAiB,GAAGiM,SAH3CnW,GAAM6E,KAAK,mBACJ,IAdR7E,GAAM6E,KAAK,8BACJ,IALP7E,GAAM6E,KAAK,2BACJ,GAuBT,SAASuR,EAAK/O,EAAU+J,EAAOgF,GAC9B,IAAIrR,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,mBACJ,EAER,IAAIjH,EAASmH,EAAaE,YAC1B,OAAIrH,EAAOsH,GAIPtH,EAAOyM,SAIR+G,EAEExT,EAAOyM,SAASF,kBAAgE,IAA5CvM,EAAOyM,SAASF,iBAAiBxnB,QAIzEib,EAAOyM,SAASF,iBAAiB,GAAGgM,SAAWC,GACxC,IAJNpW,GAAM6E,KAAK,mBACJ,GAMJjH,EAAOyM,SAASH,kBAAgE,IAA5CtM,EAAOyM,SAASH,iBAAiBvnB,QAIzEib,EAAOyM,SAASH,iBAAiB,GAAGiM,SAAWC,GACxC,IAJNpW,GAAM6E,KAAK,mBACJ,IAfR7E,GAAM6E,KAAK,8BACJ,IALP7E,GAAM6E,KAAK,2BACJ,GAyBT,SAASwR,EAAWhP,GACnB,IAAItC,EAAehB,EAAcsD,GACjC,IAAItC,IAAiBA,EAAaE,YAEjC,OADAjF,GAAM6E,KAAK,kBACJ,iBAER,IAAIjH,EAASmH,EAAaE,YAC1B,OAAIrH,EAAOsH,GAGRtH,EAAOsH,GAAGoH,SACR1O,EAAO4O,QAAQsJ,MA8CZlY,EAAO4O,QAAQrf,OA7CrB6S,GAAMjd,IAAI,yCACV6a,EAAO4O,QAAQsJ,MAAQrB,aAAY,WAClC7W,EAAOsH,GAAGoH,WACRxnB,MAAK,SAASixB,GACdA,EAAMtH,SAAQ,SAAUlQ,GACvB,GAAIA,EAAJ,CAEA,IAAI+X,GAAU,EAYd,IAVsB,UAAlB/X,EAAIgY,WAAyBhY,EAAIlZ,GAAGmxB,cAAcxf,QAAQ,UAAY,IAC3D,gBAAbuH,EAAItb,MAA0Bsb,EAAIlZ,GAAG2R,QAAQ,QAAU,EAExDsf,GAAU,EACW,QAAZ/X,EAAItb,OAAkBsb,EAAIkY,eACX,QAAtBlY,EAAImY,eAAiD,KAAtBnY,EAAImY,gBAErCJ,GAAU,GAGRA,EAGF,GAFA1Y,EAAO4O,QAAQmK,MAAQpY,EAAIkY,cAC3B7Y,EAAO4O,QAAQoK,MAAQrY,EAAIsY,UACI,OAA5BjZ,EAAO4O,QAAQsK,UAAiD,OAA5BlZ,EAAO4O,QAAQuK,SAErDnZ,EAAO4O,QAAQsK,SAAWlZ,EAAO4O,QAAQmK,MACzC/Y,EAAO4O,QAAQuK,SAAWnZ,EAAO4O,QAAQoK,UACnC,CAEN,IAAII,EAAapZ,EAAO4O,QAAQoK,MAAQhZ,EAAO4O,QAAQuK,SACL,WAA/C/W,GAAMuL,cAAcC,eAAeC,UACrCuL,GAAwB,KACzB,IAAIC,EAAUjZ,KAAKC,MAAyD,GAAlDL,EAAO4O,QAAQmK,MAAQ/Y,EAAO4O,QAAQsK,UAAgBE,GAC9B,WAA/ChX,GAAMuL,cAAcC,eAAeC,UACrCwL,EAAUzW,SAASyW,EAAQ,MAC5BrZ,EAAO4O,QAAQrf,MAAQ8pB,EAAU,aAEjCrZ,EAAO4O,QAAQsK,SAAWlZ,EAAO4O,QAAQmK,MACzC/Y,EAAO4O,QAAQuK,SAAWnZ,EAAO4O,QAAQoK,gBAK5C,KACI,gBAIR5W,GAAM6E,KAAK,oDACJ,kCApDA,yBAwDT,SAASqN,EAAYhtB,GACpB8a,GAAM9a,MAAM,gBAAiBA,GAG9B,SAAS2kB,EAAcxC,EAAU6P,GAChClX,GAAMjd,IAAI,yBACV,IAAIgiB,EAAehB,EAAcsD,GACjC,GAAItC,EAAJ,CAIA,IAAInH,EAASmH,EAAaE,YAC1B,GAAGrH,EAAQ,CACV,IAAqB,IAAlBsZ,EAAwB,CAE1B,IAAI1Q,EAAU,CAAE,MAAS,SAAU,YAAexG,GAAMyG,aAAa,KAClE1B,EAAa3gB,QACfoiB,EAAO,MAAYzB,EAAa3gB,OAC9B8e,IACFsD,EAAO,UAAgBtD,GACxBlD,GAAMuC,MAAM,kCAAoC8E,EAAW,MAC3DrH,GAAMuC,MAAMiE,GACTxE,GACFwE,EAAO,WAAiB1C,EACxB0C,EAAO,UAAgBa,EACvBpF,EAAGxJ,KAAKiO,KAAKC,UAAUH,KAEvBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAY,IAAMuD,EAAU,CAC5D7C,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,IAKT5I,EAAO2P,aAAe,KACnB3P,EAAO2O,SACN3O,EAAO2O,OAAP,OAA0B3O,EAAO2O,OAAP,MAAuBuJ,OACnDpB,cAAc9W,EAAO2O,OAAP,MAAuBuJ,OACnClY,EAAO2O,OAAP,QAA2B3O,EAAO2O,OAAP,OAAwBuJ,OACrDpB,cAAc9W,EAAO2O,OAAP,OAAwBuJ,QAExClY,EAAO2O,OAAS,GACb3O,EAAO4O,QAAQsJ,OACjBpB,cAAc9W,EAAO4O,QAAQsJ,OAC9BlY,EAAO4O,QAAQsJ,MAAQ,KACvBlY,EAAO4O,QAAQmK,MAAQ,KACvB/Y,EAAO4O,QAAQsK,SAAW,KAC1BlZ,EAAO4O,QAAQoK,MAAQ,KACvBhZ,EAAO4O,QAAQuK,SAAW,KAC1BnZ,EAAO4O,QAAQrf,MAAQ,MACnByQ,EAAO2M,gBAAkB3M,EAAOyM,WACnCrK,GAAMjd,IAAI,gCACVid,GAAMiK,cAAcrM,EAAOyM,WAE5BzM,EAAO2M,gBAAiB,EACxB3M,EAAOyM,SAAW,KAElB,IACCzM,EAAOsH,GAAGmB,QACT,MAAMpZ,IAGR2Q,EAAOsH,GAAK,KACZtH,EAAO2H,WAAa,KACpB3H,EAAOmP,MAAQ,KACfnP,EAAOuH,UAAY,KACnBvH,EAAOkP,SAAU,EACjBlP,EAAOwK,YAAc,GACrBxK,EAAOkL,WAAa,KACpBlL,EAAOuO,iBAAmB,KAC1BvO,EAAOwO,mBAAqB,KAE7BrH,EAAaoS,aAkNd,SAAS3M,EAAmBT,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMoI,aAEcpP,IAApBgH,EAAM2F,WAA+C,OAApB3F,EAAM2F,YAEd,IAApB3F,EAAM2F,WAcf,SAASE,EAAmB7F,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMoI,aAEcpP,IAApBgH,EAAM4F,WAA+C,OAApB5F,EAAM4F,YAEd,IAApB5F,EAAM4F,WAGf,SAASzE,EAAmBnB,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMqH,aAEcrO,IAApBgH,EAAMgG,WAA+C,OAApBhG,EAAMgG,YAEd,IAApBhG,EAAMgG,WAcf,SAASE,EAAmBlG,GAE3B,OADA/J,GAAMuC,MAAM,sBAAuBwH,IAC/BA,IAEe,IAAhBA,EAAMqH,aAEcrO,IAApBgH,EAAMiG,WAA+C,OAApBjG,EAAMiG,YAEd,IAApBjG,EAAMiG,WAlgGfpJ,EAAclF,GAGdnf,KAAK60B,UAAY,WAAa,OAAOrzB,GACrCxB,KAAK80B,YAAc,WAAa,OAAOxT,GACvCthB,KAAKsV,UAAY,SAASgP,IACzBA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAS,WAAgB,EACzBD,EAAcC,IAEftkB,KAAK+0B,aAAe,WAAa,OAAOxT,GACxCvhB,KAAKg1B,QAAU,SAAS1Q,IAqaxB,SAAiBA,GAMhB,IALAA,EAAYA,GAAa,IAEflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF5B,GAAMjd,IAAI,mCACN8gB,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAIjB,IAAI6gB,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,OAAQ,YAAeT,GAC7C3hB,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,GACxB,GAAGlB,EAUF,OATAkC,EAAa6B,GAAe,SAASvX,GACpCwR,GAAMjd,IAAI,gBACVid,GAAMuC,MAAM/T,GACS,gBAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAElEukB,EAAUlF,QAAQnT,SAEnByT,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAQ,CACzBygB,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMjd,IAAI,gBACVid,GAAMuC,MAAM/T,GACS,gBAAlBA,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAElEukB,EAAUlF,QAAQnT,IAEnBtJ,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GACX,KAAhBA,EACFiC,EAAU3hB,MAAMyf,EAAa,yBAE7BkC,EAAU3hB,MAAMyf,EAAa,KAAOC,MApdH2S,CAAQ1Q,IAC7CtkB,KAAKi1B,QAAU,SAAS3Q,IAydxB,SAAwBA,IACvBA,EAAYA,GAAa,IAEflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnF,IAAI6V,GAA+B,IAArB5Q,EAAU4Q,OACpBC,GAAkB,OACW3U,IAA9B8D,EAAU6Q,iBAA+D,OAA9B7Q,EAAU6Q,kBACvDA,GAAiD,IAA9B7Q,EAAU6Q,iBAC9B,IAAIC,GAA+C,IAA7B9Q,EAAU8Q,eAEhC,GADA3X,GAAMjd,IAAI,sBAAwB+gB,EAAY,YAAc2T,EAAS,MACjE3T,EAKH,OAJA9D,GAAM6E,KAAK,yBACXgC,EAAUlF,eACP+V,GACFhW,EAAiBG,aAGnB,GAAG8V,EACF,IAAI,IAAItQ,KAAYtD,EACnB4F,EAActC,EAAU,CAAEuC,WAAW,IAEvC,IAAI/F,EAIH,OAHA7D,GAAM6E,KAAK,yCACXf,EAAY,UACZ+C,EAAUlF,UAIX,IAAI6E,EAAU,CAAE,MAAS,UAAW,YAAexG,GAAMyG,aAAa,KACnEriB,IACFoiB,EAAO,MAAYpiB,GACjB8e,IACFsD,EAAO,UAAgBtD,GACxB,GAAGuU,EAgBF,OAbGzV,GACFC,EAAG+E,QAAU,KACb/E,EAAGoE,QACHpE,EAAK,MAEL9B,UAAUyX,WAAW7zB,EAAS,IAAM+f,EAAW4C,KAAKC,UAAUH,IAE/DxG,GAAMjd,IAAI,sBACV+gB,EAAY,KACZD,GAAY,EACZgD,EAAUlF,eACP+V,GACFhW,EAAiBG,aAGnB,GAAGG,EAAY,CACdwE,EAAO,WAAiB1C,EAExB,IAAI+T,EAAkB,WACrB,IAAI,IAAI5Q,KAAa/E,EACpBD,EAAG9H,oBAAoB8M,EAAW/E,EAAW+E,IAE9ChF,EAAG9H,oBAAoB,UAAW2d,GAClC7V,EAAG9H,oBAAoB,QAAS4d,GAC7B5V,GACFV,aAAaU,GAEdF,EAAGoE,SAGAyR,EAAkB,SAAS5tB,GAC9B,IAAIxH,EAAOgkB,KAAK1T,MAAM9I,EAAMxH,MACzBA,EAAKs1B,YAAcxR,EAAQwR,YAAct1B,EAAKqjB,aAAeS,EAAQT,cACvE8R,IACAhR,EAAUlF,UACP+V,GACFhW,EAAiBG,cAGhBkW,EAAgB,SAAS7tB,GAC5B2tB,IACAhR,EAAU3hB,MAAM,qDACbwyB,GACFhW,EAAiBG,aAYnB,OATAI,EAAG/H,iBAAiB,UAAW4d,GAC/B7V,EAAG/H,iBAAiB,QAAS6d,QAEP,IAAlB9V,EAAGoG,WACNpG,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAEvBuR,KAKF/X,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAW,CAC3CU,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GACjBwR,GAAMjd,IAAI,sBACVid,GAAMuC,MAAM/T,GACZsV,EAAY,KACZD,GAAY,EACS,YAAlBrV,EAAI,OACNwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAElEukB,EAAUlF,UACP+V,GACFhW,EAAiBG,aAEnB3c,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GAE9Bd,EAAY,KACZD,GAAY,EACZgD,EAAUlF,UACP+V,GACFhW,EAAiBG,eA9kBgBoW,CAAepR,IACpDtkB,KAAK21B,OAAS,SAASrR,IAmlBvB,SAAsBA,GAgBrB,IAfAA,EAAYA,GAAa,IACflF,QAAuC,mBAArBkF,EAAUlF,QAAyBkF,EAAUlF,QAAU3B,GAAM4B,KACzFiF,EAAU3hB,MAAmC,mBAAnB2hB,EAAU3hB,MAAuB2hB,EAAU3hB,MAAQ8a,GAAM4B,KACnFiF,EAAU0L,cAAmD,mBAA3B1L,EAAU0L,cAA+B1L,EAAU0L,cAAgBvS,GAAM4B,KAC3GiF,EAAU8F,SAAyC,mBAAtB9F,EAAU8F,SAA0B9F,EAAU8F,SAAW3M,GAAM4B,KAC5FiF,EAAUhB,WAA6C,mBAAxBgB,EAAUhB,WAA4BgB,EAAUhB,WAAa7F,GAAM4B,KAClGiF,EAAUrB,YAA+C,mBAAzBqB,EAAUrB,YAA6BqB,EAAUrB,YAAcxF,GAAM4B,KACrGiF,EAAUf,SAAyC,mBAAtBe,EAAUf,SAA0Be,EAAUf,SAAW9F,GAAM4B,KAC5FiF,EAAUT,UAA2C,mBAAvBS,EAAUT,UAA2BS,EAAUT,UAAYpG,GAAM4B,KAC/FiF,EAAUwI,cAAmD,mBAA3BxI,EAAUwI,cAA+BxI,EAAUwI,cAAgBrP,GAAM4B,KAC3GiF,EAAU2G,eAAqD,mBAA5B3G,EAAU2G,eAAgC3G,EAAU2G,eAAiBxN,GAAM4B,KAC9GiF,EAAU4B,OAAqC,mBAApB5B,EAAU4B,OAAwB5B,EAAU4B,OAASzI,GAAM4B,KACtFiF,EAAUyB,WAA6C,mBAAxBzB,EAAUyB,WAA4BzB,EAAUyB,WAAatI,GAAM4B,KAClGiF,EAAUsQ,UAA2C,mBAAvBtQ,EAAUsQ,UAA2BtQ,EAAUsQ,UAAYnX,GAAM4B,KAC/FiF,EAAUlB,WAA6C,mBAAxBkB,EAAUlB,WAA4BkB,EAAUlB,WAAa3F,GAAM4B,MAC9FiC,EAGH,OAFA7D,GAAM6E,KAAK,8CACXgC,EAAU3hB,MAAM,yCAGjB,IAAIizB,EAAStR,EAAUsR,OACvB,IAAIA,EAGH,OAFAnY,GAAM9a,MAAM,uBACZ2hB,EAAU3hB,MAAM,kBAGjB,IAAIkzB,EAAWvR,EAAUuR,SACrBC,EAAcxR,EAAUziB,MAAQyiB,EAAUziB,MAAQA,EAClD2hB,EAAc/F,GAAMyG,aAAa,IACjCD,EAAU,CAAE,MAAS,SAAU,OAAU2R,EAAQ,UAAaC,EAAU,YAAerS,GACxFsS,IACF7R,EAAO,MAAY6R,GACjBnV,IACFsD,EAAO,UAAgBtD,GACxB,GAAGlB,EAgFF,OA/EAkC,EAAa6B,GAAe,SAASvX,GAEpC,GADAwR,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAGN,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAGtE,IAAI+kB,EAAW7Y,EAAK9L,KAAL,GACfsd,GAAMjd,IAAI,mBAAqBskB,GAC/B,IAAItC,EACH,CACCuT,QAAUtU,EACVmU,OAASA,EACT9yB,GAAKgiB,EACLjjB,MAAQi0B,EACR3S,UAAW,EACXT,YAAc,CACbsT,SAAU,EACVlO,SAAW,KACXE,gBAAiB,EACjBgD,aAAe,KACfR,MAAQ,KACR0C,iBAAmB,KACnBvK,GAAK,KACLkD,YAAc,GACdU,WAAa,KACb2D,SAAU,EACVK,SAAU,EACVP,OAAS,CACRpf,MAAQ,KACR2oB,MAAQ,MAETtJ,QAAU,CACTrf,MAAQ,KACRwpB,MAAQ,KACRG,SAAW,KACXF,MAAQ,KACRG,SAAW,KACXjB,MAAQ,OAGV0C,MAAQ,WAAa,OAAOnR,GAC5BoR,UAAY,WAAa,OAAON,GAChCvC,UAAY,WAAa,OAAOA,EAAUvO,GAAU,IACpDqR,gBAAkB,WAAa,OAAO9C,EAAUvO,GAAU,IAC1DsR,eAAiB,WAAa,OAAO/C,EAAUvO,GAAU,IACzDuR,aAAe,WAAa,OAAO1C,EAAQ7O,GAAU,IACrDwR,UAAY,WAAa,OAAOzC,EAAK/O,GAAU,GAAO,IACtDyR,YAAc,WAAa,OAAO1C,EAAK/O,GAAU,GAAO,IACxD0R,aAAe,WAAa,OAAO7C,EAAQ7O,GAAU,IACrD2R,UAAY,WAAa,OAAO5C,EAAK/O,GAAU,GAAM,IACrD4R,YAAc,WAAa,OAAO7C,EAAK/O,GAAU,GAAM,IACvDgP,WAAa,WAAa,OAAOA,EAAWhP,IAC5C5O,KAAO,SAASoO,GAAaO,EAAYC,EAAUR,IACnDnkB,KAAO,SAASmkB,GAAa6B,EAASrB,EAAUR,IAChDuC,KAAO,SAASvC,GAAagC,EAASxB,EAAUR,IAChD0L,cAAgB1L,EAAU0L,cAC1B5F,SAAW9F,EAAU8F,SACrB9G,WAAagB,EAAUhB,WACvBL,YAAcqB,EAAUrB,YACxBM,SAAWe,EAAUf,SACrBM,UAAYS,EAAUT,UACtB6K,YAAc,SAASpK,GAAaoL,EAAc5K,GAAU,EAAMR,IAClEgK,aAAe,SAAShK,GAAaoL,EAAc5K,GAAU,EAAOR,IACpEqS,iBAAmB,SAASrS,GAAa8O,EAAkBtO,EAAUR,IACrEwI,cAAgBxI,EAAUwI,cAC1B7B,eAAiB3G,EAAU2G,eAC3B/E,OAAS5B,EAAU4B,OACnBH,WAAazB,EAAUyB,WACvB6O,UAAYtQ,EAAUsQ,UACtBxR,WAAakB,EAAUlB,WACvBF,OAAS,SAAS0T,GAAetP,EAAcxC,GAA0B,IAAhB8R,IACzDvT,OAAS,SAASiB,GAAa8C,EAActC,EAAUR,KAEzD9C,EAAcsD,GAAYtC,EAC1B8B,EAAUlF,QAAQoD,IAEnByB,EAAO,WAAiB1C,OACxB7B,EAAGxJ,KAAKiO,KAAKC,UAAUH,IAGxBxG,GAAMuE,YAAYxgB,EAAS,IAAM+f,EAAW,CAC3CU,KAAM,OACN1B,gBAAiBA,EACjBqE,KAAMX,EACN7E,QAAS,SAASnT,GAEjB,GADAwR,GAAMuC,MAAM/T,GACS,YAAlBA,EAAI,MAGN,OAFAwR,GAAM9a,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,aACjEukB,EAAU3hB,MAAM,UAAYsJ,EAAI,MAAUyX,KAAO,IAAMzX,EAAI,MAAUlM,QAGtE,IAAI+kB,EAAW7Y,EAAK9L,KAAL,GACfsd,GAAMjd,IAAI,mBAAqBskB,GAC/B,IAAItC,EACH,CACCuT,QAAUtU,EACVmU,OAASA,EACT9yB,GAAKgiB,EACLjjB,MAAQi0B,EACR3S,UAAW,EACXT,YAAc,CACbsT,SAAU,EACVlO,SAAW,KACXE,gBAAiB,EACjBgD,aAAe,KACfR,MAAQ,KACR0C,iBAAmB,KACnBvK,GAAK,KACLkD,YAAc,GACdU,WAAa,KACb2D,SAAU,EACVK,SAAU,EACVP,OAAS,CACRpf,MAAQ,KACR2oB,MAAQ,MAETtJ,QAAU,CACTrf,MAAQ,KACRwpB,MAAQ,KACRG,SAAW,KACXF,MAAQ,KACRG,SAAW,KACXjB,MAAQ,OAGV0C,MAAQ,WAAa,OAAOnR,GAC5BoR,UAAY,WAAa,OAAON,GAChCvC,UAAY,WAAa,OAAOA,EAAUvO,GAAU,IACpDqR,gBAAkB,WAAa,OAAO9C,EAAUvO,GAAU,IAC1DsR,eAAiB,WAAa,OAAO/C,EAAUvO,GAAU,IACzDuR,aAAe,WAAa,OAAO1C,EAAQ7O,GAAU,IACrDwR,UAAY,WAAa,OAAOzC,EAAK/O,GAAU,GAAO,IACtDyR,YAAc,WAAa,OAAO1C,EAAK/O,GAAU,GAAO,IACxD0R,aAAe,WAAa,OAAO7C,EAAQ7O,GAAU,IACrD2R,UAAY,WAAa,OAAO5C,EAAK/O,GAAU,GAAM,IACrD4R,YAAc,WAAa,OAAO7C,EAAK/O,GAAU,GAAM,IACvDgP,WAAa,WAAa,OAAOA,EAAWhP,IAC5C5O,KAAO,SAASoO,GAAaO,EAAYC,EAAUR,IACnDnkB,KAAO,SAASmkB,GAAa6B,EAASrB,EAAUR,IAChDuC,KAAO,SAASvC,GAAagC,EAASxB,EAAUR,IAChD0L,cAAgB1L,EAAU0L,cAC1B5F,SAAW9F,EAAU8F,SACrB9G,WAAagB,EAAUhB,WACvBL,YAAcqB,EAAUrB,YACxBM,SAAWe,EAAUf,SACrBM,UAAYS,EAAUT,UACtB6K,YAAc,SAASpK,GAAaoL,EAAc5K,GAAU,EAAMR,IAClEgK,aAAe,SAAShK,GAAaoL,EAAc5K,GAAU,EAAOR,IACpEqS,iBAAmB,SAASrS,GAAa8O,EAAkBtO,EAAUR,IACrEwI,cAAgBxI,EAAUwI,cAC1B7B,eAAiB3G,EAAU2G,eAC3B/E,OAAS5B,EAAU4B,OACnBH,WAAazB,EAAUyB,WACvB6O,UAAYtQ,EAAUsQ,UACtBxR,WAAakB,EAAUlB,WACvBF,OAAS,SAAS0T,GAAetP,EAAcxC,GAA0B,IAAhB8R,IACzDvT,OAAS,SAASiB,GAAa8C,EAActC,EAAUR,KAEzD9C,EAAcsD,GAAYtC,EAC1B8B,EAAUlF,QAAQoD,IAEnB7f,MAAO,SAASyf,EAAYC,GAC3B5E,GAAM9a,MAAMyf,EAAa,IAAKC,GACX,KAAhBA,EACFiC,EAAU3hB,MAAMyf,EAAa,yBAE7BkC,EAAU3hB,MAAMyf,EAAa,KAAOC,MA9xBJwU,CAAavS,IAndlD7G,GAAMqZ,uBAAyB,SAAUC,GACxC,IAAIC,EAAKD,GAAQA,EAAKhrB,OAAUA,MAC5BkrB,EAAKF,GAAQA,EAAKna,SAAYA,QAC9Bsa,EAAaH,GAAQA,EAAKI,WAAcA,UAE5C,MAAO,CACNxS,aAAc,SAASnjB,EAAQ41B,GAAS,OAAO,IAAIF,EAAU11B,EAAQ41B,IACrEjZ,UAAY4Y,GAAQA,EAAK5Y,WAAcE,GACvC0B,QAAS,SAASsX,GAAO,OAAOC,MAAMvX,QAAQsX,IAC9CrO,cAAgB+N,GAAQA,EAAKQ,SAAYA,KACzCvV,YAAa,SAASjK,EAAK3N,GAC1B,IAAIotB,EAAe,CAClBC,OAAQrtB,EAAQ6X,KAChB3f,QAAS,CACR,OAAU,qCAEXuc,MAAO,YAEY,SAAjBzU,EAAQ6X,OACVuV,EAAal1B,QAAQ,gBAAkB,yBAETke,IAA5BpW,EAAQmW,kBACViX,EAAaE,aAA0C,IAA5BttB,EAAQmW,gBAA2B,UAAanW,EAAQmW,gBAAkBnW,EAAQmW,gBAAkB,QAE7HnW,EAAQwa,OACV4S,EAAa5S,KAAOT,KAAKC,UAAUha,EAAQwa,OAG5C,IAAI+S,EAAWX,EAAEjf,EAAKyf,GAAc90B,OAAM,SAASC,GAClD,OAAOs0B,EAAEna,OAAO,CAACiI,QAAS,gDAAiDpiB,MAAOA,OAQnF,GAAGyH,EAAQ+X,QAAS,CACnB,IAAIA,EAAU,IAAI8U,GAAE,SAASpa,EAASC,GACrC,IAAI8a,EAAUjZ,YAAW,WAExB,OADAO,aAAa0Y,GACN9a,EAAO,CAACiI,QAAS,oBAAqB5C,QAAS/X,EAAQ+X,YAC5D/X,EAAQ+X,YAEZwV,EAAWV,EAAEY,KAAK,CAACF,EAAUxV,IA0B9B,OAvBAwV,EAASp1B,MAAK,SAASC,GACtB,OAAGA,EAASs1B,UACD1tB,EAAQgV,iBAAoB3B,GAAM4B,KACpC7c,EAASyJ,OAAO1J,MAAK,SAASqT,GACpC,IACCxL,EAAQgV,QAAQxJ,GACf,MAAMjT,GACP8a,GAAM9a,MAAM,+CAAgDA,OAE3D,SAASA,GACX,OAAOs0B,EAAEna,OAAO,CAACiI,QAAS,gCAAiCpiB,MAAOA,EAAOH,SAAUA,YARrF,EAaOy0B,EAAEna,OAAO,CAACiI,QAAS,kBAAmBviB,SAAUA,OAEtDE,OAAM,SAASC,UACPyH,EAAQzH,eAAkB8a,GAAM4B,MACzCjV,EAAQzH,MAAMA,EAAMoiB,SAAW,uBAAwBpiB,MAIlDg1B,KAKVla,GAAMsa,mBAAqB,SAAUhB,GACpC,IAAIiB,EAAMjB,GAAQA,EAAKkB,QAAWA,IAC9Bf,EAAaH,GAAQA,EAAKI,WAAcA,UAC5C,MAAO,CACNxS,aAAc,SAASnjB,EAAQ41B,GAAS,OAAO,IAAIF,EAAU11B,EAAQ41B,IACrErX,QAAS,SAASsX,GAAO,OAAOW,EAAGjY,QAAQsX,IAC3ClZ,UAAY4Y,GAAQA,EAAK5Y,WAAcE,GACvC2K,cAAgB+N,GAAQA,EAAKQ,SAAYA,KACzCvV,YAAa,SAASjK,EAAK3N,GAC1B,IAAI8tB,OAA2B1X,IAAjBpW,EAAQwa,KAAqB,CAC1CuT,YAAa,mBACbh4B,KAAMgkB,KAAKC,UAAUha,EAAQwa,OAC1B,GACA8S,OAA0ClX,IAA5BpW,EAAQmW,gBAAgC,CAAC6X,UAAW,CAAC7X,gBAAiBnW,EAAQmW,kBAAoB,GAEpH,OAAOyX,EAAGK,KAAKL,EAAGM,OAAOJ,EAASR,EAAa,CAC9C3f,IAAKA,EACLrX,KAAM0J,EAAQ6X,KACdpD,OAAO,EACP0Z,SAAU,OACVC,MAAOpuB,EAAQouB,MACfrW,QAAS/X,EAAQ+X,QACjB/C,QAAS,SAASnX,UACPmC,EAAQgV,iBAAoB3B,GAAM4B,MAC3CjV,EAAQgV,QAAQnX,IAGlBtF,MAAO,SAAS81B,EAAKC,EAAQxc,UAClB9R,EAAQzH,eAAkB8a,GAAM4B,MACzCjV,EAAQzH,MAAM+1B,EAAQxc,UAQ5BuB,GAAM4B,KAAO,aAEb5B,GAAM4I,qBAAuB,mBAI7B5I,GAAMsF,gBAAkB,KAGxBtF,GAAMiK,cAAgB,SAASD,GAC9B,IAEC,IAFG,EAECkR,EAASlR,EAAOwE,YAFjB,eAGY0M,GAHZ,IAGH,IAAI,EAAJ,qBAAuB,CAAC,IAAhBC,EAAe,QACtBnb,GAAMjd,IAAIo4B,GACPA,GACFA,EAAIpiB,QANH,+BASF,MAAM9L,MAMT+S,GAAMsB,KAAO,SAAS3U,GAGrB,IAFAA,EAAUA,GAAW,IACbqU,SAAuC,mBAApBrU,EAAQqU,SAA0BrU,EAAQqU,SAAWhB,GAAM4B,KACnF5B,GAAM8B,SAERnV,EAAQqU,eACF,CAWN,GAVqB,oBAAXle,SAAgD,oBAAfA,QAAQC,MAClDD,QAAU,CAAEC,IAAK,eAGlBid,GAAMob,MAAQpb,GAAM4B,KACpB5B,GAAMuC,MAAQvC,GAAM4B,KACpB5B,GAAMsG,OAAStG,GAAM4B,KACrB5B,GAAMjd,IAAMid,GAAM4B,KAClB5B,GAAM6E,KAAO7E,GAAM4B,KACnB5B,GAAM9a,MAAQ8a,GAAM4B,MACC,IAAlBjV,EAAQ4V,OAAoC,QAAlB5V,EAAQ4V,MAEpCvC,GAAMob,MAAQt4B,QAAQs4B,MAAMv3B,KAAKf,SACjCkd,GAAMuC,MAAQzf,QAAQyf,MAAM1e,KAAKf,SACjCkd,GAAMsG,OAASxjB,QAAQyf,MAAM1e,KAAKf,SAClCkd,GAAMjd,IAAMD,QAAQC,IAAIc,KAAKf,SAC7Bkd,GAAM6E,KAAO/hB,QAAQ+hB,KAAKhhB,KAAKf,SAC/Bkd,GAAM9a,MAAQpC,QAAQoC,MAAMrB,KAAKf,cAC3B,GAAG+2B,MAAMvX,QAAQ3V,EAAQ4V,OAAQ,CAAC,IAAD,iBAC1B5V,EAAQ4V,OADkB,IACvC,IAAI,EAAJ,qBAA4B,CAAC,IAArBra,EAAoB,QAC3B,OAAOA,GACN,IAAK,QACJ8X,GAAMob,MAAQt4B,QAAQs4B,MAAMv3B,KAAKf,SACjC,MACD,IAAK,QACJkd,GAAMuC,MAAQzf,QAAQyf,MAAM1e,KAAKf,SACjC,MACD,IAAK,SACJkd,GAAMsG,OAASxjB,QAAQyf,MAAM1e,KAAKf,SAClC,MACD,IAAK,MACJkd,GAAMjd,IAAMD,QAAQC,IAAIc,KAAKf,SAC7B,MACD,IAAK,OACJkd,GAAM6E,KAAO/hB,QAAQ+hB,KAAKhhB,KAAKf,SAC/B,MACD,IAAK,QACJkd,GAAM9a,MAAQpC,QAAQoC,MAAMrB,KAAKf,SACjC,MACD,QACCA,QAAQoC,MAAM,6BAA+BgD,EAAI,sEAtBb,+BA2BxC8X,GAAMjd,IAAI,wBAEV,IAAIs4B,EAAmB1uB,EAAQ2uB,cAAgBtb,GAAMqZ,yBACrDrZ,GAAMsC,QAAU+Y,EAAiB/Y,QACjCtC,GAAMuL,cAAgB8P,EAAiB9P,cACvCvL,GAAMuE,YAAc8W,EAAiB9W,YACrCvE,GAAMkH,aAAemU,EAAiBnU,aACtClH,GAAMU,UAAY2a,EAAiB3a,UACnCV,GAAMU,UAAUY,OAGhBtB,GAAMub,YAAc,SAASva,EAAUpD,GACtCoD,EAA+B,mBAAZA,EAA0BA,EAAWhB,GAAM4B,KAChD,MAAVhE,IAAgBA,EAAS,CAAEuU,OAAO,EAAMf,OAAO,IAChDpR,GAAM8S,0BACR3S,UAAUC,aAAamT,aAAa3V,GACnC9Y,MAAK,SAASklB,GACd7J,UAAUC,aAAauU,mBAAmB7vB,MAAK,SAAS8vB,GACvD5U,GAAMuC,MAAMqS,GACZ5T,EAAS4T,GAET5U,GAAMiK,cAAcD,SAGrB/kB,OAAM,SAASwZ,GACfuB,GAAM9a,MAAMuZ,GACZuC,EAAS,QAGVhB,GAAM6E,KAAK,sCACX7D,EAAS,MAIXhB,GAAMwb,kBAAoB,SAASC,EAASzR,GAC3C,IACCyR,EAAQC,UAAY1R,EACnB,MAAO/c,GACR,IACCwuB,EAAQlwB,IAAMowB,IAAIC,gBAAgB5R,GACjC,MAAO/c,GACR+S,GAAM9a,MAAM,wCAIf8a,GAAM6b,oBAAsB,SAASC,EAAIC,GACxC,IACCD,EAAGJ,UAAYK,EAAKL,UACnB,MAAOzuB,GACR,IACC6uB,EAAGvwB,IAAMwwB,EAAKxwB,IACb,MAAO0B,GACR+S,GAAM9a,MAAM,0CAOf,IACI+hB,EADM,CAAC,OAAQ,SAAU,QAAQjQ,QAAQmJ,UAAU6b,WAAa,EAC9C,WAAa,eAC/BC,EAASh2B,OAAO,KAAOghB,GAe3B,GAdAhhB,OAAOiU,iBAAiB+M,GAAW,SAAS/c,GAE3C,IAAI,IAAIkJ,KADR4M,GAAMjd,IAAI,kBACGid,GAAMC,SACfD,GAAMC,SAAS7M,IAAM4M,GAAMC,SAAS7M,GAAG+P,kBACzCnD,GAAMjd,IAAI,sBAAwBqQ,GAClC4M,GAAMC,SAAS7M,GAAGokB,QAAQ,CAACC,QAAQ,EAAMC,iBAAiB,KAGzDuE,GAA2B,mBAAVA,GACnBA,OAIFjc,GAAMkc,WAAY,EACgC,WAA/Clc,GAAMuL,cAAcC,eAAeC,SACpCzL,GAAMuL,cAAcC,eAAeE,SAAW,IAE/C,GAAGI,cAAgBA,aAAaqQ,iBAAmBrQ,aAAaqQ,gBAAgB,UAC9ErQ,aAAaqQ,gBAAgB,SAASC,QAAUtQ,aAAaqQ,gBAAgB,SAASC,OAAOz5B,OAAQ,CAAC,IAAD,iBACrFmpB,aAAaqQ,gBAAgB,SAASC,QAD+C,IACtG,IAAI,EAAJ,qBAA+D,CAAC,IAAxDC,EAAuD,QAC9D,GAAGA,GAASA,EAAMC,UAA6C,cAAjCD,EAAMC,SAAS9F,cAA+B,CAC3ExW,GAAMkc,WAAY,EAClB,QAJoG,8BAOnGlc,GAAMkc,UACRlc,GAAMjd,IAAI,uCAEVid,GAAM6E,KAAK,kLAGN,CAGN,IAAI0X,EAAS,IAAIlQ,kBAAkB,IACnCkQ,EAAOtL,YAAY,CAACb,qBAAqB,IAAOtrB,MAAK,SAASosB,GAC7DlR,GAAMkc,WAA0C,IAA9BhL,EAAM3J,IAAIvQ,QAAQ,OACjCgJ,GAAMkc,UACRlc,GAAMjd,IAAI,uCAEVid,GAAM6E,KAAK,8KAGZ0X,EAAOlW,QACPkW,EAAS,QAOZ,GADAvc,GAAM4K,aAAc,EAC8B,YAA/C5K,GAAMuL,cAAcC,eAAeC,SACpCzL,GAAMuL,cAAcC,eAAeE,SAAW,GAE/C1L,GAAM4K,aAAc,OACd,GAAkD,WAA/C5K,GAAMuL,cAAcC,eAAeC,SAC3CzL,GAAMuL,cAAcC,eAAeE,SAAW,GAE/C1L,GAAM4K,aAAc,OACd,GAAI3kB,OAAO8Z,mBAAuB,qBAAsBA,GAAkBgM,UAI1E,CAEN,IAAIyQ,EAAS,IAAInQ,kBACjB,IACCmQ,EAAO7N,eAAe,SACtB3O,GAAM4K,aAAc,EACnB,MAAO3d,IACTuvB,EAAOnW,aARPrG,GAAM4K,aAAc,EAUrB5K,GAAM8B,UAAW,EACjBnV,EAAQqU,aAKVhB,GAAM+B,kBAAoB,WACzB,QAAS9b,OAAOomB,mBAGjBrM,GAAM8S,wBAA0B,WAC/B,OAAO3S,UAAUC,cAAgBD,UAAUC,aAAamT,cAIzDvT,GAAMyG,aAAe,SAAShkB,GAG7B,IAFA,IAAIg6B,EAAU,iEACVhW,EAAe,GACVjkB,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC7B,IAAIk6B,EAAY1e,KAAK6T,MAAM7T,KAAK8T,SAAW2K,EAAQ95B,QACnD8jB,GAAgBgW,EAAQE,UAAUD,EAAUA,EAAU,GAEvD,OAAOjW,GAipGOzG,UChkHR,SAASif,GAAellB,GAC7B,IAAIxF,EAAOhS,KACXyd,GAAMsB,KAAK,CACTiB,MAAO,OACPvB,SAAU,WAER,IAAI6b,EAAQ,IAAI7c,GAAM,CACpBjc,OAAQwQ,EAAKvO,MAAMjC,OACnB4d,QAAS,WAEPkb,EAAM3E,OAAO,CACXC,OAAQ,yBACRC,SAAU7jB,EAAKvO,MAAMoyB,SACrBzW,QAAS,SAAUoD,GAEjBxQ,EAAKzN,SAAS,CAAE+1B,MAAOA,IACvBtoB,EAAKzN,SAAS,CAAEo4B,QAASna,IACzB/E,GAAMjd,IACJ,qBACEwR,EAAKvO,MAAMk5B,QAAQzG,YACnB,QACAlkB,EAAKvO,MAAMk5B,QAAQ1G,QACnB,KAEJxY,GAAMjd,IAAI,oCACVwR,EAAK4qB,kBAAkBplB,GA4nBnCoG,UAAUC,aAAauU,mBACtB7vB,MAAK,SAAS8vB,GACbA,EAAQnG,SAAQ,SAASsG,GACvBjyB,QAAQC,IAAIgyB,EAAO5L,MACA,gBAAhB4L,EAAO5L,MACR9Z,IAAE,kBAAkBiP,OAAO,kBAAkByW,EAAOqK,SAAS,KAAKrK,EAAO9M,MAAM,aAE7D,eAAhB8M,EAAO5L,MACT9Z,IAAE,sBAAsBiP,OAAO,kBAAkByW,EAAOqK,SAAS,KAAKrK,EAAO9M,MAAM,aAEjE,eAAhB8M,EAAO5L,MACT9Z,IAAE,sBAAsBiP,OAAO,kBAAkByW,EAAOqK,SAAS,KAAKrK,EAAO9M,MAAM,mBAIxFhjB,OAAM,SAASwZ,GACd3b,QAAQC,IAAI0b,EAAIpY,KAAO,KAAOoY,EAAI6I,aAxoB1BpiB,MAAO,SAAUA,GACf8a,GAAM9a,MAAM,iCAAkCA,IAEhDqtB,cAAe,SAAU/rB,GACvBwZ,GAAMuC,MACJ,6BAA+B/b,EAAK,KAAO,OAAS,SAGxDmmB,SAAU,SAAU3mB,GAClBga,GAAMjd,IAAI,wBAA0BiD,IAEtC6f,WAAY,SAAUlC,EAAQnd,GAC5BwZ,GAAMjd,IACJ,UACGyD,EAAK,UAAY,WAClB,kBACAmd,IAGN6B,YAAa,SAAUhf,GACrBwZ,GAAMjd,IACJ,4CACGyD,EAAK,KAAO,QACb,SAGN4f,UAAW,SAAUlO,EAAKiO,GACxBnG,GAAMuC,MAAM,qCAAsCrK,GAClD,IAAIhO,EAAQgO,EAAG,UAEf,GADA8H,GAAMuC,MAAM,UAAYrY,GACpBA,EACF,GAAc,WAAVA,GA2BF,GAvBAqK,EAAKzN,SAAS,CACZu4B,UAAWnnB,EAAG,GACdonB,SAAS,IAEXtf,GAAMjd,IACJ,4BACEmV,EAAG,KACH,YACAA,EAAG,IAEP3D,EAAKoB,eACHuC,EAAG,GACH3D,EAAKvO,MAAMgU,SAAW,OAAMzF,EAAKvO,MAAM2T,UAGvCpF,EAAKvO,MAAMu3B,cACXhpB,EAAKvO,MAAMu3B,aAAX,KAEAhpB,EAAKgrB,iBAKHrnB,EAAG,WAAgB,CACrB,IAAIhW,EAAOgW,EAAG,WAKd,IAAK,IAAIqhB,KAJTvZ,GAAMuC,MACJ,4CACArgB,GAEYA,EAAM,CAClBY,QAAQC,IAAI,UAAWb,GACvB,IAAImD,EAAKnD,EAAKq3B,GAAL,GACLppB,EAAUjO,EAAKq3B,GAAL,QACVpH,EAAQjwB,EAAKq3B,GAAL,YACRnI,EAAQlvB,EAAKq3B,GAAL,YACZvZ,GAAMuC,MACJ,SACEld,EACA,KACA8K,EACA,YACAgiB,EACA,YACAf,EACA,KAEJ7c,EAAKirB,gBAAgBt9B,EAAKq3B,GAAL,GAAer3B,EAAKq3B,GAAL,SACpChlB,EAAKkrB,eAAep6B,EAAI,GAAI8K,EAASgiB,EAAOf,UAG3C,GAAc,cAAVlnB,EAET8V,GAAM6E,KAAK,qCACN,GAAc,UAAV3a,EAET,GAAIgO,EAAG,WAAgB,CACjBhW,EAAOgW,EAAG,WAKd,IAAK,IAAIqhB,KAJTvZ,GAAMuC,MACJ,4CACArgB,GAEYA,EAAM,CACdmD,EAAKnD,EAAKq3B,GAAL,GACLppB,EAAUjO,EAAKq3B,GAAL,QACVpH,EAAQjwB,EAAKq3B,GAAL,YACRnI,EAAQlvB,EAAKq3B,GAAL,YACZz2B,QAAQC,IAAIb,GACZ8d,GAAMuC,MACJ,SACEld,EACA,KACA8K,EACA,YACAgiB,EACA,YACAf,EACA,KAEJ7c,EAAKirB,gBAAgBt9B,EAAKq3B,GAAL,GAAer3B,EAAKq3B,GAAL,SACpChlB,EAAKkrB,eAAep6B,EAAI,GAAI8K,EAASgiB,EAAOf,SAEzC,GAAIlZ,EAAG,QAAa,CAEzB,IAAIwlB,EAAUxlB,EAAG,QACjBpV,QAAQC,IAAI,sBAAwB26B,GACpCnpB,EAAKzN,SACH,CACE44B,MAAOnrB,EAAKvO,MAAM05B,MAAM9mB,QACtB,SAACxC,GAAD,OAAUA,EAAKupB,MAAQjC,OAG3B,kBAAM56B,QAAQC,IAAI,cAAewR,EAAKvO,MAAM05B,UAM5B,OADdE,EAHkBrrB,EAAKvO,MAAM05B,MAAM9mB,QACrC,SAACxC,GAAD,OAAUA,EAAKupB,OAASjC,KAEOmC,UAE/BD,EAAWha,SAEbrR,EAAKsB,kBAAkB6nB,QAClB,GAAIxlB,EAAG,YAAiB,CAE7B,IAUI0nB,EAVAE,EAAc5nB,EAAG,YAErB,GADApV,QAAQC,IAAI,mBAAqB+8B,GACb,OAAhBA,EAGF,OAFAvrB,EAAKvO,MAAMk5B,QAAQzZ,cACnBlR,EAAKwrB,iBAAiBxrB,EAAKvO,MAAMk5B,SAOjB,OADdU,EAHkBrrB,EAAKvO,MAAM05B,MAAM9mB,QACrC,SAACxC,GAAD,OAAUA,EAAKupB,OAASG,KAEOD,WAE/BD,EAAWha,SACXrR,EAAKwrB,iBAAiBH,IAExBrrB,EAAKsB,kBAAkBiqB,GAEvBvrB,EAAKzN,SAAS,CACZ44B,MAAOnrB,EAAKvO,MAAM05B,MAAM9mB,QACtB,SAACxC,GAAD,OAAUA,EAAKupB,MAAQG,YAGlB5nB,EAAG,OACRA,EAAG,WAOTiO,IACFnG,GAAMuC,MAAM,0BAA2B4D,GACvC5R,EAAKvO,MAAMk5B,QAAQhG,iBAAiB,CAAE/S,KAAMA,MAGhDkJ,cAAe,SAAUrF,GACvBhK,GAAMuC,MAAM,8BAA+ByH,GAC3ClnB,QAAQC,IAAI,8BAA+BinB,GAC3ClnB,QAAQC,IAAIwR,EAAKvO,MAAMk5B,QAAQ75B,IAIN,IAHTkP,EAAKvO,MAAM05B,MAAM9mB,QAC/B,SAACxC,GAAD,OAAUA,EAAK/Q,KAAOkP,EAAKvO,MAAMk5B,QAAQ75B,MAE7B1C,SACZ4R,EAAKvO,MAAMk5B,QAAQS,KAAOprB,EAAKvO,MAAMq5B,UACrC9qB,EAAKzN,SAAS,CACZ44B,MAAOnrB,EAAKvO,MAAM05B,MAAMnwB,OAAOgF,EAAKvO,MAAMk5B,YAI9C,IAAIc,EAAchW,EAAOG,iBACzBrnB,QAAQC,IAAI,gBAAiBi9B,GACxBA,GAAsC,IAAvBA,EAAYr9B,QAG9BG,QAAQC,IAAIwR,EAAKvO,MAAMi6B,eACvB1rB,EAAK2rB,gBAAgB3rB,EAAKvO,MAAMk5B,QAAS3qB,EAAKvO,MAAMK,OAHpDkO,EAAKwrB,iBAAiBxrB,EAAKvO,MAAMk5B,UAMrC1R,eAAgB,SAAUxD,KAG1BmN,UAAW,WACTnX,GAAMjd,IACJ,mEAKRmC,MAAO,SAAUA,GACf8a,GAAM9a,MAAMA,GAEZ,IAAIf,EAAS,GAOb,GANIoQ,EAAKvO,MAAMm6B,kBACbh8B,EAASA,EAAS,oBAAsBoQ,EAAKvO,MAAMo6B,MAEhD7rB,EAAKvO,MAAMs3B,QACdn5B,GAAkB,aAEL,KAAXA,EAAe,CACjB,IAAIk8B,EAAM9rB,EAAK+rB,eAAe/rB,EAAKgsB,IAAIC,KAAK,GAAG75B,QAAQ,IACvDxC,EAASA,EAAS,QAAUk8B,EAAG,IAAU,QAAUA,EAAG,IAGxDp6B,OAAOgB,SAASC,QAAQ,yBAA2B/C,IAGrD0d,UAAW,WACT5b,OAAOgB,SAAS4F,eAOnB,SAAS4yB,GAAep6B,EAAIq6B,EAAOvvB,EAASgiB,EAAOf,GACxD,IAAI7c,EAAOhS,KACP8D,EAAO8J,EAAQgF,MAAM,QAAK,GAE1ByqB,EAAa,KACjBrrB,EAAKvO,MAAM62B,MAAM3E,OAAO,CACtBC,OAAQ,yBACRC,SAAU71B,KAAKyD,MAAMoyB,SACrBzW,QAAS,SAAUoD,IACjB6a,EAAa7a,GACF0b,kBAAmB,EAC9BzgB,GAAMjd,IACJ,qBACE68B,EAAWnH,YACX,QACAmH,EAAWpH,QACX,KAEJxY,GAAMjd,IAAI,6BAEV,IAAI29B,EAAY,CACdla,QAAS,OACTzM,KAAM,KACN4mB,MAAO,aACP9C,IAAKtpB,EAAKvO,MAAM63B,IAChB+C,KAAMv7B,EACNw7B,WAAYtsB,EAAKvO,MAAM86B,SAQwB,WAA/C9gB,GAAMuL,cAAcC,eAAeC,SACxB,QAAV2F,IAA8B,QAAVA,GAAoBpR,GAAMkc,aAE3C9K,IAAOA,EAAQA,EAAM/b,eACzBvS,QAAQC,IACN,sBACEquB,EACA,oDAEJsP,EAAS,aAAkB,GAG7Bd,EAAWmB,WAAa3P,EACxBwO,EAAWnnB,KAAK,CAAE6O,QAASoZ,KAE7Bx7B,MAAO,SAAUA,GACf8a,GAAM9a,MAAM,iCAAkCA,GAC9Ce,OAAO+6B,MAAM,6BAA+B97B,IAE9CkhB,UAAW,SAAUlO,EAAKiO,GACxBnG,GAAMuC,MAAM,sCAAuCrK,GACnD,IAAIhO,EAAQgO,EAAG,UACf8H,GAAMjd,IAAI,UAAYmH,GAElBgO,EAAG,MACLjS,OAAO+6B,MAAM9oB,EAAG,OACPhO,GACK,aAAVA,IACF01B,EAAWD,KAAOznB,EAAG,GACrB0nB,EAAWqB,UAAY/oB,EAAG,QAC1B3D,EAAKzN,SAAS,CAAE44B,MAAOnrB,EAAKvO,MAAM05B,MAAMnwB,OAAOqwB,KAAe,kBAC5D98B,QAAQC,IAAI,OAAQwR,EAAKvO,MAAM05B,UAG5BtO,GACH7c,EAAKwrB,iBAAiBH,GAGxB5f,GAAMjd,IACJ,iCACE68B,EAAWD,KACX,KACAC,EAAWqB,UACX,aACA/oB,EAAG,OAOPiO,IACFnG,GAAMjd,IAAI,0BAA2BojB,GACrCyZ,EAAW/O,aAAa,CACtB1K,KAAMA,EAGN4D,MAAO,CAAE2F,WAAW,EAAOK,WAAW,EAAOrtB,MAAM,GACnDif,QAAS,SAAUwE,GACjBnG,GAAMjd,IAAI,WAAYojB,GACtB,IAAIgB,EAAO,CAAEX,QAAS,QAASzM,KAAMxF,EAAKvO,MAAM4T,QAChDgmB,EAAWnnB,KAAK,CAAE6O,QAASH,EAAMhB,KAAMA,KAEzCjhB,MAAO,SAAUA,GACf8a,GAAMjd,IAAI,gBAAiBmC,GAC3Be,OAAO+6B,MAAM,mBAAqB97B,EAAMoiB,cAKhDqF,SAAU,SAAU3mB,GAClBga,GAAMjd,IACJ,kDACE68B,EAAWD,KACX,gBACA35B,IAGNwf,YAAa,SAAUhf,GACrBwZ,GAAMjd,IACJ,gDACE68B,EAAWD,KACX,SACCn5B,EAAK,KAAO,QACb,QAEO,SAAPA,GACF+N,EAAK2sB,mBAAmBtB,EAAWD,OAGvCtQ,cAAe,SAAUrF,GACvBlnB,QAAQC,IAAI,cAAeinB,IAE7BwD,eAAgB,SAAUxD,GACxBlnB,QAAQC,IAAI,cAAeinB,GAC3BzV,EAAK2rB,gBAAgBN,EAAYv5B,IAEnCoiB,OAAQ,SAAU/lB,KAClBy0B,UAAW,WACTnX,GAAMjd,IAAI,gDAAkDsC,EAAK,YAKhE,SAAS85B,GAAkBplB,GAChC,IAAIxF,EAAOhS,KACPoB,EAAW,CACb6iB,QAAS,OACTzM,KAAM,KACN4mB,MAAO,YAEPxwB,QACEoE,EAAKvO,MAAMgU,SACX,QACAzF,EAAKvO,MAAM2T,SACX,OACApF,EAAKvO,MAAMm3B,UACX,OACA5oB,EAAKvO,MAAMo6B,MAEf7rB,EAAKvO,MAAMk5B,QAAQzmB,KAAK,CAAE6O,QAAS3jB,IAI9B,SAASw9B,GAAgBpnB,GAC9B,IAAIxF,EAAOhS,KACPoB,EAAW,CACb6iB,QAAS,YACTzM,KAAM,KACN4mB,MAAO,YAEPxwB,QACEoE,EAAKvO,MAAMgU,SACX,QACAzF,EAAKvO,MAAM2T,SACX,OACApF,EAAKvO,MAAMm3B,UACX,OACA5oB,EAAKvO,MAAMo6B,MAEf7rB,EAAKvO,MAAMk5B,QAAQzmB,KAAK,CAAE6O,QAAS3jB,IAI9B,SAASu8B,GAAgBU,GAAmB,IAAbzwB,EAAY,uDAAJ,GACxCoE,EAAOhS,KAGX,GAFAO,QAAQC,IAAI,aAAe69B,GAC3B99B,QAAQC,IAAIsM,IAAE,UAAYuxB,EAAKv7B,KACM,GAAjCgK,IAAE,UAAYuxB,EAAKv7B,IAAI1C,OAAa,CACtC,IAAIy+B,EAAannB,SAASonB,cAAc,SACxCD,EAAWE,UAAW,EACtBF,EAAW9D,OAAQ,EAEnB8D,EAAW/7B,GAAK,SAAWu7B,EAAKv7B,GAChCgK,IAAE,SAASiP,OAAO,cAAesiB,EAAKv7B,GAAI,kCAAmC8K,EAAS,YAMpFixB,GAAY/xB,IAAE,MAAOuxB,EAAKv7B,IAAIiZ,OAAO8iB,GACrCR,EAAKv7B,IAAMu7B,EAAK3b,aAAe2b,EAAK3b,YAAYsI,eAClDhZ,EAAKzN,SAAS,CAAEy6B,SAAS,IAEzBvhB,GAAMwb,kBACJvhB,SAAS2jB,eAAe,SAAWgD,EAAKv7B,IACxCu7B,EAAK3b,YAAYsI,cAEnBhZ,EAAKitB,UAEHZ,EAAKv7B,IAAMu7B,EAAK3b,aAAe2b,EAAK3b,YAAYoF,WAElDhb,IAAE,oBAAoBC,OACtBD,IAAE,qBAAqBC,OAEvBD,IAAE,iBAAiBK,OACnBsQ,GAAMwb,kBACJvhB,SAAS2jB,eAAe,SAAWgD,EAAKv7B,IACxCu7B,EAAK3b,YAAYoF,UAEnB9V,EAAKitB,UAGPnyB,IAAE,UAAYuxB,EAAKv7B,IAAIy5B,IAAI,QAAS,WAG/B,SAASiB,GAAiBa,GAC3BA,EAAKv7B,KAEPgK,IAAE,UAAYuxB,EAAKv7B,IAAIo8B,SACvBpyB,IAAE,MAAQuxB,EAAKv7B,IAAIo8B,SACnBl/B,KAAKi/B,UAWF,SAAShC,GAAgBn6B,EAAIm0B,GAElC,IACI2E,EAAc3E,EAAErkB,MAAM,QACtB5S,KAAK67B,qBAAqBD,EAAY,KAF/B57B,KAGJuE,SAAS,CACZm5B,cAJO19B,KAIayD,MAAMi6B,cAAc1wB,OAAO,CAC7ClK,GAAIA,EACJ8K,QAASguB,EAAY,GACrBtlB,KAAMslB,EAAY,GAClBhB,UAAWgB,EAAY,GACvB9wB,KAAM,WACNgxB,QAAS,sBAOV,SAASqD,KAA8C,IAAhClV,EAA+B,uDAArB,GAAI4S,EAAiB,uDAAN,KACjD7qB,EAAOhS,KACP6uB,GAAQ,EACR2D,GAAS,EACRxgB,EAAKvO,MAAM27B,UACdvQ,EAAQ,CAAE1pB,MAAO,IAAKC,OAAQ,MAGR,MAApB4M,EAAKvO,MAAMo6B,OACbhP,EAAQ,cAEPgO,IACDrK,EAAS,CAACqK,SAAU,CAAEwC,MAAOxC,KAE/B7qB,EAAKvO,MAAMk5B,QAAQjO,YAAY,CAC7BlH,MAAM,aACJ4F,WAAW,EACXK,WAAW,EACXttB,MAAM,EACNqtB,WAAW,EACXL,WAAW,EACX0B,MAAOA,GANJ,QAOI2D,GAGTpT,QAAS,SAAUwE,GAGjB,GAFAnG,GAAMuC,MAAM,+BAAgC4D,GAC5CrjB,QAAQC,IAAI,gBAAkBypB,GAC1BrG,EAAM,CACR,IAAIqX,EAAU,CACZhX,QAAS,YACT2L,OAAO,EACPf,OAAO,EAEP1uB,MAAM,EACN8pB,QAAmB,IAAVA,EACTqV,aAAa,GAGfttB,EAAKvO,MAAMk5B,QAAQzmB,KAAK,CAAE6O,QAASkW,EAASrX,KAAMA,IAEpD5R,EAAKzN,SAAS,CAAEq5B,iBAAiB,IACjC9wB,IAAE,mBAAmBC,OACrBD,IAAE,eAAeK,OACjBL,IAAE,eAAeyvB,IAAI,QAAS,SAC9Bh8B,QAAQC,IAAI,UAAWwR,EAAKvO,MAAMk5B,QAAQ75B,IAC1CmS,GAAO3U,KAAK,aAAc,CACxBu9B,KAAM7rB,EAAKvO,MAAMo6B,KACjBpW,OAAQzV,EAAKvO,MAAMk5B,QAAQ75B,KAE7B,IAAI61B,EAAS3mB,EAAKvO,MAAMk5B,QAAQja,YAAYoF,SAASmE,YACrD1rB,QAAQC,IAAIm4B,IAEdh2B,MAAO,SAAUA,GACf8a,GAAM9a,MAAM,sBAAuBA,MAKlC,SAAS48B,KACd,IAAIvtB,EAAOhS,KACXO,QAAQC,IAAI,mBAEZwR,EAAKvO,MAAMk5B,QAAQzmB,KAAK,CAAE6O,QADV,CAAEd,QAAS,eAE3BjS,EAAKwrB,iBAAiBxrB,EAAKvO,MAAMk5B,SACjC7vB,IAAE,mBAAmBC,OACrBD,IAAE,cAAcK,OAChBL,IAAE,eAAeyvB,IAAI,QAAS,WAC9BvqB,EAAKzN,SAAS,CAAEq5B,iBAAiB,EAAO4B,WAAY,UAAW3B,KAAM,OAGhE,SAAS4B,GAAkB5C,GAChC,IAAI7qB,EAAOhS,KACPgS,EAAKvO,MAAMm6B,iBACb5rB,EAAKutB,kBAEPvtB,EAAKmtB,cAAc,GAAItC,GA6ClB,SAAS6C,KAEV1/B,KAAKyD,MAAMk5B,UADJ38B,KAEJu/B,kBAELv/B,KAAKyD,MAAMk5B,QAAQzmB,KAAK,CAAE6O,QAAS,CAAEd,QAAS,YAK3C,SAAS0b,KACd,IAAI3tB,EAAOhS,KACX8M,IAAE,mBAAmBK,OACrBL,IAAE,eAAeC,OACjBD,IAAE,cAAcC,OACXiF,EAAKvO,MAAMm6B,gBAGd5rB,EAAKutB,kBAFLvtB,EAAKmtB,gBCjpBF,SAASS,GAASC,EAAWC,EAAOC,EAAOC,GAI9C,IAJoE,IAAdC,EAAa,uDAAJ,GAC3DhgC,EAAK,EACLigC,EAAI,EACJC,EAAgB,IAAZN,EAA6B,EAATI,EACrBhgC,EAAK6/B,GACHI,EAAIL,EAAaE,IAClBG,EAAI,EACJC,EAAIA,EAAiB,IAAZN,EAA8B,EAATI,GAElCC,EAAIA,EAAIL,EAAsB,EAATI,EACrBhgC,IAEJ,QAAIkgC,EAAIH,IACIH,EAGT,SAASZ,KAGR,IACImB,EAAU1oB,SAAS2jB,eAAe,QAClC0E,EAAQ,EACRC,EAAS,EACTI,IACCL,EAAQK,EAAQC,YAAeJ,EAC/BD,EAASI,EAAQE,aAAgBL,GAQtC,IALA,IAAIM,EAAU7oB,SAAS8oB,uBAAuB,UAC1C3lB,EAAM,EAGN5a,EAAI,EACDA,EAAI,KAAM,CAEb,IAAU,IADF2/B,GAAS3/B,EAAGsgC,EAAQngC,OAAQ2/B,EAAOC,EAflC,GAgBQ,CACbnlB,EAAO5a,EAAI,EACX,MAEJA,IAKJwgC,GADA5lB,GAAaolB,EAxBA,GA6Bd,SAASQ,GAASt7B,EAAOgD,GAE5B,IADA,IAAIo4B,EAAU7oB,SAAS8oB,uBAAuB,UACrC3vB,EAAI,EAAGA,EAAI0vB,EAAQngC,OAAQyQ,IAChC0vB,EAAQ1vB,GAAGhJ,MAAM1C,MAAQA,EAAQ,KACjCo7B,EAAQ1vB,GAAGhJ,MAAMM,OAASA,EAAS,KACnCo4B,EAAQ1vB,GAAGhJ,MAAMzC,OAAkB,IAARD,EAAgB,KCvBnD,IAAMP,GAAIxB,EAAI,GAEOkU,G,kDAEnB,WAAY/T,GAAQ,IAAD,gCACjB,cAAMA,IACDV,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBACpB,EAAK0B,YAAc,EAAKA,YAAY1B,KAAjB,gBAGnB,EAAKo7B,eAAiBA,GAAep7B,KAAf,gBACtB,EAAKs7B,kBAAoBA,GAAkBt7B,KAAlB,gBACzB,EAAK47B,eAAiBA,GAAe57B,KAAf,gBACtB,EAAK69B,cAAgBA,GAAc79B,KAAd,gBACrB,EAAKq+B,aAAeA,GAAar+B,KAAb,gBACpB,EAAKq8B,gBAAkBA,GAAgBr8B,KAAhB,gBACvB,EAAKk8B,iBAAmBA,GAAiBl8B,KAAjB,gBACxB,EAAKi+B,gBAAkBA,GAAgBj+B,KAAhB,gBACvB,EAAKs9B,gBAAkBA,GAAgBt9B,KAAhB,gBACvB,EAAK27B,gBAAkBA,GAAgB37B,KAAhB,gBACvB,EAAKm+B,kBAAoBA,GAAkBn+B,KAAlB,gBACzB,EAAKo+B,cAAgBA,GAAcp+B,KAAd,gBAErB,EAAKq5B,YAAcA,GAAYr5B,KAAZ,gBAEnB,EAAK+4B,cAAgBA,GAAc/4B,KAAd,gBACrB,EAAKk5B,iBAAmBA,GAAiBl5B,KAAjB,gBACxB,EAAKm5B,wBAA0BA,GAAwBn5B,KAAxB,gBAC/B,EAAK06B,mBAAqBA,GAAmB16B,KAAnB,gBAC1B,EAAKk7B,UAAYA,GAAUl7B,KAAV,gBACjB,EAAK86B,sBAAwBA,GAAsB96B,KAAtB,gBAC7B,EAAKm7B,cAAgBA,GAAcn7B,KAAd,gBACrB,EAAKgS,kBAAoBA,GAAkBhS,KAAlB,gBACzB,EAAK8R,eAAiBA,GAAe9R,KAAf,gBACtB,EAAKg7B,WAAaA,GAAWh7B,KAAX,gBAClB,EAAKu6B,qBAAuBA,GAAqBv6B,KAArB,gBAE5B,EAAKs+B,SAAWA,GAASt+B,KAAT,gBAChB,EAAK29B,OAASA,GAAO39B,KAAP,gBACd,EAAKm/B,SAAWA,GAASn/B,KAAT,gBAEhB,EAAKoU,aAAeA,GAAapU,KAAb,gBACpB,EAAKuU,WAAaA,GAAWvU,KAAX,gBAClB,EAAKsV,UAAYA,GAAUtV,KAAV,gBACjB,EAAKyV,SAAWA,GAASzV,KAAT,gBAChB,EAAK4U,KAAOA,GAAK5U,KAAL,gBACZ,EAAK4V,OAASA,GAAO5V,KAAP,gBACd,EAAKyU,eAAiBA,GAAezU,KAAf,gBACtB,EAAKiV,WAAaA,GAAWjV,KAAX,gBAElB,EAAKmC,OAAL,GACE5B,MAAO6B,OAAOC,aAAaC,QAAQ,SAEnCE,KAAM,KACN2T,SAAU,KACVL,SAAU,KACVrT,SAAU,KACVy3B,YAAY,EACZE,cAAc,EACdD,cAAc,EACd3wB,KAAM,KACNqxB,QAAS,GAETtG,SAAU,iBAAmBpY,GAAMyG,aAAa,IAChDqW,UAAW,KACX/4B,OAAQD,EACR8V,OAAQ,KACRikB,IAAK,KAELK,aAAc,GACd+B,cAAe,GAEf3C,OAAO,GAtBT,yBAuBW,GAvBX,qBAwBQ,MAxBR,wBAyBW,MAzBX,qBA0BQ,MA1BR,sBA4BS,MA5BT,wBA6BW,MA7BX,sBA8BS,IA9BT,2BA+Bc,IA/Bd,sBAiCS,IAjCT,yBAkCY7zB,KAAK8P,OAlCjB,wBAmCW,MAnCX,qBAoCQ,MApCR,GA/CiB,E,sDA0FnB,WACEhT,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,eAAgBjE,KAAK6C,aACnCmB,EAAWC,GAAG,mBAAoBjE,KAAK6C,e,kCAGzC,WACEmB,EAAWE,eAAe,eAAgBlE,KAAK6C,aAC/CmB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,mBAAoBlE,KAAK6C,aACnDa,OAAOC,aAAa0G,QAAQrK,KAAKyD,MAAM4T,OAAQ,WAC/CrX,KAAK0gC,Y,qBAGP,WACE1gC,KAAKy8B,gBACLz8B,KAAK0/B,kB,+BAGP,WAEE,IAAI1tB,EAAOhS,KACPA,KAAKyD,MAAM5B,OAAS7B,KAAKyD,MAAM5B,MAAMzB,OAAS,IAChD+D,EAAsB,uBAAwB,GAAInE,KAAKyD,MAAM5B,OAE/D6B,OAAOiU,iBAAiB,QAAQ,SAAUhQ,GACxCqK,EAAKitB,SACLv7B,OAAOi9B,SAAW1B,MACjB,GAEHhqB,GAAOhR,GAAG,WAAW,WACf+N,EAAKvO,MAAM4T,QACbpC,GAAO3U,KAAK,OAAQ,CAAEkX,KAAMxF,EAAKvO,MAAM4T,OAAOQ,WAAYvB,KAAMtE,EAAKvO,MAAM2T,cAI/EnC,GAAOhR,GAAG,WAAW,SAAU9D,GACzBA,EAAI,SAAe6R,EAAKvO,MAAM2T,UAChCpF,EAAK0D,aAAavV,MAIjBuD,OAAOC,aAAaC,QAAQ5D,KAAKyD,MAAM4T,SAC1C3T,OAAOC,aAAa0G,QAAQrK,KAAKyD,MAAM4T,OAAQ,WAGjD3T,OAAOk9B,SAAWl9B,OAAOm9B,eAAiB,WACxCn9B,OAAOC,aAAa0G,QAAQrK,KAAKyD,MAAM4T,OAAQ,c,0BAKnD,SAAa7S,GACXxE,KAAKuE,SAASC,K,yBAGhB,WAAe,IAAD,OACR1E,EAAQkE,EAAWM,WACnB5C,EAAQsC,EAAWK,aACT,SAAVvE,GACFE,KAAKuE,SAAS,CACZ8S,OAAQ3V,EAAM4U,KACdglB,IAAK55B,EAAM45B,IACXwF,OAAQp/B,EAAMo/B,OACdC,QAASr/B,EAAMs/B,MACfC,KAAMv/B,EAAMu/B,KACZzF,WAAY95B,EAAM85B,WAClBE,aAAch6B,EAAMg6B,aACpBD,aAAc/5B,EAAM+5B,eACnB,WACDl7B,QAAQC,IAAI,EAAKiD,OACjB,EAAK42B,cAAc,EAAK52B,MAAM4T,QAC9B,EAAKqlB,eAAe,EAAKj5B,MAAMs9B,SACwB,YAAnDr9B,OAAOC,aAAaC,QAAQ,EAAKH,MAAM4T,UACzC3T,OAAOC,aAAa0G,QAAQ,EAAK5G,MAAM4T,OAAQ,SAC/C9W,QAAQC,IAAI,kBACZkD,OAAOgB,SAAS4F,UAGlB,EAAK0N,yB,yBAKX,WACE,IAAIhG,EAAOhS,KACPF,EAAQkE,EAAWM,WACnB4O,EAAOlP,EAAWK,aACR,aAAVvE,GACFE,KAAKuE,SAAS,CAAET,KAAMoP,EAAKpP,KAAM2T,SAAUvE,EAAKpP,KAAMC,SAAUmP,EAAKnP,SAAUqT,SAAUlE,EAAKoD,OAAQ,WACpG/V,QAAQC,IAAIwR,EAAKvO,OACjBU,EAAsB,QAAS6N,EAAKzO,MAAMmM,MAAM9N,OAAOkB,GAAIkP,EAAKvO,MAAM5B,Y,wBAK5E,WACE,GAAI7B,KAAKyD,MAAMg4B,cAAgBz7B,KAAKyD,MAAMi4B,aACxC,OACE,mBAAGz2B,MAAM,MAAMgB,QAAQ,GAAvB,SACE,sBAAMhB,MAAM,SAAS4C,MAAO,CAAEq5B,gBAAiB,WAA/C,SACE,sBAAKh8B,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,qEAAqE,sBAAMC,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,IAAIC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,cAAc,sBAAMA,EAAE,wB,uBAOhe,WAAa,IAAD,OACV,GAAI3F,KAAKyD,MAAMi4B,cAAgB17B,KAAKyD,MAAMg4B,cAAgBz7B,KAAKyD,MAAM+3B,WACnE,OACE,mBAAGv2B,MAAM,MAAMgB,QAAS,kBAAM,EAAKq2B,cAAnC,SACE,uBAAMr3B,MAAM,SAAS4C,MAAO,CAAEq5B,gBAAiB,WAA/C,UACE,sBAAKp+B,GAAG,gBAAgB+E,MAAO,CAAE+F,QAAS,SAAW1I,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1O,UAAkP,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMW,EAAE,IAAIC,EAAE,IAAIjB,MAAM,IAAIC,OAAO,KAAKiB,GAAG,MAAM,sBAAMV,EAAE,yBAAyB,sBAAMC,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UAChc,sBAAKjD,GAAG,iBAAiB+E,MAAO,CAAE+F,QAAS,QAAU1I,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1O,UAAkP,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMJ,EAAE,4EAA4E,sBAAMA,EAAE,uEAAuE,sBAAMC,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,iB,2BAOjkB,WAAiB,IAAD,OACd,GAAI/F,KAAKyD,MAAMi4B,cAAgB17B,KAAKyD,MAAMg4B,cAAgBz7B,KAAKyD,MAAM+3B,WACnE,OACE,mBAAGv2B,MAAM,MAAMgB,QAAS,kBAAM,EAAK05B,gBAAnC,SACE,uBAAM16B,MAAM,SAAS4C,MAAO,CAAEq5B,gBAAiB,WAA/C,UACE,qBAAKp+B,GAAG,iBAAiBmC,MAAM,0BAA0B6F,KAAK,SAASjD,MAAO,CAAE+F,QAAS,UACzF,sBAAK9K,GAAG,YAAY+E,MAAO,CAAE+F,QAAS,SAAW1I,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAAtO,UAA8O,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,wBAAQF,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAM,sBAAMb,EAAE,0FAC1W,sBAAK7C,GAAG,aAAa+E,MAAO,CAAE+F,QAAS,QAAU1I,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAAtO,UAA8O,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,2EAA2E,sBAAMA,EAAE,2EAA2E,sBAAMA,EAAE,uFAAuF,sBAAMC,GAAG,IAAIC,GAAG,IAAIC,GAAG,KAAKC,GAAG,iB,yBAOhlB,WACE,GAAI/F,KAAKyD,MAAMi4B,cAAgB17B,KAAKyD,MAAMg4B,cAAgBz7B,KAAKyD,MAAM+3B,WACnE,OACE,mBAAGv2B,MAAM,MAAMgB,QAAQ,GAAvB,SACE,sBAAMhB,MAAM,SAAS4C,MAAO,CAAEq5B,gBAAiB,WAA/C,SACE,sBAAKh8B,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,ghBAAghB,wBAAQW,GAAG,KAAKC,GAAG,KAAKC,EAAE,e,qBAOlzB,WAAW,IAAD,OACR,OACE,mBAAGvB,MAAM,MAAMgB,QAAS,kBAAM,EAAKy6B,WAAnC,SACE,sBAAMz7B,MAAM,SAAS4C,MAAO,CAAEq5B,gBAAiB,WAA/C,SACE,sBAAKh8B,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMG,EAAE,oFAAoF,sBAAMA,EAAE,qC,sBAMlW,WACE,OACE,qBAAKV,MAAM,wBAAX,SACE,sBAAKA,MAAM,gBAAgB4C,MAAO,CAAEW,UAAW,UAA/C,UACGxI,KAAKmhC,gBACLnhC,KAAKohC,YACLphC,KAAKqhC,aACLrhC,KAAKshC,cACLthC,KAAKuhC,iB,yBAMd,WACE,GAAIvhC,KAAKyD,MAAMi4B,cAAgB17B,KAAKyD,MAAMg4B,cAAgBz7B,KAAKyD,MAAM+3B,WACnE,OAAQx7B,KAAKwhC,a,8BAIjB,SAAiB1+B,GACf,GAAI9C,KAAKyD,MAAM04B,QAAQr5B,GACrB,OAAQ,sBAAMmC,MAAM,sB,yBAIxB,WAAe,IAAD,OACRgD,EAAS,GAmBb,OAlBAjI,KAAKyD,MAAMk4B,aAAa15B,KAAI,SAAC25B,GACF,aAArBA,EAAY9wB,MACd7C,EAAO5H,KACL,qBAAK4E,MAAM,aAAX,SACE,sBAAKA,MAAM,6BAAX,UACE,uBAAMA,MAAM,mBAAZ,UACG22B,EAAY73B,SACZ,EAAK09B,iBAAiB7F,EAAY94B,OAErC,sBAAKmC,MAAM,oBAAX,UACE,sBAAMA,MAAM,aAAZ,SAA0B22B,EAAYhuB,UACtC,qBAAK3I,MAAM,kBAAX,SAA8BL,GAAEg3B,EAAY9wB,oBAOjD7C,I,0BAGT,WAAgB,IAAD,OACTA,EAAS,GAqBb,OApBAjI,KAAKyD,MAAMk4B,aAAa15B,KAAI,SAAC25B,GACF,aAArBA,EAAY9wB,MACd7C,EAAO5H,KACL,qBAAK4E,MAAM,aAAX,SACE,sBAAKA,MAAM,6BAAX,UACE,mBAAGD,KAAK,IAAIC,MAAM,WAAlB,SACE,uBAAMA,MAAM,mBAAZ,UACG22B,EAAY73B,SACZ,EAAK09B,iBAAiB7F,EAAY94B,SAGvC,sBAAKmC,MAAM,oBAAX,UACE,sBAAMA,MAAM,aAAZ,SAA0B22B,EAAYhuB,UACtC,qBAAK3I,MAAM,kBAAX,SAA8BL,GAAEg3B,EAAY9wB,oBAOjD7C,I,+BAMT,WACMjI,KAAKyD,MAAM2T,UAAYpX,KAAKyD,MAAM4T,QACpCpC,GAAO3U,KAAK,OAAQ,CAAEkX,KAAMxX,KAAKyD,MAAM4T,OAAQf,KAAMtW,KAAKyD,MAAM2T,a,oBAKpE,WAAU,IAAD,OACDxS,EAAIxB,EAAI,GACd,OACE,sBAAMyB,UAAU,cAAhB,SACE,sBAAKA,UAAU,UAAf,UACE,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,qBAAKS,UAAU,eAAf,SACE,qBAAKA,UAAU,iBAAf,SACE,qBAAKA,UAAU,kBAAf,SACE,sBAAKA,UAAU,iBAAf,UAGE,sBAAKI,MAAM,WAAX,UACGjF,KAAK0hC,cACN,sBAAKz8B,MAAM,sBAAX,UACA,qBAAKA,MAAM,8BACT,qBAAKA,MAAM,sBAAsB4C,MAAO,CAAE85B,UAAW,UAArD,SACE,qBAAK18B,MAAM,MAAX,SACGjF,KAAK4hC,qBAKZ,sBAAK38B,MAAM,qBAAX,UACA,qBAAKA,MAAM,4BACT,qBAAKA,MAAM,sBAAsB4C,MAAO,CAAE85B,UAAW,UAArD,SACE,qBAAK18B,MAAM,MAAX,SACGjF,KAAK6hC,sBAKZ,sBAAK58B,MAAM,8BAAX,UACE,qBAAKA,MAAM,4CAA4CnC,GAAG,WAAW+E,MAAO,CAAEsJ,UAAW,SAAzF,SACGnR,KAAK4W,cAER,qBAAK3R,MAAM,sBAAX,SACE,sBAAKA,MAAM,MAAX,UACE,qBAAKA,MAAM,MAAX,SACE,0BAAUnC,GAAG,YAAYmC,MAAM,eAAeH,iBAAe,WAAWyG,YAAa3G,EAAC,gBAAqBwG,SAAU,SAACV,GACpH,EAAKZ,aAAa,CAAE+J,KAAM,CAAEiD,QAASpM,EAAEC,OAAOC,MAAO9G,KAAM,EAAKL,MAAMK,KAAMC,SAAU,EAAKN,MAAMM,SAAUsU,KAAMnR,KAAK8P,MAAOV,KAAMrC,uBAGvI,qBAAKhP,MAAM,WAAX,SACE,mBAAGgB,QAAS,kBAAM,EAAKiQ,QAAQjR,MAAM,gBAAgBe,aAAW,SAAhE,SACE,sBAAKd,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,MAAM,sBAAMJ,EAAE,oGAQjT,qBAAKV,MAAM,WAAX,SACE,qBAAKA,MAAM,OAAX,SACE,qBAAKA,MAAM,YAAYnC,GAAG,UAAU+E,MAAO,CAAEzC,OAAQ,SAArD,SACE,qBAAKtC,GAAG,wBAWtB,qBAAKA,GAAG,aAAa+E,MAAO,CAAE+F,QAAS,oB,GAhZRnH,IAAMC,WC3BzC9B,GAAIxB,EAAI,GACO0+B,G,kDAEjB,WAAYv+B,GAAQ,IAAD,8BACf,cAAMA,IACDP,YAAc,EAAKA,YAAY1B,KAAjB,gBACnB,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBACpB,EAAKuB,YAAc,EAAKA,YAAYvB,KAAjB,gBACnB,EAAKsB,gBAAkB,EAAKA,gBAAgBtB,KAArB,gBACvB,EAAKoM,OAAS,EAAKA,OAAOpM,KAAZ,gBAGd,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCwE,MAAO,KACPoK,YAAa,KACbC,MAAO,KACPrJ,gBAAiB,GACjBC,cAAe,EACfqD,EAAG,GACHgG,aAAc,MAjBH,E,sDAqBnB,WACI1O,EAAWC,GAAG,oBAAqBjE,KAAK4C,iBACxCoB,EAAWC,GAAG,eAAgBjE,KAAKgD,aACnCgB,EAAWC,GAAG,mBAAoBjE,KAAK6C,e,kCAG3C,WACImB,EAAWE,eAAe,oBAAqBlE,KAAK4C,iBACpDoB,EAAWE,eAAe,eAAgBlE,KAAKgD,aAC/CgB,EAAWE,eAAe,mBAAoBlE,KAAK6C,e,+BAGvD,WAAqB,IAAD,OACV+H,EAAQ9I,KAAY2O,MAAMzQ,KAAKuD,MAAMmB,SAASgJ,QAChDtE,EAAkB,GAClBC,EAAgB,EACpBtH,OAAOC,KAAK4I,GAAO3I,KAAI,SAACC,GACpB,IAAIyQ,EAAUzQ,EAAI0Q,MAAM,KACpBD,EAAQ,KACRvJ,EAAkBuJ,EAAQ,GAAGE,OAAO,GAAGC,cAAgBH,EAAQ,GAAGI,MAAM,GACxE1J,EAAgBuB,EAAM1I,OAG9BlC,KAAKuE,SAAS,CAAE6E,gBAAiBA,EAAiBC,cAAeA,IAAiB,WAC9ElF,EAA0B,cAAe,EAAKV,MAAM9B,KAAM,EAAK8B,MAAO,EAAKA,MAAM5B,Y,6BAMzF,WACI,IAAI4J,EAAWzH,EAAWgP,iBACtBlT,EAAQkE,EAAWM,WACvB/D,QAAQC,IAAIiL,GACRA,GAAsB,eAAV3L,GACZE,KAAKuE,SAAS,CACVkO,MAAOhH,EAASgH,MAChBD,YAAa/G,EAAS+G,gB,yBAMlC,WACIrO,EAA0B,cAAenE,KAAKyD,MAAM9B,KAAM3B,KAAKyD,MAAOzD,KAAKyD,MAAM5B,S,0BAKrF,SAAa2C,GACTxE,KAAKuE,SAASC,K,oBAGlB,SAAOkI,GAAI,IAAD,OACFA,EAAEtM,OAAS,EACXJ,KAAKuE,SAAS,CAAEmI,EAAGA,IAAK,kBACpBvI,EAA0B,cAAe,EAAKV,MAAM9B,KAAM,EAAK8B,MAAO,EAAKA,MAAM5B,UAGrF7B,KAAKuE,SAAS,CAAEmI,EAAG,KAAM,kBACrBvI,EAA0B,cAAe,EAAKV,MAAM9B,KAAM,EAAK8B,MAAO,EAAKA,MAAM5B,Y,yBAK7F,WACIsC,EAA0B,cAAenE,KAAKyD,MAAM9B,KAAM3B,KAAKyD,MAAOzD,KAAKyD,MAAM5B,S,4BAGrF,SAAeoR,GACwB,KAA/BjT,KAAKyD,MAAM2F,iBAEXjF,EAAsB,cADX,CAAEkF,cAAerJ,KAAKyD,MAAM4F,cAAeD,gBAAiBpJ,KAAKyD,MAAM2F,gBAAiB6J,QAASA,GACjEjT,KAAKyD,MAAM5B,S,+BAI9D,SAAkBiB,GAEdqB,EAAyB,cADd,CAAErB,GAAIA,EAAIuG,cAAerJ,KAAKyD,MAAM4F,cAAeD,gBAAiBpJ,KAAKyD,MAAM2F,iBAC5CpJ,KAAKyD,MAAM5B,S,uBAG7D,SAAU4Q,GAAQ,IAAD,OACTxK,EAAS,GA4Bb,OA3BIwK,GACAA,EAAMxQ,KAAI,SAACiR,GACPjL,EAAO5H,KACH,qBAAK4E,MAAM,kBAAkB4C,MAAO,CAAEsL,OAAQ,QAA9C,SACI,sBAAKlO,MAAM,yBAAX,UACI,qBAAKA,MAAM,WAAX,SACI,mBAAGgB,QAAS,kBAAM,EAAKmN,eAAeF,EAAKD,UAA3C,SACI,sBAAK/N,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,KAAKC,GAAG,IAAIC,GAAG,KAAKC,GAAG,OAAO,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,cAGrU,qBAAKd,MAAM,WAAX,SACI,mBAAGD,KAAK,IAAR,SACI,sBAAMC,MAAM,SAAZ,SAAuBiO,EAAKnP,eAGpC,sBAAKkB,MAAM,oBAAX,UACI,mBAAGD,KAAK,IAAIC,MAAM,oBAAlB,SAAuCiO,EAAKpP,OAC5C,uBAAOmB,MAAM,yCAAb,SAAuDiO,EAAKhJ,SAEhE,qBAAKjF,MAAM,sBAQxBgD,I,wBAGX,SAAWnF,EAAI8H,GACXrK,QAAQC,IAAIsC,EAAI8H,GAChBzG,EAAsB,0BAA2B,CAAErB,GAAIA,EAAIi/B,KAAMn3B,GAAS5K,KAAKyD,MAAM5B,S,yBAIzF,SAAYwR,GAAa,IAAD,OACpB,IAAIrT,KAAKuD,MAAMy+B,OAcX,OACI,yBAAQ/8B,MAAM,cAAcmG,SAAU,SAACV,GAAD,OAAO,EAAKu3B,WAAW5uB,EAAWvQ,GAAI4H,EAAEC,OAAOC,QAArF,UACI,wBAAQA,MAAM,YAAYs3B,SAA8B,cAApB7uB,EAAW0uB,KAA/C,SAAqFn9B,GAAC,YACtF,wBAAQgG,MAAM,YAAYs3B,SAA8B,cAApB7uB,EAAW0uB,KAA/C,SAAqFn9B,GAAC,YACtF,wBAAQgG,MAAM,UAAUs3B,SAA8B,YAApB7uB,EAAW0uB,KAA7C,SAAiFn9B,GAAC,UAClF,wBAAQgG,MAAM,WAAWs3B,SAA8B,aAApB7uB,EAAW0uB,KAA9C,SAAmFn9B,GAAC,cAlB5F,IAAIwF,EAAU,GACdpK,KAAKuD,MAAMy+B,OAAO//B,KAAI,SAAC8/B,GAInB,OAHA33B,EAAQ/J,KACJ,wBAAQuK,MAAOm3B,EAAMG,SAAU7uB,EAAW0uB,OAASA,EAAnD,SAAyEn9B,GAAEm9B,MAG3E,wBAAQ98B,MAAM,cAAcmG,SAAU,SAACV,GAAD,OAAO,EAAKu3B,WAAW5uB,EAAWvQ,GAAI4H,EAAEC,OAAOC,QAArF,SACKR,S,6BAiBrB,SAAgBoI,GAAc,IAAD,OACrBvK,EAAS,GA+Bb,OA9BIuK,GACAA,EAAYvQ,KAAI,SAACoR,GACb9S,QAAQC,IAAI6S,GACZ,IAAIH,EAAOG,EAAWxP,QACtBoE,EAAO5H,KACH,qBAAK4E,MAAM,kBAAkB4C,MAAO,CAAEsL,OAAQ,QAA9C,SACI,sBAAKlO,MAAM,yBAAX,UACI,qBAAKA,MAAM,WAAX,SACI,mBAAGgB,QAAS,kBAAM,EAAKqN,kBAAkBD,EAAWvQ,KAApD,SACI,sBAAKoC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAS,sBAAMI,GAAG,IAAIC,GAAG,KAAKC,GAAG,KAAKC,GAAG,cAG9R,qBAAKd,MAAM,WAAX,SACI,mBAAGD,KAAK,IAAR,SACI,sBAAMC,MAAM,SAAZ,SAAuBiO,EAAKnP,eAGpC,sBAAKkB,MAAM,oBAAX,UACI,mBAAGD,KAAK,IAAIC,MAAM,oBAAlB,SAAuCiO,EAAKpP,OAC5C,uBAAOmB,MAAM,yCAAb,SAAuDiO,EAAKhJ,SAEhE,qBAAKjF,MAAM,WAAX,SACK,EAAKk9B,YAAY9uB,cAQnCpL,I,oBAIX,WAAU,IAAD,OAEL,OACI,sBAAMpD,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,2BAAf,UACI,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,SAAgCD,GAAC,mBACjC,oBAAIC,UAAU,aAAd,SAA4BD,GAAC,8BAIzC,qBAAKC,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,yBAAf,UACI,qBAAKA,UAAU,WAAf,SACI,sBAAKI,MAAM,YAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,cAE7B,qBAAKK,MAAM,mDAAX,SACI,qBAAKA,MAAM,kBAAX,SACI,sBAAKA,MAAM,cAAX,UACI,uBAAOvE,KAAK,OAAOuE,MAAM,eAAesG,YAAa3G,GAAC,mBAAwB6F,QAAS,SAACC,GAAQ,EAAKgD,OAAOhD,EAAEC,OAAOC,UACrH,sBAAM3F,MAAM,mBAAZ,SAEI,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,wBAAQc,GAAG,KAAKC,GAAG,KAAKC,EAAE,MAAa,sBAAMZ,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,mBAKlV/F,KAAKuT,UAAUvT,KAAKyD,MAAMgP,YAInC,qBAAK5N,UAAU,WAAf,SACI,sBAAKI,MAAM,YAAX,UACI,qBAAKA,MAAM,cAAX,SACI,oBAAIA,MAAM,aAAV,SAAwBL,GAAC,iBAE7B,qBAAKK,MAAM,mDAAX,SACKjF,KAAKwT,gBAAgBxT,KAAKyD,MAAM+O,uC,GAzPnC/L,IAAMC,WCD/B07B,G,kDAEjB,WAAY7+B,GAAQ,IAAD,8BACf,cAAMA,IAED9B,QAAU,EAAKA,QAAQH,KAAb,gBACf,EAAKwI,aAAe,EAAKA,aAAaxI,KAAlB,gBAEpB,EAAKmC,MAAQ,CACT5B,MAAO6B,OAAOC,aAAaC,QAAQ,SACnCy+B,SAAU,IARC,E,sDAenB,WACIr+B,EAAWC,GAAG,WAAYjE,KAAKyB,W,kCAInC,WACIuC,EAAWE,eAAe,WAAYlE,KAAKyB,W,+BAG/C,WACI0C,EAAkB,WAAYnE,KAAKyD,MAAM9B,KAAM,GAAI3B,KAAKyD,MAAM5B,S,0BAKlE,SAAa2C,M,qBAIb,WACI,IAAI7E,EAAOqE,EAAWvC,UAClB3B,EAAQkE,EAAWM,WACnB3E,GAAkB,YAAVG,GACRE,KAAKuE,SAAS,CACV89B,SAAU1iC,IAGlBY,QAAQC,IAAIb,K,kBAGhB,SAAKkE,GACD,IAAIoE,EAAS,GAIb,OAHApE,EAAQmE,KAAK/F,KAAI,SAACiG,GACdD,EAAO5H,KAAM,sBAAM4E,MAAM,mBAAmB4C,MAAO,CAACM,OAAQ,OAA/C,SAAwDD,EAAIE,YAEtEH,I,mBAGX,WAAS,IAAD,OACAA,EAAS,GA4Bb,OA3BAjI,KAAKyD,MAAM4+B,SAASpgC,KAAI,SAAC4B,GACrBoE,EAAO5H,KACH,qBAAK4E,MAAM,oBAAX,SACI,sBAAKA,MAAM,OAAX,UACI,sBAAKA,MAAM,4BAAX,UACI,sBAAMA,MAAM,uCAAZ,SAAqDpB,EAAQE,WAC7D,oBAAIkB,MAAM,WAAV,SAAqB,mBAAGD,KAAK,IAAR,SAAanB,EAAQC,SAC1C,qBAAKmB,MAAM,aAAX,SAAyBpB,EAAQy+B,YACjC,qBAAKr9B,MAAM,OAAX,SACI,qBAAKJ,UAAU,kBAAf,SACA,EAAKmD,KAAKnE,UAIlB,sBAAKoB,MAAM,SAAX,UACI,oBAAGD,KAAK,IAAIC,MAAM,WAAlB,UAE3B,sBAAKC,MAAM,6BAA6BD,MAAM,OAAOE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1L,UAAkM,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAQ,sBAAMG,EAAE,uEAAuE,sBAAMC,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,UAAU,sBAAMH,GAAG,IAAIC,GAAG,KAAKC,GAAG,IAAIC,GAAG,UAAU,sBAAMH,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,aAF9Z,aAIA,oBAAGf,KAAK,IAAIC,MAAM,WAAlB,UACI,sBAAKC,MAAM,6BAA6BD,MAAM,uBAAuBE,MAAM,KAAKC,OAAO,KAAKC,QAAQ,YAAYC,eAAa,IAAIC,OAAO,eAAeC,KAAK,OAAOC,iBAAe,QAAQC,kBAAgB,QAA1M,UAAkN,sBAAMH,OAAO,OAAOI,EAAE,gBAAgBH,KAAK,SAAc,sBAAMG,EAAE,4GADvR,sBAQbsC,I,oBAIX,WAEI,OACI,sBAAMpD,UAAU,cAAhB,SACI,sBAAKA,UAAU,UAAf,UACI,cAAC,EAAD,CAAQT,QAASpE,KAAKuD,MAAMa,UAC5B,sBAAKS,UAAU,eAAf,UACI,qBAAKA,UAAU,eAAf,SACI,sBAAKA,UAAU,2BAAf,UACI,qBAAKA,UAAU,2BACf,sBAAKA,UAAU,MAAf,UACI,qBAAKA,UAAU,gBAAf,sBACA,oBAAIA,UAAU,aAAd,8BAIZ,qBAAKA,UAAU,YAAf,SACI,qBAAKA,UAAU,eAAf,SACI,qBAAKA,UAAU,yBAAf,SACC7E,KAAKkM,0B,GA3GIzF,IAAMC,W,SC+C1CtC,GAAUm+B,eACKC,G,wKACnB,WACEp+B,GAAQq+B,QAAO,SAAC/9B,GACdnE,QAAQC,IAAIkE,Q,oBAIhB,WACE,OACE,cAAC,IAAD,CAAYN,QAASA,GAArB,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOs+B,KAAK,IAAIrD,OAAK,EAACsD,UAAWn2B,KACjC,cAAC,IAAD,CAAOk2B,KAAK,UAAUrD,OAAK,EAACsD,UAAW/4B,IACvC,cAAC,IAAD,CAAO84B,KAAK,SAASrD,OAAK,EAACsD,UAAWC,IACtC,cAAC,IAAD,CAAOF,KAAK,iBAAiBrD,OAAK,EAACsD,UAAWtlB,KAE9C,cAAC,IAAD,CAAOqlB,KAAK,eAAerD,OAAK,EAACsD,UAAW1nB,KAC5C,cAAC,IAAD,CAAOynB,KAAK,uBAAuBrD,OAAK,EAACsD,UAAWhpB,KAEpD,cAAC,IAAD,CAAO+oB,KAAK,UAAUrD,OAAK,EAACsD,UAAWn2B,KACvC,cAAC,IAAD,CAAOk2B,KAAK,iBAAiBrD,OAAK,EAACsD,UAAW9wB,KAC9C,cAAC,IAAD,CAAO6wB,KAAK,qBAAqBrD,OAAK,EAACsD,UAAWpwB,KAClD,cAAC,IAAD,CAAOmwB,KAAK,cAAcrD,OAAK,EAACsD,UAAWxzB,KAC3C,cAAC,IAAD,CAAOuzB,KAAK,qBAAqBrD,OAAK,EAACsD,UAAWxuB,KAClD,cAAC,IAAD,CAAOuuB,KAAK,mBAAmBrD,OAAK,EAACsD,UAAWE,KAEhD,cAAC,IAAD,CAAOH,KAAK,eAAerD,OAAK,EAACsD,UAAW9pB,KAC5C,cAAC,IAAD,CAAO6pB,KAAK,sBAAsBrD,OAAK,EAACsD,UAAWppB,KACnD,cAAC,IAAD,CAAOmpB,KAAK,mBAAmBrD,OAAK,EAACsD,UAAWvpB,KAChD,cAAC,IAAD,CAAOspB,KAAK,wBAAwBrD,OAAK,EAACsD,UAAWG,KAGrD,cAAC,IAAD,CAAOJ,KAAK,YAAYrD,OAAK,EAACsD,UAAW5tB,KACzC,cAAC,IAAD,CAAO2tB,KAAK,mBAAmBrD,OAAK,EAACsD,UAAWrqB,KAChD,cAAC,IAAD,CACEoqB,KAAK,uBACLrD,OAAK,EACLsD,UAAWnqB,KAEb,cAAC,IAAD,CAAOkqB,KAAK,gBAAgBrD,OAAK,EAACsD,UAAWrrB,KAC7C,cAAC,IAAD,CAAOorB,KAAK,qBAAqBrD,OAAK,EAACsD,UAAWI,KAElD,cAAC,IAAD,CAAOL,KAAK,iBAAiBrD,OAAK,EAACsD,UAAWtmB,KAC9C,cAAC,IAAD,CAAOqmB,KAAK,mBAAmBrD,OAAK,EAACsD,UAAWK,KAEhD,cAAC,IAAD,CAAON,KAAK,oBAAoBrD,OAAK,EAACsD,UAAWrlB,KAEjD,cAAC,IAAD,CACEolB,KAAK,sBACLrD,OAAK,EACLsD,UAAWb,KAGb,cAAC,IAAD,CAAOY,KAAK,aAAarD,OAAK,EAACsD,UAAWM,KAE1C,cAAC,IAAD,CAAOP,KAAK,eAAerD,OAAK,EAACsD,UAAWO,KAE5C,cAAC,IAAD,CAAOR,KAAK,YAAYrD,OAAK,EAACsD,UAAWP,c,GAzDlB37B,IAAMC,WC1CxBy8B,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqB9gC,MAAK,YAAkD,IAA/C+gC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCSdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFnsB,SAAS2jB,eAAe,SAM1B8H,O","file":"static/js/main.00b6f469.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import { Dispatcher } from \"flux\";\n\nexport default new Dispatcher;\n","import { EventEmitter } from \"events\";\n\nimport dispatcher from \"../dispatcher\";\n\nclass ModelStore extends EventEmitter {\n  constructor() {\n    super()\n    this.list = [];\n    this.multipleList = [];\n    this.instance = null;\n    this.klass= null;\n    this.reason = null;\n  }\n\n  listModel(list){\n    this.list = [];\n    this.klass = list.klass\n    for (var i = 0, len = list.data.length; i < len; ++i) {\n      this.list.push(list.data[i]);\n      if (i === len - 1 ) {\n        this.emit(\"got_list\");\n      }\n    }\n    if(list.data.length == 0){\n      this.emit(\"got_list\");\n    }\n\n  }\n\n\n  listMultipleModel(list){\n    console.log('>>>>>', list)\n    this.multipleList = list.data;\n    this.klass = list.klass\n    this.emit(\"got_multiple_list\");\n  }\n\n  showIntance(instance){\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"got_instance\");\n  }\n\n  setIntance(instance){\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"set_instance\");\n  }\n\n\n  deleteIntance(instance){\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"deleted_instance\");\n  }\n\n  postFile(instance){\n    console.log(instance)\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"file_posted\");\n  }\n\n  setIntanceFailure(reason){\n    console.log(reason)\n    this.reason = 'Error'\n    this.klass = ''\n    this.emit(\"set_instance\");\n  }\n\n  getReason(){\n    return this.reason\n  }\n\n  getIntance() {\n    return this.instance\n  }\n\n  getList(){\n    return this.list\n  }\n\n  getListnKlass(){\n    return [this.list, this.klass]\n  }\n\n\n  getMutipleList(){\n    return this.multipleList\n  }\n\n  getKlass(){\n    return this.klass\n  }\n\n  handleActions(action) {\n    switch(action.type) {\n      case \"LIST_MODEL_SUCCESS\": {\n        this.listModel(action.list);\n        break;\n      }\n      case \"MULTIPLE_LIST_MODEL_SUCCESS\": {\n        this.listMultipleModel(action.list);\n        break;\n      }\n      case \"GET_INSTANCE_SUCCESS\": {\n        this.showIntance(action.instance);\n        break;\n      }\n      case \"DELETE_INSTANCE_SUCCESS\": {\n        this.deleteIntance(action.instance);\n        break;\n      }\n      case \"SET_INSTANCE_SUCCESS\": {\n        this.setIntance(action.instance);\n        break;\n      }\n      case \"POST_FILE_SUCCESS\": {\n        this.postFile(action.instance);\n        break;\n      }\n      case \"SET_INSTANCE_FAILURE\": {\n        console.log(action)\n        this.setIntanceFailure(action.reason);\n        break;\n      }\n\n      \n    }\n  }\n}\n\n\nconst modelStore = new ModelStore;\ndispatcher.register(modelStore.handleActions.bind(modelStore));\n\nexport default modelStore;\n","export const conf = { \n//'server' : 'http://localhost:3001/v1',\n'server' : '/v1',\n'socketIOServer': 'https://connect.ut.ac.ir/',\n//'socketIOServer': 'http://localhost:8081/',\n'socketServer' : 'wss://kaarafarinan.ir/ws',\n//'socketServer' : 'ws://localhost:8080',\n//'ionSignalServer' : 'wss://kaarafarinan.ir:7000/ws',\n'ionSignalServer' : 'wss://sync.ut.ac.ir:7000/ws',\n//'janusServer' : 'https://kaarafarinan.ir:8089/janus',\n'janusServer' : 'https://sync.ut.ac.ir:8089/janus'\n\n};\n","import dispatcher from \"../dispatcher\";\nimport axios, {put} from 'axios';\nimport { conf } from '../conf';\nconst server= conf.server;\n//const server='/v1';\n//const server='http://95.156.255.115/api';\n\n\nexport function getList(model, page=1, params={}, token) {\n  var queryString = Object.keys(params).map(key => key + '=' + params[key]).join('&');\n  axios.get(server + '/'+ model +'?page='+page+'&'+queryString, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"LIST_MODEL_SUCCESS\",\n      list: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function getMultipleList(model, page=1, params={}, token) {\n  var queryString = Object.keys(params).map(key => key + '=' + params[key]).join('&');\n  axios.get(server + '/'+ model +'?page='+page+'&'+queryString, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"MULTIPLE_LIST_MODEL_SUCCESS\",\n      list: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function fileUpload(model, id , file, token){\n  const url = server + '/'+ model;\n  const formData = new FormData();\n  formData.append('upload[attached_document]',file)\n  //formData.append('profile[id]',id)\n  const config = {\n      headers: {\n          'content-type': 'multipart/form-data',\n          'Authorization': \"bearer \" + token \n      }\n  }\n  axios.post(url, formData,config).then(function (response) {\n    dispatcher.dispatch({\n      type: \"POST_FILE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function getInstance(model, id, token, page=1) {\n  axios.get(server + '/'+ model +'/'+id+'?page='+page, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"GET_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function removeInstance(model, params={}, token ) {\n  var queryString = Object.keys(params).map(key => key + '=' + params[key]).join('&');\n  axios.get(server + '/'+ model +'/delete?'+queryString, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"DELETE_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function setInstance(model, data, token) {\n  axios.post(server + '/'+ model +'/', data, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"SET_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    dispatcher.dispatch({\n      type: \"SET_INSTANCE_FAILURE\",\n      instance: error.reason,\n    });\n    console.log(error);\n  });\n}\n\nexport function updateInstance(model, data, token) {\n  axios.put(server + '/'+ model +'/'+data.id, data, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"SET_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n","export const dict = {\n  fa : {\n    'overview': 'نمای کلی',\n    'events': 'رویدادها',\n    'home': 'خانه',\n    'meetings': 'نشست ها',\n    'users': 'کاربران',\n\n    'event_detail':'جزئیات رویداد',\n    'event_title':'عنوان رویداد',\n    'event_info':'شرح رویداد',\n    'event_type':'نوع رویداد',\n    'event':'رویداد',\n    'create_event':'ایجاد رویداد',\n    'create_event_page':'ایجاد رویداد',\n    'in_person': 'حضوری',\n    'online': 'برخط',\n    'hybrid': 'تلفیقی',\n    'filter_events':'جستجو و فیلتر رویدادها',\n\n    'meeting_info':'شرح نشست',\n    'meeting_title':'عنوان نشست',\n    'meeting_detail':'جزئیات نشست',\n    'meeting_type':'نوع نشست',\n    'meeting_capacity': 'ظرفیت نشست',\n    'meeting_external_link': 'لینک نشست',\n    'meeting_start_time': 'زمان شروع',\n    'meeting_end_time': 'زمان پایان',\n    'related_to_event': 'نشستی از رویداد',\n    'create_meeting':'ایجاد نشست',\n    'create_meeting_page':'ایجاد نشست',\n    'online_external': 'برخط بیرونی',\n    'filter_meetings': 'جستجو و فیلتر نشست ها',\n    \n\n    'exhibition_info':'شرح',\n    'exhibition_detail': 'جزئیات غرفه',\n    'exhibition_title':'عنوان شرکت/موسسه',\n    'related_to_event': 'مربوط به رویداد',\n    'create_exhibition':'ایجاد غرفه',\n    'create_exhibition_page':'ایجاد غرفه',\n    'exhibitions': 'نمایشگاه',\n    'stations': 'غرفه ها',\n    'enter_room_with_admin': 'مذاکره با غرفه دار',\n\n    'choose_participants': 'شرکت کنندگان موردنظر را انتخاب کنید',\n    'participants':'شرکت کنندگان',\n    'add_participants': 'افزودن شرکت کننده',\n\n    'pages':'صفحات',\n    'page_content':'محتوای صفحه',\n    'page_title':'عنوان صفحه',\n    'create_page':'ایجاد صفحه',\n    'default_page':'صفحه پیش فرض',\n    'default_page_info':'این صفحه به عنوان پیش فرص در نشست نمایش داده شود',\n\n    'create_upload':'بارگزاری منبع',\n    'upload_title':'عنوان منبع',\n    'default_is_private_upload':'به جز مدیران فایل ها دیده نشود',\n    'cover': 'کاور',\n    'file' : 'فایل',\n    'video': 'ویدیو',\n    'choose_file': 'انتخاب فایل',\n    'resources': 'منابع',\n    'all': 'همه',\n\n    'q_and_a_s': 'پرسش و پاسخ ها',\n    'create_question_page':'ثبت پرسش',\n    'create_question':'ثبت پرسش',\n    'question_content':'متن پرسش',\n    'default_is_private_question':'پرسش فقط توسط مدیران دیده شود',\n    '':'',\n\n    'chats': 'گفتگوها',\n    'details':'جزئیات',\n    'welcome':'خوش آمدید',\n    'welcome_note':'با ورود به این سامانه می توانید رویدادهای خود را مدیریت کنید یا در سایر رویداد ها شرکت کنید.',\n    'sign_up_now':'هم اکنون ثبت نام کنید',\n    'your_email':'ایمیل',\n    'your_name':'نام کامل',\n    'choose_password':'انتخاب رمزعبور',\n    'repeat_password':'تکرار رمزعبور',\n    'password_rule':'رمزعبور حتما باید ۸ رقمی باشد',\n    'sign_up_and_continue':'ثبت نام و ادامه',\n    'login_if_registered':'اگر قبلا ثبت نام کرده اید',\n    'if_not_registered': 'اگر ثبت نام نکرده اید',\n    'login':'وارد شوید',\n    'sign_up':'ثبت نام کنید',\n    'password':'رمز عبور',\n    'enter_bigblue_room':'ورود به اتاق تعامل',\n    '':'',\n\n    'cas':'احراز هویت مرکزی',\n    'more':'بیشتر',\n    'date_from':'از تاریخ',\n    'date_to':'تا تاریخ',\n    'logout':'خروج',\n    'write_something':'اینجا بنویسید ...',\n    'provide_following_info':'اطلاعات زیر را تکمیل کنید',\n    'cancel':'انصراف',\n    'submit':'ثبت',    \n    'filter':'فیلتر کن',\n    'search_placeholder':'جستجو...',\n    'contains_words': 'شامل حروف',\n    'save':'ذخیره',\n    'filter_and_search':'فیلتر و جستجو',\n    'tags': 'برچسب ها',\n    'is_private':'خصوصی',\n    'speakers': 'صحبت کنندگان',\n    'listeners': 'شنوندگان',\n    'moderator': 'مدیر',\n    'listener': 'شنونده',\n    'presenter': 'ارائه دهنده',\n    'speaker': 'صحبت کننده',\n    'calendar':'تقویم',\n    'enter_room': 'ورود به جلسه',\n    'default_is_private_info':'کاربران نمیتوانند خودشان در رویداد ها یا نشست های خصوصی عضو شوند و صرفا باید دعوت شوند',\n  }\n\n}\n","import React from 'react'\nimport { useHistory } from \"react-router-dom\";\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\n\nexport default class Header extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.getInstance = this.getInstance.bind(this);\n        this.logout = this.logout.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            profile: { name: '', initials: '' },\n        }\n\n    }\n\n\n    componentWillMount() {\n        ModelStore.on(\"got_instance\", this.getInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_instance\", this.getInstance);\n    }\n\n    componentDidMount() {\n        if(this.state.token && this.state.token.length > 10){\n            MyActions.getInstance('profiles/my', 1, this.state.token);\n        } else {\n            this.props.history.push(\"login\")\n        }\n        \n    }\n\n    getInstance() {\n        var profile = ModelStore.getIntance()\n        var klass = ModelStore.getKlass()\n        if (profile && klass === 'Profile') {\n            this.setState({\n                profile: profile,\n            });\n        }\n    }\n\n\n\n    handleChange(obj) {\n\n    }\n\n    logout() {\n        this.setState({ token: null });\n        window.localStorage.removeItem('token');\n        window.location.replace('/')\n    }\n\n\n\n\n    render() {\n        const t = dict['fa']\n        return (\n            <header className=\"navbar navbar-expand-md navbar-dark d-print-none\">\n                <div className=\"container-xl\">\n                    <button\n                        className=\"navbar-toggler\"\n                        type=\"button\"\n                        data-bs-toggle=\"collapse\"\n                        data-bs-target=\"#navbar-menu\"\n                    >\n                        <span className=\"navbar-toggler-icon\"></span>\n                    </button>\n                    <h1 className=\"navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3\">\n                        <a href=\"/#/\"></a>\n                    </h1>\n                    <div className=\"navbar-nav flex-row order-md-last\">\n                        <div class=\"nav-item d-none d-md-flex me-3\">\n                            <a href=\"/#/discussions\" className=\"nav-link px-0\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M3 20l1.3 -3.9a9 8 0 1 1 3.4 2.9l-4.7 1\" /><line x1=\"12\" y1=\"12\" x2=\"12\" y2=\"12.01\" /><line x1=\"8\" y1=\"12\" x2=\"8\" y2=\"12.01\" /><line x1=\"16\" y1=\"12\" x2=\"16\" y2=\"12.01\" /></svg>\n                                <span className=\"badge bg-red\"></span>\n                            </a>\n                        </div>\n\n                        <div className=\"nav-item dropdown\">\n                            <a\n                                href=\"#\"\n                                className=\"nav-link d-flex lh-1 text-reset p-0\"\n                                data-bs-toggle=\"dropdown\"\n                                aria-label=\"Open user menu\"\n                            >\n                                <span className=\"avatar avatar-sm\">{this.state.profile.initials}</span>\n                                <div className=\"d-xl-block ps-2\">\n                                    <div>{this.state.profile.name}</div>\n                                    <div className=\"mt-1 small text-muted\"></div>\n                                </div>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end dropdown-menu-arrow\">\n                                <a onClick={() => this.logout()} className=\"dropdown-item\">\n                                    {t['logout']}\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"collapse navbar-collapse\" id=\"navbar-menu\">\n                        <div className=\"d-flex flex-column flex-md-row flex-fill align-items-stretch align-items-md-center\">\n                            <ul className=\"navbar-nav\">\n                                <li className=\"nav-item\">\n                                    <a className=\"nav-link\" href=\"/#/\">\n                                        <span className=\"nav-link-icon d-md-none d-lg-inline-block\">\n                                            <svg\n                                                xmlns=\"http://www.w3.org/2000/svg\"\n                                                className=\"icon\"\n                                                width=\"24\"\n                                                height=\"24\"\n                                                viewBox=\"0 0 24 24\"\n                                                stroke-width=\"2\"\n                                                stroke=\"currentColor\"\n                                                fill=\"none\"\n                                                stroke-linecap=\"round\"\n                                                stroke-linejoin=\"round\"\n                                            >\n                                                <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\n                                                <polyline points=\"5 12 3 12 12 3 21 12 19 12\" />\n                                                <path d=\"M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7\" />\n                                                <path d=\"M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6\" />\n                                            </svg>\n                                        </span>\n                                        <span className=\"nav-link-title\">{t['home']}</span>\n                                    </a>\n                                </li>\n\n                                <li className=\"nav-item\">\n                                    <a className=\"nav-link\" href=\"/#/events\">\n                                        <span className=\"nav-link-icon d-md-none d-lg-inline-block\">\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><rect x=\"4\" y=\"5\" width=\"16\" height=\"16\" rx=\"2\" /><line x1=\"16\" y1=\"3\" x2=\"16\" y2=\"7\" /><line x1=\"8\" y1=\"3\" x2=\"8\" y2=\"7\" /><line x1=\"4\" y1=\"11\" x2=\"20\" y2=\"11\" /><rect x=\"8\" y=\"15\" width=\"2\" height=\"2\" /></svg>\n                                        </span>\n                                        <span className=\"nav-link-title\">{t['events']}</span>\n                                    </a>\n                                </li>\n\n                                <li className=\"nav-item\">\n                                    <a className=\"nav-link\" href=\"/#/meetings\">\n                                        <span className=\"nav-link-icon d-md-none d-lg-inline-block\">\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"3\" y1=\"4\" x2=\"21\" y2=\"4\" /><path d=\"M4 4v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-10\" /><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"20\" /><line x1=\"9\" y1=\"20\" x2=\"15\" y2=\"20\" /><path d=\"M8 12l3 -3l2 2l3 -3\" /></svg>\n                                        </span>\n                                        <span className=\"nav-link-title\">{t['meetings']}</span>\n                                    </a>\n                                </li>\n\n                                <li className=\"nav-item\">\n                                    <a className=\"nav-link\" href=\"/#/exhibitions\">\n                                        <span className=\"nav-link-icon d-md-none d-lg-inline-block\">\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"12\" cy=\"12\" r=\"9\" /><line x1=\"3.6\" y1=\"9\" x2=\"20.4\" y2=\"9\" /><line x1=\"3.6\" y1=\"15\" x2=\"20.4\" y2=\"15\" /><path d=\"M11.5 3a17 17 0 0 0 0 18\" /><path d=\"M12.5 3a17 17 0 0 1 0 18\" /></svg>\n                                        </span>\n                                        <span className=\"nav-link-title\">{t['exhibitions']}</span>\n                                    </a>\n                                </li>\n\n                                <li className=\"nav-item\">\n                                    <a className=\"nav-link\" href=\"/#/profiles\">\n                                        <span className=\"nav-link-icon d-md-none d-lg-inline-block\">\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"9\" cy=\"7\" r=\"4\" /><path d=\"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2\" /><path d=\"M16 3.13a4 4 0 0 1 0 7.75\" /><path d=\"M21 21v-2a4 4 0 0 0 -3 -3.85\" /></svg>\n                                        </span>\n                                        <span className=\"nav-link-title\">{t['users']}</span>\n                                    </a>\n                                </li>\n\n\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </header>\n        )\n    }\n}\n\n\n\n\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport { v4 as uuidv4 } from 'uuid';\nimport moment from 'jalali-moment'\nmoment.locale('fa', { useGregorianParser: true });\n\nconst t = dict['fa']\n\nconst EventCard = (props) => {\n\n    function formatGregorianDate(gregorianDate) {\n        var date = new Date(gregorianDate);\n        var day = date.getDate();\n        var month = date.getMonth() + 1;\n        var year = date.getFullYear();\n        var hours = date.getHours();\n        var minutes = date.getMinutes();\n        var fullYear = year + '/' + month + '/' + day + ' ' + hours + ':' + minutes;\n        return fullYear;\n    }\n\n\n    function cardCover(event) {\n        if (event.cover) {\n            return (\n                <a href={'/#/events/' + event.id}>\n                    <div class=\"card-img-top img-responsive img-responsive-16by9\" style={{ backgroundImage: \"url(\" + event.cover + \")\" }}></div>\n                </a>\n            )\n        }\n    }\n\n    function tagsShow(tags) {\n        var result = []\n        if (tags && tags.length > 0) {\n            tags.map((tag) => {\n                result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n            })\n        }\n        return result\n    }\n\n    function eventItems() {\n        var result = []\n        if (props.events) {\n            props.events.map((event) => {\n                result.push(\n\n                    <div className={props.col ? \"col-md-\" + props.col : \"col-md-8\"}>\n                        <div className=\"card\">\n                            {cardCover(event)}\n                            <div className=\"card-body\">\n                                <h3 class=\"card-title\">\n                                    <a href={'/#/events/' + event.id}>\n                                        {event.title}\n                                    </a>\n                                </h3>\n                                <p style={{ textAlign: 'justify' }}>\n                                    {event.truncated_info}\n                                </p>\n\n                                <h4>{t['event_type']}:</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {t[event.event_type]}\n                                </div>\n\n\n\n                                <h4>{t['meeting_start_time']}:</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {moment(formatGregorianDate(event.start_date)).format('HH:mm jYYYY/jMM/jDD')}\n                                </div>\n\n                                <h4>{t['meeting_end_time']}:</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {moment(formatGregorianDate(event.end_date)).format('HH:mm YYYY/MM/DD')}\n                                </div>\n\n                                <h4>{t['tags']}</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {tagsShow(event.tags)}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n    return (\n        <React.Fragment>\n            {eventItems()}\n        </React.Fragment>\n    )\n}\nexport default EventCard;\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\n\n\nconst ProfileCard = (props) => {\n    return (\n<div className=\"col-lg-4\">\n                <div className=\"card\" style={{height: '24rem'}}>\n                    <div className=\"card-header\">Pepole to follow</div>\n                  <div className=\"list-group card-list-group card-body-scrollable card-body-scrollable-shadow\">\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          1\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/a4fb1d293bd8d3fd38352418c50fcf1369a7a87d.jpg\" className=\"rounded\" alt=\"Górą ty\" width=\"40\" height=\"40\" /> \n                        </div>\n                        <div className=\"col\">\n                          Górą ty\n                          <div className=\"text-muted\">\n                            GOLEC UORKIESTRA,\n                            Gromee,\n                            Bedoes\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:41\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          2\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/f04bb6fba32e89475d9981007aff21e13745dec2.jpg\" className=\"rounded\" alt=\"High Life\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          High Life\n                          <div className=\"text-muted\">\n                            Daft Punk\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:21\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          3\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/c3f13b4f7a674abda9aa36fd72fa341e918c0f26.jpg\" className=\"rounded\" alt=\"Houdini\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Houdini\n                          <div className=\"text-muted\">\n                            Foster The People\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:23\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          4\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/4d4ab714dfca7b9df41d4a02a2c39394ebdeb6b6.jpg\" className=\"rounded\" alt=\"Safe And Sound\" width=\"40\" height=\"40\"/>\n                        </div>\n                        <div className=\"col\">\n                          Safe And Sound\n                          <div className=\"text-muted\">\n                            Capital Cities\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:12\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          5\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/79b2422b467ad20c07576e8f8f5f2f1692ac7142.jpg\" className=\"rounded\" alt=\"Partied Out\" width=\"40\" height=\"40\"/>\n                        </div>\n                        <div className=\"col\">\n                          Partied Out\n                          <div className=\"text-muted\">\n                            Con Bro Chill\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:17\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          6\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/aac97056fc02fe02c7e95f7ff77a07c6e82f7d6e.jpg\" className=\"rounded\" alt=\"Runaway (U &amp; I)\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Runaway (U &amp; I)\n                          <div className=\"text-muted\">\n                            Galantis\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:47\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          7\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/859337f0eaa49b1ad6ed76719b7c1ae26d6412c8.jpg\" className=\"rounded\" alt=\"Light It Up\" width=\"40\" height=\"40\"/>\n                        </div>\n                        <div className=\"col\">\n                          Light It Up \n                          <div className=\"text-muted\">\n                            Major Lazer,\n                            Nyla,\n                            Fuse ODG\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          02:46\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          8\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/2e7357491deb8a6796ee8d9181ca9ea1f407bb5f.jpg\" className=\"rounded\" alt=\"Hangover\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Hangover\n                          <div className=\"text-muted\">\n                            Taio Cruz,\n                            Flo Rida\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          04:04\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          9\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/c976bfc96d5e44820e553a16a6097cd02a61fd2f.jpg\" className=\"rounded\" alt=\"Shape of You\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Shape of You\n                          <div className=\"text-muted\">\n                            Ed Sheeran\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:53\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          10\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/c9a8350feee77e9345eec4155cddc96694803d1a.jpg\" className=\"rounded\" alt=\"Alone\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Alone\n                          <div className=\"text-muted\">\n                            Alan Walker\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          02:41\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          11\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/fe4ee21d30450829e5b172e806b3c1e14ca1e5f3.jpg\" className=\"rounded\" alt=\"Langrennsfar\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Langrennsfar\n                          <div className=\"text-muted\">\n                            Ylvis\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          02:43\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                               \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                                \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"list-group-item\">\n                      <div className=\"row g-2 align-items-center\">\n                        <div className=\"col-auto text-h3\">\n                          12\n                        </div>\n                        <div className=\"col-auto\">\n                          <img src=\"./static/tracks/f4e96086f44c4dff1758b1fc1338cd88c1b5ce9c.jpg\" className=\"rounded\" alt=\"Skibidi\" width=\"40\" height=\"40\" />\n                        </div>\n                        <div className=\"col\">\n                          Skibidi \n                          <div className=\"text-muted\">\n                            Little Big\n                          </div>\n                        </div>\n                        <div className=\"col-auto text-muted\">\n                          03:12\n                        </div>\n                        <div className=\"col-auto\">\n                          <a href=\"#\" className=\"link-secondary\">\n                            <button className=\"switch-icon\" data-bs-toggle=\"switch-icon\">\n                              <span className=\"switch-icon-a text-muted\">\n                               \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                              <span className=\"switch-icon-b text-red\">\n                            \n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon icon-filled\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M19.5 13.572l-7.5 7.428l-7.5 -7.428m0 0a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572\"></path></svg>\n                              </span>\n                            </button>\n                          </a>\n                        </div>\n                        <div className=\"col-auto lh-1\">\n                          <div className=\"dropdown\">\n                            <a href=\"#\" className=\"link-secondary\" data-bs-toggle=\"dropdown\">  \n                              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"5\" cy=\"12\" r=\"1\"></circle><circle cx=\"12\" cy=\"12\" r=\"1\"></circle><circle cx=\"19\" cy=\"12\" r=\"1\"></circle></svg>\n                            </a>\n                            <div className=\"dropdown-menu dropdown-menu-end\">\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Action\n                              </a>\n                              <a className=\"dropdown-item\" href=\"#\">\n                                Another action\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n    )\n}\nexport default ProfileCard;\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\n\n\nconst AttendanceCard = (props) => {\n    const t = dict['fa']\n    function attendees() {\n        var result = []\n        if (props.attendees) {\n            props.attendees.map((attendee) => {\n                result.push(<span class=\"avatar avatar-sm avatar-rounded\" >{attendee.initials}</span>)\n            });\n        }\n\n        return result\n    }\n\n    function createBtn() {\n        if (props.is_admin) {\n            return (\n                <li class=\"nav-item ms-auto\">\n                    <a class=\"nav-link p-1\" href={\"/#/attendances/create?\" + props.attendable_type + \"_id=\" + props.attendable_id}>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"9\" cy=\"7\" r=\"4\" /><path d=\"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2\" /><path d=\"M16 11h6m-3 -3v6\" /></svg>\n                    </a>\n                </li>\n            )\n        }\n    }\n\n    return (\n\n        <div className=\"card mb-3\" style={props.height ? { height: props.height } : { height: 'auto' }}>\n            <div className=\"card-header\" >\n                <h3 class=\"card-title\">{t['participants']}</h3>\n                <ul class=\"nav nav-pills card-header-pills\">\n                    {createBtn()}\n                </ul>\n            </div>\n            <div className=\"card-body card-body-scrollable card-body-scrollable-shadow\">\n\n                <div class=\"avatar-list avatar-list-stacked\">\n                    {attendees()}\n                </div>\n\n            </div>\n\n        </div>\n\n    )\n}\nexport default AttendanceCard;","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport EventCard from \"../events/card.jsx\";\nimport ProfileCard from \"../profiles/card.jsx\";\nimport ProgressCard from \"../attendances/card.jsx\";\n\nexport default class Dashboard extends React.Component {\n\n    constructor(props) {\n        super(props);\n        //this.submit = this.submit.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n    }\n\n    componentDidMount() {\n\n    }\n\n\n\n    handleChange(obj) {\n\n    }\n\n    setInstance() {\n        \n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n            <div className=\"wrapper\">\n              <Header history={this.props.history}/>\n              <div className=\"page-wrapper\">\n                <div className=\"container-xl\">\n                  <div className=\"page-header d-print-none\">\n                    <div className=\"row align-items-center\"></div>\n                    <div className=\"col\">\n                      <div className=\"page-pretitle\">Overview</div>\n                      <h2 className=\"page-title\">Condensed dark layout</h2>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"page-body\">\n                  <div className=\"container-xl\">\n                    <div className=\"row row-deck row-cards\">\n                      <EventCard />\n                      <ProfileCard />\n                      <ProgressCard />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </body>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport { CountryDropdown, RegionDropdown, CountryRegionData } from 'react-country-region-selector';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class UserWizard extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.submit = this.submit.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.getInstance = this.getInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            email: null,\n            name: null,\n            password: null,\n            password_confirmation: null,\n            id: null,\n            bio: null,\n            country: null,\n            initials: 'NN',\n            options: [],\n            tags: []\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n        ModelStore.on(\"got_instance\", this.getInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n        ModelStore.removeListener(\"got_instance\", this.getInstance);\n    }\n\n    componentDidMount() {\n        if (this.state.token && this.state.token !== '') {\n            MyActions.getInstance('profiles/my', '1', this.state.token);\n        }\n    }\n\n    getInstance() {\n        var profile = ModelStore.getIntance()\n        var klass = ModelStore.getKlass()\n        if (profile && klass === 'Profile') {\n            this.setState({\n                id: profile.id,\n                name: profile.name,\n                bio: profile.bio,\n                country: profile.country,\n                initials: profile.initials,\n                tags: profile.tags\n            })\n            console.log(profile.tags)\n        }\n    }\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    setInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'SignUp') {\n            window.localStorage.setItem('token', model.token);\n            window.location.reload()\n        }\n        if (klass === 'Profile') {\n            this.props.history.push(\"/#/\")\n        }\n    }\n\n\n    submit() {\n        var data = this.state\n        MyActions.setInstance('users/sign_up', data);\n    }\n\n    submitProfile() {\n        var data = this.state\n        MyActions.updateInstance('profiles', data, this.state.token);\n    }\n\n    tagSelected(tags) {\n        var result = []\n        tags.map((tag) => {\n            if (tag['title']) {\n                result.push(tag['title'])\n            } else {\n                result.push(tag)\n            }\n        })\n        this.setState({ tags: result }, () => console.log(this.state.tags))\n    }\n\n    checkSignUp() {\n        if (!this.state.token || this.state.token === '') {\n            return (this.notSignedUp())\n        } else {\n            return (this.signedUp())\n        }\n    }\n\n    notSignedUp() {\n        return (\n            <React.Fragment>\n                <div class=\"text-center mb-4\">\n                    <a href=\".\"><img src=\"./static/logo.svg\" height=\"36\" alt=\"\" /></a>\n                </div>\n                <div class=\"card card-md\">\n                    <div class=\"card-body text-center py-4 p-sm-5\">\n                        <img src=\"./static/illustrations/undraw_sign_in_e6hj.svg\" height=\"128\" class=\"mb-n2\" alt=\"\" />\n                        <h1 class=\"mt-5\">{t['welcome']}</h1>\n                        <p class=\"text-muted\">{t['welcome_note']}</p>\n                        <p class=\"text-muted\">{t['login_if_registered']}</p>\n                        <a href=\"/#/login\" class=\"btn btn-outline-success w-100\">\n                          {t['login']}\n                        </a>\n                    </div>\n                    <div class=\"hr-text hr-text-center hr-text-spaceless\">{t['sign_up_now']}</div>\n                    <div class=\"card-body\">\n                        <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['your_email']}</label>\n                            <div class=\"input-group input-group-flat\">\n                                <span class=\"input-group-text\"></span>\n                                <input type=\"text\" onInput={(e) => { this.handleChange({ email: e.target.value }) }} class=\"form-control ps-1\" autocomplete=\"off\" />\n                            </div>\n                            <div class=\"form-hint\"></div>\n                        </div>\n\n                        <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['your_name']}</label>\n                            <div class=\"input-group input-group-flat\">\n                                <span class=\"input-group-text\"></span>\n                                <input type=\"text\" onInput={(e) => { this.handleChange({ name: e.target.value }) }} class=\"form-control ps-1\" autocomplete=\"off\" />\n                            </div>\n                            <div class=\"form-hint\"></div>\n                        </div>\n\n                        <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['choose_password']}</label>\n                            <div class=\"input-group input-group-flat\">\n                                <span class=\"input-group-text\"></span>\n                                <input type=\"text\" onInput={(e) => { this.handleChange({ password: e.target.value }) }} class=\"form-control ps-1\" autocomplete=\"off\" />\n                            </div>\n                            <div class=\"form-hint\">{t['password_rule']}</div>\n                        </div>\n\n                        <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['repeat_password']}</label>\n                            <div class=\"input-group input-group-flat\">\n                                <span class=\"input-group-text\"></span>\n                                <input type=\"text\" onInput={(e) => { this.handleChange({ password_confirmation: e.target.value }) }} class=\"form-control ps-1\" autocomplete=\"off\" />\n                            </div>\n                            <div class=\"form-hint\"></div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"row align-items-center mt-3\">\n                    <div class=\"col-4\">\n                        <div class=\"progress\">\n                            <div class=\"progress-bar\" style={{ width: \"25%\" }} role=\"progressbar\" aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                                <span class=\"visually-hidden\">25% Complete</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"col\">\n                        <div class=\"btn-list justify-content-end\">\n                            <button onClick={() => this.submit()} class=\"btn btn-primary\">\n                            {t['sign_up_and_continue']}  \n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </React.Fragment>\n        )\n    }\n\n    signedUp() {\n        if (this.state.id) {\n            return (\n                <React.Fragment>\n                    <div class=\"card card-md\">\n                        <div class=\"card-body text-center py-4 p-sm-5\">\n                            <span class=\"avatar avatar-xl mb-2 avatar-rounded\">{this.state.initials}</span>\n                            <p class=\"text-muted\">Click to change your profile picture</p>\n                        </div>\n\n                        <div class=\"hr-text hr-text-center hr-text-spaceless\">Complete your profile</div>\n\n                        <div class=\"card-body\">\n                            <div class=\"mb-3\">\n                                <label class=\"form-label\">Your country</label>\n                                <div class=\"input-group input-group-flat\">\n                                    <span class=\"input-group-text\"></span>\n                                    <CountryDropdown classes={\"form-control ps-1\"} priorityOptions={['CA', 'IR', 'US']} value={this.state.country} onChange={(val) => this.handleChange({ country: val })} />\n                                </div>\n                            </div>\n\n                            <div class=\"mb-3\">\n                                <label class=\"form-label\">Bio<span class=\"form-label-description\"></span></label>\n                                <textarea\n                                    class=\"form-control\"\n                                    name=\"example-textarea-input\"\n                                    rows=\"6\"\n                                    placeholder=\"Write about your self ...\"\n                                    onInput={(e) => { this.handleChange({ bio: e.target.value }) }}\n                                    value={this.state.bio}>\n                                </textarea>\n                            </div>\n                            <div class=\"mb-3\">\n                                <AsyncTypeahead\n                                    id='yytyty'\n                                    allowNew\n                                    multiple\n                                    defaultSelected={this.state.tags}\n                                    isLoading={this.state.isLoading}\n                                    labelKey='title'\n                                    onSearch={(query) => {\n                                        this.setState({ isLoading: true });\n                                        fetch(server + \"/tags/search?q=\" + query)\n                                            .then((resp) => resp.json())\n                                            .then(({ items }) => {\n                                                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n                                            });\n                                    }}\n                                    onChange={(t) => this.tagSelected(t)}\n                                    options={this.state.options}\n                                    renderMenuItemChildren={(option, props) => (\n                                        <React.Fragment>\n                                            <span>{option.title}</span>\n                                        </React.Fragment>\n                                    )}\n                                />\n                            </div>\n\n                        </div>\n                    </div>\n                    <div class=\"row align-items-center mt-3\">\n                        <div class=\"col-4\">\n                            <div class=\"progress\">\n                                <div class=\"progress-bar\" style={{ width: \"75%\" }} role=\"progressbar\" aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                                    <span class=\"visually-hidden\">25% Complete</span>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"col\">\n                            <div class=\"btn-list justify-content-end\">\n                                <a href=\"/#/\" class=\"btn btn-link link-secondary\">\n                                    Complete later\n                                </a>\n                                <button onClick={() => this.submitProfile()} class=\"btn btn-primary\">\n                                    Continue\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </React.Fragment>\n            )\n        }\n    }\n\n\n    render() {\n        return (\n            <div class=\"page page-center\">\n                <div class=\"container-tight py-4\">\n                    {this.checkSignUp()}\n\n                </div>\n            </div>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport { CountryDropdown, RegionDropdown, CountryRegionData } from 'react-country-region-selector';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class UserWizard extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.submit = this.submit.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            email: null,\n            password: null,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n    }\n\n    componentDidMount() {\n        if (this.state.token && this.state.token !== '') {\n            //  MyActions.getInstance('profiles/my', '1', this.state.token);\n        }\n    }\n\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    setInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'Login') {\n            window.localStorage.setItem('token', model.token);\n            this.props.history.push(\"/#/events\")\n        }\n    }\n\n\n    submit() {\n        var data = this.state\n        MyActions.setInstance('users/login', data);\n    }\n\n    render() {\n        return (\n            <div class=\"page page-center\">\n                <div class=\"container-tight py-4\">\n                    <React.Fragment>\n                        <div class=\"text-center mb-4\">\n                            <a href=\".\"><img src=\"./static/logo.svg\" height=\"36\" alt=\"\" /></a>\n                        </div>\n                        <div class=\"card card-md\">\n                            <div class=\"card-body text-center py-4 p-sm-5\">\n                                <img src=\"./static/illustrations/undraw_sign_in_e6hj.svg\" height=\"128\" class=\"mb-n2\" alt=\"\" />\n                                <h1 class=\"mt-5\">{t['welcome']}</h1>\n                                <p class=\"text-muted\">{t['welcome_note']}</p>\n                                <p class=\"text-muted\">{t['if_not_registered']}</p>\n                                <a href=\"/#/wizard\" class=\"btn btn-outline-primary w-100\">\n                                    {t['sign_up']}\n                                </a>\n                            </div>\n                            <div class=\"hr-text hr-text-center hr-text-spaceless\">{t['login_now']}</div>\n                            <div class=\"card-body\">\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\">{t['your_email']}</label>\n                                    <div class=\"input-group input-group-flat\">\n                                        <span class=\"input-group-text\"></span>\n                                        <input type=\"text\" onInput={(e) => { this.handleChange({ email: e.target.value }) }} class=\"form-control ps-1\" autocomplete=\"off\" />\n                                    </div>\n                                    <div class=\"form-hint\"></div>\n                                </div>\n\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\">{t['password']}</label>\n                                    <div class=\"input-group input-group-flat\">\n                                        <span class=\"input-group-text\"></span>\n                                        <input type=\"password\" onInput={(e) => { this.handleChange({ password: e.target.value }) }} class=\"form-control ps-1\" autocomplete=\"off\" />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"row align-items-center mt-3\">\n                            <div class=\"col-4\">\n\n                            </div>\n                            <div class=\"col\">\n                                <div class=\"btn-list justify-content-end\">\n                                    <button href=\"https://auth.ut.ac.ir:8443/cas/login?service=https%3A%2F%2Fevent.ut.ac.ir%2Fusers%2Fservice\" class=\"btn bg-azure-lt\">\n                                        {t['cas']}\n                                    </button>\n\n                                    <button onClick={() => this.submit()} class=\"btn btn-success\">\n                                        {t['login']}\n                                    </button>\n\n\n                                </div>\n                            </div>\n                        </div>\n                    </React.Fragment>\n                </div>\n            </div>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport EventCard from \"./card.jsx\";\nimport moment from 'moment-jalaali'\nimport DatePicker2 from 'react-datepicker2';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\n\nconst t = dict['fa']\n\nexport default class EventIndex extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.getList = this.getList.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            events: null,\n            allTags: null,\n            q: '',\n            start_from: moment(),\n            start_to: moment().add(2, 'jMonth'),\n            tags: [],\n            page: 1,\n        }\n\n    }\n\n\n    componentWillMount() {\n        ModelStore.on(\"got_list\", this.getList);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_list\", this.getList);\n    }\n\n    componentDidMount() {\n        MyActions.getList('events', this.state.page, {}, this.state.token);\n        MyActions.getList('tags/top', this.state.page, {}, this.state.token);\n    }\n\n    getList() {\n        var list = ModelStore.getList()\n        var klass = ModelStore.getKlass()\n\n        if (list && klass === 'Event') {\n            $('#search-spinner').hide();\n            if (list[0] && list[0].page) {\n                if (list[0].page == 1) {\n                    this.setState({\n                        events: list,\n                    });\n                } else {\n                    this.setState({\n                        events: this.state.events.concat(list),\n                    });\n                }\n                this.setState({ page: list[0].page })\n            } else {\n                this.setState({\n                    events: [],\n                });\n            }\n            console.log(list)\n        }\n        if (list && klass === 'Tag') {\n            this.setState({\n                allTags: list,\n            });\n        }\n    }\n\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n\n    noEventCard() {\n        <div class=\"col-12\">\n            <div class=\"card\">\n                <div class=\"empty\">\n                    <div class=\"empty-img\"><img src=\"./static/illustrations/undraw_quitting_time_dm8t.svg\" height=\"128\" alt=\"\" />\n                    </div>\n                    <p class=\"empty-title\">No results found</p>\n                    <p class=\"empty-subtitle text-muted\">\n                        Try adjusting your search or filter to find what you're looking for.\n                    </p>\n                    <div class=\"empty-action\">\n                        <a href=\"/#/events/create\" class=\"btn btn-primary\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><rect x=\"4\" y=\"5\" width=\"16\" height=\"16\" rx=\"2\" /><line x1=\"16\" y1=\"3\" x2=\"16\" y2=\"7\" /><line x1=\"8\" y1=\"3\" x2=\"8\" y2=\"7\" /><line x1=\"4\" y1=\"11\" x2=\"20\" y2=\"11\" /><line x1=\"10\" y1=\"16\" x2=\"14\" y2=\"16\" /><line x1=\"12\" y1=\"14\" x2=\"12\" y2=\"18\" /></svg>\n                            Create an event\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    }\n\n    checkEvent() {\n        if (this.state.events) {\n            return (\n                <React.Fragment>\n                    <div class=\"col-4\">\n                        <div class=\"card\">\n                            <div class=\"card-status-top bg-lime\"></div>\n                            <div className=\"card-header\" >\n                                <h3 class=\"card-title\">{t['events']}</h3>\n                                <ul class=\"nav nav-pills card-header-pills\">\n                                    <li class=\"nav-item ms-auto\">\n                                        <a class=\"nav-link p-1\" href={\"/#/events/create\"}>\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                                        </a>\n                                    </li>\n                                </ul>\n                            </div>\n                            <div class=\"card-body\">\n                                <p>\n                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam deleniti fugit incidunt, iste, itaque minima neque pariatur perferendis sed suscipit velit vitae voluptatem\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <EventCard events={this.state.events} col={8} />\n                </React.Fragment>\n            )\n        } else {\n            return (this.noEventCard())\n        }\n    }\n\n    cardMasonry() {\n        if (this.state.events) {\n            return (\n                <div class='row row-cards' data-masonry='{\"percentPosition\": true }' >\n                    <EventCard events={this.state.events} col={6} />\n                </div>\n            )\n        }\n    }\n\n    search() {\n        $('#search-spinner').show();\n        var data = { q: this.state.q, start_from: this.state.start_from, start_to: this.state.start_to, tags: this.state.tags }\n        MyActions.getList('events/search', this.state.page, data, this.state.token);\n        this.setState({ page: 1 })\n    }\n\n    tagCheckbox() {\n        var result = []\n        if (this.state.allTags) {\n            this.state.allTags.map((tag) => {\n                result.push(\n                    <label class=\"form-check\">\n                        <input id={'tag-check-' + tag.id} class=\"form-check-input\" type=\"checkbox\" style={{ marginTop: '3.5px' }} value={tag.id} onChange={(e) => this.changeTags(e)} />\n                        <span class=\"form-check-label\">\n                            <span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>\n                        </span>\n                    </label>\n                )\n            })\n        }\n        return result\n    }\n\n    tagSelected(tags) {\n        var result = []\n        tags.map((tag) => {\n            if (tag['title']) {\n                result.push(tag['title'])\n            } else {\n                result.push(tag)\n            }\n        })\n        this.setState({ tags: result }, () => console.log(this.state.tags))\n    }\n\n    tagInput() {\n        return (\n            <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n                <AsyncTypeahead\n                    id='search-tag'\n                    multiple\n                    defaultSelected={this.state.tags}\n                    isLoading={this.state.isLoading}\n                    labelKey='title'\n                    onSearch={(query) => {\n                        this.setState({ isLoading: true });\n                        fetch(server + \"/tags/search?q=\" + query)\n                            .then((resp) => resp.json())\n                            .then(({ items }) => {\n                                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n                            });\n                    }}\n                    onChange={(t) => this.tagSelected(t)}\n                    options={this.state.options}\n                    renderMenuItemChildren={(option, props) => (\n                        <React.Fragment>\n                            <span>{option.title}</span>\n                        </React.Fragment>\n                    )}\n                />\n            </div>\n        )\n    }\n\n\n    loadMore() {\n        var data = { id: this.state.id, page: this.state.page + 1, q: this.state.q, start_from: this.state.start_from, start_to: this.state.start_to, tags: this.state.tags }\n        MyActions.getList('events/search', this.state.page, data, this.state.token);\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history} />\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\">\n                                    <div className=\"col\">\n                                        <div className=\"page-pretitle\">{t['overview']}</div>\n                                        <h2 className=\"page-title\">{t['events']}</h2>\n                                    </div>\n                                    <div class=\"col-auto ms-auto d-print-none\">\n                                        <div class=\"btn-list\">\n                                            <a href={\"/#/events/create\"} class=\"btn btn-primary\"  >\n                                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n                                                {t['create_event']}\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div class=\"row\">\n                                    <div class=\"col-lg-3\">\n                                        <div class=\"card mb-3\">\n                                            <div className=\"card-header\" >\n                                                <h4 class=\"card-title\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                                                    {t['filter_events']}\n                                                </h4>\n                                            </div>\n\n                                            <div class=\"card-body\">\n                                                <div class=\"mb-3\">\n                                                    <label class=\"form-label\">{t['contains_words']}</label>\n                                                    <div class=\"input-icon mb-3\">\n                                                        <input type=\"text\" class=\"form-control\" placeholder={t['search_placeholder']} onInput={(e) => { this.handleChange({ q: e.target.value }) }} />\n                                                        <span class=\"input-icon-addon\">\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                        </span>\n                                                    </div>\n                                                </div>\n                                                <div class=\"mb-3\" style={{ width: '100%' }}>\n                                                    <label class=\"form-label \">{t['date_from']}<span class=\"form-label-description\"></span></label>\n                                                    <DatePicker2\n                                                        isGregorian={false}\n                                                        onChange={value => { this.setState({ start_from: value }) }}\n                                                        value={moment(this.state.start_from)}\n                                                    />\n                                                    <label class=\"form-label mt-2\">{t['date_to']}<span class=\"form-label-description\"></span></label>\n                                                    <DatePicker2\n                                                        isGregorian={false}\n                                                        onChange={value => { this.setState({ start_to: value }) }}\n                                                        value={moment(this.state.start_to)}\n                                                    />\n                                                </div>\n\n                                                <div class=\"mb-3 \" id='tags' >\n                                                    <label class=\"form-label\" >{t['tags']}</label>\n                                                    {this.tagInput()}\n                                                </div>\n                                            </div>\n                                            <div class=\"card-body\">\n\n                                                <a onClick={() => this.search()} class=\"btn btn-primary w-100\">\n                                                    <span style={{ verticalAlign: '-2px' }}>\n                                                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                                                    </span>\n                                                    {t['filter_and_search']}\n                                                    <div id='search-spinner' class=\"spinner-border text-red\" role=\"status\" style={{ display: 'none' }}></div>\n                                                </a>\n                                            </div>\n\n                                        </div>\n                                    </div>\n                                    <div class=\"col-lg-9\">\n                                        {this.cardMasonry()}\n                                        <div class=\"hr-text\">\n                                            <a onClick={() => this.loadMore()}>\n                                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"12\" cy=\"12\" r=\"9\" /><line x1=\"8\" y1=\"12\" x2=\"12\" y2=\"16\" /><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\" /><line x1=\"16\" y1=\"12\" x2=\"12\" y2=\"16\" /></svg>\n                                                {t['more']}\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport moment from 'jalali-moment'\nconst t = dict['fa']\n\nconst MeetingCard = (props) => {\n    function formatGregorianDate(gregorianDate) {\n        var date = new Date(gregorianDate);\n        var day = date.getDate();\n        var month = date.getMonth() + 1;\n        var year = date.getFullYear();\n        var hours = date.getHours();\n        var minutes = date.getMinutes();\n        var fullYear = year + '/' + month + '/' + day + ' ' + hours + ':' + minutes;\n        return fullYear;\n    }\n\n    function editBtn(meeting) {\n        if (props.is_admin) {\n            return (\n                <div class=\"col-auto\">\n                    <a href={\"/#/meetings/edit/\" + meeting.id} class=\"list-group-item-actions show\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n                    </a>\n                    <a onClick={() => props.deleteMeeting(meeting.id)} class=\"list-group-item-actions show\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n                    </a>\n                </div>\n            )\n        }\n    }\n\n    function meetingItems() {\n        var result = []\n        props.meetings.map((meeting) => {\n            result.push(\n                <div class=\"list-group-item\">\n                    <div class=\"row align-items-center\">\n                        <div class=\"col text-truncate\">\n                            <a href={'/#/meetings/' + meeting.id}>{meeting.title}</a>\n                            <small class=\"d-block text-muted text-truncate mt-n1\">\n                                {moment(formatGregorianDate(meeting.start_time)).format('HH:mm jYYYY/jMM/jDD')}\n                            </small>\n                        </div>\n                        {editBtn(meeting)}\n                    </div>\n                </div>\n            )\n        })\n        return result\n    }\n\n    function createBtn() {\n        if (props.is_admin) {\n            return (\n                <li class=\"nav-item ms-auto\">\n                    <a class=\"nav-link p-1\" href={\"/#/meetings/create?event_id=\" + props.id}>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                    </a>\n                </li>\n            )\n        }\n    }\n\n    return (\n        <div className={props.col ? \"col-md-\" + props.col : \"col-md-8\"}>\n            <div className=\"card mb-3\" style={props.height ? { height: props.height } : { height: 'auto' }}>\n                <div className=\"card-header\" >\n                    <h3 class=\"card-title\">{t['meetings']}</h3>\n                    <ul class=\"nav nav-pills card-header-pills\">\n                        {createBtn()}\n                    </ul>\n                </div>\n                <div class=\"list-group list-group-flush list-group-hoverable\">\n                    {meetingItems()}\n                </div>\n                <div class=\"card-footer\">\n                    <div class=\"d-flex\">\n                        <a herf=\"\" class=\"btn btn-link\"></a>\n                        <a href={'/#/events/detail/' + props.id} class=\"ms-auto\">{t['all']}</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\nexport default MeetingCard;\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport { Calendar } from 'react-datepicker2';\nimport moment from 'moment-jalaali'\n\nconst EventCalendar = (props) => {\n\n\n    return (\n        <Calendar\n        ranges={props.highlightRanges}\n        value={props.today}\n        isGregorian={false}\n        inputFormat=\"YYYY-M-D\"\n        inputJalaaliFormat=\"jYYYY-jM-jD\"\n        onChange={val => props.dateSelect(val)}\n      />\n    )\n}\nexport default EventCalendar;\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nconst t = dict['fa']\n\nconst EventInfo = (props) => {\n    function editBtn() {\n        if (props.is_admin) {\n            return (\n                <li class=\"nav-item ms-auto\">\n                    <a class=\"nav-link p-1\" href={\"/#/events/edit/\" + props.id}>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n                    </a>\n                </li>\n            )\n        }\n    }\n    return (\n        <div class=\"card mb-3\">\n            <div className=\"card-header bg-dark-lt\" >\n                <h3 class=\"card-title\">{props.title} </h3>\n                <ul class=\"nav nav-pills card-header-pills\">\n                    <li class=\"nav-item\" style={{ marginRight: '10px' }}>\n                        {props.isPrivateBadge()}\n                    </li>\n                    {editBtn()}\n                </ul>\n            </div>\n            <a onClick={() => props.toggleCalendar()}>\n                <div className=\"card-header cursor-pointer\" >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><rect x=\"4\" y=\"5\" width=\"16\" height=\"16\" rx=\"2\" /><line x1=\"16\" y1=\"3\" x2=\"16\" y2=\"7\" /><line x1=\"8\" y1=\"3\" x2=\"8\" y2=\"7\" /><line x1=\"4\" y1=\"11\" x2=\"20\" y2=\"11\" /><line x1=\"11\" y1=\"15\" x2=\"12\" y2=\"15\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"18\" /></svg>\n                    {t['calendar']}\n                    <ul class=\"nav nav-pills card-header-pills\">\n                        <li class=\"nav-item ms-auto\">\n\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /><line x1=\"5\" y1=\"12\" x2=\"11\" y2=\"18\" /><line x1=\"5\" y1=\"12\" x2=\"11\" y2=\"6\" /></svg>\n                        </li>\n                    </ul>\n                </div>\n            </a>\n            <div class=\"card-body\">\n                <h4>{t['event_info']}</h4>\n                <div class=\"text-muted mb-3\" style={{ textAlign: 'justify' }}>\n                    {props.info}\n                </div>\n\n                <h4>{t['event_type']}</h4>\n                <div class=\"text-muted mb-3\">\n                    {t[props.event_type]}\n                </div>\n\n                <h4>{t['tags']}</h4>\n                <div class=\"text-muted mb-3\">\n                    {props.tagsShow(props.tags)}\n                </div>\n\n            </div>\n        </div>\n    )\n}\nexport default EventInfo;\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport MeetingCard from \"../meetings/card.jsx\";\nimport AttendanceCard from \"../attendances/card.jsx\";\nimport { Calendar } from 'react-datepicker2';\nimport moment from 'moment-jalaali'\nimport EventCalendar from \"../events/calendar.jsx\";\nimport EventInfo from \"../events/info.jsx\";\nimport randomColor from \"randomcolor\";\nimport $ from 'jquery';\nimport Quill from 'quill';\nconst t = dict['fa']\n\nexport default class EventShow extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.dateSelect = this.dateSelect.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.isPrivateBadge = this.isPrivateBadge.bind(this);\n    this.toggleCalendar = this.toggleCalendar.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      id: null,\n      event_type: null,\n      info: null,\n      meetings: [],\n      flyers: [],\n      quillOne: null,\n      attendees: null,\n      tags: [],\n      is_private: false,\n      calendar: false,\n      today: moment(),\n      highlightRanges: [],\n      meetingLoaded: false,\n      selectedMeeting: [],\n      is_admin: false\n    }\n\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('events', this.props.match.params.id, this.state.token);\n    var quillOne = new Quill('#editor-one', {\n      //theme: 'snow',\n      readOnly: true,\n    });\n    this.setState({ quillOne: quillOne })\n  }\n\n\n\n  handleChange(obj) {\n\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Event') {\n      this.setState({\n        title: model.title,\n        id: model.id,\n        event_type: model.event_type,\n        info: model.info,\n        meetings: model.meetings,\n        flyers: model.flyers,\n        attendees: model.attendees,\n        tags: model.tags,\n        is_private: model.is_private,\n        uploads: model.uploads,\n        is_admin: model.is_admin\n      }, () => {\n        this.constructCalendar();\n      })\n    }\n    console.log(model)\n  }\n\n\n  deleteFlyer(id) {\n    var data = { id: id, advertisable_id: this.state.id, advertisable_type: 'Meeting' }\n    MyActions.removeInstance('flyers', data, this.state.token);\n  }\n\n  loadContent(quill_content) {\n    $('#content').html();\n    this.state.quillOne.setContents(quill_content)\n  }\n\n  toggleCalendar() {\n    this.setState({ calendar: !this.state.calendar }, () => {\n      if (this.state.calendar) {\n        $('#calendar').show();\n      } else {\n        $('#calendar').hide();\n      }\n    })\n\n\n  }\n\n  editFlyerBtn(flyer) {\n    if (this.state.is_admin) {\n      return (\n        <div class=\"col-auto\">\n          <a href={\"/#/flyers/edit/\" + flyer.id} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n          </a>\n          <a onClick={() => this.deleteFlyer(flyer.id)} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n          </a>\n        </div>\n      )\n    }\n  }\n\n  flyers() {\n    var result = []\n    this.state.flyers.map((flyer) => {\n      if (flyer.is_default) {\n        $('#content').html();\n        this.state.quillOne.setContents(flyer.quill_content)\n      }\n    })\n    this.state.flyers.map((flyer) => {\n      result.push(\n        <div class=\"list-group-item\">\n          <div class=\"row align-items-center\">\n            <div class=\"col text-truncate\">\n              <a onClick={() => this.loadContent(flyer.quill_content)} class=\"text-body d-block\">{flyer.title}</a>\n            </div>\n            {this.editFlyerBtn(flyer)}\n          </div>\n        </div>\n      )\n    })\n    return result\n  }\n\n\n\n\n  tagsShow(tags) {\n    var result = []\n    if (tags && tags.length > 0) {\n      tags.map((tag) => {\n        result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n      })\n    }\n    return result\n  }\n\n  isPrivateBadge() {\n    if (this.state.is_private) {\n      return (\n        <span class=\"badge bg-red-lt\">{t['is_private']}</span>\n      )\n    }\n  }\n\n  dateSelect(val) {\n    var result = []\n    this.state.meetings.map((meeting) => {\n      if (Date.parse(meeting.start_day) <= val._d && Date.parse(meeting.end_day) >= val._d) {\n        result.push(meeting)\n      }\n    })\n    this.setState({ selectedMeeting: result })\n  }\n\n  meetingList() {\n    var result = []\n    this.state.selectedMeeting.map((s) => {\n      result.push(\n        <div class=\"list-group-item\">\n          <div class=\"row align-items-center\">\n            <div class=\"col text-truncate\">\n              <a href={\"/#/meetings/\" + s.id} class=\"text-body d-block\">{s.title}</a>\n              <small class=\"d-block text-muted text-truncate mt-n1\">{s.info}</small>\n            </div>\n            <div class=\"col-auto\">\n              {this.tagsShow(s.tags)}\n            </div>\n          </div>\n        </div>\n      )\n    })\n    return result\n  }\n\n  constructCalendar() {\n    var result = []\n    this.state.meetings.map((meeting) => {\n      console.log(meeting)\n      result.push(\n        {\n          color: randomColor(),\n          start: meeting.start_time,\n          end: meeting.end_time\n        }\n      )\n    })\n    this.setState({ highlightRanges: this.state.highlightRanges.concat(result), today: null, meetingLoaded: true, })\n  }\n\n  showCalendar() {\n    if (this.state.meetings && this.state.meetings.length > 0 && this.state.meetingLoaded) {\n      return (\n        <div class=\"row row-deck\" id='calendar' style={{ display: 'none' }}>\n          <div class=\"col-lg-6\">\n            <div class=\"card mb-3\" >\n              <div class=\"card-body\" >\n                <EventCalendar highlightRanges={this.state.highlightRanges} today={this.state.today} dateSelect={this.dateSelect} />\n              </div>\n            </div>\n          </div>\n\n          <div class=\"col-lg-6\">\n            <div class=\"card mb-3\">\n              <div class=\"card-header\">\n                <h3 class=\"card-title\">{t['meetings']}</h3>\n              </div>\n              <div class=\"list-group list-group-flush overflow-auto\" style={{ maxHeight: '25rem' }}>\n                {this.meetingList()}\n              </div>\n            </div>\n          </div>\n        </div>\n      )\n    }\n  }\n\n  editUploadBtn(upload) {\n    if (this.state.is_admin) {\n      return (\n        <div class=\"col-auto p-0\">\n          <a onClick={() => this.deleteFlyer(upload.id)} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n          </a>\n        </div>\n      )\n    }\n  }\n\n  uploads() {\n    var result = []\n    if (this.state.uploads) {\n      this.state.uploads.map((upload) => {\n        if (upload.upload_type !== 'cover') {\n          result.push(\n            <div class=\"list-group-item\">\n              <div class=\"row align-items-center\">\n                <div class=\"col text-truncate\">\n                  <a style={{ cursor: 'pointer' }} href={upload.link} class=\"text-body d-block\">{upload.title}</a>\n                </div>\n                {this.editUploadBtn(upload)}\n              </div>\n            </div>\n          )\n        }\n      })\n    }\n    return result\n  }\n\n  createFlyerBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link\" href={\"/#/flyers/create?event_id=\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  createUploadBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link\" href={\"/#/uploads/create?event_id=\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n\n\n  render() {\n\n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history} />\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['overview']}</div>\n                  <h2 className=\"page-title\">{t['event_detail']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row  row-cards\">\n\n                  <div class=\"col-lg-4\">\n\n                    <EventInfo\n                      title={this.state.title} info={this.state.info}\n                      isPrivateBadge={this.isPrivateBadge} tagsShow={this.tagsShow}\n                      event_type={this.state.event_type} tags={this.state.tags}\n                      toggleCalendar={this.toggleCalendar} id={this.state.id}\n                      is_admin={this.state.is_admin}\n                    />\n                    <AttendanceCard attendees={this.state.attendees} attendable_type='event' attendable_id={this.state.id} is_admin={this.state.is_admin} />\n\n                    <MeetingCard meetings={this.state.meetings} col='12' id={this.state.id} is_admin={this.state.is_admin} />\n\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['pages']}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.createFlyerBtn()}\n                        </ul>\n                      </div>\n                      <div class=\"list-group list-group-flush list-group-hoverable\">\n                        {this.flyers()}\n                      </div>\n                    </div>\n\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['resources']}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.createUploadBtn()}\n                        </ul>\n                      </div>\n                      <div class=\"list-group list-group-flush list-group-hoverable\">\n                        {this.uploads()}\n                      </div>\n                    </div>\n\n                  </div>\n\n                  <div class=\"col-lg-8\">\n                    {this.showCalendar()}\n                    <div class=\"card\">\n                      <div class=\"card-body\" id='content' style={{ margin: 'initial' }}>\n                        <div id=\"editor-one\"></div>\n                      </div>\n                    </div>\n                  </div>\n\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ReactDOM from 'react-dom';\nimport $ from 'jquery';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nimport moment from 'moment-jalaali'\nimport DatePicker2 from 'react-datepicker2';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class EventCreate extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.submit = this.submit.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      id: null,\n      info: null,\n      event_type: null,\n      start_date: moment(),\n      end_date: moment(),\n      is_private: false,\n      options: [],\n      tags: [],\n    }\n\n  }\n\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    if (this.props.match.params.id) {\n      MyActions.getInstance('events', this.props.match.params.id, this.state.token);\n    }\n  }\n\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  setInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Event') {\n      this.props.history.push(\"/events/\" + model.id)\n    }\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (model && klass === 'Event') {\n      this.setState({\n        id: model.id,\n        title: model.title,\n        info: model.info,\n        event_type: model.event_type,\n        tags: model.tags,\n        is_private: model.is_private,\n        start_date: model.start_date,\n        end_date: model.end_date,\n        editing: true,\n      }, () => {\n        console.log(this.state)\n        this.changeType(this.state.event_type)\n        this.tagSelected(this.state.tags);\n      })\n    }\n  }\n\n  submit() {\n    var data = this.state\n    if (!this.state.editing) {\n      MyActions.setInstance('events', data, this.state.token);\n    } else {\n      MyActions.updateInstance('events', data, this.state.token);\n    }\n  }\n\n\n\n  changeType(e) {\n    var self = this;\n    $('.form-selectgroup-input').each(function () {\n      if ($(this).val() !== e) {\n        $(this).prop(\"checked\", false)\n      } else {\n        if ($(this).checked) {\n          $(this).prop(\"checked\", false)\n        } else {\n          $(this).prop(\"checked\", true)\n          self.setState({ event_type: e })\n        }\n      }\n    })\n  }\n\n  tagSelected(tags) {\n    var result = []\n    tags.map((tag) => {\n      if (tag['title']) {\n        result.push(tag['title'])\n      } else {\n        result.push(tag)\n      }\n    })\n    this.setState({ tags: result }, () => console.log(this.state.tags))\n  }\n\n  tagShow() {\n    if (this.props.match.params.id && this.state.id) {\n      return (this.tagInput())\n    }\n\n    if (!this.props.match.params.id) {\n      return (this.tagInput())\n    }\n  }\n\n  tagInput() {\n    return (\n      <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n        <AsyncTypeahead\n          id='event-tag'\n          allowNew\n          multiple\n          defaultSelected={this.state.tags}\n          isLoading={this.state.isLoading}\n          labelKey='title'\n          onSearch={(query) => {\n            this.setState({ isLoading: true });\n            fetch(server + \"/tags/search?q=\" + query)\n              .then((resp) => resp.json())\n              .then(({ items }) => {\n                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n              });\n          }}\n          onChange={(t) => this.tagSelected(t)}\n          options={this.state.options}\n          renderMenuItemChildren={(option, props) => (\n            <React.Fragment>\n              <span>{option.title}</span>\n            </React.Fragment>\n          )}\n        />\n      </div>\n    )\n  }\n\n\n  changeDefault(e) {\n    if (this.state.is_private) {\n      this.setState({ is_private: false })\n    } else {\n      this.setState({ is_private: true })\n    }\n  }\n\n\n\n  render() {\n    const { is_private } = this.state;\n\n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history}/>\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['create_event_page']}</div>\n                  <h2 className=\"page-title\">{t['provide_following_info']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row row-deck row-cards\">\n                  <div class=\"col-md-8\">\n                    <div class=\"card\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['create_event']}</h3>\n                      </div>\n                      <div class=\"card-body\">\n                        <form>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['event_title']}</label>\n                            <input type=\"text\" onInput={(e) => { this.handleChange({ title: e.target.value }) }} id='title' class=\"form-control\" name=\"text-input\" placeholder={t['write_something']} value={this.state.title} />\n                          </div>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['event_info']}<span class=\"form-label-description\"></span></label>\n                            <textarea onInput={(e) => { this.handleChange({ info: e.target.value }) }} class=\"form-control\" id='content' name=\"example-textarea-input\" rows=\"6\" placeholder={t['write_something']} value={this.state.info}></textarea>\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['event_type']}</label>\n                            <div class=\"form-selectgroup\">\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"in_person\" class=\"form-selectgroup-input\" checked=\"\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['in_person']}</span>\n                              </label>\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"hybrid\" class=\"form-selectgroup-input\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['hybrid']}</span>\n                              </label>\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"online\" class=\"form-selectgroup-input\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['online']}</span>\n                              </label>\n                            </div>\n                          </div>\n\n                          <div class=\"mb-3 \" id='tags' >\n                            <label class=\"form-label\" >{t['tags']}</label>\n                            {this.tagShow()}\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_start_time']}<span class=\"form-label-description\"></span></label>\n                            <DatePicker2\n                              timePicker={false}\n                              isGregorian={false}\n                              onChange={value => { this.setState({ start_date: value }) }}\n                              value={moment(this.state.start_date)}\n                            />\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_start_time']}<span class=\"form-label-description\"></span></label>\n                            <DatePicker2\n                              timePicker={false}\n                              isGregorian={false}\n                              onChange={value => { this.setState({ end_date: value }) }}\n                              value={moment(this.state.end_date)}\n                            />\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <div class=\"form-label\">{t['is_private']}</div>\n                            <label class=\"form-check form-switch\">\n                              <input class=\"form-check-input\" type=\"checkbox\" onClick={(e) => this.changeDefault(e.target.value)} checked={is_private ? true : false} />\n                              <span class=\"form-check-label\">{t['default_is_private_info']}</span>\n                            </label>\n                          </div>\n\n                        </form>\n                      </div>\n                      <div class=\"card-footer\">\n                        <div class=\"d-flex\">\n                          <a href=\"/#/events\" class=\"btn btn-link\">{t['cancel']}</a>\n                          <button onClick={() => this.submit()} class=\"btn btn-primary ms-auto\">{t['submit']}</button>\n                        </div>\n                      </div>\n                      <div class=\"progress progress-sm card-progress\">\n                        <div class=\"progress-bar\" style={{ width: \"100%\" }} role=\"progressbar\" aria-valuenow=\"38\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                          <span class=\"visually-hidden\">38% Complete</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"col-4\">\n                    <div class=\"card\">\n                      <div class=\"card-status-top bg-lime\"></div>\n                      <div class=\"card-body\">\n                        <h3 class=\"card-title\">Help</h3>\n                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam deleniti fugit incidunt, iste, itaque minima\n                          neque pariatur perferendis sed suscipit velit vitae voluptatem.</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport queryString from 'query-string'\n\nexport default class EventAttendance extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n        this.getInstance = this.getInstance.bind(this);\n        this.getMultipleList = this.getMultipleList.bind(this);\n        this.search = this.search.bind(this);\n\n        \n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            attendances: null,\n            users: null,\n            attendable_type: '',\n            attendable_id: 0,\n            q: '',\n            selectedUser: null,\n        }\n\n    }\n    componentWillMount() {\n        ModelStore.on(\"got_multiple_list\", this.getMultipleList);\n        ModelStore.on(\"set_instance\", this.setInstance);\n        ModelStore.on(\"deleted_instance\", this.getInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_multiple_list\", this.getMultipleList);\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n        ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    }\n\n    componentDidMount() {\n        const value = queryString.parse(this.props.location.search);\n        var attendable_type = '';\n        var attendable_id = 0;\n        Object.keys(value).map((key) => {\n            var splited = key.split(\"_\")\n            if (splited[0]) {\n                attendable_type = splited[0].charAt(0).toUpperCase() + splited[0].slice(1);\n                attendable_id = value[key]\n            }\n        })\n        this.setState({ attendable_type: attendable_type, attendable_id: attendable_id }, () => {\n            MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token);\n        })\n\n    }\n\n\n    getMultipleList() {\n        var multiple = ModelStore.getMutipleList()\n        var klass = ModelStore.getKlass()\n        console.log(multiple)\n        if (multiple && klass === 'Attendance') {\n            this.setState({\n                users: multiple.users,\n                attendances: multiple.attendances,\n            });\n        }\n    }\n\n\n    getInstance() {\n        MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token);\n    }\n\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    search(q) {\n        if (q.length > 3) {\n            this.setState({ q: q }, () =>\n                MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token)\n            );\n        } else {\n            this.setState({ q: '' }, () =>\n            MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token)\n        );\n        }\n    }\n\n    setInstance() {\n        MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token);\n    }\n\n    addParticipant(user_id) {\n        if (this.state.attendable_type !== '') {\n            var data = { attendable_id: this.state.attendable_id, attendable_type: this.state.attendable_type, user_id: user_id }\n            MyActions.setInstance('attendances', data, this.state.token);\n        }\n    }\n\n    removeParticipant(id) {\n        var data = { id: id, attendable_id: this.state.attendable_id, attendable_type: this.state.attendable_type }\n        MyActions.removeInstance('attendances', data, this.state.token);\n    }\n\n    userItems(users) {\n        var result = []\n        if (users) {\n            users.map((user) => {\n                result.push(\n                    <div class=\"list-group-item\" style={{ border: 'none' }}>\n                        <div class=\"row align-items-center\">\n                            <div class=\"col-auto\">\n                                <a onClick={() => this.addParticipant(user.user_id)}>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                                </a>\n                            </div>\n                            <div class=\"col-auto\">\n                                <a href=\"#\">\n                                    <span class=\"avatar\" >{user.initials}</span>\n                                </a>\n                            </div>\n                            <div class=\"col text-truncate\">\n                                <a href=\"#\" class=\"text-body d-block\">{user.name}</a>\n                                <small class=\"d-block text-muted text-truncate mt-n1\">{user.bio}</small>\n                            </div>\n                            <div class=\"col-auto\">\n                            </div>\n\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n    attendanceItems(attendances) {\n        var result = []\n        if (attendances) {\n            attendances.map((attendance) => {\n                var user = attendance.profile\n                result.push(\n                    <div class=\"list-group-item\" style={{ border: 'none' }}>\n                        <div class=\"row align-items-center\">\n                            <div class=\"col-auto\">\n                                <a onClick={() => this.removeParticipant(attendance.id)}>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                                </a>\n                            </div>\n                            <div class=\"col-auto\">\n                                <a href=\"#\">\n                                    <span class=\"avatar\" >{user.initials}</span>\n                                </a>\n                            </div>\n                            <div class=\"col text-truncate\">\n                                <a href=\"#\" class=\"text-body d-block\">{user.name}</a>\n                                <small class=\"d-block text-muted text-truncate mt-n1\">{user.bio}</small>\n                            </div>\n                            <div class=\"col-auto\">\n                            </div>\n\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history}/>\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\"></div>\n                                <div className=\"col\">\n                                    <div className=\"page-pretitle\">add participants</div>\n                                    <h2 className=\"page-title\">{this.state.title}</h2>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n                                    <div className=\"col-md-6\">\n                                        <div class=\"card mb-3\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">All Users</h3>\n                                            </div>\n                                            <div class=\"list-group list-group-flush list-group-hoverable\">\n                                                <div class=\"list-group-item\">\n                                                    <div class=\"input-icon \">\n                                                        <input type=\"text\" class=\"form-control\" placeholder=\"Search…\" onInput={(e) => { this.search(e.target.value) }} />\n                                                        <span class=\"input-icon-addon\">\n\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                        </span>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            {this.userItems(this.state.users)}\n                                        </div>\n                                    </div>\n\n                                    <div className=\"col-md-6\">\n                                        <div class=\"card mb-3\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">Participants</h3>\n                                            </div>\n                                            <div class=\"list-group list-group-flush list-group-hoverable\">\n                                                {this.attendanceItems(this.state.attendances)}\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport { v4 as uuidv4 } from 'uuid';\nimport moment from 'jalali-moment'\nmoment.locale('fa', { useGregorianParser: true });\n\nconst t = dict['fa']\n\n\nconst MeetingInfo = (props) => {\n    function isEvent() {\n        if (props.event) {\n            return (\n                <React.Fragment>\n                    <h4>{t['related_to_event']}:</h4>\n                    <div class=\"text-muted mb-3\">\n                        <a href={'/#/events/' + props.event.id}>{props.event.title}</a>\n                    </div>\n                </React.Fragment>\n            )\n        }\n    }\n\n    function footerBar() {\n        if (props.page && props.page == 'meeting') {\n            return (\n                <div class=\"card-footer\">\n                    <div class=\"mt-2\">\n                        <a href={\"/#/rooms/\" + props.room_id + \"?rnd=\" + uuidv4()} onClick={props.forceUpdate} class=\"btn btn-primary bg-lime w-100\">\n                            {t['enter_room']}\n                        </a>\n                    </div>\n                </div>\n            )\n        }\n        if (props.page && props.page == 'detail') {\n            return (\n                <div class=\"card-footer\">\n                    <div class=\"row align-items-center\">\n                        <div class=\"col-auto \">\n                            <div class=\"avatar-list avatar-list-stacked\">\n                                {avatar()}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )\n        }\n    }\n\n    function avatar() {\n        var result = []\n        if (props.attendees) {\n            props.attendees.map((att) => {\n                result.push(<span class=\"avatar avatar-sm avatar-rounded\" >{att.initials}</span>)\n            })\n        }\n        return result\n    }\n\n    function formatGregorianDate(gregorianDate) {\n        var date = new Date(gregorianDate);\n        var day = date.getDate();\n        var month = date.getMonth() + 1;\n        var year = date.getFullYear();\n        var hours = date.getHours();\n        var minutes = date.getMinutes();\n        var fullYear = year + '/' + month + '/' + day + ' ' + hours + ':' + minutes;\n        return fullYear;\n    }\n\n    function sideBlock(item, title) {\n        if (props[item]) {\n            return (\n                <React.Fragment>\n                    <h4>{title}:</h4>\n                    <div class=\"text-muted mb-3\">\n                        {props[item]}\n                    </div>\n                </React.Fragment>\n            )\n        }\n    }\n    return (\n        <div class=\"card mb-3\">\n            <div className=\"card-header\" >\n                <h3 class=\"card-title\">{props.title}</h3>\n                <ul class=\"nav nav-pills card-header-pills\">\n                    <li class=\"nav-item\" style={{ marginRight: '10px' }}>\n                        {props.isPrivateBadge()}\n                    </li>\n                    <li class=\"nav-item ms-auto\">\n                        <a class=\"nav-link p-1\" href={\"/#/meetings/edit/\" + props.id}>\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n                        </a>\n                    </li>\n                </ul>\n            </div>\n            <div class=\"card-body\">\n                {isEvent()}\n                {sideBlock('info', t['meeting_info'])}\n                <React.Fragment>\n                    <h4>{t['meeting_type']}:</h4>\n                    <div class=\"text-muted mb-3\">\n                        {t[props.meeting_type]}\n                    </div>\n                </React.Fragment>\n                {sideBlock('capacity', t['meeting_capacity'])}\n                {sideBlock('external_link', t['meeting_external_link'])}\n\n                <h4>{t['meeting_start_time']}:</h4>\n                <div class=\"text-muted mb-3\">\n                    {moment(formatGregorianDate(props.start_time)).format('HH:mm jYYYY/jMM/jDD')}\n                </div>\n\n                <h4>{t['meeting_end_time']}:</h4>\n                <div class=\"text-muted mb-3\">\n                    {moment(formatGregorianDate(props.end_time)).format('HH:mm YYYY/MM/DD')}\n                </div>\n\n                <h4>{t['tags']}</h4>\n                <div class=\"text-muted mb-3\">\n                    {props.tagsShow(props.tags)}\n                </div>\n\n\n            </div>\n\n            {footerBar()}\n\n        </div>\n    )\n}\nexport default MeetingInfo;\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport { Calendar } from 'react-datepicker2';\nimport moment from 'moment-jalaali'\nimport randomColor from \"randomcolor\";\nimport DatePicker2 from 'react-datepicker2';\nimport MeetingInfo from \"../meetings/info.jsx\";\nimport $ from 'jquery';\nconst t = dict['fa']\n\nexport default class EventDetail extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.isPrivateBadge = this.isPrivateBadge.bind(this);\n    this.getList = this.getList.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      id: null,\n      event_type: null,\n      info: null,\n      meetings: [],\n      tags: [],\n      is_private: false,\n      allTags: [],\n      start_time: moment(),\n      end_time: moment(),\n      selectedTags: []\n    }\n\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('events', this.props.match.params.id, this.state.token);\n    MyActions.getList('events/tags', this.state.page, { id: this.props.match.params.id });\n    //MyActions.getList('events/meetings', this.state.page, { id: this.props.match.params.id });\n  }\n\n\n\n  handleChange(obj) {\n\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Event') {\n      this.setState({\n        title: model.title,\n        id: model.id,\n        event_type: model.event_type,\n        info: model.info,\n        meetings: model.meetings,\n        tags: model.tags,\n        is_private: model.is_private\n      }, () => {\n        //this.constructCalendar();\n      })\n    }\n    console.log(model)\n  }\n\n  getList() {\n    var list = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (list && klass === 'Tag') {\n      this.setState({\n        allTags: list,\n      });\n    }\n    if (list && klass === 'Meeting') {\n      this.setState({\n        meetings: list,\n      });\n    }\n    console.log(list)\n  }\n\n\n\n\n\n\n\n  tagsShow(tags) {\n    var result = []\n    if (tags && tags.length > 0) {\n      tags.map((tag) => {\n        result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n      })\n    }\n    return result\n  }\n\n  isPrivateBadge() {\n    if (this.state.is_private) {\n      return (\n        <span class=\"badge bg-red-lt\">{t['is_private']}</span>\n      )\n    }\n  }\n\n  changeTags(e) {\n    var self = this;\n    var el = '#tag-check-' + e.target.value\n    console.log($(el), $(el).is(':checked'))\n    if (!$(el).is(':checked')) {\n      // $('#tag-check-'+e.target.value).prop(\"checked\", false)\n      var array = [...self.state.selectedTags]; // make a separate copy of the array\n      var index = array.indexOf(e.target.value)\n      if (index !== -1) {\n        array.splice(index, 1);\n        self.setState({ selectedTags: array })\n      }\n\n    } else {\n      //  $('#tag-check-'+e.target.value).prop(\"checked\", true)\n      self.setState({ selectedTags: self.state.selectedTags.concat(e.target.value) }, () => {\n        console.log(self.state.selectedTags)\n      })\n    }\n  }\n\n  tagCheckbox() {\n    var result = []\n    if (this.state.allTags) {\n      this.state.allTags.map((tag) => {\n        result.push(\n          <label class=\"form-check\">\n            <input id={'tag-check-' + tag.id} class=\"form-check-input\" type=\"checkbox\" style={{ marginTop: '3.5px' }} value={tag.id} onChange={(e) => this.changeTags(e)} />\n            <span class=\"form-check-label\">\n              <span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>\n            </span>\n          </label>\n        )\n      })\n    }\n    return result\n  }\n\n  checkTags() {\n\n  }\n\n\n  meetingList() {\n    var result = []\n    this.state.meetings.map((meeting) => {\n      // console.log(meeting.info)\n      result.push(\n\n        <MeetingInfo\n          title={meeting.title} info={meeting.info} start_time={meeting.start_time}\n          end_time={meeting.end_time} isPrivateBadge={this.isPrivateBadge} tagsShow={this.tagsShow}\n          meeting_type={meeting.meeting_type} tags={meeting.tags}\n          id={meeting.id} event={meeting.event} page='detail'\n          attendees={meeting.attendees}\n        />\n      )\n    })\n    return result\n  }\n\n  filterSearch() {\n    MyActions.getList('events/meetings', this.state.page, { tag_ids: this.state.selectedTags, start_time: this.state.start_time, end_time: this.state.end_time, id: this.props.match.params.id }, this.state.token);\n  }\n\n\n\n\n\n  render() {\n\n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history}/>\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['overview']}</div>\n                  <h2 className=\"page-title\">{t['event_detail']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row  row-cards\">\n\n                  <div class=\"col-lg-3\">\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">\n                          <a href={\"/#/events/\" + this.state.id}>\n                            {this.state.title}\n                          </a>\n                        </h3>\n\n                      </div>\n                      <div class=\"card-header\">\n                        <div class=\"mb-3\" style={{width: '100%'}}>\n                          <label class=\"form-label \">{t['meeting_start_time']}<span class=\"form-label-description\"></span></label>\n                          <DatePicker2\n                            isGregorian={false}\n                            onChange={value => { this.setState({ start_time: value }) }}\n                            value={moment(this.state.start_time)}\n                          />\n                          <label class=\"form-label mt-2\">{t['meeting_end_time']}<span class=\"form-label-description\"></span></label>\n                          <DatePicker2\n                            isGregorian={false}\n                            onChange={value => { this.setState({ end_time: value }) }}\n                            value={moment(this.state.end_time)}\n                          />\n                        </div>\n                      </div>\n                      <div class=\"card-header\">\n                        <div class=\"mb-3\">\n                          <div class=\"subheader mb-2\">\n                            {t['tags']}\n                          </div>\n                          <div>\n                            {this.tagCheckbox()}\n                          </div>\n                        </div>\n                      </div>\n                      <div class=\"card-body\">\n\n                        <a onClick={() => this.filterSearch()} class=\"btn btn-primary w-100\">\n                          <span style={{ verticalAlign: '-2px' }}>\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                          </span>\n                          {t['filter']}\n                        </a>\n                      </div>\n\n                    </div>\n                  </div>\n\n                  <div class=\"col-lg-9 col-xs-9\">\n                    {this.meetingList()}\n                  </div>\n\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport { v4 as uuidv4 } from 'uuid';\nimport moment from 'jalali-moment'\nmoment.locale('fa', { useGregorianParser: true });\n\nconst t = dict['fa']\n\nconst MeetingMasonry = (props) => {\n\n    function formatGregorianDate(gregorianDate) {\n        var date = new Date(gregorianDate);\n        var day = date.getDate();\n        var month = date.getMonth() + 1;\n        var year = date.getFullYear();\n        var hours = date.getHours();\n        var minutes = date.getMinutes();\n        var fullYear = year + '/' + month + '/' + day + ' ' + hours + ':' + minutes;\n        return fullYear;\n    }\n\n\n    function cardCover(meeting) {\n        if (meeting.cover) {\n            return (\n                <a href={'/#/meetings/' + meeting.id}>\n                    <div class=\"card-img-top img-responsive img-responsive-16by9\" style={{ backgroundImage: \"url(\" + meeting.cover + \")\" }}></div>\n                </a>\n            )\n        }\n    }\n\n    function tagsShow(tags) {\n        var result = []\n        if (tags && tags.length > 0) {\n            tags.map((tag) => {\n                result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n            })\n        }\n        return result\n    }\n\n    function meetingItems() {\n        var result = []\n        if (props.meetings) {\n            props.meetings.map((meeting) => {\n                result.push(\n\n                    <div className={props.col ? \"col-md-\" + props.col : \"col-md-8\"}>\n                        <div className=\"card\">\n                            {cardCover(meeting)}\n                            <div className=\"card-body\">\n                                <h3 class=\"card-title\">\n                                    <a href={'/#/meetings/' + meeting.id}>\n                                        {meeting.title}\n                                    </a>\n                                </h3>\n                                <p style={{ textAlign: 'justify' }}>\n                                    {meeting.truncated_info}\n                                </p>\n\n                                <h4>{t['meeting_type']}:</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {t[meeting.meeting_type]}\n                                </div>\n\n\n\n                                <h4>{t['meeting_start_time']}:</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {moment(formatGregorianDate(meeting.start_time)).format('HH:mm jYYYY/jMM/jDD')}\n                                </div>\n\n                                <h4>{t['meeting_end_time']}:</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {moment(formatGregorianDate(meeting.end_time)).format('HH:mm YYYY/MM/DD')}\n                                </div>\n\n                                <h4>{t['tags']}</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {tagsShow(meeting.tags)}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n    return (\n        <React.Fragment>\n            {meetingItems()}\n        </React.Fragment>\n    )\n}\nexport default MeetingMasonry;\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport MeetingMasonry from \"./masonry.jsx\";\nimport moment from 'moment-jalaali'\nimport DatePicker2 from 'react-datepicker2';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class MeetingIndex extends React.Component {\n\n    constructor(props) {\n        super(props);\n        //this.submit = this.submit.bind(this);\n        this.getList = this.getList.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            meetings: null,\n            allTags: null,\n            q: '',\n            start_from: moment(),\n            start_to: moment().add(2, 'jMonth'),\n            tags: [],\n            page: 1,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"got_list\", this.getList);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_list\", this.getList);\n    }\n\n    componentDidMount() {\n        MyActions.getList('meetings', this.state.page, {}, this.state.token);\n        MyActions.getList('tags/top', this.state.page, {}, this.state.token);\n    }\n\n    getList() {\n        var list = ModelStore.getList()\n        var klass = ModelStore.getKlass()\n\n        if (list && klass === 'Meeting') {\n            $('#search-spinner').hide();\n            if (list[0] && list[0].page) {\n                if (list[0].page == 1) {\n                    this.setState({\n                        meetings: list,\n                    });\n                } else {\n                    this.setState({\n                        meetings: this.state.meetings.concat(list),\n                    });\n                }\n                this.setState({ page: list[0].page })\n            } else {\n                this.setState({\n                    meetings: [],\n                });\n            }\n            console.log(list)\n        }\n        if (list && klass === 'Tag') {\n            this.setState({\n                allTags: list,\n            });\n        }\n    }\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    setInstance() {\n\n    }\n\n    noMeetingCard() {\n        <div class=\"col-12\">\n            <div class=\"card\">\n                <div class=\"empty\">\n                    <div class=\"empty-img\"><img src=\"./static/illustrations/undraw_quitting_time_dm8t.svg\" height=\"128\" alt=\"\" />\n                    </div>\n                    <p class=\"empty-title\">No results found</p>\n                    <p class=\"empty-subtitle text-muted\">\n                        Try adjusting your search or filter to find what you're looking for.\n                    </p>\n                    <div class=\"empty-action\">\n                        <a href=\"/#/meetings/create\" class=\"btn btn-primary\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"3\" y1=\"4\" x2=\"21\" y2=\"4\" /><path d=\"M4 4v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-10\" /><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"20\" /><line x1=\"9\" y1=\"20\" x2=\"15\" y2=\"20\" /><path d=\"M8 12l3 -3l2 2l3 -3\" /></svg>\n                            Create a meeting\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    }\n\n    checkMeeting() {\n        if (this.state.meetings) {\n            return (<MeetingMasonry meetings={this.state.meetings} col={12} />)\n        } else {\n            return (this.noMeetingCard())\n        }\n    }\n\n    cardMasonry() {\n        if (this.state.meetings) {\n            return (\n                <div class='row row-cards' data-masonry='{\"percentPosition\": true }' >\n                    <MeetingMasonry meetings={this.state.meetings} col={6} />\n                </div>\n            )\n        }\n    }\n\n    search() {\n        $('#search-spinner').show();\n        var data = { q: this.state.q, start_from: this.state.start_from, start_to: this.state.start_to, tags: this.state.tags }\n        MyActions.getList('meetings/search', this.state.page, data, this.state.token);\n        this.setState({ page: 1 })\n    }\n\n\n    tagCheckbox() {\n        var result = []\n        if (this.state.allTags) {\n            this.state.allTags.map((tag) => {\n                result.push(\n                    <label class=\"form-check\">\n                        <input id={'tag-check-' + tag.id} class=\"form-check-input\" type=\"checkbox\" style={{ marginTop: '3.5px' }} value={tag.id} onChange={(e) => this.changeTags(e)} />\n                        <span class=\"form-check-label\">\n                            <span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>\n                        </span>\n                    </label>\n                )\n            })\n        }\n        return result\n    }\n\n    tagSelected(tags) {\n        var result = []\n        tags.map((tag) => {\n            if (tag['title']) {\n                result.push(tag['title'])\n            } else {\n                result.push(tag)\n            }\n        })\n        this.setState({ tags: result }, () => console.log(this.state.tags))\n    }\n\n    tagInput() {\n        return (\n            <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n                <AsyncTypeahead\n                    id='search-tag'\n                    multiple\n                    defaultSelected={this.state.tags}\n                    isLoading={this.state.isLoading}\n                    labelKey='title'\n                    onSearch={(query) => {\n                        this.setState({ isLoading: true });\n                        fetch(server + \"/tags/search?q=\" + query)\n                            .then((resp) => resp.json())\n                            .then(({ items }) => {\n                                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n                            });\n                    }}\n                    onChange={(t) => this.tagSelected(t)}\n                    options={this.state.options}\n                    renderMenuItemChildren={(option, props) => (\n                        <React.Fragment>\n                            <span>{option.title}</span>\n                        </React.Fragment>\n                    )}\n                />\n            </div>\n        )\n    }\n\n\n    loadMore() {\n\n        var data = { id: this.state.id, page: this.state.page + 1, q: this.state.q, start_from: this.state.start_from, start_to: this.state.start_to, tags: this.state.tags }\n        MyActions.getList('meetings/search', this.state.page, data, this.state.token);\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history} />\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\">\n                                    <div className=\"col\">\n                                        <div className=\"page-pretitle\">{t['overview']}</div>\n                                        <h2 className=\"page-title\">{t['meetings']}</h2>\n                                    </div>\n                                    <div class=\"col-auto ms-auto d-print-none\">\n                                        <div class=\"btn-list\">\n                                            <a href={\"/#/events/create\"} class=\"btn btn-primary\"  >\n                                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n                                                {t['create_meeting']}\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div class=\"row\">\n                                    <div class=\"col-lg-3\">\n                                        <div class=\"card mb-3\">\n                                            <div className=\"card-header\" >\n                                                <h4 class=\"card-title\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                                                    {t['filter_meetings']}\n                                                </h4>\n                                            </div>\n\n                                            <div class=\"card-body\">\n                                                <div class=\"mb-3\">\n                                                    <label class=\"form-label\">{t['contains_words']}</label>\n                                                    <div class=\"input-icon mb-3\">\n                                                        <input type=\"text\" class=\"form-control\" placeholder={t['search_placeholder']} onInput={(e) => { this.handleChange({ q: e.target.value }) }} />\n                                                        <span class=\"input-icon-addon\">\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                        </span>\n                                                    </div>\n                                                </div>\n                                                <div class=\"mb-3\" style={{ width: '100%' }}>\n                                                    <label class=\"form-label \">{t['date_from']}<span class=\"form-label-description\"></span></label>\n                                                    <DatePicker2\n                                                        isGregorian={false}\n                                                        onChange={value => { this.setState({ start_from: value }) }}\n                                                        value={moment(this.state.start_from)}\n                                                    />\n                                                    <label class=\"form-label mt-2\">{t['date_to']}<span class=\"form-label-description\"></span></label>\n                                                    <DatePicker2\n                                                        isGregorian={false}\n                                                        onChange={value => { this.setState({ start_to: value }) }}\n                                                        value={moment(this.state.start_to)}\n                                                    />\n                                                </div>\n\n                                                <div class=\"mb-3 \" id='tags' >\n                                                    <label class=\"form-label\" >{t['tags']}</label>\n                                                    {this.tagInput()}\n                                                </div>\n                                            </div>\n                                            <div class=\"card-body\">\n\n                                                <a onClick={() => this.search()} class=\"btn btn-primary w-100\">\n                                                    <span style={{ verticalAlign: '-2px' }}>\n                                                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                                                    </span>\n                                                    {t['filter_and_search']}\n                                                    <div id='search-spinner' class=\"spinner-border text-red\" role=\"status\" style={{ display: 'none' }}></div>\n                                                </a>\n                                            </div>\n\n                                        </div>\n                                    </div>\n                                    <div class=\"col-lg-9\">\n                                        {this.cardMasonry()}\n                                        <div class=\"hr-text\">\n                                            <a onClick={() => this.loadMore()}>\n                                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"12\" cy=\"12\" r=\"9\" /><line x1=\"8\" y1=\"12\" x2=\"12\" y2=\"16\" /><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\" /><line x1=\"16\" y1=\"12\" x2=\"12\" y2=\"16\" /></svg>\n                                                {t['more']}\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import io from 'socket.io-client'\nimport { conf } from \"./conf\";\n//const socket = io.connect(conf.socketIOServer)\n//const socket = io.connect(conf.socketIOServer, { transports: ['websocket'] })\nconst socket = io.connect(conf.socketIOServer, \n    { transports: ['websocket'],\n    secure:true,\n    reconnect: true,\n    rejectUnauthorized : false }\n    )\nexport { socket }","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport { dict } from '../../Dict';\nimport { conf } from \"../../conf\";\nimport Quill from 'quill';\n\nclass FlyerCard extends Component {\n    constructor(props) {\n        super(props);\n\n\n        this.state = {\n            quillOne: null,\n            cover: null,\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.quill_content !== this.props.quill_content) {\n            //console.log('*****', this.props.quill_content)\n            // if(this.state.quillOne){\n            this.state.quillOne.setContents(this.props.quill_content)\n            // }\n\n        }\n        if (prevProps.cover !== this.props.cover) {\n            this.setState({ cover: this.props.cover })\n        }\n    }\n\n    componentWillUnmount() {\n\n    }\n\n\n\n\n    componentDidMount() {\n        var quillOne = new Quill('#editor-one', {\n            readOnly: true,\n        });\n        this.setState({ quillOne: quillOne })\n    }\n\n    cardCover() {\n        if (this.state.cover) {\n            return (<div class=\"card-img-top img-responsive img-responsive-16by9\" style={{ backgroundImage: \"url(\" + this.state.cover + \")\" }}></div>)\n        }\n    }\n\n\n\n    render() {\n        return (\n\n            <div class=\"col-lg-8\">\n                <div class=\"card\">\n                    {this.cardCover()}\n                    <div class=\"card-body\" id='content'>\n                        <div id=\"editor-one\"></div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\nexport default FlyerCard;","import $ from \"jquery\";\nimport { socket } from \"../../socket.js\";\n\nexport function socketHandle(msg) {\n  var self = this;\n  var parsed = msg;\n  switch (parsed.type) {\n    case \"chat\":\n      self.appendChat(parsed.c);\n      break;\n  }\n}\n\nexport function keydownHandler(e){\n    if(e.keyCode===13 && e.ctrlKey) this.send()\n  }\n\nexport function appendChat(c) {\n  var exist = this.state.chats.filter((item) => item.uuid === c.uuid);\n  if (exist && exist.length === 0) {\n    if (this.state.chats && this.state.chats.length > 100) {\n      this.setState({ chats: this.state.chats.slice(1).concat(c)});\n    } else {\n      this.setState({ chats: this.state.chats.concat(c) }, () => {\n        this.scrollChat();\n      });\n    }\n  }\n}\n\nexport function scrollChat(){\n    $(\"#chat-box\").stop().animate({\n        scrollTop: $(\"#chat-box\")[0].scrollHeight\n    });\n}\n\nexport function chatItems() {\n  var result = [];\n  this.state.chats.map((chat) => {\n    result.push(\n      <div class=\"list-group-item p-tight\" id={'chat-'+chat.uuid}>\n        <div class=\"row\">\n          <div class=\"col-auto\">\n            <a href=\"#\">\n              <span class=\"avatar avatar-sm\">{chat.initials}</span>\n            </a>\n          </div>\n          <div class=\"col text-sm\">\n           <span class=\"chat-title\">{chat.name}</span>\n           <div class=\"form-hint mt-n1\">{chat.content}</div>\n          </div>\n        </div>\n      </div>\n    );\n  });\n  return result;\n}\n\nexport function throttle(c, t) {\n  if (Date.now() - this.state.lastTime > 100) {\n    this.setState({ lastTime: Date.now() }, () => {\n      this.wsSend({ type: t, c: c });\n    });\n  }\n}\n\nexport function send() {\n    console.log(this.state.item)\n  if (this.state.item) {\n    this.throttle(this.state.item, \"chat\");\n    this.appendChat(this.state.item);\n    $(\"#chat-form\").val(\"\");\n  }\n}\n\nexport function wsSend(msg, sender = this.state.userUUID) {\n  msg[\"room\"] = this.state.roomId;\n  msg[\"sender\"] = sender;\n  socket.emit(\"message\", msg);\n}\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport $ from 'jquery';\nimport Header from \"../header/header.jsx\";\nimport { v4 as uuidv4 } from 'uuid';\nimport Quill from 'quill';\nimport AttendanceCard from \"../attendances/card.jsx\";\nimport moment from 'jalali-moment'\nimport { socket } from '../../socket.js'\nimport FlyerCard from \"../flyers/card.jsx\";\nimport {\n  socketHandle, appendChat, chatItems, throttle, send, wsSend, keydownHandler, scrollChat\n} from \"../rooms/chat.js\";\n\nmoment.locale('fa', { useGregorianParser: true });\nconst t = dict['fa']\n\nexport default class MeetingShow extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.flyers = this.flyers.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n\n    this.socketHandle = socketHandle.bind(this);\n    this.appendChat = appendChat.bind(this);\n    this.chatItems = chatItems.bind(this);\n    this.throttle = throttle.bind(this);\n    this.send = send.bind(this);\n    this.wsSend = wsSend.bind(this);\n    this.keydownHandler = keydownHandler.bind(this);\n    this.scrollChat = scrollChat.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      start_time: null,\n      end_time: null,\n      info: null,\n      capacity: null,\n      meeting_type: null,\n      event: { title: '', id: 0 },\n      flyers: [],\n      quillOne: null,\n      attendees: null,\n      tags: [],\n      is_private: false,\n      room_id: null,\n      roomId: null,\n      cover: null,\n      is_admin: false,\n      room: null,\n\n      name: null,\n      fullname: null,\n      initials: null,\n      userUUID: null,\n\n      chats: [],\n      lastTime: Date.now(),\n      content: null,\n      item: null,\n      quill_content: null,\n    }\n\n  }\n\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n    document.addEventListener('keydown', this.keydownHandler);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    document.removeEventListener('keydown', this.keydownHandler);\n  }\n\n  componentDidMount() {\n    var self = this;\n    MyActions.getInstance('meetings', this.props.match.params.id, this.state.token);\n    //var quillOne = new Quill('#editor-one', {\n    // readOnly: true,\n    //});\n    //this.setState({ quillOne: quillOne })\n\n    socket.on('connect', function () {\n      if (self.state.roomId) {\n        socket.emit('room', { room: self.state.roomId.toString(), uuid: self.state.userUUID });\n      }\n    });\n\n    socket.on('message', function (data) {\n      if (data['sender'] !== self.state.userUUID) {\n        self.socketHandle(data)\n      }\n    });\n  }\n\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Meeting') {\n      this.setState({\n        title: model.title,\n        id: model.id,\n        start_time: model.start_time,\n        end_time: model.end_time,\n        info: model.info,\n        capacity: model.capacity,\n        meeting_type: model.meeting_type,\n        event: model.event,\n        flyers: model.flyers,\n        attendees: model.attendees,\n        tags: model.tags,\n        is_private: model.is_private,\n        room_id: model.room_id,\n        roomId: model.room_uuid,\n        cover: model.cover,\n        uploads: model.uploads,\n        is_admin: model.is_admin\n      }, () => {\n        if (this.state.token && this.state.token.length > 10) {\n          MyActions.setInstance('users/validate_token', {}, this.state.token);\n        }\n        if (this.state.flyers && this.state.flyers[0]) {\n          this.loadContent(this.state.flyers[0].quill_content)\n        }\n      })\n    }\n    if (klass === 'MeetingUrl') {\n      //this.setState({ bigBlueUrl: model.url})\n      console.log(model)\n      if(model.url){\n        console.log(model.url)\n        $('#bigblue-spinner').hide();\n        window.location.replace(model.url)\n      }\n      //console.log(model.url)\n    }\n  }\n\n  setInstance() {\n    var self = this;\n    var klass = ModelStore.getKlass()\n    var user = ModelStore.getIntance();\n    if (klass === 'Validate') {\n      this.setState({ name: user.name, fullname: user.name, initials: user.initials, userUUID: user.uuid }, () => {\n        this.connectSocketRoom();\n        //console.log(self.state)\n      });\n    }\n  }\n\n  sideBlock(item, title) {\n    if (this.state[item]) {\n      return (\n        <React.Fragment>\n          <h4>{title}:</h4>\n          <div class=\"text-muted mb-3\">\n            {this.state[item]}\n          </div>\n        </React.Fragment>\n      )\n    }\n  }\n\n  deleteFlyer(id) {\n    var data = { id: id, advertisable_id: this.state.id, advertisable_type: 'Meeting' }\n    MyActions.removeInstance('flyers', data, this.state.token);\n  }\n\n  editFlyerBtn(flyer) {\n    if (this.state.is_admin) {\n      return (\n        <div class=\"col-auto p-0\">\n          <a href={\"/#/flyers/edit/\" + flyer.id} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n          </a>\n          <a onClick={() => this.deleteFlyer(flyer.id)} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n          </a>\n        </div>\n      )\n    }\n  }\n\n  flyers() {\n    var result = []\n    this.state.flyers.map((flyer) => {\n      if (flyer.is_default) {\n        //$('#content').html();\n        //this.state.quillOne.setContents(flyer.quill_content)\n        //this.setState({quill_content: flyer.quill_content})\n        // this.loadContent(flyer.quill_content)\n      }\n    })\n    this.state.flyers.map((flyer) => {\n      result.push(\n        <div class=\"list-group-item\">\n          <div class=\"row align-items-center\">\n            <div class=\"col text-truncate\">\n              <a style={{ cursor: 'pointer' }} onClick={() => this.loadContent(flyer.quill_content)} class=\"text-body d-block\">{flyer.title}</a>\n            </div>\n            {this.editFlyerBtn(flyer)}\n            <div class=\"col-auto p-0\">\n              <a style={{ cursor: 'pointer', color: '#f4f6fa' }} onClick={() => this.loadContent(flyer.quill_content)} class=\"text-body d-block\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /><line x1=\"5\" y1=\"12\" x2=\"11\" y2=\"18\" /><line x1=\"5\" y1=\"12\" x2=\"11\" y2=\"6\" /></svg>\n              </a>\n            </div>\n\n          </div>\n        </div>\n      )\n    })\n    return result\n  }\n\n\n  loadContent(quill_content) {\n   // console.log('44444')\n    //$('#content').html();\n    // this.state.quillOne.setContents(quill_content)\n    this.setState({ quill_content: quill_content })\n  }\n\n  formatGregorianDate(gregorianDate) {\n    var date = new Date(gregorianDate);\n    var day = date.getDate();\n    var month = date.getMonth() + 1;\n    var year = date.getFullYear();\n    var hours = date.getHours();\n    var minutes = date.getMinutes();\n    var fullYear = year + '/' + month + '/' + day + ' ' + hours + ':' + minutes;\n    return fullYear;\n  }\n\n\n  tagsShow(tags) {\n    var result = []\n    if (tags && tags.length > 0) {\n      tags.map((tag) => {\n        result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n      })\n    }\n    return result\n  }\n\n  isPrivateBadge() {\n    if (this.state.is_private) {\n      return (\n        <span class=\"badge bg-red-lt\">{t['is_private']}</span>\n      )\n    }\n  }\n\n  cardCover() {\n    if (this.state.cover) {\n      return (<div class=\"card-img-top img-responsive img-responsive-16by9\" style={{ backgroundImage: \"url(\" + this.state.cover + \")\" }}></div>)\n    }\n  }\n\n  editUploadBtn(upload) {\n    if (this.state.is_admin) {\n      return (\n        <div class=\"col-auto p-0\">\n          <a onClick={() => this.deleteFlyer(upload.id)} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n          </a>\n        </div>\n      )\n    }\n  }\n\n  uploads() {\n    var result = []\n    if (this.state.uploads) {\n      this.state.uploads.map((upload) => {\n        if (upload.upload_type !== 'cover') {\n          result.push(\n            <div class=\"list-group-item\">\n              <div class=\"row align-items-center\">\n                <div class=\"col text-truncate\">\n                  <a style={{ cursor: 'pointer' }} href={upload.link} class=\"text-body d-block\">{upload.title}</a>\n                </div>\n                {this.editUploadBtn(upload)}\n              </div>\n            </div>\n          )\n        }\n      })\n    }\n    return result\n  }\n\n  createFlyerBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link\" href={\"/#/flyers/create?meeting_id=\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  createUploadBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link\" href={\"/#/uploads/create?meeting_id=\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  editMeetingBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link p-1\" href={\"/#/meetings/edit/\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  connectSocketRoom() {\n    if (this.state.userUUID && this.state.roomId) {\n      socket.emit('room', { room: this.state.roomId, uuid: this.state.userUUID });\n    }\n  }\n\n  createBigBlue(){\n    $('#bigblue-spinner').show();\n    MyActions.getInstance('meetings/join_bigblue', this.props.match.params.id, this.state.token);\n  }\n\n\n  render() {\n    const t = dict['fa']\n\n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history} />\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['overview']}</div>\n                  <h2 className=\"page-title\">{t['meeting_detail']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row  row-cards\">\n\n                  <div class=\"col-lg-4\">\n                    <div class=\"card mb-3\">\n                      <div className=\"card-header bg-dark-lt\" >\n                        <h3 class=\"card-title\">{this.state.title}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          <li class=\"nav-item\" style={{ marginRight: '10px' }}>\n                            {this.isPrivateBadge()}\n                          </li>\n                          {this.editMeetingBtn()}\n                        </ul>\n                      </div>\n                      <ul class=\"nav nav-tabs\" data-bs-toggle=\"tabs\">\n                        <li class=\"nav-item\">\n                          <a href=\"#tabs-home-9\" class=\"nav-link active\" data-bs-toggle=\"tab\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"12\" cy=\"12\" r=\"9\" /><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" /><polyline points=\"11 12 12 12 12 16 13 16\" /></svg>\n                            {t['details']}\n                          </a>\n                        </li>\n                        <li class=\"nav-item\">\n                          <a href=\"#tabs-profile-9\" onClick={() => this.scrollChat()} class=\"nav-link\" data-bs-toggle=\"tab\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M21 14l-3 -3h-7a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1h9a1 1 0 0 1 1 1v10\" /><path d=\"M14 15v2a1 1 0 0 1 -1 1h-7l-3 3v-10a1 1 0 0 1 1 -1h2\" /></svg>\n                            {t['chats']}\n                          </a>\n                        </li>\n                      </ul>\n\n\n                      <div class=\"tab-content\">\n                        <div class=\"tab-pane active show\" id='tabs-home-9'>\n                          <div class=\"card-body\">\n                            <h4>{t['related_to_event']}:</h4>\n                            <div class=\"text-muted mb-3\">\n                              <a href={'/#/events/' + this.state.event.id}>{this.state.event.title}</a>\n                            </div>\n\n                            {this.sideBlock('info', t['meeting_info'])}\n                            <React.Fragment>\n                              <h4>{t['meeting_type']}:</h4>\n                              <div class=\"text-muted mb-3\">\n                                {t[this.state.meeting_type]}\n                              </div>\n                            </React.Fragment>\n                            {this.sideBlock('capacity', t['meeting_capacity'])}\n                            {this.sideBlock('external_link', t['meeting_external_link'])}\n\n                            <h4>{t['meeting_start_time']}:</h4>\n                            <div class=\"text-muted mb-3\">\n                              {moment(this.formatGregorianDate(this.state.start_time)).format('HH:mm jYYYY/jMM/jDD')}\n                            </div>\n\n                            <h4>{t['meeting_end_time']}:</h4>\n                            <div class=\"text-muted mb-3\">\n                              {moment(this.formatGregorianDate(this.state.end_time)).format('HH:mm YYYY/MM/DD')}\n                            </div>\n\n                            <h4>{t['tags']}</h4>\n                            <div class=\"text-muted mb-3\">\n                              {this.tagsShow(this.state.tags)}\n                            </div>\n\n                          </div>\n                          <div class=\"card-footer\">\n                            <div class=\"d-flex\">\n                              <a href={\"/#/rooms/\" + this.state.room_id + \"?rnd=\" + uuidv4()} onClick={this.forceUpdate} class=\"btn bg-green-lt\">\n                                {t['enter_room']}\n                              </a>\n                              <a onClick={() => this.createBigBlue()} class=\"btn bg-cyan-lt ms-auto\">\n                                {t['enter_bigblue_room']}\n                                <div id='bigblue-spinner' class=\"spinner-border text-black\" role=\"status\" style={{ display: 'none' }}></div>\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n                        <div class=\"tab-pane\" id='tabs-profile-9' >\n                          <div class=\"card mb-3 maxh-250 minh-250\" style={{ borderColor: 'white', boxShadow: 'none' }}>\n                            <div class=\"list-group list-group-flush overflow-auto\" id='chat-box' style={{ maxHeight: '25rem' }}>\n                              {this.chatItems()}\n                            </div>\n                            <div class=\"card-footer\" style={{ borderColor: 'white' }} >\n                              <div class=\"row\">\n                                <div class=\"col\">\n                                  <input id='chat-form' type=\"text\" class=\"form-control\" placeholder={t['write_something']} onChange={(e) => {\n                                    this.handleChange({ item: { content: e.target.value, name: this.state.name, initials: this.state.initials, time: Date.now(), uuid: uuidv4() } })\n                                  }} />\n                                </div>\n                                <div class=\"col-auto\">\n                                  <a onClick={() => this.send()} class=\"btn btn-white btn-icon\" aria-label=\"Button\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 20v-8h-3.586a1 1 0 0 1 -.707 -1.707l6.586 -6.586a1 1 0 0 1 1.414 0l6.586 6.586a1 1 0 0 1 -.707 1.707h-3.586v8a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z\" /></svg>\n                                  </a>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    <AttendanceCard is_admin={this.state.is_admin} attendees={this.state.attendees} attendable_type='meeting' attendable_id={this.state.id} />\n\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['pages']}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.createFlyerBtn()}\n                        </ul>\n                      </div>\n                      <div class=\"list-group list-group-flush list-group-hoverable\">\n                        {this.flyers()}\n                      </div>\n                    </div>\n\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['resources']}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.createUploadBtn()}\n                        </ul>\n\n                      </div>\n                      <div class=\"list-group list-group-flush list-group-hoverable\">\n                        {this.uploads()}\n                      </div>\n                    </div>\n                  </div>\n\n                  <FlyerCard quill_content={this.state.quill_content} cover={this.state.cover} />\n\n                </div>\n              </div>\n            </div>\n          </div>\n        </div >\n      </body >\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport DatePicker from \"react-datepicker\";\nimport queryString from 'query-string'\nimport RangeSlider from 'react-bootstrap-range-slider';\nimport moment from 'moment-jalaali'\nimport DatePicker2 from 'react-datepicker2';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class MeetingCreate extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.getInstance = this.getInstance.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      info: null,\n      meeting_type: 'online',\n      start_time: Date.now(),\n      end_time: Date.now(),\n      event_id: null,\n      capacity: 20,\n      editing: false,\n      options: [],\n      tags: [],\n      is_private: false,\n    }\n\n  }\n\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    const value = queryString.parse(this.props.location.search);\n    this.setState({ event_id: value.event_id }, () => console.log(this.state.event_id))\n    if (this.props.match.params.id) {\n      MyActions.getInstance('meetings', this.props.match.params.id, this.state.token);\n    }\n  }\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  setInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Meeting') {\n      this.props.history.push(\"/meetings/\" + model.id)\n    }\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (model && klass === 'Meeting') {\n      this.setState({\n        id: model.id,\n        title: model.title,\n        info: model.info,\n        meeting_type: model.meeting_type,\n        start_time: model.start_time,\n        end_time: model.end_time,\n        event_id: model.event.id,\n        capacity: model.capacity,\n        tags: model.tags,\n        is_private: model.is_private,\n        editing: true,\n      }, () => {\n        console.log(this.state)\n        this.changeType(this.state.meeting_type)\n        this.tagSelected(this.state.tags);\n      })\n    }\n  }\n\n  submit() {\n    var data = this.state\n    if (!this.state.editing) {\n      MyActions.setInstance('meetings', data, this.state.token);\n    } else {\n      MyActions.updateInstance('meetings', data, this.state.token);\n    }\n  }\n\n  changeType(e) {\n    var self = this;\n    $('.form-selectgroup-input').each(function () {\n      if ($(this).val() !== e) {\n        $(this).prop(\"checked\", false)\n      } else {\n        if ($(this).checked) {\n          $(this).prop(\"checked\", false)\n        } else {\n          $(this).prop(\"checked\", true)\n          self.setState({ meeting_type: e })\n        }\n      }\n    })\n  }\n\n  tagSelected(tags) {\n    var result = []\n    tags.map((tag) => {\n      if (tag['title']) {\n        result.push(tag['title'])\n      } else {\n        result.push(tag)\n      }\n    })\n    this.setState({ tags: result }, () => console.log(this.state.tags))\n  }\n\n  tagShow() {\n    if (this.props.match.params.id && this.state.id) {\n      return (this.tagInput())\n    }\n\n    if (!this.props.match.params.id) {\n      return (this.tagInput())\n    }\n  }\n\n  tagInput() {\n    return (\n      <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n        <AsyncTypeahead\n          id='event-tag'\n          allowNew\n          multiple\n          defaultSelected={this.state.tags}\n          isLoading={this.state.isLoading}\n          labelKey='title'\n          onSearch={(query) => {\n            this.setState({ isLoading: true });\n            fetch(server + \"/tags/search?q=\" + query)\n              .then((resp) => resp.json())\n              .then(({ items }) => {\n                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n              });\n          }}\n          onChange={(t) => this.tagSelected(t)}\n          options={this.state.options}\n          renderMenuItemChildren={(option, props) => (\n            <React.Fragment>\n              <span>{option.title}</span>\n            </React.Fragment>\n          )}\n        />\n      </div>\n    )\n  }\n\n  changeDefault(e) {\n    if(this.state.is_private){\n        this.setState({is_private: false})\n    } else {\n        this.setState({is_private: true})\n    }\n  }\n\n  isPrivateBadge(){\n    if(this.state.is_private){\n      return(\n        <span class=\"badge bg-red-lt\">{t['private']}</span>\n      )\n    }\n  }\n\n\n  render() {\n    const { is_private} = this.state; \n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history}/>\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['create_meeting_page']}</div>\n                  <h2 className=\"page-title\">{t['provide_following_info']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row row-deck row-cards\">\n                  <div class=\"col-md-8\">\n                    <div class=\"card\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['create_meeting']}</h3>\n                      </div>\n                      <div class=\"card-body\">\n                        <form>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_title']}</label>\n                            <input type=\"text\" class=\"form-control\" name=\"text-input\" placeholder={t['write_something']} onInput={(e) => { this.handleChange({ title: e.target.value }) }} value={this.state.title} />\n                          </div>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_info']}<span class=\"form-label-description\"></span></label>\n                            <textarea class=\"form-control\" name=\"example-textarea-input\" rows=\"6\" placeholder={t['write_something']} onInput={(e) => { this.handleChange({ info: e.target.value }) }} value={this.state.info}></textarea>\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_type']}</label>\n                            <div class=\"form-selectgroup\">\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"in_person\" class=\"form-selectgroup-input\" checked=\"\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['in_person']}</span>\n                              </label>\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"hybrid\" class=\"form-selectgroup-input\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['hybrid']}</span>\n                              </label>\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"online\" class=\"form-selectgroup-input\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['online']}</span>\n                              </label>\n                              <label class=\"form-selectgroup-item\">\n                                <input type=\"checkbox\" name=\"name\" value=\"online_external\" class=\"form-selectgroup-input\" onClick={(e) => this.changeType(e.target.value)} />\n                                <span class=\"form-selectgroup-label\">{t['online_external']}</span>\n                              </label>\n                            </div>\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_capacity']}</label>\n                            <RangeSlider\n                              value={this.state.capacity}\n                              onChange={(e) => { this.handleChange({ capacity: e.target.value }) }}\n                            />\n                          </div>\n\n                          <div class=\"mb-3 \" id='tags' >\n                            <label class=\"form-label\" >{t['tags']}</label>\n                            {this.tagShow()}\n                          </div>\n\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_start_time']}<span class=\"form-label-description\"></span></label>\n                            <DatePicker2\n                              isGregorian={false}\n                              onChange={value => { this.setState({ start_time: value }) }}\n                              value={moment(this.state.start_time)}\n                            />\n                          </div>\n\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['meeting_end_time']}<span class=\"form-label-description\"></span></label>\n                            <DatePicker2\n                              isGregorian={false}\n                              onChange={value => { this.setState({ end_time: value }) }}\n                              value={moment(this.state.end_time)}\n                            />\n                          </div>\n\n\n                          <div class=\"mb-3\">\n                            <div class=\"form-label\">{t['is_private']}</div>\n                            <label class=\"form-check form-switch\">\n                              <input class=\"form-check-input\" type=\"checkbox\" onClick={(e) => this.changeDefault(e.target.value)} checked={is_private ? true : false} />\n                              <span class=\"form-check-label\">{t['default_is_private_info']}</span>\n                            </label>\n                          </div>\n\n\n\n\n                        </form>\n                      </div>\n                      <div class=\"card-footer\">\n                        <div class=\"d-flex\">\n                          <a href=\"/#/meetings\" class=\"btn btn-link\">{t['cancel']}</a>\n                          <button onClick={() => this.submit()} class=\"btn btn-primary ms-auto\">{t['submit']}</button>\n                        </div>\n                      </div>\n                      <div class=\"progress progress-sm card-progress\">\n                        <div class=\"progress-bar\" style={{ width: \"100%\" }} role=\"progressbar\" aria-valuenow=\"38\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                          <span class=\"visually-hidden\">38% Complete</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"col-4\">\n                    <div class=\"card\">\n                      <div class=\"card-status-top bg-lime\"></div>\n                      <div class=\"card-body\">\n                        <h3 class=\"card-title\">Help</h3>\n                        <p></p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\n\nexport default class MeetingAttendance extends React.Component {\n\n    constructor(props) {\n        super(props);\n        //this.submit = this.submit.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n    }\n\n    componentDidMount() {\n\n    }\n\n\n\n    handleChange(obj) {\n\n    }\n\n    setInstance() {\n\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history}/>\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\"></div>\n                                <div className=\"col\">\n                                    <div className=\"page-pretitle\">Overview</div>\n                                    <h2 className=\"page-title\">Condensed dark layout</h2>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n\n                                    <div className=\"col-md-6\">\n                                        <div class=\"card mb-3\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">Add Attendees</h3>\n                                            </div>\n                                            <div class=\"list-group list-group-flush list-group-hoverable\">\n                                                <div class=\"list-group-item\">\n                                                    <div class=\"input-icon mb-3\">\n                                                        <input type=\"text\" class=\"form-control\" placeholder=\"Search…\" />\n                                                        <span class=\"input-icon-addon\">\n\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                        </span>\n                                                    </div>\n                                                </div>\n\n                                                <div class=\"list-group-item\">\n                                                    <div class=\"row align-items-center\">\n                                                        <div class=\"col-auto\"><span class=\"badge bg-red\"></span></div>\n                                                        <div class=\"col-auto\">\n                                                            <a href=\"#\">\n                                                                <span class=\"avatar\" ></span>\n                                                            </a>\n                                                        </div>\n                                                        <div class=\"col text-truncate\">\n                                                            <a href=\"#\" class=\"text-body d-block\">Paweł Kuna</a>\n                                                            <small class=\"d-block text-muted text-truncate mt-n1\">Change deprecated html tags to text decoration classes (#29604)</small>\n                                                        </div>\n                                                        <div class=\"col-auto\">\n                                                            <a href=\"#\" class=\"list-group-item-actions\">\n                                                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon text-muted\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z\"></path></svg>\n                                                            </a>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport { v4 as uuidv4 } from 'uuid';\nimport moment from 'jalali-moment'\nmoment.locale('fa', { useGregorianParser: true });\n\nconst t = dict['fa']\n\nconst ExhibitionCard = (props) => {\n\n    function formatGregorianDate(gregorianDate) {\n        var date = new Date(gregorianDate);\n        var day = date.getDate();\n        var month = date.getMonth() + 1;\n        var year = date.getFullYear();\n        var hours = date.getHours();\n        var minutes = date.getMinutes();\n        var fullYear = year + '/' + month + '/' + day + ' ' + hours + ':' + minutes;\n        return fullYear;\n    }\n\n\n    function cardCover(exhibition) {\n        if (exhibition.cover) {\n            return (\n                <a href={'/#/exhibitions/' + exhibition.id}>\n                    <div class=\"card-img-top img-responsive img-responsive-16by9\" style={{ backgroundImage: \"url(\" + exhibition.cover + \")\" }}></div>\n                </a>\n            )\n        }\n    }\n\n    function tagsShow(tags) {\n        var result = []\n        if (tags && tags.length > 0) {\n            tags.map((tag) => {\n                result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n            })\n        }\n        return result\n    }\n\n    function exhibitionItems() {\n        var result = []\n        if (props.exhibitions) {\n            props.exhibitions.map((exhibition) => {\n                result.push(\n\n                    <div className={props.col ? \"col-md-\" + props.col : \"col-md-8\"} >\n                        <div className=\"card\">\n                            {cardCover(exhibition)}\n                            <div className=\"card-body\">\n                                <h3 class=\"card-title\">\n                                    <a href={'/#/exhibitions/' + exhibition.id}>\n                                        {exhibition.title}\n                                    </a>\n                                </h3>\n                                <p style={{ textAlign: 'justify' }}>\n                                    {exhibition.truncated_info}\n                                </p>\n\n\n\n\n                                <h4>{t['tags']}</h4>\n                                <div class=\"text-muted mb-3\">\n                                    {tagsShow(exhibition.tags)}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n    return (\n        <React.Fragment>\n            {exhibitionItems()}\n        </React.Fragment>\n    )\n}\nexport default ExhibitionCard;\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport ExhibitionCard from \"./card.jsx\";\nimport moment from 'moment-jalaali'\nimport DatePicker2 from 'react-datepicker2';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\n\nconst t = dict['fa']\n\nexport default class ExhibitionIndex extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.getList = this.getList.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            exhibitions: null,\n            allTags: null,\n            q: '',\n            start_from: moment(),\n            start_to: moment().add(2, 'jMonth'),\n            tags: [],\n            page: 1,\n        }\n\n    }\n\n\n    componentWillMount() {\n        ModelStore.on(\"got_list\", this.getList);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_list\", this.getList);\n    }\n\n    componentDidMount() {\n        MyActions.getList('exhibitions', this.state.page, {}, this.state.token);\n        MyActions.getList('tags/top', this.state.page, {}, this.state.token);\n    }\n\n    getList() {\n        var list = ModelStore.getList()\n        var klass = ModelStore.getKlass()\n\n        if (list && klass === 'Exhibition') {\n            $('#search-spinner').hide();\n            if (list[0] && list[0].page) {\n                if (list[0].page == 1) {\n                    this.setState({\n                        exhibitions: list,\n                    });\n                } else {\n                    this.setState({\n                        exhibitions: this.state.exhibitions.concat(list),\n                    });\n                }\n                this.setState({ page: list[0].page })\n            } else {\n                this.setState({\n                    exhibitions: [],\n                });\n            }\n            console.log(list)\n        }\n        if (list && klass === 'Tag') {\n            this.setState({\n                allTags: list,\n            });\n        }\n    }\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n\n\n    noExhibitionCard() {\n        <div class=\"col-12\">\n            <div class=\"card\">\n                <div class=\"empty\">\n                    <div class=\"empty-img\"><img src=\"./static/illustrations/undraw_quitting_time_dm8t.svg\" height=\"128\" alt=\"\" />\n                    </div>\n                    <p class=\"empty-title\">No results found</p>\n                    <p class=\"empty-subtitle text-muted\">\n                        Try adjusting your search or filter to find what you're looking for.\n                    </p>\n                    <div class=\"empty-action\">\n                        <a href=\"/#/exhibitions/create\" class=\"btn btn-primary\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><rect x=\"4\" y=\"5\" width=\"16\" height=\"16\" rx=\"2\" /><line x1=\"16\" y1=\"3\" x2=\"16\" y2=\"7\" /><line x1=\"8\" y1=\"3\" x2=\"8\" y2=\"7\" /><line x1=\"4\" y1=\"11\" x2=\"20\" y2=\"11\" /><line x1=\"10\" y1=\"16\" x2=\"14\" y2=\"16\" /><line x1=\"12\" y1=\"14\" x2=\"12\" y2=\"18\" /></svg>\n                            Create an exhibition\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    }\n\n    checkExhibition() {\n        if (this.state.exhibitions) {\n            return (\n                <React.Fragment>\n                    <div class=\"col-4\">\n                        <div class=\"card\">\n                            <div class=\"card-status-top bg-lime\"></div>\n                            <div className=\"card-header\" >\n                                <h3 class=\"card-title\">{t['exhibitions']}</h3>\n                                <ul class=\"nav nav-pills card-header-pills\">\n                                    <li class=\"nav-item ms-auto\">\n                                        <a class=\"nav-link p-1\" href={\"/#/exhibitions/create\"}>\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                                        </a>\n                                    </li>\n                                </ul>\n                            </div>\n                            <div class=\"card-body\">\n                                <p>\n                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam deleniti fugit incidunt, iste, itaque minima neque pariatur perferendis sed suscipit velit vitae voluptatem\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    <ExhibitionCard exhibitions={this.state.exhibitions} col={8} />\n                </React.Fragment>\n            )\n        } else {\n            return (this.noExhibitionCard())\n        }\n    }\n\n    cardMasonry() {\n        if (this.state.exhibitions) {\n            return (\n                <div class='row row-cards' data-masonry='{\"percentPosition\": true }'  >\n                    <ExhibitionCard exhibitions={this.state.exhibitions} col={6} />\n                </div>\n            )\n        }\n    }\n\n    search() {\n        $('#search-spinner').show();\n        var data = { q: this.state.q, tags: this.state.tags }\n        MyActions.getList('exhibitions/search', this.state.page, data, this.state.token);\n        this.setState({ page: 1 })\n    }\n\n    tagCheckbox() {\n        var result = []\n        if (this.state.allTags) {\n            this.state.allTags.map((tag) => {\n                result.push(\n                    <label class=\"form-check\">\n                        <input id={'tag-check-' + tag.id} class=\"form-check-input\" type=\"checkbox\" style={{ marginTop: '3.5px' }} value={tag.id} onChange={(e) => this.changeTags(e)} />\n                        <span class=\"form-check-label\">\n                            <span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>\n                        </span>\n                    </label>\n                )\n            })\n        }\n        return result\n    }\n\n    tagSelected(tags) {\n        var result = []\n        tags.map((tag) => {\n            if (tag['title']) {\n                result.push(tag['title'])\n            } else {\n                result.push(tag)\n            }\n        })\n        this.setState({ tags: result }, () => console.log(this.state.tags))\n    }\n\n    tagInput() {\n        return (\n            <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n                <AsyncTypeahead\n                    id='search-tag'\n                    multiple\n                    defaultSelected={this.state.tags}\n                    isLoading={this.state.isLoading}\n                    labelKey='title'\n                    onSearch={(query) => {\n                        this.setState({ isLoading: true });\n                        fetch(server + \"/tags/search?q=\" + query)\n                            .then((resp) => resp.json())\n                            .then(({ items }) => {\n                                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n                            });\n                    }}\n                    onChange={(t) => this.tagSelected(t)}\n                    options={this.state.options}\n                    renderMenuItemChildren={(option, props) => (\n                        <React.Fragment>\n                            <span>{option.title}</span>\n                        </React.Fragment>\n                    )}\n                />\n            </div>\n        )\n    }\n\n\n    loadMore() {\n        var data = { id: this.state.id, page: this.state.page + 1, q: this.state.q, tags: this.state.tags }\n        MyActions.getList('exhibitions/search', this.state.page, data, this.state.token);\n    }\n\n\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history} />\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\">\n                                    <div className=\"col\">\n                                        <div className=\"page-pretitle\">{t['overview']}</div>\n                                        <h2 className=\"page-title\">{t['exhibitions']}</h2>\n                                    </div>\n                                    <div class=\"col-auto ms-auto d-print-none\">\n                                        <div class=\"btn-list\">\n                                            <a href={\"/#/exhibitions/create\"} class=\"btn btn-primary\"  >\n                                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>\n                                                {t['create_exhibition']}\n                                            </a>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div class=\"row\">\n                                    <div class=\"col-lg-3\">\n                                        <div class=\"card mb-3\">\n                                            <div className=\"card-header\" >\n                                                <h4 class=\"card-title\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                                                    {t['filter_events']}\n                                                </h4>\n                                            </div>\n\n                                            <div class=\"card-body\">\n                                                <div class=\"mb-3\">\n                                                    <label class=\"form-label\">{t['contains_words']}</label>\n                                                    <div class=\"input-icon mb-3\">\n                                                        <input type=\"text\" class=\"form-control\" placeholder={t['search_placeholder']} onInput={(e) => { this.handleChange({ q: e.target.value }) }} />\n                                                        <span class=\"input-icon-addon\">\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                        </span>\n                                                    </div>\n                                                </div>\n\n                                                <div class=\"mb-3 \" id='tags' >\n                                                    <label class=\"form-label\" >{t['tags']}</label>\n                                                    {this.tagInput()}\n                                                </div>\n                                            </div>\n                                            <div class=\"card-footer\">\n\n                                                <a onClick={() => this.search()} class=\"btn btn-primary w-100\">\n                                                    <span style={{ verticalAlign: '-2px' }}>\n                                                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M5.5 5h13a1 1 0 0 1 .5 1.5l-5 5.5l0 7l-4 -3l0 -4l-5 -5.5a1 1 0 0 1 .5 -1.5\" /></svg>\n                                                    </span>\n                                                    {t['filter_and_search']}\n                                                    <div id='search-spinner' class=\"spinner-border text-red\" role=\"status\" style={{ display: 'none' }}></div>\n                                                </a>\n                                            </div>\n\n                                        </div>\n                                    </div>\n                                    <div class=\"col-lg-9\">\n                                        {this.cardMasonry()}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from \"react\";\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\n\n\nconst QuestionCard = (props) => {\n    const t = dict['fa']\n    function questions() {\n        var result = []\n        if (props.questions) {\n            props.questions.map((question) => {\n                if (question.content) {\n                    result.push(\n                        <div class=\"list-group-item\">\n                            <div class=\"row align-items-center\">\n                                <div class=\"col text-truncate\">\n                                    <a onClick=\"\" class=\"text-body d-block\">{question.content}</a>\n                                </div>\n                            </div>\n                        </div>)\n                }\n            });\n        }\n\n        return result\n    }\n\n    function createBtn() {\n        if (props.is_admin) {\n            return (\n                <li class=\"nav-item ms-auto\">\n                    <a class=\"nav-link p-1\" href={\"/#/questions/create?\" + props.questionable_type + \"_id=\" + props.questionable_id}>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                    </a>\n                </li>\n            )\n        }\n    }\n\n    return (\n\n        <div className=\"card mb-3\" style={props.height ? { height: props.height } : { height: 'auto' }}>\n            <div className=\"card-header\" >\n                <h3 class=\"card-title\">{t['q_and_a_s']}</h3>\n                <ul class=\"nav nav-pills card-header-pills\">\n                    {createBtn()}\n                </ul>\n            </div>\n            <div class=\"list-group list-group-flush list-group-hoverable\">\n                {questions()}\n            </div>\n        </div>\n\n    )\n}\nexport default QuestionCard;","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport MeetingCard from \"../meetings/card.jsx\";\nimport { v4 as uuidv4 } from 'uuid';\nimport $ from 'jquery';\nimport AttendanceCard from \"../attendances/card.jsx\";\nimport QuestionCard from \"../questions/card.jsx\";\nimport Quill from 'quill';\nimport { socket } from '../../socket.js'\nimport FlyerCard from \"../flyers/card.jsx\";\nimport {\n  socketHandle, appendChat, chatItems, throttle, send, wsSend, keydownHandler, scrollChat\n} from \"../rooms/chat.js\";\n\nconst t = dict['fa']\n\nexport default class ExhibitionShow extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n\n    this.socketHandle = socketHandle.bind(this);\n    this.appendChat = appendChat.bind(this);\n    this.chatItems = chatItems.bind(this);\n    this.throttle = throttle.bind(this);\n    this.send = send.bind(this);\n    this.wsSend = wsSend.bind(this);\n    this.keydownHandler = keydownHandler.bind(this);\n    this.scrollChat = scrollChat.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      id: null,\n      info: null,\n      flyers: [],\n      questions: [],\n      quillOne: null,\n      tags: [],\n      uploads: null,\n      is_admin: false,\n      attendees: [],\n      room_id: null,\n      roomId: null,\n      cover: null,\n\n      name: null,\n      fullname: null,\n      initials: null,\n      userUUID: null,\n\n      chats: [],\n      lastTime: Date.now(),\n      content: null,\n      item: null,\n      quill_content: null,\n    }\n\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n    document.addEventListener('keydown', this.keydownHandler);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    document.removeEventListener('keydown', this.keydownHandler);\n  }\n\n  componentDidMount() {\n    var self = this;\n    MyActions.getInstance('exhibitions', this.props.match.params.id, this.state.token);\n    // var quillOne = new Quill('#editor-one', {\n    //theme: 'snow',\n    //   readOnly: true,\n    // });\n    // this.setState({ quillOne: quillOne })\n    socket.on('connect', function () {\n      if (self.state.roomId) {\n        socket.emit('room', { room: self.state.roomId.toString(), uuid: self.state.userUUID });\n      }\n    });\n\n    socket.on('message', function (data) {\n      if (data['sender'] !== self.state.userUUID) {\n        self.socketHandle(data)\n      }\n    });\n  }\n\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Exhibition') {\n      this.setState({\n        title: model.title,\n        id: model.id,\n        info: model.info,\n        flyers: model.flyers,\n        tags: model.tags,\n        uploads: model.uploads,\n        is_admin: model.is_admin,\n        attendees: model.attendees,\n        room_id: model.room_id,\n        roomId: model.room_uuid,\n        cover: model.cover,\n        questions: model.questions\n      }, () => {\n        if (this.state.token && this.state.token.length > 10) {\n          MyActions.setInstance('users/validate_token', {}, this.state.token);\n        }\n        if (this.state.flyers && this.state.flyers[0]) {\n          this.loadContent(this.state.flyers[0].quill_content)\n        }\n      })\n    }\n    console.log(model)\n  }\n\n  setInstance() {\n    var self = this;\n    var klass = ModelStore.getKlass()\n    var user = ModelStore.getIntance();\n    if (klass === 'Validate') {\n      this.setState({ name: user.name, fullname: user.name, initials: user.initials, userUUID: user.uuid }, () => {\n        this.connectSocketRoom();\n        //console.log(self.state)\n      });\n    }\n  }\n\n\n  deleteFlyer(id) {\n    var data = { id: id, advertisable_id: this.state.id, advertisable_type: 'Meeting' }\n    MyActions.removeInstance('flyers', data, this.state.token);\n  }\n\n  loadContent(quill_content) {\n    this.setState({ quill_content: quill_content })\n  }\n\n  editFlyerBtn(flyer) {\n    if (this.state.is_admin) {\n      return (\n        <div class=\"col-auto\">\n          <a href={\"/#/flyers/edit/\" + flyer.id} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n          </a>\n          <a onClick={() => this.deleteFlyer(flyer.id)} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n          </a>\n        </div>\n      )\n    }\n  }\n\n  flyers() {\n    var result = []\n    this.state.flyers.map((flyer) => {\n      if (flyer.is_default) {\n        // $('#content').html();\n        // this.state.quillOne.setContents(flyer.quill_content)\n      }\n    })\n    this.state.flyers.map((flyer) => {\n      result.push(\n        <div class=\"list-group-item\">\n          <div class=\"row align-items-center\">\n            <div class=\"col text-truncate\">\n              <a onClick={() => this.loadContent(flyer.quill_content)} class=\"text-body d-block\">{flyer.title}</a>\n            </div>\n            {this.editFlyerBtn(flyer)}\n          </div>\n        </div>\n      )\n    })\n    return result\n  }\n\n  tagsShow(tags) {\n    var result = []\n    if (tags && tags.length > 0) {\n      tags.map((tag) => {\n        result.push(<span class=\"badge bg-lime-lt\" style={{ margin: '2px' }}>{tag.title}</span>)\n      })\n    }\n    return result\n  }\n\n  editUploadBtn(upload) {\n    if (this.state.is_admin) {\n      return (\n        <div class=\"col-auto p-0\">\n          <a onClick={() => this.deleteFlyer(upload.id)} class=\"list-group-item-actions show\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"4\" y1=\"7\" x2=\"20\" y2=\"7\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>\n          </a>\n        </div>\n      )\n    }\n  }\n\n  uploads() {\n    var result = []\n    if (this.state.uploads) {\n      this.state.uploads.map((upload) => {\n        if (upload.upload_type !== 'cover') {\n          result.push(\n            <div class=\"list-group-item\">\n              <div class=\"row align-items-center\">\n                <div class=\"col text-truncate\">\n                  <a style={{ cursor: 'pointer' }} href={upload.link} class=\"text-body d-block\">{upload.title}</a>\n                </div>\n                {this.editUploadBtn(upload)}\n              </div>\n            </div>\n          )\n        }\n      })\n    }\n    return result\n  }\n\n  createFlyerBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link\" href={\"/#/flyers/create?exhibition_id=\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  createUploadBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link\" href={\"/#/uploads/create?exhibition_id=\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  editExhibitionBtn() {\n    if (this.state.is_admin) {\n      return (\n        <li class=\"nav-item ms-auto\">\n          <a class=\"nav-link p-1\" href={\"/#/exhibitions/edit/\" + this.state.id}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3\" /><path d=\"M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3\" /><line x1=\"16\" y1=\"5\" x2=\"19\" y2=\"8\" /></svg>\n          </a>\n        </li>\n      )\n    }\n  }\n\n  addAttendance() {\n    if (this.state.is_admin) {\n      return (\n        <AttendanceCard is_admin={this.state.is_admin} attendees={this.state.attendees} attendable_type='exhibition' attendable_id={this.state.id} />\n      )\n    }\n\n  }\n\n  connectSocketRoom() {\n    if (this.state.userUUID && this.state.roomId) {\n      socket.emit('room', { room: this.state.roomId, uuid: this.state.userUUID });\n    }\n  }\n\n\n  render() {\n\n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history} />\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['overview']}</div>\n                  <h2 className=\"page-title\">{t['exhibition_detail']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row  row-cards\">\n\n                  <div class=\"col-lg-4\">\n                    <div class=\"card mb-3\">\n                      <div className=\"card-header bg-dark-lt\" >\n                        <h3 class=\"card-title\">{this.state.title} </h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.editExhibitionBtn()}\n                        </ul>\n                      </div>\n                      <ul class=\"nav nav-tabs\" data-bs-toggle=\"tabs\">\n                        <li class=\"nav-item\">\n                          <a href=\"#tabs-home-9\" class=\"nav-link active\" data-bs-toggle=\"tab\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"12\" cy=\"12\" r=\"9\" /><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\" /><polyline points=\"11 12 12 12 12 16 13 16\" /></svg>\n                            {t['details']}\n                          </a>\n                        </li>\n                        <li class=\"nav-item\">\n                          <a href=\"#tabs-profile-9\" onClick={() => this.scrollChat()} class=\"nav-link\" data-bs-toggle=\"tab\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M21 14l-3 -3h-7a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1h9a1 1 0 0 1 1 1v10\" /><path d=\"M14 15v2a1 1 0 0 1 -1 1h-7l-3 3v-10a1 1 0 0 1 1 -1h2\" /></svg>\n                            {t['chats']}\n                          </a>\n                        </li>\n                      </ul>\n\n                      <div class=\"tab-content\">\n                        <div class=\"tab-pane active show\" id='tabs-home-9'>\n\n                          <div class=\"card-body\">\n                            <h4>{t['exhibition_info']}</h4>\n                            <div class=\"text-muted mb-3\" style={{ textAlign: 'justify' }}>\n                              {this.state.info}\n                            </div>\n\n\n                            <h4>{t['tags']}</h4>\n                            <div class=\"text-muted mb-3\">\n                              {this.tagsShow(this.state.tags)}\n                            </div>\n                          </div>\n                          <div class=\"card-footer\">\n                            <div class=\"mt-2\">\n                              <a href={\"/#/rooms/\" + this.state.room_id + \"?rnd=\" + uuidv4()} class=\"btn btn-primary bg-green-lt w-100\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><rect x=\"3\" y=\"4\" width=\"18\" height=\"16\" rx=\"3\" /><circle cx=\"9\" cy=\"10\" r=\"2\" /><line x1=\"15\" y1=\"8\" x2=\"17\" y2=\"8\" /><line x1=\"15\" y1=\"12\" x2=\"17\" y2=\"12\" /><line x1=\"7\" y1=\"16\" x2=\"17\" y2=\"16\" /></svg>\n                                {t['enter_room_with_admin']}\n                              </a>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div class=\"tab-pane\" id='tabs-profile-9' >\n                          <div class=\"card mb-3 maxh-250 minh-250\" style={{ borderColor: 'white', boxShadow: 'none' }}>\n                            <div class=\"list-group list-group-flush overflow-auto\" id='chat-box' style={{ maxHeight: '25rem' }}>\n                              {this.chatItems()}\n                            </div>\n                            <div class=\"card-footer\" style={{ borderColor: 'white' }} >\n                              <div class=\"row\">\n                                <div class=\"col\">\n                                  <input id='chat-form' type=\"text\" class=\"form-control\" placeholder={t['write_something']} onChange={(e) => {\n                                    this.handleChange({ item: { content: e.target.value, name: this.state.name, initials: this.state.initials, time: Date.now(), uuid: uuidv4() } })\n                                  }} />\n                                </div>\n                                <div class=\"col-auto\">\n                                  <a onClick={() => this.send()} class=\"btn btn-white btn-icon\" aria-label=\"Button\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M9 20v-8h-3.586a1 1 0 0 1 -.707 -1.707l6.586 -6.586a1 1 0 0 1 1.414 0l6.586 6.586a1 1 0 0 1 -.707 1.707h-3.586v8a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z\" /></svg>\n                                  </a>\n                                </div>\n                              </div>\n                            </div>\n\n                          </div>\n\n                        </div>\n                      </div>\n                    </div>\n\n                    {this.addAttendance()}\n\n                    <QuestionCard is_admin={this.state.is_admin} questions={this.state.questions} questionable_type='exhibition' questionable_id={this.state.id} />\n\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['pages']}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.createFlyerBtn()}\n                        </ul>\n                      </div>\n                      <div class=\"list-group list-group-flush list-group-hoverable\">\n                        {this.flyers()}\n                      </div>\n                    </div>\n\n                    <div class=\"card mb-3\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['resources']}</h3>\n                        <ul class=\"nav nav-pills card-header-pills\">\n                          {this.createUploadBtn()}\n                        </ul>\n\n                      </div>\n                      <div class=\"list-group list-group-flush list-group-hoverable\">\n                        {this.uploads()}\n                      </div>\n                    </div>\n\n                  </div>\n\n                  <FlyerCard quill_content={this.state.quill_content} cover={this.state.cover} />\n\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ReactDOM from 'react-dom';\nimport $ from 'jquery';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class ExhibitionCreate extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.submit = this.submit.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: null,\n      id: null,\n      info: null,\n      options: [],\n      tags: [],\n    }\n\n  }\n\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    if (this.props.match.params.id) {\n      MyActions.getInstance('exhibitions', this.props.match.params.id, this.state.token);\n    }\n  }\n\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  setInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Exhibition') {\n      this.props.history.push(\"/exhibitions/\" + model.id)\n    }\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (model && klass === 'Exhibition') {\n      this.setState({\n        id: model.id,\n        title: model.title,\n        info: model.info,\n        tags: model.tags,\n        editing: true,\n      }, () => {\n        console.log(this.state)\n        this.tagSelected(this.state.tags);\n      })\n    }\n  }\n\n  submit() {\n    var data = this.state\n    if (!this.state.editing) {\n      MyActions.setInstance('exhibitions', data, this.state.token);\n    } else {\n      MyActions.updateInstance('exhibitions', data, this.state.token);\n    }\n  }\n\n\n\n  tagSelected(tags) {\n    var result = []\n    tags.map((tag) => {\n      if (tag['title']) {\n        result.push(tag['title'])\n      } else {\n        result.push(tag)\n      }\n    })\n    this.setState({ tags: result }, () => console.log(this.state.tags))\n  }\n\n  tagShow() {\n    if (this.props.match.params.id && this.state.id) {\n      return (this.tagInput())\n    }\n\n    if (!this.props.match.params.id) {\n      return (this.tagInput())\n    }\n  }\n\n  tagInput() {\n    return (\n      <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n        <AsyncTypeahead\n          id='exhibition-tag'\n          allowNew\n          multiple\n          defaultSelected={this.state.tags}\n          isLoading={this.state.isLoading}\n          labelKey='title'\n          onSearch={(query) => {\n            this.setState({ isLoading: true });\n            fetch(server + \"/tags/search?q=\" + query)\n              .then((resp) => resp.json())\n              .then(({ items }) => {\n                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n              });\n          }}\n          onChange={(t) => this.tagSelected(t)}\n          options={this.state.options}\n          renderMenuItemChildren={(option, props) => (\n            <React.Fragment>\n              <span>{option.title}</span>\n            </React.Fragment>\n          )}\n        />\n      </div>\n    )\n  }\n\n\n  changeDefault(e) {\n    if(this.state.is_private){\n        this.setState({is_private: false})\n    } else {\n        this.setState({is_private: true})\n    }\n  }\n\n\n\n  render() {\n    const { is_private} = this.state;\n    \n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history}/>\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['create_exhibition_page']}</div>\n                  <h2 className=\"page-title\">{t['provide_following_info']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row row-deck row-cards\">\n                  <div class=\"col-md-8\">\n                    <div class=\"card\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['create_exhibition']}</h3>\n                      </div>\n                      <div class=\"card-body\">\n                        <form>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['exhibition_title']}</label>\n                            <input type=\"text\" onInput={(e) => { this.handleChange({ title: e.target.value }) }} id='title' class=\"form-control\" name=\"text-input\" placeholder={t['write_something']} value={this.state.title} />\n                          </div>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['exhibition_info']}<span class=\"form-label-description\"></span></label>\n                            <textarea onInput={(e) => { this.handleChange({ info: e.target.value }) }} class=\"form-control\" id='content' name=\"example-textarea-input\" rows=\"6\" placeholder={t['write_something']} value={this.state.info}></textarea>\n                          </div>\n\n\n                          <div class=\"mb-3 \" id='tags' >\n                            <label class=\"form-label\" >{t['tags']}</label>\n                            {this.tagShow()}\n                          </div>\n\n\n                        </form>\n                      </div>\n                      <div class=\"card-footer\">\n                        <div class=\"d-flex\">\n                          <a href=\"/#/exhibitions\" class=\"btn btn-link\">{t['cancel']}</a>\n                          <button onClick={() => this.submit()} class=\"btn btn-primary ms-auto\">{t['submit']}</button>\n                        </div>\n                      </div>\n                      <div class=\"progress progress-sm card-progress\">\n                        <div class=\"progress-bar\" style={{ width: \"100%\" }} role=\"progressbar\" aria-valuenow=\"38\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                          <span class=\"visually-hidden\">38% Complete</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"col-4\">\n                    <div class=\"card\">\n                      <div class=\"card-status-top bg-lime\"></div>\n                      <div class=\"card-body\">\n                        <h3 class=\"card-title\">Help</h3>\n                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam deleniti fugit incidunt, iste, itaque minima\n                          neque pariatur perferendis sed suscipit velit vitae voluptatem.</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\n\nexport default class DiscssionIndex extends React.Component {\n\n    constructor(props) {\n        super(props);\n        //this.submit = this.submit.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n    }\n\n    componentDidMount() {\n\n    }\n\n\n\n    handleChange(obj) {\n\n    }\n\n    setInstance() {\n\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history}/>\n                    <div className=\"page-wrapper\">\n\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n\n\n                                    <div class=\"card chat-app\">\n                                        <div id=\"plist\" class=\"people-list\">\n\n                                            <div class=\"input-icon mb-3\">\n                                                <input type=\"text\" class=\"form-control\" placeholder=\"Search…\" />\n                                                <span class=\"input-icon-addon\">\n                                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                </span>\n                                            </div>\n                                            <ul class=\"list-unstyled chat-list mt-2 mb-0\">\n                                                <li class=\"clearfix\">\n                                                    <img src=\"https://bootdey.com/img/Content/avatar/avatar1.png\" alt=\"avatar\" />\n                                                    <div class=\"about\">\n                                                        <div class=\"name\">Vincent Porter</div>\n                                                        <div class=\"status\"> <i class=\"fa fa-circle offline\"></i> left 7 mins ago </div>\n                                                    </div>\n                                                </li>\n                                                <li class=\"clearfix active\">\n                                                    <img src=\"https://bootdey.com/img/Content/avatar/avatar2.png\" alt=\"avatar\" />\n                                                    <div class=\"about\">\n                                                        <div class=\"name\">Aiden Chavez</div>\n                                                        <div class=\"status\"> <i class=\"fa fa-circle online\"></i> online </div>\n                                                    </div>\n                                                </li>\n                                                <li class=\"clearfix\">\n                                                    <img src=\"https://bootdey.com/img/Content/avatar/avatar3.png\" alt=\"avatar\" />\n                                                    <div class=\"about\">\n                                                        <div class=\"name\">Mike Thomas</div>\n                                                        <div class=\"status\"> <i class=\"fa fa-circle online\"></i> online </div>\n                                                    </div>\n                                                </li>\n                                                <li class=\"clearfix\">\n                                                    <img src=\"https://bootdey.com/img/Content/avatar/avatar7.png\" alt=\"avatar\" />\n                                                    <div class=\"about\">\n                                                        <div class=\"name\">Christian Kelly</div>\n                                                        <div class=\"status\"> <i class=\"fa fa-circle offline\"></i> left 10 hours ago </div>\n                                                    </div>\n                                                </li>\n                                                <li class=\"clearfix\">\n                                                    <img src=\"https://bootdey.com/img/Content/avatar/avatar8.png\" alt=\"avatar\" />\n                                                    <div class=\"about\">\n                                                        <div class=\"name\">Monica Ward</div>\n                                                        <div class=\"status\"> <i class=\"fa fa-circle online\"></i> online </div>\n                                                    </div>\n                                                </li>\n                                                <li class=\"clearfix\">\n                                                    <img src=\"https://bootdey.com/img/Content/avatar/avatar3.png\" alt=\"avatar\" />\n                                                    <div class=\"about\">\n                                                        <div class=\"name\">Dean Henry</div>\n                                                        <div class=\"status\"> <i class=\"fa fa-circle offline\"></i> offline since Oct 28 </div>\n                                                    </div>\n                                                </li>\n                                            </ul>\n                                        </div>\n                                        <div class=\"chat\">\n                                            <div class=\"chat-header clearfix\">\n                                                <div class=\"row\">\n                                                    <div class=\"col-lg-6\">\n                                                        <a href=\"javascript:void(0);\" data-toggle=\"modal\" data-target=\"#view_info\">\n                                                            <img src=\"https://bootdey.com/img/Content/avatar/avatar2.png\" alt=\"avatar\" />\n                                                        </a>\n                                                        <div class=\"chat-about\">\n                                                            <h6 class=\"m-b-0\">Aiden Chavez</h6>\n                                                            <small>Last seen: 2 hours ago</small>\n                                                        </div>\n                                                    </div>\n                                                    <div class=\"col-lg-6 hidden-sm text-right\">\n\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            <div class=\"chat-history\">\n                                                <ul class=\"m-b-0\">\n                                                    <li class=\"clearfix\">\n                                                        <div class=\"message-data text-right\">\n                                                            <span class=\"message-data-time\">10:10 AM, Today</span>\n                                                            <img src=\"https://bootdey.com/img/Content/avatar/avatar7.png\" alt=\"avatar\" />\n                                                        </div>\n                                                        <div class=\"message other-message float-right\"> Hi Aiden, how are you? How is the project coming along? </div>\n                                                    </li>\n                                                    <li class=\"clearfix\">\n                                                        <div class=\"message-data\">\n                                                            <span class=\"message-data-time\">10:12 AM, Today</span>\n                                                        </div>\n                                                        <div class=\"message my-message\">Are we meeting today?</div>\n                                                    </li>\n                                                    <li class=\"clearfix\">\n                                                        <div class=\"message-data\">\n                                                            <span class=\"message-data-time\">10:15 AM, Today</span>\n                                                        </div>\n                                                        <div class=\"message my-message\">Project has been already finished and I have results to show you.</div>\n                                                    </li>\n                                                </ul>\n                                            </div>\n                                            <div class=\"chat-message clearfix\">\n                                                <div class=\"input-group mb-2\">\n                                                    <input type=\"text\" class=\"form-control\" placeholder=\"Type here…\" />\n                                                    <button class=\"btn\" type=\"button\">Send</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Slider from '@material-ui/core/Slider'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport Cropper from 'react-easy-crop'\nimport RangeSlider from 'react-bootstrap-range-slider';\nimport { dict } from '../../Dict';\nconst t = dict['fa']\n\nexport default class CropperShow extends React.Component {\n    constructor(props) {\n        super(props);\n        this.getInstance = this.getInstance.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.showCropper = this.showCropper.bind(this);\n\n        this.state = {\n            crop: { x: 0, y: 0 },\n            zoom: 1,\n            aspect: 16 / 5,\n            uploadable_type: null,\n            uploadable_id: null,\n            id: null,\n            imageSrc: null,\n            crop_settings: null,\n            uploadable_link: null,\n        }\n\n    }\n\n    componentWillMount() {\n        ModelStore.on(\"got_instance\", this.getInstance);\n        ModelStore.on(\"set_instance\", this.setInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_instance\", this.getInstance);\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n    }\n\n    componentDidMount() {\n        MyActions.getInstance('uploads', this.props.match.params.id, this.state.token);\n    }\n\n    getInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'UploadShow') {\n            this.setState({\n                id: model.id,\n                crop_settings: model.crop,\n                uploadable_type: model.uploadable_type,\n                uploadable_id: model.uploadable_id,\n                imageSrc: model.link,\n                uploadable_link: model.uploadable_link\n            }, () => {\n               \n            })\n        }\n        console.log(model.cropped)\n        \n    }\n\n    onCropChange = (crop) => {\n        this.setState({ crop })\n    }\n\n    onCropComplete = (croppedArea, croppedAreaPixels) => {\n        console.log(croppedArea, croppedAreaPixels)\n        this.setState({ crop_settings: croppedAreaPixels })\n        \n    }\n\n    onZoomChange = (zoom) => {\n        this.setState({ zoom })\n    }\n\n    submit() {\n        MyActions.updateInstance('uploads', {id: this.state.id, crop_settings: this.state.crop_settings}, this.state.token);\n    }\n\n    setInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'Upload') {\n            this.props.history.push('/'+ this.state.uploadable_link)\n        }\n    }\n\n    showCropper() {\n        if(this.state.imageSrc){\n            console.log(this.state.imageSrc)\n            return(\n                <Cropper\n                image={this.state.imageSrc}\n                crop={this.state.crop}\n                zoom={this.state.zoom}\n                aspect={this.state.aspect}\n                onCropChange={this.onCropChange}\n                onCropComplete={this.onCropComplete}\n                onZoomChange={this.onZoomChange}\n            />\n            )\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"App\">\n                <div className=\"crop-container\">\n                    {this.showCropper()}\n                </div>\n                <div className=\"controls\">\n                    <RangeSlider\n                        value={this.state.zoom}\n                        min={1}\n                        max={3}\n                        step={0.1}\n                        aria-labelledby=\"Zoom\"\n                        onChange={(e, zoom) => this.onZoomChange(zoom)}\n                        classes={{ container: 'slider' }}\n                    />\n\n\n                </div>\n                <div className=\"crop-save\">\n                    <a onClick={() => this.submit()} class=\"btn btn-primary\">\n                        {t['save']}\n                    </a>\n                </div>\n            </div>\n        )\n    }\n}\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport { conf } from '../../conf';\nimport queryString from 'query-string'\nimport axios, { put } from 'axios';\n\nconst server = conf.server;\n\nexport default class UploadCreate extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.getInstance = this.getInstance.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            id: null,\n            upload_type: null,\n            file: null,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n        ModelStore.on(\"got_instance\", this.getInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n        ModelStore.removeListener(\"got_instance\", this.getInstance);\n    }\n\n    componentDidMount() {\n        var self = this;\n        const value = queryString.parse(this.props.location.search);\n        var uploadable_type = '';\n        var uploadable_id = 0;\n        Object.keys(value).map((key) => {\n            var splited = key.split(\"_\")\n            if (splited[0]) {\n                uploadable_type = splited[0].charAt(0).toUpperCase() + splited[0].slice(1);\n                uploadable_id = value[key]\n            }\n        })\n        this.setState({ uploadable_type: uploadable_type, uploadable_id: uploadable_id })\n        if (this.props.match.params.id) {\n            MyActions.getInstance('uploads', this.props.match.params.id, this.state.token);\n        }\n    }\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    setInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'Upload') {\n            this.props.history.push('/' + model.advertisable_link)\n        }\n    }\n\n    getInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (model && klass === 'Upload') {\n            this.setState({\n                id: model.id,\n                title: model.title,\n                uploadable_type: model.uploadable_type,\n                uploadable_id: model.uploadable_id,\n                editing: true,\n            })\n        }\n\n    }\n\n    changeDefault(e) {\n        if (this.state.is_private) {\n            this.setState({ is_private: false })\n        } else {\n            this.setState({ is_private: true })\n        }\n    }\n\n    changeType(e) {\n        var self = this;\n        self.setState({ upload_type: e })\n    }\n\n    fileAttacher(file) {\n        this.setState({file: file})\n    }\n\n    submit() {\n        var self = this;\n        self.setState({ progressShow: true }, () => console.log(this.state.progressShow))\n        const config = {\n          onUploadProgress: function (progressEvent) {\n            var percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\n            console.log(percentCompleted)\n            self.setState({ progress: percentCompleted })\n    \n          },\n          headers: { 'Content-Type': 'application/json', 'Authorization': \"bearer \" + self.state.token }\n        }\n    \n        let data = new FormData()\n        data.append('upload[attached_document]', this.state.file)\n        data.append('upload[title]', this.state.title)\n        data.append('upload[uploadable_type]', this.state.uploadable_type)\n        data.append('upload[uploadable_id]', this.state.uploadable_id)\n        data.append('upload[is_private]', this.state.is_private)\n        data.append('upload[upload_type]', this.state.upload_type)\n\n        axios.post(conf.server + '/uploads', data, config)\n          .then(res => {\n            self.setState({ progressShow: false, uploadedRecently: true });\n            var upload = res.data.data\n            if(upload.upload_type === 'cover') {\n                this.props.history.push(\"/uploads/cropper/\" + upload.uuid)\n            }\n           // MyActions.getInstance('uploads/recent', 1, this.state.token);\n            //self.props.fileUploaded()\n          })\n          .catch(err => self.setState({ progressShow: false }))\n      }\n\n    render() {\n        const { is_private } = this.state;\n        const t = dict['fa'];\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history}/>\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\"></div>\n                                <div className=\"col\">\n                                    <div className=\"page-pretitle\">{t['create_upload']}</div>\n                                    <h2 className=\"page-title\">{t['provide_following_info']}</h2>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n                                    <div class=\"col-md-8\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">{t['create_upload']}</h3>\n                                            </div>\n                                            <div class=\"card-body\">\n                                                <form>\n                                                    <div class=\"mb-3\">\n                                                        <label class=\"form-label\">{t['upload_title']}</label>\n                                                        <input type=\"text\" class=\"form-control\" name=\"text-input\" placeholder={t['write_something']} onInput={(e) => { this.handleChange({ title: e.target.value }) }} value={this.state.title} />\n                                                    </div>\n\n                                                    <div class=\"mb-3\">\n                                                        <label class=\"form-label\">{t['meeting_type']}</label>\n                                                        <div class=\"form-selectgroup\">\n                                                            <label class=\"form-selectgroup-item\">\n                                                                <input type=\"checkbox\" name=\"name\" value=\"cover\" class=\"form-selectgroup-input\" checked={this.state.upload_type === 'cover' ? true : false} onClick={(e) => this.changeType(e.target.value)} />\n                                                                <span class=\"form-selectgroup-label\">{t['cover']}</span>\n                                                            </label>\n                                                            <label class=\"form-selectgroup-item\">\n                                                                <input type=\"checkbox\" name=\"name\" value=\"file\" class=\"form-selectgroup-input\" checked={this.state.upload_type === 'file' ? true : false} onClick={(e) => this.changeType(e.target.value)} />\n                                                                <span class=\"form-selectgroup-label\">{t['file']}</span>\n                                                            </label>\n                                                            <label class=\"form-selectgroup-item\">\n                                                                <input type=\"checkbox\" name=\"name\" value=\"video\" class=\"form-selectgroup-input\" checked={this.state.upload_type === 'video' ? true : false}onClick={(e) => this.changeType(e.target.value)} />\n                                                                <span class=\"form-selectgroup-label\">{t['video']}</span>\n                                                            </label>\n                                                        </div>\n                                                    </div>\n\n                                                    <div class=\"mb-3\">\n                                                        <div class=\"form-label\">{t['choose_file']}</div>\n                                                        <input type=\"file\" class=\"form-control\"  onInput={(e) => { this.fileAttacher(e.target.files[0]); }}/>\n                                                    </div>\n\n\n                                                    <div class=\"mb-3\">\n                                                        <div class=\"form-label\">{t['is_private']}</div>\n                                                        <label class=\"form-check form-switch\">\n                                                            <input class=\"form-check-input\" type=\"checkbox\" onClick={(e) => this.changeDefault(e.target.value)} checked={is_private ? true : false} />\n                                                            <span class=\"form-check-label\">{t['default_is_private_upload']}</span>\n                                                        </label>\n                                                    </div>\n\n\n\n\n\n                                                </form>\n                                            </div>\n                                            <div class=\"card-footer\">\n                                                <div class=\"d-flex\">\n                                                    <a href=\"/#/meetings\" class=\"btn btn-link\">{t['cancel']}</a>\n                                                    <button onClick={() => this.submit()} class=\"btn btn-primary ms-auto\">{t['submit']}</button>\n                                                </div>\n                                            </div>\n                                            <div class=\"progress progress-sm card-progress\">\n                                                <div class=\"progress-bar\" style={{ width: \"100%\" }} role=\"progressbar\" aria-valuenow=\"38\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                                                    <span class=\"visually-hidden\">38% Complete</span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"col-4\">\n                                        <div class=\"card\">\n                                            <div class=\"card-status-top bg-lime\"></div>\n                                            <div class=\"card-body\">\n                                                <h3 class=\"card-title\">Help</h3>\n                                                <p></p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport { conf } from '../../conf';\nimport queryString from 'query-string'\nimport Quill from 'quill';\nimport ImageUploader from \"quill-image-uploader\";\nimport axios, { put } from 'axios';\n\nconst server = conf.server;\n\nexport default class FlyerCreate extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.getInstance = this.getInstance.bind(this);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            id: null,\n            content: null,\n            advertisable_type: null,\n            advertisable_id: null,\n            quill: null,\n            quill_content: {},\n            editing: false,\n            is_default: false,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n        ModelStore.on(\"got_instance\", this.getInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n        ModelStore.removeListener(\"got_instance\", this.getInstance);\n    }\n\n    componentDidMount() {\n        var self = this;\n        const value = queryString.parse(this.props.location.search);\n        var advertisable_type = '';\n        var advertisable_id = 0;\n        Object.keys(value).map((key) => {\n            var splited = key.split(\"_\")\n            if (splited[0]) {\n                advertisable_type = splited[0].charAt(0).toUpperCase() + splited[0].slice(1);\n                advertisable_id = value[key]\n            }\n        })\n        this.setState({ advertisable_type: advertisable_type, advertisable_id: advertisable_id })\n        if (this.props.match.params.id) {\n            MyActions.getInstance('flyers', this.props.match.params.id, this.state.token);\n        }\n        var toolbarOptions = [\n            ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\n            [{ 'list': 'ordered' }, { 'list': 'bullet' }],      // superscript/subscript\n            [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent\n            [{ 'direction': 'ltr' }, { 'direction': 'rtl' }],                         // text direction\n            ['image'],\n            ['video'],\n            [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n            [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme\n            [{ 'align': [] }],          \n        ];\n        Quill.register(\"modules/imageUploader\", ImageUploader);\n        var quillOne = new Quill('#editor-one', {\n            theme: 'snow',\n            modules: {\n                toolbar: toolbarOptions,\n                imageUploader: {\n                    upload: (file) => {\n                        return new Promise((resolve, reject) => {\n                            const url = server + '/uploads';\n                            const formData = new FormData();\n                            formData.append('upload[attached_document]', file)\n                            //formData.append('profile[id]',id)\n                            const config = {\n                                headers: {\n                                    'content-type': 'multipart/form-data',\n                                    'Authorization': \"bearer \" + this.state.token\n                                }\n                            }\n                            axios.post(url, formData, config).then(function (response) {\n                                resolve(response.data.data.link)\n                            })\n                                .catch(function (error) {\n                                    console.log(error);\n                                });\n                        });\n                    },\n                },\n            },\n        });\n\n        quillOne.on('text-change', function (delta, oldDelta, source) {\n            if (source == 'api') {\n                // console.log(\"An API call triggered this change.\");\n            } else if (source == 'user') {\n                self.setState({ quill_content: quillOne.getContents(), content: quillOne.getText() })\n                // console.log(\"A user action triggered this change.\");\n            }\n        });\n\n\n\n        this.setState({ quill: quillOne })\n    }\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    setInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'Flyer') {\n            this.props.history.push('/'+model.advertisable_link)\n        }\n    }\n\n    getInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (model && klass === 'Flyer') {\n            this.setState({\n                id: model.id,\n                title: model.title,\n                content: model.content,\n                advertisable_type: model.advertisable_type,\n                advertisable_id: model.advertisable_id,\n                quill_content: model.quill_content,\n                is_default: model.is_default,\n                editing: true,\n            }, () => {\n                console.log(this.state)\n                this.state.quill.setContents(this.state.quill_content)\n            })\n        }\n        \n    }\n\n    submit() {\n        var data = {\n            id: this.state.id,\n            title: this.state.title,\n            content: this.state.content,\n            advertisable_type: this.state.advertisable_type,\n            advertisable_id: this.state.advertisable_id,\n            quill_content: this.state.quill_content,\n            is_default:  this.state.is_default,\n        }\n        if (!this.state.editing) {\n            MyActions.setInstance('flyers', data, this.state.token);\n        } else {\n            MyActions.updateInstance('flyers', data, this.state.token);\n        }\n\n    }\n\n    changeDefault(e) {\n        console.log(e)\n        var self = this;\n        if(this.state.is_default){\n            this.setState({is_default: false})\n        } else {\n            this.setState({is_default: true})\n        }\n      }\n\n\n    render() {\n        const { is_default} = this.state;\n        const t = dict['fa'];\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history}/>\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\"></div>\n                                <div className=\"col\">\n                                    <div className=\"page-pretitle\">{t['create_page']}</div>\n                                    <h2 className=\"page-title\">{t['provide_following_info']}</h2>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n                                    <div class=\"col-md-8\">\n                                        <div class=\"card\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">{t['create_page']}</h3>\n                                            </div>\n                                            <div class=\"card-body\">\n                                                <form>\n                                                    <div class=\"mb-3\">\n                                                        <label class=\"form-label\">{t['page_title']}</label>\n                                                        <input type=\"text\" class=\"form-control\" name=\"text-input\" placeholder={t['write_something']} onInput={(e) => { this.handleChange({ title: e.target.value }) }} value={this.state.title} />\n                                                    </div>\n                                                    <div class=\"mb-3\">\n                                                        <label class=\"form-label\">{t['page_content']}<span class=\"form-label-description\"></span></label>\n                                                        <div id=\"editor-one\"></div>\n                                                    </div>\n                                                    <div class=\"mb-3\">\n                                                        <div class=\"form-label\">{t['default_page']}</div>\n                                                        <label class=\"form-check form-switch\">\n                                                            <input class=\"form-check-input\" type=\"checkbox\" onClick={(e) => this.changeDefault(e.target.value)} checked={is_default? true : false}/>\n                                                            <span class=\"form-check-label\">{t['default_page_info']}</span>\n                                                        </label>\n                                                    </div>\n\n\n\n\n                                                </form>\n                                            </div>\n                                            <div class=\"card-footer\">\n                                                <div class=\"d-flex\">\n                                                    <a href=\"/#/meetings\" class=\"btn btn-link\">{t['cancel']}</a>\n                                                    <button onClick={() => this.submit()} class=\"btn btn-primary ms-auto\">{t['submit']}</button>\n                                                </div>\n                                            </div>\n                                            <div class=\"progress progress-sm card-progress\">\n                                                <div class=\"progress-bar\" style={{ width: \"100%\" }} role=\"progressbar\" aria-valuenow=\"38\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                                                    <span class=\"visually-hidden\">38% Complete</span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"col-4\">\n                                        <div class=\"card\">\n                                            <div class=\"card-status-top bg-lime\"></div>\n                                            <div class=\"card-body\">\n                                                <h3 class=\"card-title\">Help</h3>\n                                                <p></p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport queryString from 'query-string'\n\nconst t = dict['fa']\n\nexport default class LoginJwt extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: null,\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"set_instance\", this.setInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n    }\n\n    componentDidMount() {\n        MyActions.setInstance('users/validate_token', {}, this.props.match.params.id);\n    }\n\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    setInstance() {\n        var klass = ModelStore.getKlass()\n        var model = ModelStore.getIntance()\n        if (klass === 'Validate') {\n            window.localStorage.setItem('token', model.token);\n            this.props.history.push(\"/#/events\")\n        }\n    }\n\n    render() {\n        return (null)\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport $ from 'jquery';\nimport { dict } from '../../Dict';\nimport { conf } from '../../conf';\nimport Header from \"../header/header.jsx\";\nimport DatePicker from \"react-datepicker\";\nimport queryString from 'query-string'\nimport RangeSlider from 'react-bootstrap-range-slider';\nimport moment from 'moment-jalaali'\nimport DatePicker2 from 'react-datepicker2';\nimport { Typeahead, withAsync } from 'react-bootstrap-typeahead';\nconst AsyncTypeahead = withAsync(Typeahead);\nconst server = conf.server;\nconst t = dict['fa']\n\nexport default class QuestionCreate extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      content: null,\n      tags: [],\n      is_private: false,\n      questionable_type: null,\n      questionable_id: null,\n    }\n\n  }\n\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  componentDidMount() {\n    var self = this;\n    const value = queryString.parse(this.props.location.search);\n    var questionable_type = '';\n    var questionable_id = 0;\n    Object.keys(value).map((key) => {\n        var splited = key.split(\"_\")\n        if (splited[0]) {\n            questionable_type = splited[0].charAt(0).toUpperCase() + splited[0].slice(1);\n            questionable_id = value[key]\n        }\n    })\n    this.setState({ questionable_type: questionable_type, questionable_id: questionable_id })\n  }\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  setInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Question') {\n        this.props.history.push('/'+model.questionable_link)\n    }\n  }\n\n\n  submit() {\n    var data = this.state\n    if (!this.state.editing) {\n      MyActions.setInstance('questions', data, this.state.token);\n    } \n  }\n\n\n  tagSelected(tags) {\n    var result = []\n    tags.map((tag) => {\n      if (tag['title']) {\n        result.push(tag['title'])\n      } else {\n        result.push(tag)\n      }\n    })\n    this.setState({ tags: result }, () => console.log(this.state.tags))\n  }\n\n  tagShow() {\n    if (this.props.match.params.id && this.state.id) {\n      return (this.tagInput())\n    }\n\n    if (!this.props.match.params.id) {\n      return (this.tagInput())\n    }\n  }\n\n  tagInput() {\n    return (\n      <div style={{ direction: 'ltr', marginBottom: '70px' }}>\n        <AsyncTypeahead\n          id='event-tag'\n          allowNew\n          multiple\n          defaultSelected={this.state.tags}\n          isLoading={this.state.isLoading}\n          labelKey='title'\n          onSearch={(query) => {\n            this.setState({ isLoading: true });\n            fetch(server + \"/tags/search?q=\" + query)\n              .then((resp) => resp.json())\n              .then(({ items }) => {\n                this.setState({ options: items, isLoading: false }, () => console.log(this.state.options))\n              });\n          }}\n          onChange={(t) => this.tagSelected(t)}\n          options={this.state.options}\n          renderMenuItemChildren={(option, props) => (\n            <React.Fragment>\n              <span>{option.title}</span>\n            </React.Fragment>\n          )}\n        />\n      </div>\n    )\n  }\n\n  changeDefault(e) {\n    if(this.state.is_private){\n        this.setState({is_private: false})\n    } else {\n        this.setState({is_private: true})\n    }\n  }\n\n  isPrivateBadge(){\n    if(this.state.is_private){\n      return(\n        <span class=\"badge bg-red-lt\">{t['private']}</span>\n      )\n    }\n  }\n\n\n  render() {\n    const { is_private} = this.state; \n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history}/>\n          <div className=\"page-wrapper\">\n            <div className=\"container-xl\">\n              <div className=\"page-header d-print-none\">\n                <div className=\"row align-items-center\"></div>\n                <div className=\"col\">\n                  <div className=\"page-pretitle\">{t['create_question_page']}</div>\n                  <h2 className=\"page-title\">{t['provide_following_info']}</h2>\n                </div>\n              </div>\n            </div>\n            <div className=\"page-body\">\n              <div className=\"container-xl\">\n                <div className=\"row row-deck row-cards\">\n                  <div class=\"col-md-8\">\n                    <div class=\"card\">\n                      <div class=\"card-header\">\n                        <h3 class=\"card-title\">{t['create_question']}</h3>\n                      </div>\n                      <div class=\"card-body\">\n                        <form>\n                          <div class=\"mb-3\">\n                            <label class=\"form-label\">{t['question_content']}<span class=\"form-label-description\"></span></label>\n                            <textarea class=\"form-control\" name=\"example-textarea-input\" rows=\"6\" placeholder={t['write_something']} onInput={(e) => { this.handleChange({ content: e.target.value }) }} value={this.state.info}></textarea>\n                          </div>\n\n\n                          <div class=\"mb-3 \" id='tags' >\n                            <label class=\"form-label\" >{t['tags']}</label>\n                            {this.tagShow()}\n                          </div>\n\n\n\n                          <div class=\"mb-3\">\n                            <div class=\"form-label\">{t['is_private']}</div>\n                            <label class=\"form-check form-switch\">\n                              <input class=\"form-check-input\" type=\"checkbox\" onClick={(e) => this.changeDefault(e.target.value)} checked={is_private ? true : false} />\n                              <span class=\"form-check-label\">{t['default_is_private_question']}</span>\n                            </label>\n                          </div>\n\n\n\n\n                        </form>\n                      </div>\n                      <div class=\"card-footer\">\n                        <div class=\"d-flex\">\n                          <a href=\"/#/questions\" class=\"btn btn-link\">{t['cancel']}</a>\n                          <button onClick={() => this.submit()} class=\"btn btn-primary ms-auto\">{t['submit']}</button>\n                        </div>\n                      </div>\n                      <div class=\"progress progress-sm card-progress\">\n                        <div class=\"progress-bar\" style={{ width: \"100%\" }} role=\"progressbar\" aria-valuenow=\"38\" aria-valuemin=\"0\" aria-valuemax=\"100\">\n                          <span class=\"visually-hidden\">38% Complete</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"col-4\">\n                    <div class=\"card\">\n                      <div class=\"card-status-top bg-lime\"></div>\n                      <div class=\"card-body\">\n                        <h3 class=\"card-title\">Help</h3>\n                        <p></p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </body>\n    )\n  }\n}\n\n\n\n\n","/*\n\tThe MIT License (MIT)\n\n\tCopyright (c) 2016 Meetecho\n\n\tPermission is hereby granted, free of charge, to any person obtaining\n\ta copy of this software and associated documentation files (the \"Software\"),\n\tto deal in the Software without restriction, including without limitation\n\tthe rights to use, copy, modify, merge, publish, distribute, sublicense,\n\tand/or sell copies of the Software, and to permit persons to whom the\n\tSoftware is furnished to do so, subject to the following conditions:\n\n\tThe above copyright notice and this permission notice shall be included\n\tin all copies or substantial portions of the Software.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n\tOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n\tTHE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n\tOTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n\tARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n\tOTHER DEALINGS IN THE SOFTWARE.\n */\n\n// List of sessions\nimport jQuery from 'jquery';\nimport adapter from 'webrtc-adapter';\n\nconst RTCRtpTransceiver = window.RTCRtpTransceiver;\nJanus.sessions = {};\n\nJanus.isExtensionEnabled = function() {\n\tif(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\n\t\t// No need for the extension, getDisplayMedia is supported\n\t\treturn true;\n\t}\n\tif(window.navigator.userAgent.match('Chrome')) {\n\t\tvar chromever = parseInt(window.navigator.userAgent.match(/Chrome\\/(.*) /)[1], 10);\n\t\tvar maxver = 33;\n\t\tif(window.navigator.userAgent.match('Linux'))\n\t\t\tmaxver = 35;\t// \"known\" crash in chrome 34 and 35 on linux\n\t\tif(chromever >= 26 && chromever <= maxver) {\n\t\t\t// Older versions of Chrome don't support this extension-based approach, so lie\n\t\t\treturn true;\n\t\t}\n\t\treturn Janus.extension.isInstalled();\n\t} else {\n\t\t// Firefox and others, no need for the extension (but this doesn't mean it will work)\n\t\treturn true;\n\t}\n};\n\nvar defaultExtension = {\n\t// Screensharing Chrome Extension ID\n\textensionId: 'hapfgfdkleiggjjpfpenajgdnfckjpaj',\n\tisInstalled: function() { return document.querySelector('#janus-extension-installed') !== null; },\n\tgetScreen: function (callback) {\n\t\tvar pending = window.setTimeout(function () {\n\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\terror.name = 'The required Chrome extension is not installed: click <a href=\"#\">here</a> to install it. (NOTE: this will need you to refresh the page)';\n\t\t\treturn callback(error);\n\t\t}, 1000);\n\t\tthis.cache[pending] = callback;\n\t\twindow.postMessage({ type: 'janusGetScreen', id: pending }, '*');\n\t},\n\tinit: function () {\n\t\tvar cache = {};\n\t\tthis.cache = cache;\n\t\t// Wait for events from the Chrome Extension\n\t\twindow.addEventListener('message', function (event) {\n\t\t\tif(event.origin != window.location.origin)\n\t\t\t\treturn;\n\t\t\tif(event.data.type == 'janusGotScreen' && cache[event.data.id]) {\n\t\t\t\tvar callback = cache[event.data.id];\n\t\t\t\tdelete cache[event.data.id];\n\n\t\t\t\tif (event.data.sourceId === '') {\n\t\t\t\t\t// user canceled\n\t\t\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\t\t\terror.name = 'You cancelled the request for permission, giving up...';\n\t\t\t\t\tcallback(error);\n\t\t\t\t} else {\n\t\t\t\t\tcallback(null, event.data.sourceId);\n\t\t\t\t}\n\t\t\t} else if (event.data.type == 'janusGetScreenPending') {\n\t\t\t\tconsole.log('clearing ', event.data.id);\n\t\t\t\twindow.clearTimeout(event.data.id);\n\t\t\t}\n\t\t});\n\t}\n};\n\nJanus.UseDefaultDependencies = function (deps) {\n\tvar f = (deps && deps.fetch) || fetch;\n\tvar p = (deps && deps.Promise) || Promise;\n\tvar socketCls = (deps && deps.WebSocket) || WebSocket;\n\n\treturn {\n\t\tnewWebSocket: function(server, proto) { return new socketCls(server, proto); },\n\t\textension: (deps && deps.extension) || defaultExtension,\n\t\tisArray: function(arr) { return Array.isArray(arr); },\n\t\twebRTCAdapter: (deps && deps.adapter) || adapter,\n\t\thttpAPICall: function(url, options) {\n\t\t\tvar fetchOptions = {\n\t\t\t\tmethod: options.verb,\n\t\t\t\theaders: {\n\t\t\t\t\t'Accept': 'application/json, text/plain, */*'\n\t\t\t\t},\n\t\t\t\tcache: 'no-cache'\n\t\t\t};\n\t\t\tif(options.verb === \"POST\") {\n\t\t\t\tfetchOptions.headers['Content-Type'] = 'application/json';\n\t\t\t}\n\t\t\tif(options.withCredentials !== undefined) {\n\t\t\t\tfetchOptions.credentials = options.withCredentials === true ? 'include' : (options.withCredentials ? options.withCredentials : 'omit');\n\t\t\t}\n\t\t\tif(options.body) {\n\t\t\t\tfetchOptions.body = JSON.stringify(options.body);\n\t\t\t}\n\n\t\t\tvar fetching = f(url, fetchOptions).catch(function(error) {\n\t\t\t\treturn p.reject({message: 'Probably a network error, is the server down?', error: error});\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * fetch() does not natively support timeouts.\n\t\t\t * Work around this by starting a timeout manually, and racing it agains the fetch() to see which thing resolves first.\n\t\t\t */\n\n\t\t\tif(options.timeout) {\n\t\t\t\tvar timeout = new p(function(resolve, reject) {\n\t\t\t\t\tvar timerId = setTimeout(function() {\n\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\treturn reject({message: 'Request timed out', timeout: options.timeout});\n\t\t\t\t\t}, options.timeout);\n\t\t\t\t});\n\t\t\t\tfetching = p.race([fetching, timeout]);\n\t\t\t}\n\n\t\t\tfetching.then(function(response) {\n\t\t\t\tif(response.ok) {\n\t\t\t\t\tif(typeof(options.success) === typeof(Janus.noop)) {\n\t\t\t\t\t\treturn response.json().then(function(parsed) {\n\t\t\t\t\t\t\toptions.success(parsed);\n\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\treturn p.reject({message: 'Failed to parse response body', error: error, response: response});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn p.reject({message: 'API call failed', response: response});\n\t\t\t\t}\n\t\t\t}).catch(function(error) {\n\t\t\t\tif(typeof(options.error) === typeof(Janus.noop)) {\n\t\t\t\t\toptions.error(error.message || '<< internal error >>', error);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn fetching;\n\t\t}\n\t}\n};\n\nJanus.useOldDependencies = function (deps) {\n\tvar jq = (deps && deps.jQuery) || jQuery;\n\tvar socketCls = (deps && deps.WebSocket) || WebSocket;\n\treturn {\n\t\tnewWebSocket: function(server, proto) { return new socketCls(server, proto); },\n\t\tisArray: function(arr) { return jq.isArray(arr); },\n\t\textension: (deps && deps.extension) || defaultExtension,\n\t\twebRTCAdapter: (deps && deps.adapter) || adapter,\n\t\thttpAPICall: function(url, options) {\n\t\t\tvar payload = options.body !== undefined ? {\n\t\t\t\tcontentType: 'application/json',\n\t\t\t\tdata: JSON.stringify(options.body)\n\t\t\t} : {};\n\t\t\tvar credentials = options.withCredentials !== undefined ? {xhrFields: {withCredentials: options.withCredentials}} : {};\n\n\t\t\treturn jq.ajax(jq.extend(payload, credentials, {\n\t\t\t\turl: url,\n\t\t\t\ttype: options.verb,\n\t\t\t\tcache: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: options.async,\n\t\t\t\ttimeout: options.timeout,\n\t\t\t\tsuccess: function(result) {\n\t\t\t\t\tif(typeof(options.success) === typeof(Janus.noop)) {\n\t\t\t\t\t\toptions.success(result);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function(xhr, status, err) {\n\t\t\t\t\tif(typeof(options.error) === typeof(Janus.noop)) {\n\t\t\t\t\t\toptions.error(status, err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t};\n};\n\nJanus.noop = function() {};\n\nJanus.dataChanDefaultLabel = \"JanusDataChannel\";\n\n// Note: in the future we may want to change this, e.g., as was\n// attempted in https://github.com/meetecho/janus-gateway/issues/1670\nJanus.endOfCandidates = null;\n\n// Stop all tracks from a given stream\nJanus.stopAllTracks = function(stream) {\n\ttry {\n\t\t// Try a MediaStreamTrack.stop() for each track\n\t\tvar tracks = stream.getTracks();\n\t\tfor(var mst of tracks) {\n\t\t\tJanus.log(mst);\n\t\t\tif(mst) {\n\t\t\t\tmst.stop();\n\t\t\t}\n\t\t}\n\t} catch(e) {\n\t\t// Do nothing if this fails\n\t}\n}\n\n// Initialization\nJanus.init = function(options) {\n\toptions = options || {};\n\toptions.callback = (typeof options.callback == \"function\") ? options.callback : Janus.noop;\n\tif(Janus.initDone) {\n\t\t// Already initialized\n\t\toptions.callback();\n\t} else {\n\t\tif(typeof console == \"undefined\" || typeof console.log == \"undefined\") {\n\t\t\tconsole = { log: function() {} };\n\t\t}\n\t\t// Console logging (all debugging disabled by default)\n\t\tJanus.trace = Janus.noop;\n\t\tJanus.debug = Janus.noop;\n\t\tJanus.vdebug = Janus.noop;\n\t\tJanus.log = Janus.noop;\n\t\tJanus.warn = Janus.noop;\n\t\tJanus.error = Janus.noop;\n\t\tif(options.debug === true || options.debug === \"all\") {\n\t\t\t// Enable all debugging levels\n\t\t\tJanus.trace = console.trace.bind(console);\n\t\t\tJanus.debug = console.debug.bind(console);\n\t\t\tJanus.vdebug = console.debug.bind(console);\n\t\t\tJanus.log = console.log.bind(console);\n\t\t\tJanus.warn = console.warn.bind(console);\n\t\t\tJanus.error = console.error.bind(console);\n\t\t} else if(Array.isArray(options.debug)) {\n\t\t\tfor(var d of options.debug) {\n\t\t\t\tswitch(d) {\n\t\t\t\t\tcase \"trace\":\n\t\t\t\t\t\tJanus.trace = console.trace.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"debug\":\n\t\t\t\t\t\tJanus.debug = console.debug.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"vdebug\":\n\t\t\t\t\t\tJanus.vdebug = console.debug.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\tJanus.log = console.log.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"warn\":\n\t\t\t\t\t\tJanus.warn = console.warn.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"error\":\n\t\t\t\t\t\tJanus.error = console.error.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error(\"Unknown debugging option '\" + d + \"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tJanus.log(\"Initializing library\");\n\n\t\tvar usedDependencies = options.dependencies || Janus.UseDefaultDependencies();\n\t\tJanus.isArray = usedDependencies.isArray;\n\t\tJanus.webRTCAdapter = usedDependencies.webRTCAdapter;\n\t\tJanus.httpAPICall = usedDependencies.httpAPICall;\n\t\tJanus.newWebSocket = usedDependencies.newWebSocket;\n\t\tJanus.extension = usedDependencies.extension;\n\t\tJanus.extension.init();\n\n\t\t// Helper method to enumerate devices\n\t\tJanus.listDevices = function(callback, config) {\n\t\t\tcallback = (typeof callback == \"function\") ? callback : Janus.noop;\n\t\t\tif (config == null) config = { audio: true, video: true };\n\t\t\tif(Janus.isGetUserMediaAvailable()) {\n\t\t\t\tnavigator.mediaDevices.getUserMedia(config)\n\t\t\t\t.then(function(stream) {\n\t\t\t\t\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n\t\t\t\t\t\tJanus.debug(devices);\n\t\t\t\t\t\tcallback(devices);\n\t\t\t\t\t\t// Get rid of the now useless stream\n\t\t\t\t\t\tJanus.stopAllTracks(stream)\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(function(err) {\n\t\t\t\t\tJanus.error(err);\n\t\t\t\t\tcallback([]);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tJanus.warn(\"navigator.mediaDevices unavailable\");\n\t\t\t\tcallback([]);\n\t\t\t}\n\t\t};\n\t\t// Helper methods to attach/reattach a stream to a video element (previously part of adapter.js)\n\t\tJanus.attachMediaStream = function(element, stream) {\n\t\t\ttry {\n\t\t\t\telement.srcObject = stream;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\telement.src = URL.createObjectURL(stream);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tJanus.error(\"Error attaching stream to element\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tJanus.reattachMediaStream = function(to, from) {\n\t\t\ttry {\n\t\t\t\tto.srcObject = from.srcObject;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\tto.src = from.src;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tJanus.error(\"Error reattaching stream to element\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t// Detect tab close: make sure we don't loose existing onbeforeunload handlers\n\t\t// (note: for iOS we need to subscribe to a different event, 'pagehide', see\n\t\t// https://gist.github.com/thehunmonkgroup/6bee8941a49b86be31a787fe8f4b8cfe)\n\t\tvar iOS = ['iPad', 'iPhone', 'iPod'].indexOf(navigator.platform) >= 0;\n\t\tvar eventName = iOS ? 'pagehide' : 'beforeunload';\n\t\tvar oldOBF = window[\"on\" + eventName];\n\t\twindow.addEventListener(eventName, function(event) {\n\t\t\tJanus.log(\"Closing window\");\n\t\t\tfor(var s in Janus.sessions) {\n\t\t\t\tif(Janus.sessions[s] && Janus.sessions[s].destroyOnUnload) {\n\t\t\t\t\tJanus.log(\"Destroying session \" + s);\n\t\t\t\t\tJanus.sessions[s].destroy({unload: true, notifyDestroyed: false});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(oldOBF && typeof oldOBF == \"function\") {\n\t\t\t\toldOBF();\n\t\t\t}\n\t\t});\n\t\t// If this is a Safari Technology Preview, check if VP8 is supported\n\t\tJanus.safariVp8 = false;\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'safari' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 605) {\n\t\t\t// Let's see if RTCRtpSender.getCapabilities() is there\n\t\t\tif(RTCRtpSender && RTCRtpSender.getCapabilities && RTCRtpSender.getCapabilities(\"video\") &&\n\t\t\t\t\tRTCRtpSender.getCapabilities(\"video\").codecs && RTCRtpSender.getCapabilities(\"video\").codecs.length) {\n\t\t\t\tfor(var codec of RTCRtpSender.getCapabilities(\"video\").codecs) {\n\t\t\t\t\tif(codec && codec.mimeType && codec.mimeType.toLowerCase() === \"video/vp8\") {\n\t\t\t\t\t\tJanus.safariVp8 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(Janus.safariVp8) {\n\t\t\t\t\tJanus.log(\"This version of Safari supports VP8\");\n\t\t\t\t} else {\n\t\t\t\t\tJanus.warn(\"This version of Safari does NOT support VP8: if you're using a Technology Preview, \" +\n\t\t\t\t\t\t\"try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We do it in a very ugly way, as there's no alternative...\n\t\t\t\t// We create a PeerConnection to see if VP8 is in an offer\n\t\t\t\tvar testpc = new RTCPeerConnection({});\n\t\t\t\ttestpc.createOffer({offerToReceiveVideo: true}).then(function(offer) {\n\t\t\t\t\tJanus.safariVp8 = offer.sdp.indexOf(\"VP8\") !== -1;\n\t\t\t\t\tif(Janus.safariVp8) {\n\t\t\t\t\t\tJanus.log(\"This version of Safari supports VP8\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.warn(\"This version of Safari does NOT support VP8: if you're using a Technology Preview, \" +\n\t\t\t\t\t\t\t\"try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu\");\n\t\t\t\t\t}\n\t\t\t\t\ttestpc.close();\n\t\t\t\t\ttestpc = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t// Check if this browser supports Unified Plan and transceivers\n\t\t// Based on https://codepen.io/anon/pen/ZqLwWV?editors=0010\n\t\tJanus.unifiedPlan = false;\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'firefox' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 59) {\n\t\t\t// Firefox definitely does, starting from version 59\n\t\t\tJanus.unifiedPlan = true;\n\t\t} else if(Janus.webRTCAdapter.browserDetails.browser === 'chrome' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 72) {\n\t\t\t// Chrome does, but it's only usable from version 72 on\n\t\t\tJanus.unifiedPlan = true;\n\t\t} else if(!window.RTCRtpTransceiver || !('currentDirection' in RTCRtpTransceiver.prototype)) {\n\t\t\t// Safari supports addTransceiver() but not Unified Plan when\n\t\t\t// currentDirection is not defined (see codepen above).\n\t\t\tJanus.unifiedPlan = false;\n\t\t} else {\n\t\t\t// Check if addTransceiver() throws an exception\n\t\t\tvar tempPc = new RTCPeerConnection();\n\t\t\ttry {\n\t\t\t\ttempPc.addTransceiver('audio');\n\t\t\t\tJanus.unifiedPlan = true;\n\t\t\t} catch (e) {}\n\t\t\ttempPc.close();\n\t\t}\n\t\tJanus.initDone = true;\n\t\toptions.callback();\n\t}\n};\n\n// Helper method to check whether WebRTC is supported by this browser\nJanus.isWebrtcSupported = function() {\n\treturn !!window.RTCPeerConnection;\n};\n// Helper method to check whether devices can be accessed by this browser (e.g., not possible via plain HTTP)\nJanus.isGetUserMediaAvailable = function() {\n\treturn navigator.mediaDevices && navigator.mediaDevices.getUserMedia;\n};\n\n// Helper method to create random identifiers (e.g., transaction)\nJanus.randomString = function(len) {\n\tvar charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\tvar randomString = '';\n\tfor (var i = 0; i < len; i++) {\n\t\tvar randomPoz = Math.floor(Math.random() * charSet.length);\n\t\trandomString += charSet.substring(randomPoz,randomPoz+1);\n\t}\n\treturn randomString;\n};\n\nfunction Janus(gatewayCallbacks) {\n\tgatewayCallbacks = gatewayCallbacks || {};\n\tgatewayCallbacks.success = (typeof gatewayCallbacks.success == \"function\") ? gatewayCallbacks.success : Janus.noop;\n\tgatewayCallbacks.error = (typeof gatewayCallbacks.error == \"function\") ? gatewayCallbacks.error : Janus.noop;\n\tgatewayCallbacks.destroyed = (typeof gatewayCallbacks.destroyed == \"function\") ? gatewayCallbacks.destroyed : Janus.noop;\n\tif(!Janus.initDone) {\n\t\tgatewayCallbacks.error(\"Library not initialized\");\n\t\treturn {};\n\t}\n\tif(!Janus.isWebrtcSupported()) {\n\t\tgatewayCallbacks.error(\"WebRTC not supported by this browser\");\n\t\treturn {};\n\t}\n\tJanus.log(\"Library initialized: \" + Janus.initDone);\n\tif(!gatewayCallbacks.server) {\n\t\tgatewayCallbacks.error(\"Invalid server url\");\n\t\treturn {};\n\t}\n\tvar websockets = false;\n\tvar ws = null;\n\tvar wsHandlers = {};\n\tvar wsKeepaliveTimeoutId = null;\n\tvar servers = null;\n\tvar serversIndex = 0;\n\tvar server = gatewayCallbacks.server;\n\tif(Janus.isArray(server)) {\n\t\tJanus.log(\"Multiple servers provided (\" + server.length + \"), will use the first that works\");\n\t\tserver = null;\n\t\tservers = gatewayCallbacks.server;\n\t\tJanus.debug(servers);\n\t} else {\n\t\tif(server.indexOf(\"ws\") === 0) {\n\t\t\twebsockets = true;\n\t\t\tJanus.log(\"Using WebSockets to contact Janus: \" + server);\n\t\t} else {\n\t\t\twebsockets = false;\n\t\t\tJanus.log(\"Using REST API to contact Janus: \" + server);\n\t\t}\n\t}\n\tvar iceServers = gatewayCallbacks.iceServers || [{urls: \"stun:stun.l.google.com:19302\"}];\n\tvar iceTransportPolicy = gatewayCallbacks.iceTransportPolicy;\n\tvar bundlePolicy = gatewayCallbacks.bundlePolicy;\n\t// Whether IPv6 candidates should be gathered\n\tvar ipv6Support = (gatewayCallbacks.ipv6 === true);\n\t// Whether we should enable the withCredentials flag for XHR requests\n\tvar withCredentials = false;\n\tif(gatewayCallbacks.withCredentials !== undefined && gatewayCallbacks.withCredentials !== null)\n\t\twithCredentials = gatewayCallbacks.withCredentials === true;\n\t// Optional max events\n\tvar maxev = 10;\n\tif(gatewayCallbacks.max_poll_events !== undefined && gatewayCallbacks.max_poll_events !== null)\n\t\tmaxev = gatewayCallbacks.max_poll_events;\n\tif(maxev < 1)\n\t\tmaxev = 1;\n\t// Token to use (only if the token based authentication mechanism is enabled)\n\tvar token = null;\n\tif(gatewayCallbacks.token !== undefined && gatewayCallbacks.token !== null)\n\t\ttoken = gatewayCallbacks.token;\n\t// API secret to use (only if the shared API secret is enabled)\n\tvar apisecret = null;\n\tif(gatewayCallbacks.apisecret !== undefined && gatewayCallbacks.apisecret !== null)\n\t\tapisecret = gatewayCallbacks.apisecret;\n\t// Whether we should destroy this session when onbeforeunload is called\n\tthis.destroyOnUnload = true;\n\tif(gatewayCallbacks.destroyOnUnload !== undefined && gatewayCallbacks.destroyOnUnload !== null)\n\t\tthis.destroyOnUnload = (gatewayCallbacks.destroyOnUnload === true);\n\t// Some timeout-related values\n\tvar keepAlivePeriod = 25000;\n\tif(gatewayCallbacks.keepAlivePeriod !== undefined && gatewayCallbacks.keepAlivePeriod !== null)\n\t\tkeepAlivePeriod = gatewayCallbacks.keepAlivePeriod;\n\tif(isNaN(keepAlivePeriod))\n\t\tkeepAlivePeriod = 25000;\n\tvar longPollTimeout = 60000;\n\tif(gatewayCallbacks.longPollTimeout !== undefined && gatewayCallbacks.longPollTimeout !== null)\n\t\tlongPollTimeout = gatewayCallbacks.longPollTimeout;\n\tif(isNaN(longPollTimeout))\n\t\tlongPollTimeout = 60000;\n\n\t// overrides for default maxBitrate values for simulcasting\n\tfunction getMaxBitrates(simulcastMaxBitrates) {\n\t\tvar maxBitrates = {\n\t\t\thigh: 900000,\n\t\t\tmedium: 300000,\n\t\t\tlow: 100000,\n\t\t};\n\n\t\tif (simulcastMaxBitrates !== undefined && simulcastMaxBitrates !== null) {\n\t\t\tif (simulcastMaxBitrates.high)\n\t\t\t\tmaxBitrates.high = simulcastMaxBitrates.high;\n\t\t\tif (simulcastMaxBitrates.medium)\n\t\t\t\tmaxBitrates.medium = simulcastMaxBitrates.medium;\n\t\t\tif (simulcastMaxBitrates.low)\n\t\t\t\tmaxBitrates.low = simulcastMaxBitrates.low;\n\t\t}\n\n\t\treturn maxBitrates;\n\t}\n\n\tvar connected = false;\n\tvar sessionId = null;\n\tvar pluginHandles = {};\n\tvar that = this;\n\tvar retries = 0;\n\tvar transactions = {};\n\tcreateSession(gatewayCallbacks);\n\n\t// Public methods\n\tthis.getServer = function() { return server; };\n\tthis.isConnected = function() { return connected; };\n\tthis.reconnect = function(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks[\"reconnect\"] = true;\n\t\tcreateSession(callbacks);\n\t};\n\tthis.getSessionId = function() { return sessionId; };\n\tthis.getInfo = function(callbacks) { getInfo(callbacks); };\n\tthis.destroy = function(callbacks) { destroySession(callbacks); };\n\tthis.attach = function(callbacks) { createHandle(callbacks); };\n\n\tfunction eventHandler() {\n\t\tif(sessionId == null)\n\t\t\treturn;\n\t\tJanus.debug('Long poll...');\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar longpoll = server + \"/\" + sessionId + \"?rid=\" + new Date().getTime();\n\t\tif(maxev)\n\t\t\tlongpoll = longpoll + \"&maxev=\" + maxev;\n\t\tif(token)\n\t\t\tlongpoll = longpoll + \"&token=\" + encodeURIComponent(token);\n\t\tif(apisecret)\n\t\t\tlongpoll = longpoll + \"&apisecret=\" + encodeURIComponent(apisecret);\n\t\tJanus.httpAPICall(longpoll, {\n\t\t\tverb: 'GET',\n\t\t\twithCredentials: withCredentials,\n\t\t\tsuccess: handleEvent,\n\t\t\ttimeout: longPollTimeout,\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\n\t\t\t\tretries++;\n\t\t\t\tif(retries > 3) {\n\t\t\t\t\t// Did we just lose the server? :-(\n\t\t\t\t\tconnected = false;\n\t\t\t\t\tgatewayCallbacks.error(\"Lost connection to the server (is it down?)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\teventHandler();\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private event handler: this will trigger plugin callbacks, if set\n\tfunction handleEvent(json, skipTimeout) {\n\t\tretries = 0;\n\t\tif(!websockets && sessionId !== undefined && sessionId !== null && skipTimeout !== true)\n\t\t\teventHandler();\n\t\tif(!websockets && Janus.isArray(json)) {\n\t\t\t// We got an array: it means we passed a maxev > 1, iterate on all objects\n\t\t\tfor(var i=0; i<json.length; i++) {\n\t\t\t\thandleEvent(json[i], true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(json[\"janus\"] === \"keepalive\") {\n\t\t\t// Nothing happened\n\t\t\tJanus.vdebug(\"Got a keepalive on session \" + sessionId);\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"server_info\") {\n\t\t\t// Just info on the Janus instance\n\t\t\tJanus.debug(\"Got info on the Janus instance\");\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"ack\") {\n\t\t\t// Just an ack, we can probably ignore\n\t\t\tJanus.debug(\"Got an ack on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"success\") {\n\t\t\t// Success!\n\t\t\tJanus.debug(\"Got a success on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"trickle\") {\n\t\t\t// We got a trickle candidate from Janus\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar candidate = json[\"candidate\"];\n\t\t\tJanus.debug(\"Got a trickled candidate on session \" + sessionId);\n\t\t\tJanus.debug(candidate);\n\t\t\tvar config = pluginHandle.webrtcStuff;\n\t\t\tif(config.pc && config.remoteSdp) {\n\t\t\t\t// Add candidate right now\n\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t// end-of-candidates\n\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t} else {\n\t\t\t\t\t// New candidate\n\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We didn't do setRemoteDescription (trickle got here before the offer?)\n\t\t\t\tJanus.debug(\"We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate\");\n\t\t\t\tif(!config.candidates)\n\t\t\t\t\tconfig.candidates = [];\n\t\t\t\tconfig.candidates.push(candidate);\n\t\t\t\tJanus.debug(config.candidates);\n\t\t\t}\n\t\t} else if(json[\"janus\"] === \"webrtcup\") {\n\t\t\t// The PeerConnection with the server is up! Notify this\n\t\t\tJanus.debug(\"Got a webrtcup event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.webrtcState(true);\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"hangup\") {\n\t\t\t// A plugin asked the core to hangup a PeerConnection on one of our handles\n\t\t\tJanus.debug(\"Got a hangup event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.webrtcState(false, json[\"reason\"]);\n\t\t\tpluginHandle.hangup();\n\t\t} else if(json[\"janus\"] === \"detached\") {\n\t\t\t// A plugin asked the core to detach one of our handles\n\t\t\tJanus.debug(\"Got a detached event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\t// Don't warn here because destroyHandle causes this situation.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.detached = true;\n\t\t\tpluginHandle.ondetached();\n\t\t\tpluginHandle.detach();\n\t\t} else if(json[\"janus\"] === \"media\") {\n\t\t\t// Media started/stopped flowing\n\t\t\tJanus.debug(\"Got a media event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.mediaState(json[\"type\"], json[\"receiving\"]);\n\t\t} else if(json[\"janus\"] === \"slowlink\") {\n\t\t\tJanus.debug(\"Got a slowlink event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\t// Trouble uplink or downlink\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.slowLink(json[\"uplink\"], json[\"lost\"]);\n\t\t} else if(json[\"janus\"] === \"error\") {\n\t\t\t// Oops, something wrong happened\n\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess) {\n\t\t\t\t\treportSuccess(json);\n\t\t\t\t}\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"event\") {\n\t\t\tJanus.debug(\"Got a plugin event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\tif(!plugindata) {\n\t\t\t\tJanus.warn(\"Missing plugindata...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tJanus.debug(\"  -- Event is coming from \" + sender + \" (\" + plugindata[\"plugin\"] + \")\");\n\t\t\tvar data = plugindata[\"data\"];\n\t\t\tJanus.debug(data);\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.warn(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar jsep = json[\"jsep\"];\n\t\t\tif(jsep) {\n\t\t\t\tJanus.debug(\"Handling SDP as well...\");\n\t\t\t\tJanus.debug(jsep);\n\t\t\t}\n\t\t\tvar callback = pluginHandle.onmessage;\n\t\t\tif(callback) {\n\t\t\t\tJanus.debug(\"Notifying application...\");\n\t\t\t\t// Send to callback specified when attaching plugin handle\n\t\t\t\tcallback(data, jsep);\n\t\t\t} else {\n\t\t\t\t// Send to generic callback (?)\n\t\t\t\tJanus.debug(\"No provided notification callback\");\n\t\t\t}\n\t\t} else if(json[\"janus\"] === \"timeout\") {\n\t\t\tJanus.error(\"Timeout on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tif (websockets) {\n\t\t\t\tws.close(3504, \"Gateway timeout\");\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tJanus.warn(\"Unknown message/event  '\" + json[\"janus\"] + \"' on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t}\n\t}\n\n\t// Private helper to send keep-alive messages on WebSockets\n\tfunction keepAlive() {\n\t\tif(!server || !websockets || !connected)\n\t\t\treturn;\n\t\twsKeepaliveTimeoutId = setTimeout(keepAlive, keepAlivePeriod);\n\t\tvar request = { \"janus\": \"keepalive\", \"session_id\": sessionId, \"transaction\": Janus.randomString(12) };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tws.send(JSON.stringify(request));\n\t}\n\n\t// Private method to create a session\n\tfunction createSession(callbacks) {\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"create\", \"transaction\": transaction };\n\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t// We're reconnecting, claim the session\n\t\t\tconnected = false;\n\t\t\trequest[\"janus\"] = \"claim\";\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\t// If we were using websockets, ignore the old connection\n\t\t\tif(ws) {\n\t\t\t\tws.onopen = null;\n\t\t\t\tws.onerror = null;\n\t\t\t\tws.onclose = null;\n\t\t\t\tif(wsKeepaliveTimeoutId) {\n\t\t\t\t\tclearTimeout(wsKeepaliveTimeoutId);\n\t\t\t\t\twsKeepaliveTimeoutId = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(!server && Janus.isArray(servers)) {\n\t\t\t// We still need to find a working server from the list we were given\n\t\t\tserver = servers[serversIndex];\n\t\t\tif(server.indexOf(\"ws\") === 0) {\n\t\t\t\twebsockets = true;\n\t\t\t\tJanus.log(\"Server #\" + (serversIndex+1) + \": trying WebSockets to contact Janus (\" + server + \")\");\n\t\t\t} else {\n\t\t\t\twebsockets = false;\n\t\t\t\tJanus.log(\"Server #\" + (serversIndex+1) + \": trying REST API to contact Janus (\" + server + \")\");\n\t\t\t}\n\t\t}\n\t\tif(websockets) {\n\t\t\tws = Janus.newWebSocket(server, 'janus-protocol');\n\t\t\twsHandlers = {\n\t\t\t\t'error': function() {\n\t\t\t\t\tJanus.error(\"Error connecting to the Janus WebSockets server... \" + server);\n\t\t\t\t\tif (Janus.isArray(servers) && !callbacks[\"reconnect\"]) {\n\t\t\t\t\t\tserversIndex++;\n\t\t\t\t\t\tif (serversIndex === servers.length) {\n\t\t\t\t\t\t\t// We tried all the servers the user gave us and they all failed\n\t\t\t\t\t\t\tcallbacks.error(\"Error connecting to any of the provided Janus servers: Is the server down?\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Let's try the next server\n\t\t\t\t\t\tserver = null;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tcreateSession(callbacks);\n\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcallbacks.error(\"Error connecting to the Janus WebSockets server: Is the server down?\");\n\t\t\t\t},\n\n\t\t\t\t'open': function() {\n\t\t\t\t\t// We need to be notified about the success\n\t\t\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\t\t\tJanus.debug(json);\n\t\t\t\t\t\tif (json[\"janus\"] !== \"success\") {\n\t\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\t\tcallbacks.error(json[\"error\"].reason);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twsKeepaliveTimeoutId = setTimeout(keepAlive, keepAlivePeriod);\n\t\t\t\t\t\tconnected = true;\n\t\t\t\t\t\tsessionId = json[\"session_id\"] ? json[\"session_id\"] : json.data[\"id\"];\n\t\t\t\t\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t\t\t\t\tJanus.log(\"Claimed session: \" + sessionId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tJanus.log(\"Created session: \" + sessionId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.sessions[sessionId] = that;\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t};\n\t\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t\t},\n\n\t\t\t\t'message': function(event) {\n\t\t\t\t\thandleEvent(JSON.parse(event.data));\n\t\t\t\t},\n\n\t\t\t\t'close': function() {\n\t\t\t\t\tif (!server || !connected) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconnected = false;\n\t\t\t\t\t// FIXME What if this is called when the page is closed?\n\t\t\t\t\tgatewayCallbacks.error(\"Lost connection to the server (is it down?)\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfor(var eventName in wsHandlers) {\n\t\t\t\tws.addEventListener(eventName, wsHandlers[eventName]);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconnected = true;\n\t\t\t\tsessionId = json[\"session_id\"] ? json[\"session_id\"] : json.data[\"id\"];\n\t\t\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t\t\tJanus.log(\"Claimed session: \" + sessionId);\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log(\"Created session: \" + sessionId);\n\t\t\t\t}\n\t\t\t\tJanus.sessions[sessionId] = that;\n\t\t\t\teventHandler();\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(Janus.isArray(servers) && !callbacks[\"reconnect\"]) {\n\t\t\t\t\tserversIndex++;\n\t\t\t\t\tif(serversIndex === servers.length) {\n\t\t\t\t\t\t// We tried all the servers the user gave us and they all failed\n\t\t\t\t\t\tcallbacks.error(\"Error connecting to any of the provided Janus servers: Is the server down?\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Let's try the next server\n\t\t\t\t\tserver = null;\n\t\t\t\t\tsetTimeout(function() { createSession(callbacks); }, 200);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to get info on the server\n\tfunction getInfo(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\t// FIXME This method triggers a success even when we fail\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tJanus.log(\"Getting info on Janus instance\");\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\t// We just need to send an \"info\" request\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"info\", \"transaction\": transaction };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.log(\"Server info:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"server_info\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success(json);\n\t\t\t}\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Server info:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"server_info\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success(json);\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to destroy a session\n\tfunction destroySession(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\t// FIXME This method triggers a success even when we fail\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar unload = (callbacks.unload === true);\n\t\tvar notifyDestroyed = true;\n\t\tif(callbacks.notifyDestroyed !== undefined && callbacks.notifyDestroyed !== null)\n\t\t\tnotifyDestroyed = (callbacks.notifyDestroyed === true);\n\t\tvar cleanupHandles = (callbacks.cleanupHandles === true);\n\t\tJanus.log(\"Destroying session \" + sessionId + \" (unload=\" + unload + \")\");\n\t\tif(!sessionId) {\n\t\t\tJanus.warn(\"No session to destroy\");\n\t\t\tcallbacks.success();\n\t\t\tif(notifyDestroyed)\n\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\treturn;\n\t\t}\n\t\tif(cleanupHandles) {\n\t\t\tfor(var handleId in pluginHandles)\n\t\t\t\tdestroyHandle(handleId, { noRequest: true });\n\t\t}\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tsessionId = null;\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\t// No need to destroy all handles first, Janus will do that itself\n\t\tvar request = { \"janus\": \"destroy\", \"transaction\": Janus.randomString(12) };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(unload) {\n\t\t\t// We're unloading the page: use sendBeacon for HTTP instead,\n\t\t\t// or just close the WebSocket connection if we're using that\n\t\t\tif(websockets) {\n\t\t\t\tws.onclose = null;\n\t\t\t\tws.close();\n\t\t\t\tws = null;\n\t\t\t} else {\n\t\t\t\tnavigator.sendBeacon(server + \"/\" + sessionId, JSON.stringify(request));\n\t\t\t}\n\t\t\tJanus.log(\"Destroyed session:\");\n\t\t\tsessionId = null;\n\t\t\tconnected = false;\n\t\t\tcallbacks.success();\n\t\t\tif(notifyDestroyed)\n\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\treturn;\n\t\t}\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\n\t\t\tvar unbindWebSocket = function() {\n\t\t\t\tfor(var eventName in wsHandlers) {\n\t\t\t\t\tws.removeEventListener(eventName, wsHandlers[eventName]);\n\t\t\t\t}\n\t\t\t\tws.removeEventListener('message', onUnbindMessage);\n\t\t\t\tws.removeEventListener('error', onUnbindError);\n\t\t\t\tif(wsKeepaliveTimeoutId) {\n\t\t\t\t\tclearTimeout(wsKeepaliveTimeoutId);\n\t\t\t\t}\n\t\t\t\tws.close();\n\t\t\t};\n\n\t\t\tvar onUnbindMessage = function(event){\n\t\t\t\tvar data = JSON.parse(event.data);\n\t\t\t\tif(data.session_id == request.session_id && data.transaction == request.transaction) {\n\t\t\t\t\tunbindWebSocket();\n\t\t\t\t\tcallbacks.success();\n\t\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar onUnbindError = function(event) {\n\t\t\t\tunbindWebSocket();\n\t\t\t\tcallbacks.error(\"Failed to destroy the server: Is the server down?\");\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t};\n\n\t\t\tws.addEventListener('message', onUnbindMessage);\n\t\t\tws.addEventListener('error', onUnbindError);\n\n\t\t\tif (ws.readyState === 1) {\n\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t} else {\n\t\t\t\tonUnbindError();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Destroyed session:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tsessionId = null;\n\t\t\t\tconnected = false;\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success();\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\t// Reset everything anyway\n\t\t\t\tsessionId = null;\n\t\t\t\tconnected = false;\n\t\t\t\tcallbacks.success();\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to create a plugin handle\n\tfunction createHandle(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.consentDialog = (typeof callbacks.consentDialog == \"function\") ? callbacks.consentDialog : Janus.noop;\n\t\tcallbacks.iceState = (typeof callbacks.iceState == \"function\") ? callbacks.iceState : Janus.noop;\n\t\tcallbacks.mediaState = (typeof callbacks.mediaState == \"function\") ? callbacks.mediaState : Janus.noop;\n\t\tcallbacks.webrtcState = (typeof callbacks.webrtcState == \"function\") ? callbacks.webrtcState : Janus.noop;\n\t\tcallbacks.slowLink = (typeof callbacks.slowLink == \"function\") ? callbacks.slowLink : Janus.noop;\n\t\tcallbacks.onmessage = (typeof callbacks.onmessage == \"function\") ? callbacks.onmessage : Janus.noop;\n\t\tcallbacks.onlocalstream = (typeof callbacks.onlocalstream == \"function\") ? callbacks.onlocalstream : Janus.noop;\n\t\tcallbacks.onremotestream = (typeof callbacks.onremotestream == \"function\") ? callbacks.onremotestream : Janus.noop;\n\t\tcallbacks.ondata = (typeof callbacks.ondata == \"function\") ? callbacks.ondata : Janus.noop;\n\t\tcallbacks.ondataopen = (typeof callbacks.ondataopen == \"function\") ? callbacks.ondataopen : Janus.noop;\n\t\tcallbacks.oncleanup = (typeof callbacks.oncleanup == \"function\") ? callbacks.oncleanup : Janus.noop;\n\t\tcallbacks.ondetached = (typeof callbacks.ondetached == \"function\") ? callbacks.ondetached : Janus.noop;\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar plugin = callbacks.plugin;\n\t\tif(!plugin) {\n\t\t\tJanus.error(\"Invalid plugin\");\n\t\t\tcallbacks.error(\"Invalid plugin\");\n\t\t\treturn;\n\t\t}\n\t\tvar opaqueId = callbacks.opaqueId;\n\t\tvar handleToken = callbacks.token ? callbacks.token : token;\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"attach\", \"plugin\": plugin, \"opaque_id\": opaqueId, \"transaction\": transaction };\n\t\tif(handleToken)\n\t\t\trequest[\"token\"] = handleToken;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar handleId = json.data[\"id\"];\n\t\t\t\tJanus.log(\"Created handle: \" + handleId);\n\t\t\t\tvar pluginHandle =\n\t\t\t\t\t{\n\t\t\t\t\t\tsession : that,\n\t\t\t\t\t\tplugin : plugin,\n\t\t\t\t\t\tid : handleId,\n\t\t\t\t\t\ttoken : handleToken,\n\t\t\t\t\t\tdetached : false,\n\t\t\t\t\t\twebrtcStuff : {\n\t\t\t\t\t\t\tstarted : false,\n\t\t\t\t\t\t\tmyStream : null,\n\t\t\t\t\t\t\tstreamExternal : false,\n\t\t\t\t\t\t\tremoteStream : null,\n\t\t\t\t\t\t\tmySdp : null,\n\t\t\t\t\t\t\tmediaConstraints : null,\n\t\t\t\t\t\t\tpc : null,\n\t\t\t\t\t\t\tdataChannel : {},\n\t\t\t\t\t\t\tdtmfSender : null,\n\t\t\t\t\t\t\ttrickle : true,\n\t\t\t\t\t\t\ticeDone : false,\n\t\t\t\t\t\t\tvolume : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbitrate : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\tbsnow : null,\n\t\t\t\t\t\t\t\tbsbefore : null,\n\t\t\t\t\t\t\t\ttsnow : null,\n\t\t\t\t\t\t\t\ttsbefore : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetId : function() { return handleId; },\n\t\t\t\t\t\tgetPlugin : function() { return plugin; },\n\t\t\t\t\t\tgetVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetRemoteVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetLocalVolume : function() { return getVolume(handleId, false); },\n\t\t\t\t\t\tisAudioMuted : function() { return isMuted(handleId, false); },\n\t\t\t\t\t\tmuteAudio : function() { return mute(handleId, false, true); },\n\t\t\t\t\t\tunmuteAudio : function() { return mute(handleId, false, false); },\n\t\t\t\t\t\tisVideoMuted : function() { return isMuted(handleId, true); },\n\t\t\t\t\t\tmuteVideo : function() { return mute(handleId, true, true); },\n\t\t\t\t\t\tunmuteVideo : function() { return mute(handleId, true, false); },\n\t\t\t\t\t\tgetBitrate : function() { return getBitrate(handleId); },\n\t\t\t\t\t\tsend : function(callbacks) { sendMessage(handleId, callbacks); },\n\t\t\t\t\t\tdata : function(callbacks) { sendData(handleId, callbacks); },\n\t\t\t\t\t\tdtmf : function(callbacks) { sendDtmf(handleId, callbacks); },\n\t\t\t\t\t\tconsentDialog : callbacks.consentDialog,\n\t\t\t\t\t\ticeState : callbacks.iceState,\n\t\t\t\t\t\tmediaState : callbacks.mediaState,\n\t\t\t\t\t\twebrtcState : callbacks.webrtcState,\n\t\t\t\t\t\tslowLink : callbacks.slowLink,\n\t\t\t\t\t\tonmessage : callbacks.onmessage,\n\t\t\t\t\t\tcreateOffer : function(callbacks) { prepareWebrtc(handleId, true, callbacks); },\n\t\t\t\t\t\tcreateAnswer : function(callbacks) { prepareWebrtc(handleId, false, callbacks); },\n\t\t\t\t\t\thandleRemoteJsep : function(callbacks) { prepareWebrtcPeer(handleId, callbacks); },\n\t\t\t\t\t\tonlocalstream : callbacks.onlocalstream,\n\t\t\t\t\t\tonremotestream : callbacks.onremotestream,\n\t\t\t\t\t\tondata : callbacks.ondata,\n\t\t\t\t\t\tondataopen : callbacks.ondataopen,\n\t\t\t\t\t\toncleanup : callbacks.oncleanup,\n\t\t\t\t\t\tondetached : callbacks.ondetached,\n\t\t\t\t\t\thangup : function(sendRequest) { cleanupWebrtc(handleId, sendRequest === true); },\n\t\t\t\t\t\tdetach : function(callbacks) { destroyHandle(handleId, callbacks); }\n\t\t\t\t\t};\n\t\t\t\tpluginHandles[handleId] = pluginHandle;\n\t\t\t\tcallbacks.success(pluginHandle);\n\t\t\t};\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar handleId = json.data[\"id\"];\n\t\t\t\tJanus.log(\"Created handle: \" + handleId);\n\t\t\t\tvar pluginHandle =\n\t\t\t\t\t{\n\t\t\t\t\t\tsession : that,\n\t\t\t\t\t\tplugin : plugin,\n\t\t\t\t\t\tid : handleId,\n\t\t\t\t\t\ttoken : handleToken,\n\t\t\t\t\t\tdetached : false,\n\t\t\t\t\t\twebrtcStuff : {\n\t\t\t\t\t\t\tstarted : false,\n\t\t\t\t\t\t\tmyStream : null,\n\t\t\t\t\t\t\tstreamExternal : false,\n\t\t\t\t\t\t\tremoteStream : null,\n\t\t\t\t\t\t\tmySdp : null,\n\t\t\t\t\t\t\tmediaConstraints : null,\n\t\t\t\t\t\t\tpc : null,\n\t\t\t\t\t\t\tdataChannel : {},\n\t\t\t\t\t\t\tdtmfSender : null,\n\t\t\t\t\t\t\ttrickle : true,\n\t\t\t\t\t\t\ticeDone : false,\n\t\t\t\t\t\t\tvolume : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbitrate : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\tbsnow : null,\n\t\t\t\t\t\t\t\tbsbefore : null,\n\t\t\t\t\t\t\t\ttsnow : null,\n\t\t\t\t\t\t\t\ttsbefore : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetId : function() { return handleId; },\n\t\t\t\t\t\tgetPlugin : function() { return plugin; },\n\t\t\t\t\t\tgetVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetRemoteVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetLocalVolume : function() { return getVolume(handleId, false); },\n\t\t\t\t\t\tisAudioMuted : function() { return isMuted(handleId, false); },\n\t\t\t\t\t\tmuteAudio : function() { return mute(handleId, false, true); },\n\t\t\t\t\t\tunmuteAudio : function() { return mute(handleId, false, false); },\n\t\t\t\t\t\tisVideoMuted : function() { return isMuted(handleId, true); },\n\t\t\t\t\t\tmuteVideo : function() { return mute(handleId, true, true); },\n\t\t\t\t\t\tunmuteVideo : function() { return mute(handleId, true, false); },\n\t\t\t\t\t\tgetBitrate : function() { return getBitrate(handleId); },\n\t\t\t\t\t\tsend : function(callbacks) { sendMessage(handleId, callbacks); },\n\t\t\t\t\t\tdata : function(callbacks) { sendData(handleId, callbacks); },\n\t\t\t\t\t\tdtmf : function(callbacks) { sendDtmf(handleId, callbacks); },\n\t\t\t\t\t\tconsentDialog : callbacks.consentDialog,\n\t\t\t\t\t\ticeState : callbacks.iceState,\n\t\t\t\t\t\tmediaState : callbacks.mediaState,\n\t\t\t\t\t\twebrtcState : callbacks.webrtcState,\n\t\t\t\t\t\tslowLink : callbacks.slowLink,\n\t\t\t\t\t\tonmessage : callbacks.onmessage,\n\t\t\t\t\t\tcreateOffer : function(callbacks) { prepareWebrtc(handleId, true, callbacks); },\n\t\t\t\t\t\tcreateAnswer : function(callbacks) { prepareWebrtc(handleId, false, callbacks); },\n\t\t\t\t\t\thandleRemoteJsep : function(callbacks) { prepareWebrtcPeer(handleId, callbacks); },\n\t\t\t\t\t\tonlocalstream : callbacks.onlocalstream,\n\t\t\t\t\t\tonremotestream : callbacks.onremotestream,\n\t\t\t\t\t\tondata : callbacks.ondata,\n\t\t\t\t\t\tondataopen : callbacks.ondataopen,\n\t\t\t\t\t\toncleanup : callbacks.oncleanup,\n\t\t\t\t\t\tondetached : callbacks.ondetached,\n\t\t\t\t\t\thangup : function(sendRequest) { cleanupWebrtc(handleId, sendRequest === true); },\n\t\t\t\t\t\tdetach : function(callbacks) { destroyHandle(handleId, callbacks); }\n\t\t\t\t\t}\n\t\t\t\tpluginHandles[handleId] = pluginHandle;\n\t\t\t\tcallbacks.success(pluginHandle);\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to send a message\n\tfunction sendMessage(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar message = callbacks.message;\n\t\tvar jsep = callbacks.jsep;\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"message\", \"body\": message, \"transaction\": transaction };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(jsep) {\n\t\t\trequest.jsep = {\n\t\t\t\ttype: jsep.type,\n\t\t\t\tsdp: jsep.sdp\n\t\t\t};\n\t\t\tif(jsep.e2ee)\n\t\t\t\trequest.jsep.e2ee = true;\n\t\t\tif(jsep.rid_order === \"hml\" || jsep.rid_order === \"lmh\")\n\t\t\t\trequest.jsep.rid_order = jsep.rid_order;\n\t\t}\n\t\tJanus.debug(\"Sending message to plugin (handle=\" + handleId + \"):\");\n\t\tJanus.debug(request);\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.debug(\"Message sent!\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] === \"success\") {\n\t\t\t\t\t// We got a success, must have been a synchronous transaction\n\t\t\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\t\t\tif(!plugindata) {\n\t\t\t\t\t\tJanus.warn(\"Request succeeded, but missing plugindata...\");\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Synchronous transaction successful (\" + plugindata[\"plugin\"] + \")\");\n\t\t\t\t\tvar data = plugindata[\"data\"];\n\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\tcallbacks.success(data);\n\t\t\t\t\treturn;\n\t\t\t\t} else if(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\t// Not a success and not an ack, must be an error\n\t\t\t\t\tif(json[\"error\"]) {\n\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\tcallbacks.error(json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.error(\"Unknown error\");\t// FIXME\n\t\t\t\t\t\tcallbacks.error(\"Unknown error\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If we got here, the plugin decided to handle the request asynchronously\n\t\t\t\tcallbacks.success();\n\t\t\t};\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(\"Message sent!\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] === \"success\") {\n\t\t\t\t\t// We got a success, must have been a synchronous transaction\n\t\t\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\t\t\tif(!plugindata) {\n\t\t\t\t\t\tJanus.warn(\"Request succeeded, but missing plugindata...\");\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Synchronous transaction successful (\" + plugindata[\"plugin\"] + \")\");\n\t\t\t\t\tvar data = plugindata[\"data\"];\n\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\tcallbacks.success(data);\n\t\t\t\t\treturn;\n\t\t\t\t} else if(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\t// Not a success and not an ack, must be an error\n\t\t\t\t\tif(json[\"error\"]) {\n\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\tcallbacks.error(json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.error(\"Unknown error\");\t// FIXME\n\t\t\t\t\t\tcallbacks.error(\"Unknown error\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If we got here, the plugin decided to handle the request asynchronously\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to send a trickle candidate\n\tfunction sendTrickleCandidate(handleId, candidate) {\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = { \"janus\": \"trickle\", \"candidate\": candidate, \"transaction\": Janus.randomString(12) };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tJanus.vdebug(\"Sending trickle candidate (handle=\" + handleId + \"):\");\n\t\tJanus.vdebug(request);\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.vdebug(\"Candidate sent!\");\n\t\t\t\tJanus.vdebug(json);\n\t\t\t\tif(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to create a data channel\n\tfunction createDataChannel(handleId, dclabel, dcprotocol, incoming, pendingData) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn;\n\t\t}\n\t\tvar onDataChannelMessage = function(event) {\n\t\t\tJanus.log('Received message on data channel:', event);\n\t\t\tvar label = event.target.label;\n\t\t\tpluginHandle.ondata(event.data, label);\n\t\t};\n\t\tvar onDataChannelStateChange = function(event) {\n\t\t\tJanus.log('Received state change on data channel:', event);\n\t\t\tvar label = event.target.label;\n\t\t\tvar protocol = event.target.protocol;\n\t\t\tvar dcState = config.dataChannel[label] ? config.dataChannel[label].readyState : \"null\";\n\t\t\tJanus.log('State change on <' + label + '> data channel: ' + dcState);\n\t\t\tif(dcState === 'open') {\n\t\t\t\t// Any pending messages to send?\n\t\t\t\tif(config.dataChannel[label].pending && config.dataChannel[label].pending.length > 0) {\n\t\t\t\t\tJanus.log(\"Sending pending messages on <\" + label + \">:\", config.dataChannel[label].pending.length);\n\t\t\t\t\tfor(var data of config.dataChannel[label].pending) {\n\t\t\t\t\t\tJanus.log(\"Sending data on data channel <\" + label + \">\");\n\t\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\t\tconfig.dataChannel[label].send(data);\n\t\t\t\t\t}\n\t\t\t\t\tconfig.dataChannel[label].pending = [];\n\t\t\t\t}\n\t\t\t\t// Notify the open data channel\n\t\t\t\tpluginHandle.ondataopen(label, protocol);\n\t\t\t}\n\t\t};\n\t\tvar onDataChannelError = function(error) {\n\t\t\tJanus.error('Got error on data channel:', error);\n\t\t\t// TODO\n\t\t};\n\t\tif(!incoming) {\n\t\t\t// FIXME Add options (ordered, maxRetransmits, etc.)\n\t\t\tvar dcoptions = { ordered: true };\n\t\t\tif(dcprotocol)\n\t\t\t\tdcoptions.protocol = dcprotocol;\n\t\t\tconfig.dataChannel[dclabel] = config.pc.createDataChannel(dclabel, dcoptions);\n\t\t} else {\n\t\t\t// The channel was created by Janus\n\t\t\tconfig.dataChannel[dclabel] = incoming;\n\t\t}\n\t\tconfig.dataChannel[dclabel].onmessage = onDataChannelMessage;\n\t\tconfig.dataChannel[dclabel].onopen = onDataChannelStateChange;\n\t\tconfig.dataChannel[dclabel].onclose = onDataChannelStateChange;\n\t\tconfig.dataChannel[dclabel].onerror = onDataChannelError;\n\t\tconfig.dataChannel[dclabel].pending = [];\n\t\tif(pendingData)\n\t\t\tconfig.dataChannel[dclabel].pending.push(pendingData);\n\t}\n\n\t// Private method to send a data channel message\n\tfunction sendData(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar data = callbacks.text || callbacks.data;\n\t\tif(!data) {\n\t\t\tJanus.warn(\"Invalid data\");\n\t\t\tcallbacks.error(\"Invalid data\");\n\t\t\treturn;\n\t\t}\n\t\tvar label = callbacks.label ? callbacks.label : Janus.dataChanDefaultLabel;\n\t\tif(!config.dataChannel[label]) {\n\t\t\t// Create new data channel and wait for it to open\n\t\t\tcreateDataChannel(handleId, label, callbacks.protocol, false, data, callbacks.protocol);\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(config.dataChannel[label].readyState !== \"open\") {\n\t\t\tconfig.dataChannel[label].pending.push(data);\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tJanus.log(\"Sending data on data channel <\" + label + \">\");\n\t\tJanus.debug(data);\n\t\tconfig.dataChannel[label].send(data);\n\t\tcallbacks.success();\n\t}\n\n\t// Private method to send a DTMF tone\n\tfunction sendDtmf(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.dtmfSender) {\n\t\t\t// Create the DTMF sender the proper way, if possible\n\t\t\tif(config.pc) {\n\t\t\t\tvar senders = config.pc.getSenders();\n\t\t\t\tvar audioSender = senders.find(function(sender) {\n\t\t\t\t\treturn sender.track && sender.track.kind === 'audio';\n\t\t\t\t});\n\t\t\t\tif(!audioSender) {\n\t\t\t\t\tJanus.warn(\"Invalid DTMF configuration (no audio track)\");\n\t\t\t\t\tcallbacks.error(\"Invalid DTMF configuration (no audio track)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconfig.dtmfSender = audioSender.dtmf;\n\t\t\t\tif(config.dtmfSender) {\n\t\t\t\t\tJanus.log(\"Created DTMF Sender\");\n\t\t\t\t\tconfig.dtmfSender.ontonechange = function(tone) { Janus.debug(\"Sent DTMF tone: \" + tone.tone); };\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!config.dtmfSender) {\n\t\t\t\tJanus.warn(\"Invalid DTMF configuration\");\n\t\t\t\tcallbacks.error(\"Invalid DTMF configuration\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tvar dtmf = callbacks.dtmf;\n\t\tif(!dtmf) {\n\t\t\tJanus.warn(\"Invalid DTMF parameters\");\n\t\t\tcallbacks.error(\"Invalid DTMF parameters\");\n\t\t\treturn;\n\t\t}\n\t\tvar tones = dtmf.tones;\n\t\tif(!tones) {\n\t\t\tJanus.warn(\"Invalid DTMF string\");\n\t\t\tcallbacks.error(\"Invalid DTMF string\");\n\t\t\treturn;\n\t\t}\n\t\tvar duration = (typeof dtmf.duration === 'number') ? dtmf.duration : 500; // We choose 500ms as the default duration for a tone\n\t\tvar gap = (typeof dtmf.gap === 'number') ? dtmf.gap : 50; // We choose 50ms as the default gap between tones\n\t\tJanus.debug(\"Sending DTMF string \" + tones + \" (duration \" + duration + \"ms, gap \" + gap + \"ms)\");\n\t\tconfig.dtmfSender.insertDTMF(tones, duration, gap);\n\t\tcallbacks.success();\n\t}\n\n\t// Private method to destroy a plugin handle\n\tfunction destroyHandle(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar noRequest = (callbacks.noRequest === true);\n\t\tJanus.log(\"Destroying handle \" + handleId + \" (only-locally=\" + noRequest + \")\");\n\t\tcleanupWebrtc(handleId);\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || pluginHandle.detached) {\n\t\t\t// Plugin was already detached by Janus, calling detach again will return a handle not found error, so just exit here\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(noRequest) {\n\t\t\t// We're only removing the handle locally\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = { \"janus\": \"detach\", \"transaction\": Janus.randomString(12) };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Destroyed handle:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tdelete pluginHandles[handleId];\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\t// We cleanup anyway\n\t\t\t\tdelete pluginHandles[handleId];\n\t\t\t\tcallbacks.success();\n\t\t\t}\n\t\t});\n\t}\n\n\t// WebRTC stuff\n\tfunction streamsDone(handleId, jsep, media, callbacks, stream) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\t// Close all tracks if the given stream has been created internally\n\t\t\tif(!callbacks.stream) {\n\t\t\t\tJanus.stopAllTracks(stream);\n\t\t\t}\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tJanus.debug(\"streamsDone:\", stream);\n\t\tif(stream) {\n\t\t\tJanus.debug(\"  -- Audio tracks:\", stream.getAudioTracks());\n\t\t\tJanus.debug(\"  -- Video tracks:\", stream.getVideoTracks());\n\t\t}\n\t\t// We're now capturing the new stream: check if we're updating or if it's a new thing\n\t\tvar addTracks = false;\n\t\tif(!config.myStream || !media.update || config.streamExternal) {\n\t\t\tconfig.myStream = stream;\n\t\t\taddTracks = true;\n\t\t} else {\n\t\t\t// We only need to update the existing stream\n\t\t\tif(((!media.update && isAudioSendEnabled(media)) || (media.update && (media.addAudio || media.replaceAudio))) &&\n\t\t\t\t\tstream.getAudioTracks() && stream.getAudioTracks().length) {\n\t\t\t\tconfig.myStream.addTrack(stream.getAudioTracks()[0]);\n\t\t\t\tif(Janus.unifiedPlan) {\n\t\t\t\t\t// Use Transceivers\n\t\t\t\t\tJanus.log((media.replaceAudio ? \"Replacing\" : \"Adding\") + \" audio track:\", stream.getAudioTracks()[0]);\n\t\t\t\t\tvar audioTransceiver = null;\n\t\t\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(audioTransceiver && audioTransceiver.sender) {\n\t\t\t\t\t\taudioTransceiver.sender.replaceTrack(stream.getAudioTracks()[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.pc.addTrack(stream.getAudioTracks()[0], stream);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log((media.replaceAudio ? \"Replacing\" : \"Adding\") + \" audio track:\", stream.getAudioTracks()[0]);\n\t\t\t\t\tconfig.pc.addTrack(stream.getAudioTracks()[0], stream);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(((!media.update && isVideoSendEnabled(media)) || (media.update && (media.addVideo || media.replaceVideo))) &&\n\t\t\t\t\tstream.getVideoTracks() && stream.getVideoTracks().length) {\n\t\t\t\tconfig.myStream.addTrack(stream.getVideoTracks()[0]);\n\t\t\t\tif(Janus.unifiedPlan) {\n\t\t\t\t\t// Use Transceivers\n\t\t\t\t\tJanus.log((media.replaceVideo ? \"Replacing\" : \"Adding\") + \" video track:\", stream.getVideoTracks()[0]);\n\t\t\t\t\tvar videoTransceiver = null;\n\t\t\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(videoTransceiver && videoTransceiver.sender) {\n\t\t\t\t\t\tvideoTransceiver.sender.replaceTrack(stream.getVideoTracks()[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.pc.addTrack(stream.getVideoTracks()[0], stream);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log((media.replaceVideo ? \"Replacing\" : \"Adding\") + \" video track:\", stream.getVideoTracks()[0]);\n\t\t\t\t\tconfig.pc.addTrack(stream.getVideoTracks()[0], stream);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// If we still need to create a PeerConnection, let's do that\n\t\tif(!config.pc) {\n\t\t\tvar pc_config = {\"iceServers\": iceServers, \"iceTransportPolicy\": iceTransportPolicy, \"bundlePolicy\": bundlePolicy};\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\") {\n\t\t\t\t// For Chrome versions before 72, we force a plan-b semantic, and unified-plan otherwise\n\t\t\t\tpc_config[\"sdpSemantics\"] = (Janus.webRTCAdapter.browserDetails.version < 72) ? \"plan-b\" : \"unified-plan\";\n\t\t\t}\n\t\t\tvar pc_constraints = {\n\t\t\t\t\"optional\": [{\"DtlsSrtpKeyAgreement\": true}]\n\t\t\t};\n\t\t\tif(ipv6Support) {\n\t\t\t\tpc_constraints.optional.push({\"googIPv6\":true});\n\t\t\t}\n\t\t\t// Any custom constraint to add?\n\t\t\tif(callbacks.rtcConstraints && typeof callbacks.rtcConstraints === 'object') {\n\t\t\t\tJanus.debug(\"Adding custom PeerConnection constraints:\", callbacks.rtcConstraints);\n\t\t\t\tfor(var i in callbacks.rtcConstraints) {\n\t\t\t\t\tpc_constraints.optional.push(callbacks.rtcConstraints[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\t\t// This is Edge, enable BUNDLE explicitly\n\t\t\t\tpc_config.bundlePolicy = \"max-bundle\";\n\t\t\t}\n\t\t\t// Check if a sender or receiver transform has been provided\n\t\t\tif(RTCRtpSender && (RTCRtpSender.prototype.createEncodedStreams ||\n\t\t\t\t\t(RTCRtpSender.prototype.createEncodedAudioStreams &&\n\t\t\t\t\tRTCRtpSender.prototype.createEncodedVideoStreams)) &&\n\t\t\t\t\t(callbacks.senderTransforms || callbacks.receiverTransforms)) {\n\t\t\t\tconfig.senderTransforms = callbacks.senderTransforms;\n\t\t\t\tconfig.receiverTransforms = callbacks.receiverTransforms;\n\t\t\t\tpc_config[\"forceEncodedAudioInsertableStreams\"] = true;\n\t\t\t\tpc_config[\"forceEncodedVideoInsertableStreams\"] = true;\n\t\t\t\tpc_config[\"encodedInsertableStreams\"] = true;\n\t\t\t}\n\t\t\tJanus.log(\"Creating PeerConnection\");\n\t\t\tJanus.debug(pc_constraints);\n\t\t\tconfig.pc = new RTCPeerConnection(pc_config, pc_constraints);\n\t\t\tJanus.debug(config.pc);\n\t\t\tif(config.pc.getStats) {\t// FIXME\n\t\t\t\tconfig.volume = {};\n\t\t\t\tconfig.bitrate.value = \"0 kbits/sec\";\n\t\t\t}\n\t\t\tJanus.log(\"Preparing local SDP and gathering candidates (trickle=\" + config.trickle + \")\");\n\t\t\tconfig.pc.oniceconnectionstatechange = function(e) {\n\t\t\t\tif(config.pc)\n\t\t\t\t\tpluginHandle.iceState(config.pc.iceConnectionState);\n\t\t\t};\n\t\t\tconfig.pc.onicecandidate = function(event) {\n\t\t\t\tif (!event.candidate ||\n\t\t\t\t\t\t(Janus.webRTCAdapter.browserDetails.browser === 'edge' && event.candidate.candidate.indexOf('endOfCandidates') > 0)) {\n\t\t\t\t\tJanus.log(\"End of candidates.\");\n\t\t\t\t\tconfig.iceDone = true;\n\t\t\t\t\tif(config.trickle === true) {\n\t\t\t\t\t\t// Notify end of candidates\n\t\t\t\t\t\tsendTrickleCandidate(handleId, {\"completed\": true});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// No trickle, time to send the complete SDP (including all candidates)\n\t\t\t\t\t\tsendSDP(handleId, callbacks);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\t\tvar candidate = {\n\t\t\t\t\t\t\"candidate\": event.candidate.candidate,\n\t\t\t\t\t\t\"sdpMid\": event.candidate.sdpMid,\n\t\t\t\t\t\t\"sdpMLineIndex\": event.candidate.sdpMLineIndex\n\t\t\t\t\t};\n\t\t\t\t\tif(config.trickle === true) {\n\t\t\t\t\t\t// Send candidate\n\t\t\t\t\t\tsendTrickleCandidate(handleId, candidate);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconfig.pc.ontrack = function(event) {\n\t\t\t\tJanus.log(\"Handling Remote Track\");\n\t\t\t\tJanus.debug(event);\n\t\t\t\tif(!event.streams)\n\t\t\t\t\treturn;\n\t\t\t\tconfig.remoteStream = event.streams[0];\n\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\tif(event.track.onended)\n\t\t\t\t\treturn;\n\t\t\t\tif(config.receiverTransforms) {\n\t\t\t\t\tvar receiverStreams = null;\n\t\t\t\t\tif(RTCRtpSender.prototype.createEncodedStreams) {\n\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedStreams();\n\t\t\t\t\t} else if(RTCRtpSender.prototype.createAudioEncodedStreams || RTCRtpSender.prototype.createEncodedVideoStreams) {\n\t\t\t\t\t\tif(event.track.kind === \"audio\" && config.receiverTransforms[\"audio\"]) {\n\t\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedAudioStreams();\n\t\t\t\t\t\t} else if(event.track.kind === \"video\" && config.receiverTransforms[\"video\"]) {\n\t\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedVideoStreams();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(receiverStreams) {\n\t\t\t\t\t\tconsole.log(receiverStreams);\n\t\t\t\t\t\tif(receiverStreams.readableStream && receiverStreams.writableStream) {\n\t\t\t\t\t\t\treceiverStreams.readableStream\n\t\t\t\t\t\t\t\t.pipeThrough(config.receiverTransforms[event.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(receiverStreams.writableStream);\n\t\t\t\t\t\t} else if(receiverStreams.readable && receiverStreams.writable) {\n\t\t\t\t\t\t\treceiverStreams.readable\n\t\t\t\t\t\t\t\t.pipeThrough(config.receiverTransforms[event.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(receiverStreams.writable);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar trackMutedTimeoutId = null;\n\t\t\t\tJanus.log(\"Adding onended callback to track:\", event.track);\n\t\t\t\tevent.track.onended = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track removed:\", ev);\n\t\t\t\t\tif(config.remoteStream) {\n\t\t\t\t\t\tclearTimeout(trackMutedTimeoutId);\n\t\t\t\t\t\tconfig.remoteStream.removeTrack(ev.target);\n\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tevent.track.onmute = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track muted:\", ev);\n\t\t\t\t\tif(config.remoteStream && trackMutedTimeoutId == null) {\n\t\t\t\t\t\ttrackMutedTimeoutId = setTimeout(function() {\n\t\t\t\t\t\t\tJanus.log(\"Removing remote track\");\n\t\t\t\t\t\t\tif (config.remoteStream) {\n\t\t\t\t\t\t\t\tconfig.remoteStream.removeTrack(ev.target);\n\t\t\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttrackMutedTimeoutId = null;\n\t\t\t\t\t\t// Chrome seems to raise mute events only at multiples of 834ms;\n\t\t\t\t\t\t// we set the timeout to three times this value (rounded to 840ms)\n\t\t\t\t\t\t}, 3 * 840);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tevent.track.onunmute = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track flowing again:\", ev);\n\t\t\t\t\tif(trackMutedTimeoutId != null) {\n\t\t\t\t\t\tclearTimeout(trackMutedTimeoutId);\n\t\t\t\t\t\ttrackMutedTimeoutId = null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconfig.remoteStream.addTrack(ev.target);\n\t\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\t\tif(addTracks && stream) {\n\t\t\tJanus.log('Adding local stream');\n\t\t\tvar simulcast2 = (callbacks.simulcast2 === true);\n\t\t\tstream.getTracks().forEach(function(track) {\n\t\t\t\tJanus.log('Adding local track:', track);\n\t\t\t\tvar sender = null;\n\t\t\t\tif(!simulcast2 || track.kind === 'audio') {\n\t\t\t\t\tsender = config.pc.addTrack(track, stream);\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log('Enabling rid-based simulcasting:', track);\n\t\t\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\t\t\tvar tr = config.pc.addTransceiver(track, {\n\t\t\t\t\t\tdirection: \"sendrecv\",\n\t\t\t\t\t\tstreams: [stream],\n\t\t\t\t\t\tsendEncodings: callbacks.sendEncodings || [\n\t\t\t\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2 },\n\t\t\t\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4 }\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t\tif(tr)\n\t\t\t\t\t\tsender = tr.sender;\n\t\t\t\t}\n\t\t\t\t// Check if insertable streams are involved\n\t\t\t\tif(sender && config.senderTransforms) {\n\t\t\t\t\tvar senderStreams = null;\n\t\t\t\t\tif(RTCRtpSender.prototype.createEncodedStreams) {\n\t\t\t\t\t\tsenderStreams = sender.createEncodedStreams();\n\t\t\t\t\t} else if(RTCRtpSender.prototype.createAudioEncodedStreams || RTCRtpSender.prototype.createEncodedVideoStreams) {\n\t\t\t\t\t\tif(sender.track.kind === \"audio\" && config.senderTransforms[\"audio\"]) {\n\t\t\t\t\t\t\tsenderStreams = sender.createEncodedAudioStreams();\n\t\t\t\t\t\t} else if(sender.track.kind === \"video\" && config.senderTransforms[\"video\"]) {\n\t\t\t\t\t\t\tsenderStreams = sender.createEncodedVideoStreams();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(senderStreams) {\n\t\t\t\t\t\tconsole.log(senderStreams);\n\t\t\t\t\t\tif(senderStreams.readableStream && senderStreams.writableStream) {\n\t\t\t\t\t\t\tsenderStreams.readableStream\n\t\t\t\t\t\t\t\t.pipeThrough(config.senderTransforms[sender.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(senderStreams.writableStream);\n\t\t\t\t\t\t} else if(senderStreams.readable && senderStreams.writable) {\n\t\t\t\t\t\t\tsenderStreams.readable\n\t\t\t\t\t\t\t\t.pipeThrough(config.senderTransforms[sender.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(senderStreams.writable);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Any data channel to create?\n\t\tif(isDataEnabled(media) && !config.dataChannel[Janus.dataChanDefaultLabel]) {\n\t\t\tJanus.log(\"Creating default data channel\");\n\t\t\tcreateDataChannel(handleId, Janus.dataChanDefaultLabel, null, false);\n\t\t\tconfig.pc.ondatachannel = function(event) {\n\t\t\t\tJanus.log(\"Data channel created by Janus:\", event);\n\t\t\t\tcreateDataChannel(handleId, event.channel.label, event.channel.protocol, event.channel);\n\t\t\t};\n\t\t}\n\t\t// If there's a new local stream, let's notify the application\n\t\tif(config.myStream) {\n\t\t\tpluginHandle.onlocalstream(config.myStream);\n\t\t}\n\t\t// Create offer/answer now\n\t\tif(!jsep) {\n\t\t\tcreateOffer(handleId, media, callbacks);\n\t\t} else {\n\t\t\tconfig.pc.setRemoteDescription(jsep)\n\t\t\t\t.then(function() {\n\t\t\t\t\tJanus.log(\"Remote description accepted!\");\n\t\t\t\t\tconfig.remoteSdp = jsep.sdp;\n\t\t\t\t\t// Any trickle candidate we cached?\n\t\t\t\t\tif(config.candidates && config.candidates.length > 0) {\n\t\t\t\t\t\tfor(var i = 0; i< config.candidates.length; i++) {\n\t\t\t\t\t\t\tvar candidate = config.candidates[i];\n\t\t\t\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t\t\t\t// end-of-candidates\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// New candidate\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.candidates = [];\n\t\t\t\t\t}\n\t\t\t\t\t// Create the answer now\n\t\t\t\t\tcreateAnswer(handleId, media, callbacks);\n\t\t\t\t}, callbacks.error);\n\t\t}\n\t}\n\n\tfunction prepareWebrtc(handleId, offer, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : webrtcError;\n\t\tvar jsep = callbacks.jsep;\n\t\tif(offer && jsep) {\n\t\t\tJanus.error(\"Provided a JSEP to a createOffer\");\n\t\t\tcallbacks.error(\"Provided a JSEP to a createOffer\");\n\t\t\treturn;\n\t\t} else if(!offer && (!jsep || !jsep.type || !jsep.sdp)) {\n\t\t\tJanus.error(\"A valid JSEP is required for createAnswer\");\n\t\t\tcallbacks.error(\"A valid JSEP is required for createAnswer\");\n\t\t\treturn;\n\t\t}\n\t\t/* Check that callbacks.media is a (not null) Object */\n\t\tcallbacks.media = (typeof callbacks.media === 'object' && callbacks.media) ? callbacks.media : { audio: true, video: true };\n\t\tvar media = callbacks.media;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tconfig.trickle = isTrickleEnabled(callbacks.trickle);\n\t\t// Are we updating a session?\n\t\tif(!config.pc) {\n\t\t\t// Nope, new PeerConnection\n\t\t\tmedia.update = false;\n\t\t\tmedia.keepAudio = false;\n\t\t\tmedia.keepVideo = false;\n\t\t} else {\n\t\t\tJanus.log(\"Updating existing media session\");\n\t\t\tmedia.update = true;\n\t\t\t// Check if there's anything to add/remove/replace, or if we\n\t\t\t// can go directly to preparing the new SDP offer or answer\n\t\t\tif(callbacks.stream) {\n\t\t\t\t// External stream: is this the same as the one we were using before?\n\t\t\t\tif(callbacks.stream !== config.myStream) {\n\t\t\t\t\tJanus.log(\"Renegotiation involves a new external stream\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Check if there are changes on audio\n\t\t\t\tif(media.addAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\tmedia.removeAudio = false;\n\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\tif(config.myStream && config.myStream.getAudioTracks() && config.myStream.getAudioTracks().length) {\n\t\t\t\t\t\tJanus.error(\"Can't add audio stream, there already is one\");\n\t\t\t\t\t\tcallbacks.error(\"Can't add audio stream, there already is one\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if(media.removeAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\tmedia.addAudio = false;\n\t\t\t\t\tmedia.audioSend = false;\n\t\t\t\t} else if(media.replaceAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.addAudio = false;\n\t\t\t\t\tmedia.removeAudio = false;\n\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t}\n\t\t\t\tif(!config.myStream) {\n\t\t\t\t\t// No media stream: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\tif(media.replaceAudio) {\n\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(isAudioSendEnabled(media)) {\n\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\t\t\t// No audio track: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\t\tif(media.replaceAudio) {\n\t\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isAudioSendEnabled(media)) {\n\t\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We have an audio track: should we keep it as it is?\n\t\t\t\t\t\tif(isAudioSendEnabled(media) &&\n\t\t\t\t\t\t\t\t!media.removeAudio && !media.replaceAudio) {\n\t\t\t\t\t\t\tmedia.keepAudio = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Check if there are changes on video\n\t\t\t\tif(media.addVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\tmedia.removeVideo = false;\n\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\tif(config.myStream && config.myStream.getVideoTracks() && config.myStream.getVideoTracks().length) {\n\t\t\t\t\t\tJanus.error(\"Can't add video stream, there already is one\");\n\t\t\t\t\t\tcallbacks.error(\"Can't add video stream, there already is one\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if(media.removeVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\tmedia.addVideo = false;\n\t\t\t\t\tmedia.videoSend = false;\n\t\t\t\t} else if(media.replaceVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.addVideo = false;\n\t\t\t\t\tmedia.removeVideo = false;\n\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t}\n\t\t\t\tif(!config.myStream) {\n\t\t\t\t\t// No media stream: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\tif(media.replaceVideo) {\n\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(isVideoSendEnabled(media)) {\n\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\t\t\t// No video track: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\t\tif(media.replaceVideo) {\n\t\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isVideoSendEnabled(media)) {\n\t\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We have a video track: should we keep it as it is?\n\t\t\t\t\t\tif(isVideoSendEnabled(media) && !media.removeVideo && !media.replaceVideo) {\n\t\t\t\t\t\t\tmedia.keepVideo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Data channels can only be added\n\t\t\t\tif(media.addData) {\n\t\t\t\t\tmedia.data = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we're updating and keeping all tracks, let's skip the getUserMedia part\n\t\t\tif((isAudioSendEnabled(media) && media.keepAudio) &&\n\t\t\t\t\t(isVideoSendEnabled(media) && media.keepVideo)) {\n\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, config.myStream);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t// If we're updating, check if we need to remove/replace one of the tracks\n\t\tif(media.update && !config.streamExternal) {\n\t\t\tif(media.removeAudio || media.replaceAudio) {\n\t\t\t\tif(config.myStream && config.myStream.getAudioTracks() && config.myStream.getAudioTracks().length) {\n\t\t\t\t\tvar at = config.myStream.getAudioTracks()[0];\n\t\t\t\t\tJanus.log(\"Removing audio track:\", at);\n\t\t\t\t\tconfig.myStream.removeTrack(at);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tat.stop();\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\tif(config.pc.getSenders() && config.pc.getSenders().length) {\n\t\t\t\t\tvar ra = true;\n\t\t\t\t\tif(media.replaceAudio && Janus.unifiedPlan) {\n\t\t\t\t\t\t// We can use replaceTrack\n\t\t\t\t\t\tra = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(ra) {\n\t\t\t\t\t\tfor(var asnd of config.pc.getSenders()) {\n\t\t\t\t\t\t\tif(asnd && asnd.track && asnd.track.kind === \"audio\") {\n\t\t\t\t\t\t\t\tJanus.log(\"Removing audio sender:\", asnd);\n\t\t\t\t\t\t\t\tconfig.pc.removeTrack(asnd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(media.removeVideo || media.replaceVideo) {\n\t\t\t\tif(config.myStream && config.myStream.getVideoTracks() && config.myStream.getVideoTracks().length) {\n\t\t\t\t\tvar vt = config.myStream.getVideoTracks()[0];\n\t\t\t\t\tJanus.log(\"Removing video track:\", vt);\n\t\t\t\t\tconfig.myStream.removeTrack(vt);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvt.stop();\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\tif(config.pc.getSenders() && config.pc.getSenders().length) {\n\t\t\t\t\tvar rv = true;\n\t\t\t\t\tif(media.replaceVideo && Janus.unifiedPlan) {\n\t\t\t\t\t\t// We can use replaceTrack\n\t\t\t\t\t\trv = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(rv) {\n\t\t\t\t\t\tfor(var vsnd of config.pc.getSenders()) {\n\t\t\t\t\t\t\tif(vsnd && vsnd.track && vsnd.track.kind === \"video\") {\n\t\t\t\t\t\t\t\tJanus.log(\"Removing video sender:\", vsnd);\n\t\t\t\t\t\t\t\tconfig.pc.removeTrack(vsnd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Was a MediaStream object passed, or do we need to take care of that?\n\t\tif(callbacks.stream) {\n\t\t\tvar stream = callbacks.stream;\n\t\t\tJanus.log(\"MediaStream provided by the application\");\n\t\t\tJanus.debug(stream);\n\t\t\t// If this is an update, let's check if we need to release the previous stream\n\t\t\tif(media.update) {\n\t\t\t\tif(config.myStream && config.myStream !== callbacks.stream && !config.streamExternal) {\n\t\t\t\t\t// We're replacing a stream we captured ourselves with an external one\n\t\t\t\t\tJanus.stopAllTracks(config.myStream);\n\t\t\t\t\tconfig.myStream = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Skip the getUserMedia part\n\t\t\tconfig.streamExternal = true;\n\t\t\tpluginHandle.consentDialog(false);\n\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\treturn;\n\t\t}\n\t\tif(isAudioSendEnabled(media) || isVideoSendEnabled(media)) {\n\t\t\tif(!Janus.isGetUserMediaAvailable()) {\n\t\t\t\tcallbacks.error(\"getUserMedia not available\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar constraints = { mandatory: {}, optional: []};\n\t\t\tpluginHandle.consentDialog(true);\n\t\t\tvar audioSupport = isAudioSendEnabled(media);\n\t\t\tif(audioSupport && media && typeof media.audio === 'object')\n\t\t\t\taudioSupport = media.audio;\n\t\t\tvar videoSupport = isVideoSendEnabled(media);\n\t\t\tif(videoSupport && media) {\n\t\t\t\tvar simulcast = (callbacks.simulcast === true);\n\t\t\t\tvar simulcast2 = (callbacks.simulcast2 === true);\n\t\t\t\tif((simulcast || simulcast2) && !jsep && !media.video)\n\t\t\t\t\tmedia.video = \"hires\";\n\t\t\t\tif(media.video && media.video != 'screen' && media.video != 'window') {\n\t\t\t\t\tif(typeof media.video === 'object') {\n\t\t\t\t\t\tvideoSupport = media.video;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar width = 0;\n\t\t\t\t\t\tvar height = 0, maxHeight = 0;\n\t\t\t\t\t\tif(media.video === 'lowres') {\n\t\t\t\t\t\t\t// Small resolution, 4:3\n\t\t\t\t\t\t\theight = 240;\n\t\t\t\t\t\t\tmaxHeight = 240;\n\t\t\t\t\t\t\twidth = 320;\n\t\t\t\t\t\t} else if(media.video === 'lowres-16:9') {\n\t\t\t\t\t\t\t// Small resolution, 16:9\n\t\t\t\t\t\t\theight = 180;\n\t\t\t\t\t\t\tmaxHeight = 180;\n\t\t\t\t\t\t\twidth = 320;\n\t\t\t\t\t\t} else if(media.video === 'hires' || media.video === 'hires-16:9' || media.video === 'hdres') {\n\t\t\t\t\t\t\t// High(HD) resolution is only 16:9\n\t\t\t\t\t\t\theight = 720;\n\t\t\t\t\t\t\tmaxHeight = 720;\n\t\t\t\t\t\t\twidth = 1280;\n\t\t\t\t\t\t} else if(media.video === 'fhdres') {\n\t\t\t\t\t\t\t// Full HD resolution is only 16:9\n\t\t\t\t\t\t\theight = 1080;\n\t\t\t\t\t\t\tmaxHeight = 1080;\n\t\t\t\t\t\t\twidth = 1920;\n\t\t\t\t\t\t} else if(media.video === '4kres') {\n\t\t\t\t\t\t\t// 4K resolution is only 16:9\n\t\t\t\t\t\t\theight = 2160;\n\t\t\t\t\t\t\tmaxHeight = 2160;\n\t\t\t\t\t\t\twidth = 3840;\n\t\t\t\t\t\t} else if(media.video === 'stdres') {\n\t\t\t\t\t\t\t// Normal resolution, 4:3\n\t\t\t\t\t\t\theight = 480;\n\t\t\t\t\t\t\tmaxHeight = 480;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t} else if(media.video === 'stdres-16:9') {\n\t\t\t\t\t\t\t// Normal resolution, 16:9\n\t\t\t\t\t\t\theight = 360;\n\t\t\t\t\t\t\tmaxHeight = 360;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tJanus.log(\"Default video setting is stdres 4:3\");\n\t\t\t\t\t\t\theight = 480;\n\t\t\t\t\t\t\tmaxHeight = 480;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Adding media constraint:\", media.video);\n\t\t\t\t\t\tvideoSupport = {\n\t\t\t\t\t\t\t'height': {'ideal': height},\n\t\t\t\t\t\t\t'width': {'ideal': width}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tJanus.log(\"Adding video constraint:\", videoSupport);\n\t\t\t\t\t}\n\t\t\t\t} else if(media.video === 'screen' || media.video === 'window') {\n\t\t\t\t\tif(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\n\t\t\t\t\t\t// The new experimental getDisplayMedia API is available, let's use that\n\t\t\t\t\t\t// https://groups.google.com/forum/#!topic/discuss-webrtc/Uf0SrR4uxzk\n\t\t\t\t\t\t// https://webrtchacks.com/chrome-screensharing-getdisplaymedia/\n\t\t\t\t\t\tconstraints.video = {};\n\t\t\t\t\t\tif(media.screenshareFrameRate) {\n\t\t\t\t\t\t\tconstraints.video.frameRate = media.screenshareFrameRate;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(media.screenshareHeight) {\n\t\t\t\t\t\t\tconstraints.video.height = media.screenshareHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(media.screenshareWidth) {\n\t\t\t\t\t\t\tconstraints.video.width = media.screenshareWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconstraints.audio = media.captureDesktopAudio;\n\t\t\t\t\t\tnavigator.mediaDevices.getDisplayMedia(constraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tif(isAudioSendEnabled(media) && !media.keepAudio) {\n\t\t\t\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\t\t\t\t\t\t\t\t\t.then(function (audioStream) {\n\t\t\t\t\t\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, function (error) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// We're going to try and use the extension for Chrome 34+, the old approach\n\t\t\t\t\t// for older versions of Chrome, or the experimental support in Firefox 33+\n\t\t\t\t\tfunction callbackUserMedia (error, stream) {\n\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\tif(error) {\n\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction getScreenMedia(constraints, gsmCallback, useAudio) {\n\t\t\t\t\t\tJanus.log(\"Adding media constraint (screen capture)\");\n\t\t\t\t\t\tJanus.debug(constraints);\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tif(useAudio) {\n\t\t\t\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\t\t\t\t\t\t\t\t\t.then(function (audioStream) {\n\t\t\t\t\t\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t\t\t\t\t\t\tgsmCallback(null, stream);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tgsmCallback(null, stream);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(function(error) { pluginHandle.consentDialog(false); gsmCallback(error); });\n\t\t\t\t\t}\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'chrome') {\n\t\t\t\t\t\tvar chromever = Janus.webRTCAdapter.browserDetails.version;\n\t\t\t\t\t\tvar maxver = 33;\n\t\t\t\t\t\tif(window.navigator.userAgent.match('Linux'))\n\t\t\t\t\t\t\tmaxver = 35;\t// \"known\" crash in chrome 34 and 35 on linux\n\t\t\t\t\t\tif(chromever >= 26 && chromever <= maxver) {\n\t\t\t\t\t\t\t// Chrome 26->33 requires some awkward chrome://flags manipulation\n\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\t\t\tgoogLeakyBucket: true,\n\t\t\t\t\t\t\t\t\t\tmaxWidth: window.screen.width,\n\t\t\t\t\t\t\t\t\t\tmaxHeight: window.screen.height,\n\t\t\t\t\t\t\t\t\t\tminFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\tmaxFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\tchromeMediaSource: 'screen'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taudio: isAudioSendEnabled(media) && !media.keepAudio\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tgetScreenMedia(constraints, callbackUserMedia);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Chrome 34+ requires an extension\n\t\t\t\t\t\t\tJanus.extension.getScreen(function (error, sourceId) {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\t\treturn callbacks.error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\t\taudio: false,\n\t\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\t\t\t\tchromeMediaSource: 'desktop',\n\t\t\t\t\t\t\t\t\t\t\tmaxWidth: window.screen.width,\n\t\t\t\t\t\t\t\t\t\t\tmaxHeight: window.screen.height,\n\t\t\t\t\t\t\t\t\t\t\tminFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\t\tmaxFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\toptional: [\n\t\t\t\t\t\t\t\t\t\t\t{googLeakyBucket: true},\n\t\t\t\t\t\t\t\t\t\t\t{googTemporalLayeredScreencast: true}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tconstraints.video.mandatory.chromeMediaSourceId = sourceId;\n\t\t\t\t\t\t\t\tgetScreenMedia(constraints, callbackUserMedia,\n\t\t\t\t\t\t\t\t\tisAudioSendEnabled(media) && !media.keepAudio);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser === 'firefox') {\n\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.version >= 33) {\n\t\t\t\t\t\t\t// Firefox 33+ has experimental support for screen sharing\n\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\tmozMediaSource: media.video,\n\t\t\t\t\t\t\t\t\tmediaSource: media.video\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taudio: isAudioSendEnabled(media) && !media.keepAudio\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tgetScreenMedia(constraints, function (err, stream) {\n\t\t\t\t\t\t\t\tcallbackUserMedia(err, stream);\n\t\t\t\t\t\t\t\t// Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1045810\n\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\tvar lastTime = stream.currentTime;\n\t\t\t\t\t\t\t\t\tvar polly = window.setInterval(function () {\n\t\t\t\t\t\t\t\t\t\tif(!stream)\n\t\t\t\t\t\t\t\t\t\t\twindow.clearInterval(polly);\n\t\t\t\t\t\t\t\t\t\tif(stream.currentTime == lastTime) {\n\t\t\t\t\t\t\t\t\t\t\twindow.clearInterval(polly);\n\t\t\t\t\t\t\t\t\t\t\tif(stream.onended) {\n\t\t\t\t\t\t\t\t\t\t\t\tstream.onended();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tlastTime = stream.currentTime;\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\t\t\t\t\terror.name = 'Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)';\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we got here, we're not screensharing\n\t\t\tif(!media || media.video !== 'screen') {\n\t\t\t\t// Check whether all media sources are actually available or not\n\t\t\t\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n\t\t\t\t\tvar audioExist = devices.some(function(device) {\n\t\t\t\t\t\treturn device.kind === 'audioinput';\n\t\t\t\t\t}),\n\t\t\t\t\tvideoExist = isScreenSendEnabled(media) || devices.some(function(device) {\n\t\t\t\t\t\treturn device.kind === 'videoinput';\n\t\t\t\t\t});\n\n\t\t\t\t\t// Check whether a missing device is really a problem\n\t\t\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\t\t\tvar needAudioDevice = isAudioSendRequired(media);\n\t\t\t\t\tvar needVideoDevice = isVideoSendRequired(media);\n\t\t\t\t\tif(audioSend || videoSend || needAudioDevice || needVideoDevice) {\n\t\t\t\t\t\t// We need to send either audio or video\n\t\t\t\t\t\tvar haveAudioDevice = audioSend ? audioExist : false;\n\t\t\t\t\t\tvar haveVideoDevice = videoSend ? videoExist : false;\n\t\t\t\t\t\tif(!haveAudioDevice && !haveVideoDevice) {\n\t\t\t\t\t\t\t// FIXME Should we really give up, or just assume recvonly for both?\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('No capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if(!haveAudioDevice && needAudioDevice) {\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('Audio capture is required, but no capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if(!haveVideoDevice && needVideoDevice) {\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('Video capture is required, but no capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar gumConstraints = {\n\t\t\t\t\t\taudio: (audioExist && !media.keepAudio) ? audioSupport : false,\n\t\t\t\t\t\tvideo: (videoExist && !media.keepVideo) ? videoSupport : false\n\t\t\t\t\t};\n\t\t\t\t\tJanus.debug(\"getUserMedia constraints\", gumConstraints);\n\t\t\t\t\tif (!gumConstraints.audio && !gumConstraints.video) {\n\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia(gumConstraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tcallbacks.error({code: error.code, name: error.name, message: error.message});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function(error) {\n\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\t// No need to do a getUserMedia, create offer/answer right away\n\t\t\tstreamsDone(handleId, jsep, media, callbacks);\n\t\t}\n\t}\n\n\tfunction prepareWebrtcPeer(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : webrtcError;\n\t\tvar jsep = callbacks.jsep;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(jsep) {\n\t\t\tif(!config.pc) {\n\t\t\t\tJanus.warn(\"Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep\");\n\t\t\t\tcallbacks.error(\"No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconfig.pc.setRemoteDescription(jsep)\n\t\t\t\t.then(function() {\n\t\t\t\t\tJanus.log(\"Remote description accepted!\");\n\t\t\t\t\tconfig.remoteSdp = jsep.sdp;\n\t\t\t\t\t// Any trickle candidate we cached?\n\t\t\t\t\tif(config.candidates && config.candidates.length > 0) {\n\t\t\t\t\t\tfor(var i = 0; i< config.candidates.length; i++) {\n\t\t\t\t\t\t\tvar candidate = config.candidates[i];\n\t\t\t\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t\t\t\t// end-of-candidates\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// New candidate\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.candidates = [];\n\t\t\t\t\t}\n\t\t\t\t\t// Done\n\t\t\t\t\tcallbacks.success();\n\t\t\t\t}, callbacks.error);\n\t\t} else {\n\t\t\tcallbacks.error(\"Invalid JSEP\");\n\t\t}\n\t}\n\n\tfunction createOffer(handleId, media, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar simulcast = (callbacks.simulcast === true);\n\t\tif(!simulcast) {\n\t\t\tJanus.log(\"Creating offer (iceDone=\" + config.iceDone + \")\");\n\t\t} else {\n\t\t\tJanus.log(\"Creating offer (iceDone=\" + config.iceDone + \", simulcast=\" + simulcast + \")\");\n\t\t}\n\t\t// https://code.google.com/p/webrtc/issues/detail?id=3508\n\t\tvar mediaConstraints = {};\n\t\tif(Janus.unifiedPlan) {\n\t\t\t// We can use Transceivers\n\t\t\tvar audioTransceiver = null, videoTransceiver = null;\n\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\tif(!audioTransceiver) {\n\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\tif(!videoTransceiver) {\n\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle audio (and related changes, if any)\n\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\tvar audioRecv = isAudioRecvEnabled(media);\n\t\t\tif(!audioSend && !audioRecv) {\n\t\t\t\t// Audio disabled: have we removed it?\n\t\t\t\tif(media.removeAudio && audioTransceiver) {\n\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\taudioTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\taudioTransceiver.direction = \"inactive\";\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Setting audio transceiver to inactive:\", audioTransceiver);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of audio m-line\n\t\t\t\tif(audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendrecv:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(audioSend && !audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendonly:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(!audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to recvonly:\", audioTransceiver);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\taudioTransceiver = config.pc.addTransceiver(\"audio\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly audio transceiver:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle video (and related changes, if any)\n\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\tvar videoRecv = isVideoRecvEnabled(media);\n\t\t\tif(!videoSend && !videoRecv) {\n\t\t\t\t// Video disabled: have we removed it?\n\t\t\t\tif(media.removeVideo && videoTransceiver) {\n\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\tvideoTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvideoTransceiver.direction = \"inactive\";\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Setting video transceiver to inactive:\", videoTransceiver);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of video m-line\n\t\t\t\tif(videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendrecv:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(videoSend && !videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendonly:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(!videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to recvonly:\", videoTransceiver);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\tvideoTransceiver = config.pc.addTransceiver(\"video\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly video transceiver:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tmediaConstraints[\"offerToReceiveAudio\"] = isAudioRecvEnabled(media);\n\t\t\tmediaConstraints[\"offerToReceiveVideo\"] = isVideoRecvEnabled(media);\n\t\t}\n\t\tvar iceRestart = (callbacks.iceRestart === true);\n\t\tif(iceRestart) {\n\t\t\tmediaConstraints[\"iceRestart\"] = true;\n\t\t}\n\t\tJanus.debug(mediaConstraints);\n\t\t// Check if this is Firefox and we've been asked to do simulcasting\n\t\tvar sendVideo = isVideoSendEnabled(media);\n\t\tif(sendVideo && simulcast && Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n\t\t\t// FIXME Based on https://gist.github.com/voluntas/088bc3cc62094730647b\n\t\t\tJanus.log(\"Enabling Simulcasting for Firefox (RID)\");\n\t\t\tvar sender = config.pc.getSenders().find(function(s) {return s.track.kind === \"video\"});\n\t\t\tif(sender) {\n\t\t\t\tvar parameters = sender.getParameters();\n\t\t\t\tif(!parameters) {\n\t\t\t\t\tparameters = {};\n\t\t\t\t}\n\t\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\t\tparameters.encodings = callbacks.sendEncodings || [\n\t\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2 },\n\t\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4 }\n\t\t\t\t];\n\t\t\t\tsender.setParameters(parameters);\n\t\t\t}\n\t\t}\n\t\tconfig.pc.createOffer(mediaConstraints)\n\t\t\t.then(function(offer) {\n\t\t\t\tJanus.debug(offer);\n\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\tvar jsep = {\n\t\t\t\t\t\"type\": offer.type,\n\t\t\t\t\t\"sdp\": offer.sdp\n\t\t\t\t};\n\t\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\t\toffer.sdp = jsep.sdp;\n\t\t\t\tJanus.log(\"Setting local description\");\n\t\t\t\tif(sendVideo && simulcast) {\n\t\t\t\t\t// This SDP munging only works with Chrome (Safari STP may support it too)\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n\t\t\t\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\") {\n\t\t\t\t\t\tJanus.log(\"Enabling Simulcasting for Chrome (SDP munging)\");\n\t\t\t\t\t\toffer.sdp = mungeSdpForSimulcasting(offer.sdp);\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser !== \"firefox\") {\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is not Chrome nor Firefox, ignoring\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconfig.mySdp = offer.sdp;\n\t\t\t\tconfig.pc.setLocalDescription(offer)\n\t\t\t\t\t.catch(callbacks.error);\n\t\t\t\tconfig.mediaConstraints = mediaConstraints;\n\t\t\t\tif(!config.iceDone && !config.trickle) {\n\t\t\t\t\t// Don't do anything until we have all candidates\n\t\t\t\t\tJanus.log(\"Waiting for all candidates...\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If transforms are present, notify Janus that the media is end-to-end encrypted\n\t\t\t\tif(config.senderTransforms || config.receiverTransforms) {\n\t\t\t\t\toffer[\"e2ee\"] = true;\n\t\t\t\t}\n\t\t\t\tcallbacks.success(offer);\n\t\t\t}, callbacks.error);\n\t}\n\n\tfunction createAnswer(handleId, media, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar simulcast = (callbacks.simulcast === true);\n\t\tif(!simulcast) {\n\t\t\tJanus.log(\"Creating answer (iceDone=\" + config.iceDone + \")\");\n\t\t} else {\n\t\t\tJanus.log(\"Creating answer (iceDone=\" + config.iceDone + \", simulcast=\" + simulcast + \")\");\n\t\t}\n\t\tvar mediaConstraints = null;\n\t\tif(Janus.unifiedPlan) {\n\t\t\t// We can use Transceivers\n\t\t\tmediaConstraints = {};\n\t\t\tvar audioTransceiver = null, videoTransceiver = null;\n\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\tif(!audioTransceiver)\n\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\tif(!videoTransceiver)\n\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle audio (and related changes, if any)\n\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\tvar audioRecv = isAudioRecvEnabled(media);\n\t\t\tif(!audioSend && !audioRecv) {\n\t\t\t\t// Audio disabled: have we removed it?\n\t\t\t\tif(media.removeAudio && audioTransceiver) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"inactive\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to inactive:\", audioTransceiver);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of audio m-line\n\t\t\t\tif(audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendrecv:\", audioTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(audioSend && !audioRecv) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendonly:\", audioTransceiver);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t} else if(!audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to recvonly:\", audioTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\taudioTransceiver = config.pc.addTransceiver(\"audio\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly audio transceiver:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle video (and related changes, if any)\n\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\tvar videoRecv = isVideoRecvEnabled(media);\n\t\t\tif(!videoSend && !videoRecv) {\n\t\t\t\t// Video disabled: have we removed it?\n\t\t\t\tif(media.removeVideo && videoTransceiver) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"inactive\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to inactive:\", videoTransceiver);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of video m-line\n\t\t\t\tif(videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendrecv:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(videoSend && !videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendonly:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(!videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to recvonly:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\tvideoTransceiver = config.pc.addTransceiver(\"video\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly video transceiver:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"firefox\" || Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\t\tmediaConstraints = {\n\t\t\t\t\tofferToReceiveAudio: isAudioRecvEnabled(media),\n\t\t\t\t\tofferToReceiveVideo: isVideoRecvEnabled(media)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tmediaConstraints = {\n\t\t\t\t\tmandatory: {\n\t\t\t\t\t\tOfferToReceiveAudio: isAudioRecvEnabled(media),\n\t\t\t\t\t\tOfferToReceiveVideo: isVideoRecvEnabled(media)\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tJanus.debug(mediaConstraints);\n\t\t// Check if this is Firefox and we've been asked to do simulcasting\n\t\tvar sendVideo = isVideoSendEnabled(media);\n\t\tif(sendVideo && simulcast && Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n\t\t\t// FIXME Based on https://gist.github.com/voluntas/088bc3cc62094730647b\n\t\t\tJanus.log(\"Enabling Simulcasting for Firefox (RID)\");\n\t\t\tvar sender = config.pc.getSenders()[1];\n\t\t\tJanus.log(sender);\n\t\t\tvar parameters = sender.getParameters();\n\t\t\tJanus.log(parameters);\n\n\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\tsender.setParameters({encodings: callbacks.sendEncodings || [\n\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2},\n\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4}\n\t\t\t]});\n\t\t}\n\t\tconfig.pc.createAnswer(mediaConstraints)\n\t\t\t.then(function(answer) {\n\t\t\t\tJanus.debug(answer);\n\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\tvar jsep = {\n\t\t\t\t\t\"type\": answer.type,\n\t\t\t\t\t\"sdp\": answer.sdp\n\t\t\t\t};\n\t\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\t\tanswer.sdp = jsep.sdp;\n\t\t\t\tJanus.log(\"Setting local description\");\n\t\t\t\tif(sendVideo && simulcast) {\n\t\t\t\t\t// This SDP munging only works with Chrome\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\") {\n\t\t\t\t\t\t// FIXME Apparently trying to simulcast when answering breaks video in Chrome...\n\t\t\t\t\t\t//~ Janus.log(\"Enabling Simulcasting for Chrome (SDP munging)\");\n\t\t\t\t\t\t//~ answer.sdp = mungeSdpForSimulcasting(answer.sdp);\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is an answer, and video breaks in Chrome if we enable it\");\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser !== \"firefox\") {\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is not Chrome nor Firefox, ignoring\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconfig.mySdp = answer.sdp;\n\t\t\t\tconfig.pc.setLocalDescription(answer)\n\t\t\t\t\t.catch(callbacks.error);\n\t\t\t\tconfig.mediaConstraints = mediaConstraints;\n\t\t\t\tif(!config.iceDone && !config.trickle) {\n\t\t\t\t\t// Don't do anything until we have all candidates\n\t\t\t\t\tJanus.log(\"Waiting for all candidates...\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If transforms are present, notify Janus that the media is end-to-end encrypted\n\t\t\t\tif(config.senderTransforms || config.receiverTransforms) {\n\t\t\t\t\tanswer[\"e2ee\"] = true;\n\t\t\t\t}\n\t\t\t\tcallbacks.success(answer);\n\t\t\t}, callbacks.error);\n\t}\n\n\tfunction sendSDP(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle, not sending anything\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tJanus.log(\"Sending offer/answer SDP...\");\n\t\tif(!config.mySdp) {\n\t\t\tJanus.warn(\"Local SDP instance is invalid, not sending anything...\");\n\t\t\treturn;\n\t\t}\n\t\tconfig.mySdp = {\n\t\t\t\"type\": config.pc.localDescription.type,\n\t\t\t\"sdp\": config.pc.localDescription.sdp\n\t\t};\n\t\tif(config.trickle === false)\n\t\t\tconfig.mySdp[\"trickle\"] = false;\n\t\tJanus.debug(callbacks);\n\t\tconfig.sdpSent = true;\n\t\tcallbacks.success(config.mySdp);\n\t}\n\n\tfunction getVolume(handleId, remote) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn 0;\n\t\t}\n\t\tvar stream = remote ? \"remote\" : \"local\";\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.volume[stream])\n\t\t\tconfig.volume[stream] = { value: 0 };\n\t\t// Start getting the volume, if audioLevel in getStats is supported (apparently\n\t\t// they're only available in Chrome/Safari right now: https://webrtc-stats.callstats.io/)\n\t\tif(config.pc.getStats && (Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\")) {\n\t\t\tif(remote && !config.remoteStream) {\n\t\t\t\tJanus.warn(\"Remote stream unavailable\");\n\t\t\t\treturn 0;\n\t\t\t} else if(!remote && !config.myStream) {\n\t\t\t\tJanus.warn(\"Local stream unavailable\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(!config.volume[stream].timer) {\n\t\t\t\tJanus.log(\"Starting \" + stream + \" volume monitor\");\n\t\t\t\tconfig.volume[stream].timer = setInterval(function() {\n\t\t\t\t\tconfig.pc.getStats()\n\t\t\t\t\t\t.then(function(stats) {\n\t\t\t\t\t\t\tstats.forEach(function (res) {\n\t\t\t\t\t\t\t\tif(!res || res.kind !== \"audio\")\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tif((remote && !res.remoteSource) || (!remote && res.type !== \"media-source\"))\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tconfig.volume[stream].value = (res.audioLevel ? res.audioLevel : 0);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}, 200);\n\t\t\t\treturn 0;\t// We don't have a volume to return yet\n\t\t\t}\n\t\t\treturn config.volume[stream].value;\n\t\t} else {\n\t\t\t// audioInputLevel and audioOutputLevel seem only available in Chrome? audioLevel\n\t\t\t// seems to be available on Chrome and Firefox, but they don't seem to work\n\t\t\tJanus.warn(\"Getting the \" + stream + \" volume unsupported by browser\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tfunction isMuted(handleId, video) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn true;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn true;\n\t\t}\n\t\tif(!config.myStream) {\n\t\t\tJanus.warn(\"Invalid local MediaStream\");\n\t\t\treturn true;\n\t\t}\n\t\tif(video) {\n\t\t\t// Check video track\n\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No video track\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !config.myStream.getVideoTracks()[0].enabled;\n\t\t} else {\n\t\t\t// Check audio track\n\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No audio track\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !config.myStream.getAudioTracks()[0].enabled;\n\t\t}\n\t}\n\n\tfunction mute(handleId, video, mute) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn false;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn false;\n\t\t}\n\t\tif(!config.myStream) {\n\t\t\tJanus.warn(\"Invalid local MediaStream\");\n\t\t\treturn false;\n\t\t}\n\t\tif(video) {\n\t\t\t// Mute/unmute video track\n\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No video track\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconfig.myStream.getVideoTracks()[0].enabled = !mute;\n\t\t\treturn true;\n\t\t} else {\n\t\t\t// Mute/unmute audio track\n\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No audio track\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconfig.myStream.getAudioTracks()[0].enabled = !mute;\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tfunction getBitrate(handleId) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn \"Invalid handle\";\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc)\n\t\t\treturn \"Invalid PeerConnection\";\n\t\t// Start getting the bitrate, if getStats is supported\n\t\tif(config.pc.getStats) {\n\t\t\tif(!config.bitrate.timer) {\n\t\t\t\tJanus.log(\"Starting bitrate timer (via getStats)\");\n\t\t\t\tconfig.bitrate.timer = setInterval(function() {\n\t\t\t\t\tconfig.pc.getStats()\n\t\t\t\t\t\t.then(function(stats) {\n\t\t\t\t\t\t\tstats.forEach(function (res) {\n\t\t\t\t\t\t\t\tif(!res)\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tvar inStats = false;\n\t\t\t\t\t\t\t\t// Check if these are statistics on incoming media\n\t\t\t\t\t\t\t\tif((res.mediaType === \"video\" || res.id.toLowerCase().indexOf(\"video\") > -1) &&\n\t\t\t\t\t\t\t\t\t\tres.type === \"inbound-rtp\" && res.id.indexOf(\"rtcp\") < 0) {\n\t\t\t\t\t\t\t\t\t// New stats\n\t\t\t\t\t\t\t\t\tinStats = true;\n\t\t\t\t\t\t\t\t} else if(res.type == 'ssrc' && res.bytesReceived &&\n\t\t\t\t\t\t\t\t\t\t(res.googCodecName === \"VP8\" || res.googCodecName === \"\")) {\n\t\t\t\t\t\t\t\t\t// Older Chromer versions\n\t\t\t\t\t\t\t\t\tinStats = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Parse stats now\n\t\t\t\t\t\t\t\tif(inStats) {\n\t\t\t\t\t\t\t\t\tconfig.bitrate.bsnow = res.bytesReceived;\n\t\t\t\t\t\t\t\t\tconfig.bitrate.tsnow = res.timestamp;\n\t\t\t\t\t\t\t\t\tif(config.bitrate.bsbefore === null || config.bitrate.tsbefore === null) {\n\t\t\t\t\t\t\t\t\t\t// Skip this round\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.bsbefore = config.bitrate.bsnow;\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.tsbefore = config.bitrate.tsnow;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Calculate bitrate\n\t\t\t\t\t\t\t\t\t\tvar timePassed = config.bitrate.tsnow - config.bitrate.tsbefore;\n\t\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"safari\")\n\t\t\t\t\t\t\t\t\t\t\ttimePassed = timePassed/1000;\t// Apparently the timestamp is in microseconds, in Safari\n\t\t\t\t\t\t\t\t\t\tvar bitRate = Math.round((config.bitrate.bsnow - config.bitrate.bsbefore) * 8 / timePassed);\n\t\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"safari\")\n\t\t\t\t\t\t\t\t\t\t\tbitRate = parseInt(bitRate/1000);\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.value = bitRate + ' kbits/sec';\n\t\t\t\t\t\t\t\t\t\t//~ Janus.log(\"Estimated bitrate is \" + config.bitrate.value);\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.bsbefore = config.bitrate.bsnow;\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.tsbefore = config.bitrate.tsnow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}, 1000);\n\t\t\t\treturn \"0 kbits/sec\";\t// We don't have a bitrate value yet\n\t\t\t}\n\t\t\treturn config.bitrate.value;\n\t\t} else {\n\t\t\tJanus.warn(\"Getting the video bitrate unsupported by browser\");\n\t\t\treturn \"Feature unsupported by browser\";\n\t\t}\n\t}\n\n\tfunction webrtcError(error) {\n\t\tJanus.error(\"WebRTC error:\", error);\n\t}\n\n\tfunction cleanupWebrtc(handleId, hangupRequest) {\n\t\tJanus.log(\"Cleaning WebRTC stuff\");\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle) {\n\t\t\t// Nothing to clean\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(config) {\n\t\t\tif(hangupRequest === true) {\n\t\t\t\t// Send a hangup request (we don't really care about the response)\n\t\t\t\tvar request = { \"janus\": \"hangup\", \"transaction\": Janus.randomString(12) };\n\t\t\t\tif(pluginHandle.token)\n\t\t\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\t\t\tif(apisecret)\n\t\t\t\t\trequest[\"apisecret\"] = apisecret;\n\t\t\t\tJanus.debug(\"Sending hangup request (handle=\" + handleId + \"):\");\n\t\t\t\tJanus.debug(request);\n\t\t\t\tif(websockets) {\n\t\t\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t\t} else {\n\t\t\t\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\t\t\t\tverb: 'POST',\n\t\t\t\t\t\twithCredentials: withCredentials,\n\t\t\t\t\t\tbody: request\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Cleanup stack\n\t\t\tconfig.remoteStream = null;\n\t\t\tif(config.volume) {\n\t\t\t\tif(config.volume[\"local\"] && config.volume[\"local\"].timer)\n\t\t\t\t\tclearInterval(config.volume[\"local\"].timer);\n\t\t\t\tif(config.volume[\"remote\"] && config.volume[\"remote\"].timer)\n\t\t\t\t\tclearInterval(config.volume[\"remote\"].timer);\n\t\t\t}\n\t\t\tconfig.volume = {};\n\t\t\tif(config.bitrate.timer)\n\t\t\t\tclearInterval(config.bitrate.timer);\n\t\t\tconfig.bitrate.timer = null;\n\t\t\tconfig.bitrate.bsnow = null;\n\t\t\tconfig.bitrate.bsbefore = null;\n\t\t\tconfig.bitrate.tsnow = null;\n\t\t\tconfig.bitrate.tsbefore = null;\n\t\t\tconfig.bitrate.value = null;\n\t\t\tif(!config.streamExternal && config.myStream) {\n\t\t\t\tJanus.log(\"Stopping local stream tracks\");\n\t\t\t\tJanus.stopAllTracks(config.myStream);\n\t\t\t}\n\t\t\tconfig.streamExternal = false;\n\t\t\tconfig.myStream = null;\n\t\t\t// Close PeerConnection\n\t\t\ttry {\n\t\t\t\tconfig.pc.close();\n\t\t\t} catch(e) {\n\t\t\t\t// Do nothing\n\t\t\t}\n\t\t\tconfig.pc = null;\n\t\t\tconfig.candidates = null;\n\t\t\tconfig.mySdp = null;\n\t\t\tconfig.remoteSdp = null;\n\t\t\tconfig.iceDone = false;\n\t\t\tconfig.dataChannel = {};\n\t\t\tconfig.dtmfSender = null;\n\t\t\tconfig.senderTransforms = null;\n\t\t\tconfig.receiverTransforms = null;\n\t\t}\n\t\tpluginHandle.oncleanup();\n\t}\n\n\t// Helper method to munge an SDP to enable simulcasting (Chrome only)\n\tfunction mungeSdpForSimulcasting(sdp) {\n\t\t// Let's munge the SDP to add the attributes for enabling simulcasting\n\t\t// (based on https://gist.github.com/ggarber/a19b4c33510028b9c657)\n\t\tvar lines = sdp.split(\"\\r\\n\");\n\t\tvar video = false;\n\t\tvar ssrc = [ -1 ], ssrc_fid = [ -1 ];\n\t\tvar cname = null, msid = null, mslabel = null, label = null;\n\t\tvar insertAt = -1;\n\t\tfor(var i=0; i<lines.length; i++) {\n\t\t\tvar mline = lines[i].match(/m=(\\w+) */);\n\t\t\tif(mline) {\n\t\t\t\tvar medium = mline[1];\n\t\t\t\tif(medium === \"video\") {\n\t\t\t\t\t// New video m-line: make sure it's the first one\n\t\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\t\tvideo = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// New non-video m-line: do we have what we were looking for?\n\t\t\t\t\tif(ssrc[0] > -1) {\n\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!video)\n\t\t\t\tcontinue;\n\t\t\tvar fid = lines[i].match(/a=ssrc-group:FID (\\d+) (\\d+)/);\n\t\t\tif(fid) {\n\t\t\t\tssrc[0] = fid[1];\n\t\t\t\tssrc_fid[0] = fid[2];\n\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(ssrc[0]) {\n\t\t\t\tvar match = lines[i].match('a=ssrc:' + ssrc[0] + ' cname:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tcname = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' msid:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tmsid = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' mslabel:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tmslabel = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' label:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tlabel = match[1];\n\t\t\t\t}\n\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc_fid[0]) === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc[0]) === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(lines[i].length == 0) {\n\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(ssrc[0] < 0) {\n\t\t\t// Couldn't find a FID attribute, let's just take the first video SSRC we find\n\t\t\tinsertAt = -1;\n\t\t\tvideo = false;\n\t\t\tfor(var i=0; i<lines.length; i++) {\n\t\t\t\tvar mline = lines[i].match(/m=(\\w+) */);\n\t\t\t\tif(mline) {\n\t\t\t\t\tvar medium = mline[1];\n\t\t\t\t\tif(medium === \"video\") {\n\t\t\t\t\t\t// New video m-line: make sure it's the first one\n\t\t\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\t\t\tvideo = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// New non-video m-line: do we have what we were looking for?\n\t\t\t\t\t\tif(ssrc[0] > -1) {\n\t\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(!video)\n\t\t\t\t\tcontinue;\n\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\tvar value = lines[i].match(/a=ssrc:(\\d+)/);\n\t\t\t\t\tif(value) {\n\t\t\t\t\t\tssrc[0] = value[1];\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar match = lines[i].match('a=ssrc:' + ssrc[0] + ' cname:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tcname = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' msid:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tmsid = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' mslabel:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tmslabel = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' label:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tlabel = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc_fid[0]) === 0) {\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc[0]) === 0) {\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(lines[i].length === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(ssrc[0] < 0) {\n\t\t\t// Still nothing, let's just return the SDP we were asked to munge\n\t\t\tJanus.warn(\"Couldn't find the video SSRC, simulcasting NOT enabled\");\n\t\t\treturn sdp;\n\t\t}\n\t\tif(insertAt < 0) {\n\t\t\t// Append at the end\n\t\t\tinsertAt = lines.length;\n\t\t}\n\t\t// Generate a couple of SSRCs (for retransmissions too)\n\t\t// Note: should we check if there are conflicts, here?\n\t\tssrc[1] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc[2] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc_fid[1] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc_fid[2] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\t// Add attributes to the SDP\n\t\tfor(var i=0; i<ssrc.length; i++) {\n\t\t\tif(cname) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' cname:' + cname);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(msid) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' msid:' + msid);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(mslabel) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' mslabel:' + mslabel);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(label) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' label:' + label);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\t// Add the same info for the retransmission SSRC\n\t\t\tif(cname) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' cname:' + cname);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(msid) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' msid:' + msid);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(mslabel) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' mslabel:' + mslabel);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(label) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' label:' + label);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t}\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[2] + ' ' + ssrc_fid[2]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[1] + ' ' + ssrc_fid[1]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[0] + ' ' + ssrc_fid[0]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:SIM ' + ssrc[0] + ' ' + ssrc[1] + ' ' + ssrc[2]);\n\t\tsdp = lines.join(\"\\r\\n\");\n\t\tif(!sdp.endsWith(\"\\r\\n\"))\n\t\t\tsdp += \"\\r\\n\";\n\t\treturn sdp;\n\t}\n\n\t// Helper methods to parse a media object\n\tfunction isAudioSendEnabled(media) {\n\t\tJanus.debug(\"isAudioSendEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.audio === false)\n\t\t\treturn false;\t// Generic audio has precedence\n\t\tif(media.audioSend === undefined || media.audioSend === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.audioSend === true);\n\t}\n\n\tfunction isAudioSendRequired(media) {\n\t\tJanus.debug(\"isAudioSendRequired:\", media);\n\t\tif(!media)\n\t\t\treturn false;\t// Default\n\t\tif(media.audio === false || media.audioSend === false)\n\t\t\treturn false;\t// If we're not asking to capture audio, it's not required\n\t\tif(media.failIfNoAudio === undefined || media.failIfNoAudio === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.failIfNoAudio === true);\n\t}\n\n\tfunction isAudioRecvEnabled(media) {\n\t\tJanus.debug(\"isAudioRecvEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.audio === false)\n\t\t\treturn false;\t// Generic audio has precedence\n\t\tif(media.audioRecv === undefined || media.audioRecv === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.audioRecv === true);\n\t}\n\n\tfunction isVideoSendEnabled(media) {\n\t\tJanus.debug(\"isVideoSendEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.video === false)\n\t\t\treturn false;\t// Generic video has precedence\n\t\tif(media.videoSend === undefined || media.videoSend === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.videoSend === true);\n\t}\n\n\tfunction isVideoSendRequired(media) {\n\t\tJanus.debug(\"isVideoSendRequired:\", media);\n\t\tif(!media)\n\t\t\treturn false;\t// Default\n\t\tif(media.video === false || media.videoSend === false)\n\t\t\treturn false;\t// If we're not asking to capture video, it's not required\n\t\tif(media.failIfNoVideo === undefined || media.failIfNoVideo === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.failIfNoVideo === true);\n\t}\n\n\tfunction isVideoRecvEnabled(media) {\n\t\tJanus.debug(\"isVideoRecvEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.video === false)\n\t\t\treturn false;\t// Generic video has precedence\n\t\tif(media.videoRecv === undefined || media.videoRecv === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.videoRecv === true);\n\t}\n\n\tfunction isScreenSendEnabled(media) {\n\t\tJanus.debug(\"isScreenSendEnabled:\", media);\n\t\tif (!media)\n\t\t\treturn false;\n\t\tif (typeof media.video !== 'object' || typeof media.video.mandatory !== 'object')\n\t\t\treturn false;\n\t\tvar constraints = media.video.mandatory;\n\t\tif (constraints.chromeMediaSource)\n\t\t\treturn constraints.chromeMediaSource === 'desktop' || constraints.chromeMediaSource === 'screen';\n\t\telse if (constraints.mozMediaSource)\n\t\t\treturn constraints.mozMediaSource === 'window' || constraints.mozMediaSource === 'screen';\n\t\telse if (constraints.mediaSource)\n\t\t\treturn constraints.mediaSource === 'window' || constraints.mediaSource === 'screen';\n\t\treturn false;\n\t}\n\n\tfunction isDataEnabled(media) {\n\t\tJanus.debug(\"isDataEnabled:\", media);\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\tJanus.warn(\"Edge doesn't support data channels yet\");\n\t\t\treturn false;\n\t\t}\n\t\tif(media === undefined || media === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.data === true);\n\t}\n\n\tfunction isTrickleEnabled(trickle) {\n\t\tJanus.debug(\"isTrickleEnabled:\", trickle);\n\t\treturn (trickle === false) ? false : true;\n\t}\n}\n\nexport default Janus;","import Janus from \"../../janus.js\";\nimport $ from \"jquery\";\nexport function sessionCreate(room) {\n  var self = this;\n  console.log('Trying to connect to', room)\n  Janus.init({\n    debug: \"all\",\n    callback: function () {\n      var janus = new Janus({\n        server: self.state.server,\n        success: function () {\n          // Attach to AudioBridge plugin\n          janus.attach({\n            plugin: \"janus.plugin.audiobridge\",\n            opaqueId: self.state.opaqueId,\n            success: function (pluginHandle) {\n              self.setState({ mixertest: pluginHandle , janus: janus});\n              Janus.log(\n                \"Plugin attached! (\" +\n                  self.state.mixertest.getPlugin() +\n                  \", id=\" +\n                  self.state.mixertest.getId() +\n                  \")\"\n              );\n              self.registerUsername(room);\n            },\n            error: function (error) {\n              Janus.error(\"  -- Error attaching plugin...\", error);\n            },\n            consentDialog: function (on) {\n              Janus.debug(\n                \"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\"\n              );\n            },\n            iceState: function (state) {\n              Janus.log(\"ICE state changed to \" + state);\n            },\n            mediaState: function (medium, on) {\n              Janus.log(\n                \"Janus \" +\n                  (on ? \"started\" : \"stopped\") +\n                  \" receiving our \" +\n                  medium\n              );\n            },\n            webrtcState: function (on) {\n              Janus.log(\n                \"Janus says our WebRTC PeerConnection is \" +\n                  (on ? \"up\" : \"down\") +\n                  \" now\"\n              );\n            },\n            onmessage: function (msg, jsep) {\n              Janus.debug(\" ::: Got a message :::\", msg);\n              var event = msg[\"audiobridge\"];\n              Janus.debug(\"Event: \" + event);\n              if (event) {\n                //console.log(event, msg);\n                if (event == \"talking\") {\n                  self.participantChangeStatus(msg[\"id\"], true);\n                }\n                if (event == \"stopped-talking\") {\n                  self.participantChangeStatus(msg[\"id\"], false);\n                }\n                if (event === \"joined\") {\n                  // Successfully joined, negotiate WebRTC now\n                  if (msg[\"id\"]) {\n                    self.setState({\n                      myid: msg[\"id\"],\n                    });\n                    Janus.log(\n                      \"Successfully joined room \" +\n                        msg[\"room\"] +\n                        \" with ID \" +\n                        self.state.myid + \n                        'with role:' + \n                        self.currentRole()\n                    );\n                    var role = self.currentRole();\n                    self.addParticipant(\n                      msg[\"id\"],\n                      self.state.fullname +\n                        \"§\" +\n                        self.state.userUUID +\n                        \"§\" +\n                        self.state.userColor +\n                        \"§\" +\n                        self.state.initials +\n                        \"§\" +\n                        role,\n                    );\n\n                    if (!self.state.webrtcUp) {\n                      self.setState({ webrtcUp: true });\n                      // Publish our stream\n                      self.state.mixertest.createOffer({\n                        media: {\n                          video: false,\n                          audio: { echoCancellation: true },\n                        }, // This is an audio only room\n                        success: function (jsep) {\n                          Janus.debug(\"Got SDP!\", jsep);\n                          var muted = true;\n                          if (\n                            self.state.reloadParams &&\n                            self.state.reloadParams[\"mic\"]\n                          ) {\n                            muted = false;\n                          }\n                          var publish = { request: \"configure\", muted: muted };\n                          self.state.mixertest.send({\n                            message: publish,\n                            jsep: jsep,\n                          });\n                        },\n                        error: function (error) {\n                          Janus.error(\"WebRTC error:\", error);\n                        },\n                      });\n                    }\n                  }\n                  // Any room participant?\n                  if (msg[\"participants\"]) {\n                    var list = msg[\"participants\"];\n                    Janus.debug(\"Got a list of participants:\", list);\n                    for (var f in list) {\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var setup = list[f][\"setup\"];\n                      var muted = list[f][\"muted\"];\n                      self.addParticipant(list[f][\"id\"], list[f][\"display\"]);\n                    }\n                  }\n                } else if (event === \"roomchanged\") {\n                  // The user switched to a different room\n                  self.setState({\n                    myid: msg[\"id\"],\n                  });\n                  Janus.log(\n                    \"Moved to room \" +\n                      msg[\"room\"] +\n                      \", new ID: \" +\n                      self.state.myid\n                  );\n                  if (msg[\"participants\"]) {\n                    var list = msg[\"participants\"];\n                    console.log(\">>>>>>>>>>>>>>>\");\n                    console.log(\"Got a list of participants:\", list);\n                    for (var f in list) {\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var setup = list[f][\"setup\"];\n                      var muted = list[f][\"muted\"];\n                      var role = self.currentRole();\n                      self.addParticipant(\n                        msg[\"id\"],\n                        self.state.fullname +\n                          \"§\" +\n                          self.state.userUUID +\n                          \"§\" +\n                          self.state.userColor +\n                          \"§\" +\n                          self.state.initials +\n                          \"§\" +\n                          role\n                      );\n\n                      Janus.debug(\n                        \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (setup=\" +\n                          setup +\n                          \", muted=\" +\n                          muted +\n                          \")\"\n                      );\n                    }\n                  }\n                } else if (event === \"destroyed\") {\n                  // The room has been destroyed\n                  Janus.warn(\"The room has been destroyed!\");\n                } else if (event === \"event\") {\n                  if (msg[\"participants\"]) {\n                    var list = msg[\"participants\"];\n                    Janus.debug(\"Got a list of participants:\", list);\n                    for (var f in list) {\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var setup = list[f][\"setup\"];\n                      var muted = list[f][\"muted\"];\n                      var talking = list[f][\"talking\"];\n                      Janus.debug(\n                        \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (setup=\" +\n                          setup +\n                          \", muted=\" +\n                          muted +\n                          \")\"\n                      );\n\n                      if (talking) {\n                        //console.log(\"%%%%%%%%\",list[f][\"id\"],\"is talking ...\");\n                      }\n                      if (muted) {\n                        self.participantChangeStatus(list[f][\"id\"], false);\n                      }\n                      self.addParticipant(list[f][\"id\"], list[f][\"display\"]);\n                    }\n                  } else if (msg[\"error\"]) {\n                    if (msg[\"error_code\"] === 485) {\n                      // This is a \"no such room\" error: give a more meaningful description\n                    } else {\n                    }\n                    return;\n                  }\n                  // Any new feed to attach to?\n                  if (msg[\"leaving\"]) {\n                    // One of the participants has gone away?\n                    var leaving = msg[\"leaving\"];\n                    self.removeParticipant(leaving);\n                    Janus.log(\n                      \"Participant left: \" +\n                        leaving +\n                        \" elements with ID #rp\" +\n                        leaving +\n                        \")\"\n                    );\n                    //$('#rp' + leaving).remove();\n                  }\n                }\n              }\n              if (jsep) {\n                Janus.debug(\"Handling SDP as well...\", jsep);\n                self.state.mixertest.handleRemoteJsep({ jsep: jsep });\n              }\n            },\n            onlocalstream: function (stream) {\n              Janus.debug(\" ::: Got a local stream :::\", stream);\n              self.setState({ localStream: stream });\n            },\n            onremotestream: function (stream) {\n              if ($(\"#roomaudio\").length === 0) {\n                $(\"#mixedaudio\").append(\n                  '<audio class=\"rounded centered\" id=\"roomaudio\" width=\"100%\" height=\"100%\" autoplay/>'\n                );\n                Janus.attachMediaStream(\n                  document.getElementById(\"roomaudio\"),\n                  stream\n                );\n                self.setState({ remoteStream: stream });\n              }\n            },\n            oncleanup: function () {\n              Janus.log(\" ::: Got a cleanup notification :::\");\n            },\n          });\n        },\n        error: function (error) {},\n        destroyed: function () {\n          window.location.reload();\n        },\n      });\n    },\n  });\n}\n\nexport function registerUsername(room) {\n  var self = this;\n  var role = this.currentRole();\n  var register = {\n    request: \"join\",\n    room: parseInt(room),\n    pin: self.state.pin,\n    // secret: self.state.secret,\n    display:\n      self.state.fullname +\n      \" §\" +\n      self.state.userUUID +\n      \"§\" +\n      self.state.userColor +\n      \"§\" +\n      self.state.initials +\n      \"§\" +\n      role,\n  };\n  self.state.mixertest.send({ message: register });\n  self.setState({ myId: self.state.mixertest.id, role: role });\n}\n\nexport function currentRole() {\n  var role = \"listener\";\n  if (this.state.is_speaker) {\n    role = \"speaker\";\n  }\n  if (this.state.is_presenter) {\n    role = \"presenter\";\n  }\n  if (this.state.is_moderator) {\n    role = \"moderator\";\n  }\n  return role;\n}\n\nexport function removeParticipant(id) {\n  var self = this;\n  self.setState({\n    participants: self.state.participants.filter((item) => item.id !== id),\n  });\n}\n\nexport function addParticipant(id, p) {\n  var self = this;\n  var participant = p.split(\"§\");\n  if (participant.length > 4 && this.exisitingParticipant(participant[1])) {\n    self.setState({\n      participants: self.state.participants.concat({\n        id: id,\n        display: participant[0],\n        uuid: participant[1],\n        userColor: participant[2],\n        initials: participant[3],\n        role: participant[4],\n        current: \"stopped-talking\",\n      }),\n    });\n  }\n  console.log(\"Adding Participants ...\", participant[0], participant[4]);\n}\n\nexport function exisitingParticipant(participantId) {\n  var self = this;\n  var exisiting = self.state.participants.filter(\n    (item) => item.uuid === participantId\n  );\n  if (exisiting.length === 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function participantDisplay(participantId) {\n  var self = this;\n  var exisiting = self.state.participants.filter(\n    (item) => item.uuid === participantId\n  );\n  if (exisiting.length === 0) {\n    return \"\";\n  } else {\n    return exisiting[0].display;\n  }\n}\n\nexport function participantChangeStatus(participantId, status) {\n  this.setState((prevState) => ({\n    talking: {\n      ...prevState.talking,\n      [participantId]: status,\n    },\n  }));\n}\n\nexport function participantChangeRoom(participantId, room) {\n  this.setState((prevState) => ({\n    participantRoom: {\n      ...prevState.participantRoom,\n      [participantId]: room,\n    },\n  }));\n}\n\nexport function toggleMute() {\n  var self = this;\n\n  this.setState({ muted: !this.state.muted }, () => {\n    self.state.mixertest.send({\n      message: { request: \"configure\", muted: self.state.muted },\n    });\n    if (this.state.muted) {\n      $(\"#microphone-on\").show();\n      $(\"#microphone-off\").hide();\n      $(\"#microphone-off\").css(\"color\", \"initial\");\n    } else {\n      $(\"#microphone-off\").show();\n      $(\"#microphone-off\").css(\"color\", \"black\");\n      $(\"#microphone-on\").hide();\n    }\n    console.log(\"muted\", this.state.muted, this.state.myId);\n  });\n\n  //if(self.state.muted){\n  self.participantChangeStatus(this.state.myId, false);\n  //}\n}\n\nexport function forceMute() {\n  var self = this;\n\n  this.state.mixertest.send({\n    message: { request: \"configure\", muted: true },\n  });\n  self.participantChangeStatus(this.state.myId, false);\n}\n\nexport function exitAudioRoom() {\n  var self = this;\n  console.log('exitAudioRoom')\n  if (this.state.mixertest) {\n    console.log('exitAudioRoom')\n    this.state.mixertest.send({ message: { request: \"leave\" } });\n  }\n}\n\n\n\n","/*\n\tThe MIT License (MIT)\n\n\tCopyright (c) 2016 Meetecho\n\n\tPermission is hereby granted, free of charge, to any person obtaining\n\ta copy of this software and associated documentation files (the \"Software\"),\n\tto deal in the Software without restriction, including without limitation\n\tthe rights to use, copy, modify, merge, publish, distribute, sublicense,\n\tand/or sell copies of the Software, and to permit persons to whom the\n\tSoftware is furnished to do so, subject to the following conditions:\n\n\tThe above copyright notice and this permission notice shall be included\n\tin all copies or substantial portions of the Software.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n\tOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n\tTHE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n\tOTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n\tARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n\tOTHER DEALINGS IN THE SOFTWARE.\n */\n\n// List of sessions\nimport jQuery from 'jquery';\nimport adapter from 'webrtc-adapter';\nconst RTCRtpTransceiver = window.RTCRtpTransceiver;\nJanus.sessions = {};\n\nJanus.isExtensionEnabled = function() {\n\tif(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\n\t\t// No need for the extension, getDisplayMedia is supported\n\t\treturn true;\n\t}\n\tif(window.navigator.userAgent.match('Chrome')) {\n\t\tvar chromever = parseInt(window.navigator.userAgent.match(/Chrome\\/(.*) /)[1], 10);\n\t\tvar maxver = 33;\n\t\tif(window.navigator.userAgent.match('Linux'))\n\t\t\tmaxver = 35;\t// \"known\" crash in chrome 34 and 35 on linux\n\t\tif(chromever >= 26 && chromever <= maxver) {\n\t\t\t// Older versions of Chrome don't support this extension-based approach, so lie\n\t\t\treturn true;\n\t\t}\n\t\treturn Janus.extension.isInstalled();\n\t} else {\n\t\t// Firefox and others, no need for the extension (but this doesn't mean it will work)\n\t\treturn true;\n\t}\n};\n\nvar defaultExtension = {\n\t// Screensharing Chrome Extension ID\n\textensionId: 'hapfgfdkleiggjjpfpenajgdnfckjpaj',\n\tisInstalled: function() { return document.querySelector('#janus-extension-installed') !== null; },\n\tgetScreen: function (callback) {\n\t\tvar pending = window.setTimeout(function () {\n\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\terror.name = 'The required Chrome extension is not installed: click <a href=\"#\">here</a> to install it. (NOTE: this will need you to refresh the page)';\n\t\t\treturn callback(error);\n\t\t}, 1000);\n\t\tthis.cache[pending] = callback;\n\t\twindow.postMessage({ type: 'janusGetScreen', id: pending }, '*');\n\t},\n\tinit: function () {\n\t\tvar cache = {};\n\t\tthis.cache = cache;\n\t\t// Wait for events from the Chrome Extension\n\t\twindow.addEventListener('message', function (event) {\n\t\t\tif(event.origin != window.location.origin)\n\t\t\t\treturn;\n\t\t\tif(event.data.type == 'janusGotScreen' && cache[event.data.id]) {\n\t\t\t\tvar callback = cache[event.data.id];\n\t\t\t\tdelete cache[event.data.id];\n\n\t\t\t\tif (event.data.sourceId === '') {\n\t\t\t\t\t// user canceled\n\t\t\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\t\t\terror.name = 'You cancelled the request for permission, giving up...';\n\t\t\t\t\tcallback(error);\n\t\t\t\t} else {\n\t\t\t\t\tcallback(null, event.data.sourceId);\n\t\t\t\t}\n\t\t\t} else if (event.data.type == 'janusGetScreenPending') {\n\t\t\t\tconsole.log('clearing ', event.data.id);\n\t\t\t\twindow.clearTimeout(event.data.id);\n\t\t\t}\n\t\t});\n\t}\n};\n\nJanus.UseDefaultDependencies = function (deps) {\n\tvar f = (deps && deps.fetch) || fetch;\n\tvar p = (deps && deps.Promise) || Promise;\n\tvar socketCls = (deps && deps.WebSocket) || WebSocket;\n\n\treturn {\n\t\tnewWebSocket: function(server, proto) { return new socketCls(server, proto); },\n\t\textension: (deps && deps.extension) || defaultExtension,\n\t\tisArray: function(arr) { return Array.isArray(arr); },\n\t\twebRTCAdapter: (deps && deps.adapter) || adapter,\n\t\thttpAPICall: function(url, options) {\n\t\t\tvar fetchOptions = {\n\t\t\t\tmethod: options.verb,\n\t\t\t\theaders: {\n\t\t\t\t\t'Accept': 'application/json, text/plain, */*'\n\t\t\t\t},\n\t\t\t\tcache: 'no-cache'\n\t\t\t};\n\t\t\tif(options.verb === \"POST\") {\n\t\t\t\tfetchOptions.headers['Content-Type'] = 'application/json';\n\t\t\t}\n\t\t\tif(options.withCredentials !== undefined) {\n\t\t\t\tfetchOptions.credentials = options.withCredentials === true ? 'include' : (options.withCredentials ? options.withCredentials : 'omit');\n\t\t\t}\n\t\t\tif(options.body) {\n\t\t\t\tfetchOptions.body = JSON.stringify(options.body);\n\t\t\t}\n\n\t\t\tvar fetching = f(url, fetchOptions).catch(function(error) {\n\t\t\t\treturn p.reject({message: 'Probably a network error, is the server down?', error: error});\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * fetch() does not natively support timeouts.\n\t\t\t * Work around this by starting a timeout manually, and racing it agains the fetch() to see which thing resolves first.\n\t\t\t */\n\n\t\t\tif(options.timeout) {\n\t\t\t\tvar timeout = new p(function(resolve, reject) {\n\t\t\t\t\tvar timerId = setTimeout(function() {\n\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\treturn reject({message: 'Request timed out', timeout: options.timeout});\n\t\t\t\t\t}, options.timeout);\n\t\t\t\t});\n\t\t\t\tfetching = p.race([fetching, timeout]);\n\t\t\t}\n\n\t\t\tfetching.then(function(response) {\n\t\t\t\tif(response.ok) {\n\t\t\t\t\tif(typeof(options.success) === typeof(Janus.noop)) {\n\t\t\t\t\t\treturn response.json().then(function(parsed) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\toptions.success(parsed);\n\t\t\t\t\t\t\t} catch(error) {\n\t\t\t\t\t\t\t\tJanus.error('Unhandled httpAPICall success callback error', error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, function(error) {\n\t\t\t\t\t\t\treturn p.reject({message: 'Failed to parse response body', error: error, response: response});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn p.reject({message: 'API call failed', response: response});\n\t\t\t\t}\n\t\t\t}).catch(function(error) {\n\t\t\t\tif(typeof(options.error) === typeof(Janus.noop)) {\n\t\t\t\t\toptions.error(error.message || '<< internal error >>', error);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn fetching;\n\t\t}\n\t}\n};\n\nJanus.useOldDependencies = function (deps) {\n\tvar jq = (deps && deps.jQuery) || jQuery;\n\tvar socketCls = (deps && deps.WebSocket) || WebSocket;\n\treturn {\n\t\tnewWebSocket: function(server, proto) { return new socketCls(server, proto); },\n\t\tisArray: function(arr) { return jq.isArray(arr); },\n\t\textension: (deps && deps.extension) || defaultExtension,\n\t\twebRTCAdapter: (deps && deps.adapter) || adapter,\n\t\thttpAPICall: function(url, options) {\n\t\t\tvar payload = options.body !== undefined ? {\n\t\t\t\tcontentType: 'application/json',\n\t\t\t\tdata: JSON.stringify(options.body)\n\t\t\t} : {};\n\t\t\tvar credentials = options.withCredentials !== undefined ? {xhrFields: {withCredentials: options.withCredentials}} : {};\n\n\t\t\treturn jq.ajax(jq.extend(payload, credentials, {\n\t\t\t\turl: url,\n\t\t\t\ttype: options.verb,\n\t\t\t\tcache: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: options.async,\n\t\t\t\ttimeout: options.timeout,\n\t\t\t\tsuccess: function(result) {\n\t\t\t\t\tif(typeof(options.success) === typeof(Janus.noop)) {\n\t\t\t\t\t\toptions.success(result);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function(xhr, status, err) {\n\t\t\t\t\tif(typeof(options.error) === typeof(Janus.noop)) {\n\t\t\t\t\t\toptions.error(status, err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t};\n};\n\nJanus.noop = function() {};\n\nJanus.dataChanDefaultLabel = \"JanusDataChannel\";\n\n// Note: in the future we may want to change this, e.g., as was\n// attempted in https://github.com/meetecho/janus-gateway/issues/1670\nJanus.endOfCandidates = null;\n\n// Stop all tracks from a given stream\nJanus.stopAllTracks = function(stream) {\n\ttry {\n\t\t// Try a MediaStreamTrack.stop() for each track\n\t\tvar tracks = stream.getTracks();\n\t\tfor(var mst of tracks) {\n\t\t\tJanus.log(mst);\n\t\t\tif(mst) {\n\t\t\t\tmst.stop();\n\t\t\t}\n\t\t}\n\t} catch(e) {\n\t\t// Do nothing if this fails\n\t}\n}\n\n// Initialization\nJanus.init = function(options) {\n\toptions = options || {};\n\toptions.callback = (typeof options.callback == \"function\") ? options.callback : Janus.noop;\n\tif(Janus.initDone) {\n\t\t// Already initialized\n\t\toptions.callback();\n\t} else {\n\t\tif(typeof console == \"undefined\" || typeof console.log == \"undefined\") {\n\t\t\tconsole = { log: function() {} };\n\t\t}\n\t\t// Console logging (all debugging disabled by default)\n\t\tJanus.trace = Janus.noop;\n\t\tJanus.debug = Janus.noop;\n\t\tJanus.vdebug = Janus.noop;\n\t\tJanus.log = Janus.noop;\n\t\tJanus.warn = Janus.noop;\n\t\tJanus.error = Janus.noop;\n\t\tif(options.debug === true || options.debug === \"all\") {\n\t\t\t// Enable all debugging levels\n\t\t\tJanus.trace = console.trace.bind(console);\n\t\t\tJanus.debug = console.debug.bind(console);\n\t\t\tJanus.vdebug = console.debug.bind(console);\n\t\t\tJanus.log = console.log.bind(console);\n\t\t\tJanus.warn = console.warn.bind(console);\n\t\t\tJanus.error = console.error.bind(console);\n\t\t} else if(Array.isArray(options.debug)) {\n\t\t\tfor(var d of options.debug) {\n\t\t\t\tswitch(d) {\n\t\t\t\t\tcase \"trace\":\n\t\t\t\t\t\tJanus.trace = console.trace.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"debug\":\n\t\t\t\t\t\tJanus.debug = console.debug.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"vdebug\":\n\t\t\t\t\t\tJanus.vdebug = console.debug.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\tJanus.log = console.log.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"warn\":\n\t\t\t\t\t\tJanus.warn = console.warn.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"error\":\n\t\t\t\t\t\tJanus.error = console.error.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error(\"Unknown debugging option '\" + d + \"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tJanus.log(\"Initializing library\");\n\n\t\tvar usedDependencies = options.dependencies || Janus.UseDefaultDependencies();\n\t\tJanus.isArray = usedDependencies.isArray;\n\t\tJanus.webRTCAdapter = usedDependencies.webRTCAdapter;\n\t\tJanus.httpAPICall = usedDependencies.httpAPICall;\n\t\tJanus.newWebSocket = usedDependencies.newWebSocket;\n\t\tJanus.extension = usedDependencies.extension;\n\t\tJanus.extension.init();\n\n\t\t// Helper method to enumerate devices\n\t\tJanus.listDevices = function(callback, config) {\n\t\t\tcallback = (typeof callback == \"function\") ? callback : Janus.noop;\n\t\t\tif (config == null) config = { audio: true, video: true };\n\t\t\tif(Janus.isGetUserMediaAvailable()) {\n\t\t\t\tnavigator.mediaDevices.getUserMedia(config)\n\t\t\t\t.then(function(stream) {\n\t\t\t\t\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n\t\t\t\t\t\tJanus.debug(devices);\n\t\t\t\t\t\tcallback(devices);\n\t\t\t\t\t\t// Get rid of the now useless stream\n\t\t\t\t\t\tJanus.stopAllTracks(stream)\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(function(err) {\n\t\t\t\t\tJanus.error(err);\n\t\t\t\t\tcallback([]);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tJanus.warn(\"navigator.mediaDevices unavailable\");\n\t\t\t\tcallback([]);\n\t\t\t}\n\t\t};\n\t\t// Helper methods to attach/reattach a stream to a video element (previously part of adapter.js)\n\t\tJanus.attachMediaStream = function(element, stream) {\n\t\t\ttry {\n\t\t\t\telement.srcObject = stream;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\telement.src = URL.createObjectURL(stream);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tJanus.error(\"Error attaching stream to element\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tJanus.reattachMediaStream = function(to, from) {\n\t\t\ttry {\n\t\t\t\tto.srcObject = from.srcObject;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\tto.src = from.src;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tJanus.error(\"Error reattaching stream to element\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t// Detect tab close: make sure we don't loose existing onbeforeunload handlers\n\t\t// (note: for iOS we need to subscribe to a different event, 'pagehide', see\n\t\t// https://gist.github.com/thehunmonkgroup/6bee8941a49b86be31a787fe8f4b8cfe)\n\t\tvar iOS = ['iPad', 'iPhone', 'iPod'].indexOf(navigator.platform) >= 0;\n\t\tvar eventName = iOS ? 'pagehide' : 'beforeunload';\n\t\tvar oldOBF = window[\"on\" + eventName];\n\t\twindow.addEventListener(eventName, function(event) {\n\t\t\tJanus.log(\"Closing window\");\n\t\t\tfor(var s in Janus.sessions) {\n\t\t\t\tif(Janus.sessions[s] && Janus.sessions[s].destroyOnUnload) {\n\t\t\t\t\tJanus.log(\"Destroying session \" + s);\n\t\t\t\t\tJanus.sessions[s].destroy({unload: true, notifyDestroyed: false});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(oldOBF && typeof oldOBF == \"function\") {\n\t\t\t\toldOBF();\n\t\t\t}\n\t\t});\n\t\t// If this is a Safari Technology Preview, check if VP8 is supported\n\t\tJanus.safariVp8 = false;\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'safari' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 605) {\n\t\t\t// Let's see if RTCRtpSender.getCapabilities() is there\n\t\t\tif(RTCRtpSender && RTCRtpSender.getCapabilities && RTCRtpSender.getCapabilities(\"video\") &&\n\t\t\t\t\tRTCRtpSender.getCapabilities(\"video\").codecs && RTCRtpSender.getCapabilities(\"video\").codecs.length) {\n\t\t\t\tfor(var codec of RTCRtpSender.getCapabilities(\"video\").codecs) {\n\t\t\t\t\tif(codec && codec.mimeType && codec.mimeType.toLowerCase() === \"video/vp8\") {\n\t\t\t\t\t\tJanus.safariVp8 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(Janus.safariVp8) {\n\t\t\t\t\tJanus.log(\"This version of Safari supports VP8\");\n\t\t\t\t} else {\n\t\t\t\t\tJanus.warn(\"This version of Safari does NOT support VP8: if you're using a Technology Preview, \" +\n\t\t\t\t\t\t\"try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We do it in a very ugly way, as there's no alternative...\n\t\t\t\t// We create a PeerConnection to see if VP8 is in an offer\n\t\t\t\tvar testpc = new RTCPeerConnection({});\n\t\t\t\ttestpc.createOffer({offerToReceiveVideo: true}).then(function(offer) {\n\t\t\t\t\tJanus.safariVp8 = offer.sdp.indexOf(\"VP8\") !== -1;\n\t\t\t\t\tif(Janus.safariVp8) {\n\t\t\t\t\t\tJanus.log(\"This version of Safari supports VP8\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.warn(\"This version of Safari does NOT support VP8: if you're using a Technology Preview, \" +\n\t\t\t\t\t\t\t\"try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu\");\n\t\t\t\t\t}\n\t\t\t\t\ttestpc.close();\n\t\t\t\t\ttestpc = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t// Check if this browser supports Unified Plan and transceivers\n\t\t// Based on https://codepen.io/anon/pen/ZqLwWV?editors=0010\n\t\tJanus.unifiedPlan = false;\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'firefox' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 59) {\n\t\t\t// Firefox definitely does, starting from version 59\n\t\t\tJanus.unifiedPlan = true;\n\t\t} else if(Janus.webRTCAdapter.browserDetails.browser === 'chrome' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 72) {\n\t\t\t// Chrome does, but it's only usable from version 72 on\n\t\t\tJanus.unifiedPlan = true;\n\t\t} else if(!window.RTCRtpTransceiver || !('currentDirection' in RTCRtpTransceiver.prototype)) {\n\t\t\t// Safari supports addTransceiver() but not Unified Plan when\n\t\t\t// currentDirection is not defined (see codepen above).\n\t\t\tJanus.unifiedPlan = false;\n\t\t} else {\n\t\t\t// Check if addTransceiver() throws an exception\n\t\t\tvar tempPc = new RTCPeerConnection();\n\t\t\ttry {\n\t\t\t\ttempPc.addTransceiver('audio');\n\t\t\t\tJanus.unifiedPlan = true;\n\t\t\t} catch (e) {}\n\t\t\ttempPc.close();\n\t\t}\n\t\tJanus.initDone = true;\n\t\toptions.callback();\n\t}\n};\n\n// Helper method to check whether WebRTC is supported by this browser\nJanus.isWebrtcSupported = function() {\n\treturn !!window.RTCPeerConnection;\n};\n// Helper method to check whether devices can be accessed by this browser (e.g., not possible via plain HTTP)\nJanus.isGetUserMediaAvailable = function() {\n\treturn navigator.mediaDevices && navigator.mediaDevices.getUserMedia;\n};\n\n// Helper method to create random identifiers (e.g., transaction)\nJanus.randomString = function(len) {\n\tvar charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\tvar randomString = '';\n\tfor (var i = 0; i < len; i++) {\n\t\tvar randomPoz = Math.floor(Math.random() * charSet.length);\n\t\trandomString += charSet.substring(randomPoz,randomPoz+1);\n\t}\n\treturn randomString;\n};\n\nfunction Janus(gatewayCallbacks) {\n\tgatewayCallbacks = gatewayCallbacks || {};\n\tgatewayCallbacks.success = (typeof gatewayCallbacks.success == \"function\") ? gatewayCallbacks.success : Janus.noop;\n\tgatewayCallbacks.error = (typeof gatewayCallbacks.error == \"function\") ? gatewayCallbacks.error : Janus.noop;\n\tgatewayCallbacks.destroyed = (typeof gatewayCallbacks.destroyed == \"function\") ? gatewayCallbacks.destroyed : Janus.noop;\n\tif(!Janus.initDone) {\n\t\tgatewayCallbacks.error(\"Library not initialized\");\n\t\treturn {};\n\t}\n\tif(!Janus.isWebrtcSupported()) {\n\t\tgatewayCallbacks.error(\"WebRTC not supported by this browser\");\n\t\treturn {};\n\t}\n\tJanus.log(\"Library initialized: \" + Janus.initDone);\n\tif(!gatewayCallbacks.server) {\n\t\tgatewayCallbacks.error(\"Invalid server url\");\n\t\treturn {};\n\t}\n\tvar websockets = false;\n\tvar ws = null;\n\tvar wsHandlers = {};\n\tvar wsKeepaliveTimeoutId = null;\n\tvar servers = null;\n\tvar serversIndex = 0;\n\tvar server = gatewayCallbacks.server;\n\tif(Janus.isArray(server)) {\n\t\tJanus.log(\"Multiple servers provided (\" + server.length + \"), will use the first that works\");\n\t\tserver = null;\n\t\tservers = gatewayCallbacks.server;\n\t\tJanus.debug(servers);\n\t} else {\n\t\tif(server.indexOf(\"ws\") === 0) {\n\t\t\twebsockets = true;\n\t\t\tJanus.log(\"Using WebSockets to contact Janus: \" + server);\n\t\t} else {\n\t\t\twebsockets = false;\n\t\t\tJanus.log(\"Using REST API to contact Janus: \" + server);\n\t\t}\n\t}\n\tvar iceServers = gatewayCallbacks.iceServers || [{urls: \"stun:stun.l.google.com:19302\"}];\n\tvar iceTransportPolicy = gatewayCallbacks.iceTransportPolicy;\n\tvar bundlePolicy = gatewayCallbacks.bundlePolicy;\n\t// Whether IPv6 candidates should be gathered\n\tvar ipv6Support = (gatewayCallbacks.ipv6 === true);\n\t// Whether we should enable the withCredentials flag for XHR requests\n\tvar withCredentials = false;\n\tif(gatewayCallbacks.withCredentials !== undefined && gatewayCallbacks.withCredentials !== null)\n\t\twithCredentials = gatewayCallbacks.withCredentials === true;\n\t// Optional max events\n\tvar maxev = 10;\n\tif(gatewayCallbacks.max_poll_events !== undefined && gatewayCallbacks.max_poll_events !== null)\n\t\tmaxev = gatewayCallbacks.max_poll_events;\n\tif(maxev < 1)\n\t\tmaxev = 1;\n\t// Token to use (only if the token based authentication mechanism is enabled)\n\tvar token = null;\n\tif(gatewayCallbacks.token !== undefined && gatewayCallbacks.token !== null)\n\t\ttoken = gatewayCallbacks.token;\n\t// API secret to use (only if the shared API secret is enabled)\n\tvar apisecret = null;\n\tif(gatewayCallbacks.apisecret !== undefined && gatewayCallbacks.apisecret !== null)\n\t\tapisecret = gatewayCallbacks.apisecret;\n\t// Whether we should destroy this session when onbeforeunload is called\n\tthis.destroyOnUnload = true;\n\tif(gatewayCallbacks.destroyOnUnload !== undefined && gatewayCallbacks.destroyOnUnload !== null)\n\t\tthis.destroyOnUnload = (gatewayCallbacks.destroyOnUnload === true);\n\t// Some timeout-related values\n\tvar keepAlivePeriod = 25000;\n\tif(gatewayCallbacks.keepAlivePeriod !== undefined && gatewayCallbacks.keepAlivePeriod !== null)\n\t\tkeepAlivePeriod = gatewayCallbacks.keepAlivePeriod;\n\tif(isNaN(keepAlivePeriod))\n\t\tkeepAlivePeriod = 25000;\n\tvar longPollTimeout = 60000;\n\tif(gatewayCallbacks.longPollTimeout !== undefined && gatewayCallbacks.longPollTimeout !== null)\n\t\tlongPollTimeout = gatewayCallbacks.longPollTimeout;\n\tif(isNaN(longPollTimeout))\n\t\tlongPollTimeout = 60000;\n\n\t// overrides for default maxBitrate values for simulcasting\n\tfunction getMaxBitrates(simulcastMaxBitrates) {\n\t\tvar maxBitrates = {\n\t\t\thigh: 900000,\n\t\t\tmedium: 300000,\n\t\t\tlow: 100000,\n\t\t};\n\n\t\tif (simulcastMaxBitrates !== undefined && simulcastMaxBitrates !== null) {\n\t\t\tif (simulcastMaxBitrates.high)\n\t\t\t\tmaxBitrates.high = simulcastMaxBitrates.high;\n\t\t\tif (simulcastMaxBitrates.medium)\n\t\t\t\tmaxBitrates.medium = simulcastMaxBitrates.medium;\n\t\t\tif (simulcastMaxBitrates.low)\n\t\t\t\tmaxBitrates.low = simulcastMaxBitrates.low;\n\t\t}\n\n\t\treturn maxBitrates;\n\t}\n\n\tvar connected = false;\n\tvar sessionId = null;\n\tvar pluginHandles = {};\n\tvar that = this;\n\tvar retries = 0;\n\tvar transactions = {};\n\tcreateSession(gatewayCallbacks);\n\n\t// Public methods\n\tthis.getServer = function() { return server; };\n\tthis.isConnected = function() { return connected; };\n\tthis.reconnect = function(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks[\"reconnect\"] = true;\n\t\tcreateSession(callbacks);\n\t};\n\tthis.getSessionId = function() { return sessionId; };\n\tthis.getInfo = function(callbacks) { getInfo(callbacks); };\n\tthis.destroy = function(callbacks) { destroySession(callbacks); };\n\tthis.attach = function(callbacks) { createHandle(callbacks); };\n\n\tfunction eventHandler() {\n\t\tif(sessionId == null)\n\t\t\treturn;\n\t\tJanus.debug('Long poll...');\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar longpoll = server + \"/\" + sessionId + \"?rid=\" + new Date().getTime();\n\t\tif(maxev)\n\t\t\tlongpoll = longpoll + \"&maxev=\" + maxev;\n\t\tif(token)\n\t\t\tlongpoll = longpoll + \"&token=\" + encodeURIComponent(token);\n\t\tif(apisecret)\n\t\t\tlongpoll = longpoll + \"&apisecret=\" + encodeURIComponent(apisecret);\n\t\tJanus.httpAPICall(longpoll, {\n\t\t\tverb: 'GET',\n\t\t\twithCredentials: withCredentials,\n\t\t\tsuccess: handleEvent,\n\t\t\ttimeout: longPollTimeout,\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\n\t\t\t\tretries++;\n\t\t\t\tif(retries > 3) {\n\t\t\t\t\t// Did we just lose the server? :-(\n\t\t\t\t\tconnected = false;\n\t\t\t\t\tgatewayCallbacks.error(\"Lost connection to the server (is it down?)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\teventHandler();\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private event handler: this will trigger plugin callbacks, if set\n\tfunction handleEvent(json, skipTimeout) {\n\t\tretries = 0;\n\t\tif(!websockets && sessionId !== undefined && sessionId !== null && skipTimeout !== true)\n\t\t\teventHandler();\n\t\tif(!websockets && Janus.isArray(json)) {\n\t\t\t// We got an array: it means we passed a maxev > 1, iterate on all objects\n\t\t\tfor(var i=0; i<json.length; i++) {\n\t\t\t\thandleEvent(json[i], true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(json[\"janus\"] === \"keepalive\") {\n\t\t\t// Nothing happened\n\t\t\tJanus.vdebug(\"Got a keepalive on session \" + sessionId);\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"server_info\") {\n\t\t\t// Just info on the Janus instance\n\t\t\tJanus.debug(\"Got info on the Janus instance\");\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"ack\") {\n\t\t\t// Just an ack, we can probably ignore\n\t\t\tJanus.debug(\"Got an ack on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"success\") {\n\t\t\t// Success!\n\t\t\tJanus.debug(\"Got a success on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"trickle\") {\n\t\t\t// We got a trickle candidate from Janus\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar candidate = json[\"candidate\"];\n\t\t\tJanus.debug(\"Got a trickled candidate on session \" + sessionId);\n\t\t\tJanus.debug(candidate);\n\t\t\tvar config = pluginHandle.webrtcStuff;\n\t\t\tif(config.pc && config.remoteSdp) {\n\t\t\t\t// Add candidate right now\n\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t// end-of-candidates\n\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t} else {\n\t\t\t\t\t// New candidate\n\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We didn't do setRemoteDescription (trickle got here before the offer?)\n\t\t\t\tJanus.debug(\"We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate\");\n\t\t\t\tif(!config.candidates)\n\t\t\t\t\tconfig.candidates = [];\n\t\t\t\tconfig.candidates.push(candidate);\n\t\t\t\tJanus.debug(config.candidates);\n\t\t\t}\n\t\t} else if(json[\"janus\"] === \"webrtcup\") {\n\t\t\t// The PeerConnection with the server is up! Notify this\n\t\t\tJanus.debug(\"Got a webrtcup event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.webrtcState(true);\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"hangup\") {\n\t\t\t// A plugin asked the core to hangup a PeerConnection on one of our handles\n\t\t\tJanus.debug(\"Got a hangup event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.webrtcState(false, json[\"reason\"]);\n\t\t\tpluginHandle.hangup();\n\t\t} else if(json[\"janus\"] === \"detached\") {\n\t\t\t// A plugin asked the core to detach one of our handles\n\t\t\tJanus.debug(\"Got a detached event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\t// Don't warn here because destroyHandle causes this situation.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.ondetached();\n\t\t\tpluginHandle.detach();\n\t\t} else if(json[\"janus\"] === \"media\") {\n\t\t\t// Media started/stopped flowing\n\t\t\tJanus.debug(\"Got a media event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.mediaState(json[\"type\"], json[\"receiving\"]);\n\t\t} else if(json[\"janus\"] === \"slowlink\") {\n\t\t\tJanus.debug(\"Got a slowlink event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\t// Trouble uplink or downlink\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.slowLink(json[\"uplink\"], json[\"lost\"]);\n\t\t} else if(json[\"janus\"] === \"error\") {\n\t\t\t// Oops, something wrong happened\n\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess) {\n\t\t\t\t\treportSuccess(json);\n\t\t\t\t}\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"event\") {\n\t\t\tJanus.debug(\"Got a plugin event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\tif(!plugindata) {\n\t\t\t\tJanus.warn(\"Missing plugindata...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tJanus.debug(\"  -- Event is coming from \" + sender + \" (\" + plugindata[\"plugin\"] + \")\");\n\t\t\tvar data = plugindata[\"data\"];\n\t\t\tJanus.debug(data);\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.warn(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar jsep = json[\"jsep\"];\n\t\t\tif(jsep) {\n\t\t\t\tJanus.debug(\"Handling SDP as well...\");\n\t\t\t\tJanus.debug(jsep);\n\t\t\t}\n\t\t\tvar callback = pluginHandle.onmessage;\n\t\t\tif(callback) {\n\t\t\t\tJanus.debug(\"Notifying application...\");\n\t\t\t\t// Send to callback specified when attaching plugin handle\n\t\t\t\tcallback(data, jsep);\n\t\t\t} else {\n\t\t\t\t// Send to generic callback (?)\n\t\t\t\tJanus.debug(\"No provided notification callback\");\n\t\t\t}\n\t\t} else if(json[\"janus\"] === \"timeout\") {\n\t\t\tJanus.error(\"Timeout on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tif (websockets) {\n\t\t\t\tws.close(3504, \"Gateway timeout\");\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tJanus.warn(\"Unknown message/event  '\" + json[\"janus\"] + \"' on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t}\n\t}\n\n\t// Private helper to send keep-alive messages on WebSockets\n\tfunction keepAlive() {\n\t\tif(!server || !websockets || !connected)\n\t\t\treturn;\n\t\twsKeepaliveTimeoutId = setTimeout(keepAlive, keepAlivePeriod);\n\t\tvar request = { \"janus\": \"keepalive\", \"session_id\": sessionId, \"transaction\": Janus.randomString(12) };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tws.send(JSON.stringify(request));\n\t}\n\n\t// Private method to create a session\n\tfunction createSession(callbacks) {\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"create\", \"transaction\": transaction };\n\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t// We're reconnecting, claim the session\n\t\t\tconnected = false;\n\t\t\trequest[\"janus\"] = \"claim\";\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\t// If we were using websockets, ignore the old connection\n\t\t\tif(ws) {\n\t\t\t\tws.onopen = null;\n\t\t\t\tws.onerror = null;\n\t\t\t\tws.onclose = null;\n\t\t\t\tif(wsKeepaliveTimeoutId) {\n\t\t\t\t\tclearTimeout(wsKeepaliveTimeoutId);\n\t\t\t\t\twsKeepaliveTimeoutId = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(!server && Janus.isArray(servers)) {\n\t\t\t// We still need to find a working server from the list we were given\n\t\t\tserver = servers[serversIndex];\n\t\t\tif(server.indexOf(\"ws\") === 0) {\n\t\t\t\twebsockets = true;\n\t\t\t\tJanus.log(\"Server #\" + (serversIndex+1) + \": trying WebSockets to contact Janus (\" + server + \")\");\n\t\t\t} else {\n\t\t\t\twebsockets = false;\n\t\t\t\tJanus.log(\"Server #\" + (serversIndex+1) + \": trying REST API to contact Janus (\" + server + \")\");\n\t\t\t}\n\t\t}\n\t\tif(websockets) {\n\t\t\tws = Janus.newWebSocket(server, 'janus-protocol');\n\t\t\twsHandlers = {\n\t\t\t\t'error': function() {\n\t\t\t\t\tJanus.error(\"Error connecting to the Janus WebSockets server... \" + server);\n\t\t\t\t\tif (Janus.isArray(servers) && !callbacks[\"reconnect\"]) {\n\t\t\t\t\t\tserversIndex++;\n\t\t\t\t\t\tif (serversIndex === servers.length) {\n\t\t\t\t\t\t\t// We tried all the servers the user gave us and they all failed\n\t\t\t\t\t\t\tcallbacks.error(\"Error connecting to any of the provided Janus servers: Is the server down?\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Let's try the next server\n\t\t\t\t\t\tserver = null;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tcreateSession(callbacks);\n\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcallbacks.error(\"Error connecting to the Janus WebSockets server: Is the server down?\");\n\t\t\t\t},\n\n\t\t\t\t'open': function() {\n\t\t\t\t\t// We need to be notified about the success\n\t\t\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\t\t\tJanus.debug(json);\n\t\t\t\t\t\tif (json[\"janus\"] !== \"success\") {\n\t\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\t\tcallbacks.error(json[\"error\"].reason);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twsKeepaliveTimeoutId = setTimeout(keepAlive, keepAlivePeriod);\n\t\t\t\t\t\tconnected = true;\n\t\t\t\t\t\tsessionId = json[\"session_id\"] ? json[\"session_id\"] : json.data[\"id\"];\n\t\t\t\t\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t\t\t\t\tJanus.log(\"Claimed session: \" + sessionId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tJanus.log(\"Created session: \" + sessionId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.sessions[sessionId] = that;\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t};\n\t\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t\t},\n\n\t\t\t\t'message': function(event) {\n\t\t\t\t\thandleEvent(JSON.parse(event.data));\n\t\t\t\t},\n\n\t\t\t\t'close': function() {\n\t\t\t\t\tif (!server || !connected) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconnected = false;\n\t\t\t\t\t// FIXME What if this is called when the page is closed?\n\t\t\t\t\tgatewayCallbacks.error(\"Lost connection to the server (is it down?)\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfor(var eventName in wsHandlers) {\n\t\t\t\tws.addEventListener(eventName, wsHandlers[eventName]);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconnected = true;\n\t\t\t\tsessionId = json[\"session_id\"] ? json[\"session_id\"] : json.data[\"id\"];\n\t\t\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t\t\tJanus.log(\"Claimed session: \" + sessionId);\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log(\"Created session: \" + sessionId);\n\t\t\t\t}\n\t\t\t\tJanus.sessions[sessionId] = that;\n\t\t\t\teventHandler();\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(Janus.isArray(servers) && !callbacks[\"reconnect\"]) {\n\t\t\t\t\tserversIndex++;\n\t\t\t\t\tif(serversIndex === servers.length) {\n\t\t\t\t\t\t// We tried all the servers the user gave us and they all failed\n\t\t\t\t\t\tcallbacks.error(\"Error connecting to any of the provided Janus servers: Is the server down?\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Let's try the next server\n\t\t\t\t\tserver = null;\n\t\t\t\t\tsetTimeout(function() { createSession(callbacks); }, 200);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to get info on the server\n\tfunction getInfo(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\t// FIXME This method triggers a success even when we fail\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tJanus.log(\"Getting info on Janus instance\");\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\t// We just need to send an \"info\" request\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"info\", \"transaction\": transaction };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.log(\"Server info:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"server_info\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success(json);\n\t\t\t}\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Server info:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"server_info\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success(json);\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to destroy a session\n\tfunction destroySession(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\t// FIXME This method triggers a success even when we fail\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar unload = (callbacks.unload === true);\n\t\tvar notifyDestroyed = true;\n\t\tif(callbacks.notifyDestroyed !== undefined && callbacks.notifyDestroyed !== null)\n\t\t\tnotifyDestroyed = (callbacks.notifyDestroyed === true);\n\t\tvar cleanupHandles = (callbacks.cleanupHandles === true);\n\t\tJanus.log(\"Destroying session \" + sessionId + \" (unload=\" + unload + \")\");\n\t\tif(!sessionId) {\n\t\t\tJanus.warn(\"No session to destroy\");\n\t\t\tcallbacks.success();\n\t\t\tif(notifyDestroyed)\n\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\treturn;\n\t\t}\n\t\tif(cleanupHandles) {\n\t\t\tfor(var handleId in pluginHandles)\n\t\t\t\tdestroyHandle(handleId, { noRequest: true });\n\t\t}\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tsessionId = null;\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\t// No need to destroy all handles first, Janus will do that itself\n\t\tvar request = { \"janus\": \"destroy\", \"transaction\": Janus.randomString(12) };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(unload) {\n\t\t\t// We're unloading the page: use sendBeacon for HTTP instead,\n\t\t\t// or just close the WebSocket connection if we're using that\n\t\t\tif(websockets) {\n\t\t\t\tws.onclose = null;\n\t\t\t\tws.close();\n\t\t\t\tws = null;\n\t\t\t} else {\n\t\t\t\tnavigator.sendBeacon(server + \"/\" + sessionId, JSON.stringify(request));\n\t\t\t}\n\t\t\tJanus.log(\"Destroyed session:\");\n\t\t\tsessionId = null;\n\t\t\tconnected = false;\n\t\t\tcallbacks.success();\n\t\t\tif(notifyDestroyed)\n\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\treturn;\n\t\t}\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\n\t\t\tvar unbindWebSocket = function() {\n\t\t\t\tfor(var eventName in wsHandlers) {\n\t\t\t\t\tws.removeEventListener(eventName, wsHandlers[eventName]);\n\t\t\t\t}\n\t\t\t\tws.removeEventListener('message', onUnbindMessage);\n\t\t\t\tws.removeEventListener('error', onUnbindError);\n\t\t\t\tif(wsKeepaliveTimeoutId) {\n\t\t\t\t\tclearTimeout(wsKeepaliveTimeoutId);\n\t\t\t\t}\n\t\t\t\tws.close();\n\t\t\t};\n\n\t\t\tvar onUnbindMessage = function(event){\n\t\t\t\tvar data = JSON.parse(event.data);\n\t\t\t\tif(data.session_id == request.session_id && data.transaction == request.transaction) {\n\t\t\t\t\tunbindWebSocket();\n\t\t\t\t\tcallbacks.success();\n\t\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar onUnbindError = function(event) {\n\t\t\t\tunbindWebSocket();\n\t\t\t\tcallbacks.error(\"Failed to destroy the server: Is the server down?\");\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t};\n\n\t\t\tws.addEventListener('message', onUnbindMessage);\n\t\t\tws.addEventListener('error', onUnbindError);\n\n\t\t\tif (ws.readyState === 1) {\n\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t} else {\n\t\t\t\tonUnbindError();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Destroyed session:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tsessionId = null;\n\t\t\t\tconnected = false;\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success();\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\t// Reset everything anyway\n\t\t\t\tsessionId = null;\n\t\t\t\tconnected = false;\n\t\t\t\tcallbacks.success();\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to create a plugin handle\n\tfunction createHandle(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.consentDialog = (typeof callbacks.consentDialog == \"function\") ? callbacks.consentDialog : Janus.noop;\n\t\tcallbacks.iceState = (typeof callbacks.iceState == \"function\") ? callbacks.iceState : Janus.noop;\n\t\tcallbacks.mediaState = (typeof callbacks.mediaState == \"function\") ? callbacks.mediaState : Janus.noop;\n\t\tcallbacks.webrtcState = (typeof callbacks.webrtcState == \"function\") ? callbacks.webrtcState : Janus.noop;\n\t\tcallbacks.slowLink = (typeof callbacks.slowLink == \"function\") ? callbacks.slowLink : Janus.noop;\n\t\tcallbacks.onmessage = (typeof callbacks.onmessage == \"function\") ? callbacks.onmessage : Janus.noop;\n\t\tcallbacks.onlocalstream = (typeof callbacks.onlocalstream == \"function\") ? callbacks.onlocalstream : Janus.noop;\n\t\tcallbacks.onremotestream = (typeof callbacks.onremotestream == \"function\") ? callbacks.onremotestream : Janus.noop;\n\t\tcallbacks.ondata = (typeof callbacks.ondata == \"function\") ? callbacks.ondata : Janus.noop;\n\t\tcallbacks.ondataopen = (typeof callbacks.ondataopen == \"function\") ? callbacks.ondataopen : Janus.noop;\n\t\tcallbacks.oncleanup = (typeof callbacks.oncleanup == \"function\") ? callbacks.oncleanup : Janus.noop;\n\t\tcallbacks.ondetached = (typeof callbacks.ondetached == \"function\") ? callbacks.ondetached : Janus.noop;\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar plugin = callbacks.plugin;\n\t\tif(!plugin) {\n\t\t\tJanus.error(\"Invalid plugin\");\n\t\t\tcallbacks.error(\"Invalid plugin\");\n\t\t\treturn;\n\t\t}\n\t\tvar opaqueId = callbacks.opaqueId;\n\t\tvar handleToken = callbacks.token ? callbacks.token : token;\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"attach\", \"plugin\": plugin, \"opaque_id\": opaqueId, \"transaction\": transaction };\n\t\tif(handleToken)\n\t\t\trequest[\"token\"] = handleToken;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar handleId = json.data[\"id\"];\n\t\t\t\tJanus.log(\"Created handle: \" + handleId);\n\t\t\t\tvar pluginHandle =\n\t\t\t\t\t{\n\t\t\t\t\t\tsession : that,\n\t\t\t\t\t\tplugin : plugin,\n\t\t\t\t\t\tid : handleId,\n\t\t\t\t\t\ttoken : handleToken,\n\t\t\t\t\t\tdetached : false,\n\t\t\t\t\t\twebrtcStuff : {\n\t\t\t\t\t\t\tstarted : false,\n\t\t\t\t\t\t\tmyStream : null,\n\t\t\t\t\t\t\tstreamExternal : false,\n\t\t\t\t\t\t\tremoteStream : null,\n\t\t\t\t\t\t\tmySdp : null,\n\t\t\t\t\t\t\tmediaConstraints : null,\n\t\t\t\t\t\t\tpc : null,\n\t\t\t\t\t\t\tdataChannel : {},\n\t\t\t\t\t\t\tdtmfSender : null,\n\t\t\t\t\t\t\ttrickle : true,\n\t\t\t\t\t\t\ticeDone : false,\n\t\t\t\t\t\t\tvolume : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbitrate : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\tbsnow : null,\n\t\t\t\t\t\t\t\tbsbefore : null,\n\t\t\t\t\t\t\t\ttsnow : null,\n\t\t\t\t\t\t\t\ttsbefore : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetId : function() { return handleId; },\n\t\t\t\t\t\tgetPlugin : function() { return plugin; },\n\t\t\t\t\t\tgetVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetRemoteVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetLocalVolume : function() { return getVolume(handleId, false); },\n\t\t\t\t\t\tisAudioMuted : function() { return isMuted(handleId, false); },\n\t\t\t\t\t\tmuteAudio : function() { return mute(handleId, false, true); },\n\t\t\t\t\t\tunmuteAudio : function() { return mute(handleId, false, false); },\n\t\t\t\t\t\tisVideoMuted : function() { return isMuted(handleId, true); },\n\t\t\t\t\t\tmuteVideo : function() { return mute(handleId, true, true); },\n\t\t\t\t\t\tunmuteVideo : function() { return mute(handleId, true, false); },\n\t\t\t\t\t\tgetBitrate : function() { return getBitrate(handleId); },\n\t\t\t\t\t\tsend : function(callbacks) { sendMessage(handleId, callbacks); },\n\t\t\t\t\t\tdata : function(callbacks) { sendData(handleId, callbacks); },\n\t\t\t\t\t\tdtmf : function(callbacks) { sendDtmf(handleId, callbacks); },\n\t\t\t\t\t\tconsentDialog : callbacks.consentDialog,\n\t\t\t\t\t\ticeState : callbacks.iceState,\n\t\t\t\t\t\tmediaState : callbacks.mediaState,\n\t\t\t\t\t\twebrtcState : callbacks.webrtcState,\n\t\t\t\t\t\tslowLink : callbacks.slowLink,\n\t\t\t\t\t\tonmessage : callbacks.onmessage,\n\t\t\t\t\t\tcreateOffer : function(callbacks) { prepareWebrtc(handleId, true, callbacks); },\n\t\t\t\t\t\tcreateAnswer : function(callbacks) { prepareWebrtc(handleId, false, callbacks); },\n\t\t\t\t\t\thandleRemoteJsep : function(callbacks) { prepareWebrtcPeer(handleId, callbacks); },\n\t\t\t\t\t\tonlocalstream : callbacks.onlocalstream,\n\t\t\t\t\t\tonremotestream : callbacks.onremotestream,\n\t\t\t\t\t\tondata : callbacks.ondata,\n\t\t\t\t\t\tondataopen : callbacks.ondataopen,\n\t\t\t\t\t\toncleanup : callbacks.oncleanup,\n\t\t\t\t\t\tondetached : callbacks.ondetached,\n\t\t\t\t\t\thangup : function(sendRequest) { cleanupWebrtc(handleId, sendRequest === true); },\n\t\t\t\t\t\tdetach : function(callbacks) { destroyHandle(handleId, callbacks); }\n\t\t\t\t\t};\n\t\t\t\tpluginHandles[handleId] = pluginHandle;\n\t\t\t\tcallbacks.success(pluginHandle);\n\t\t\t};\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar handleId = json.data[\"id\"];\n\t\t\t\tJanus.log(\"Created handle: \" + handleId);\n\t\t\t\tvar pluginHandle =\n\t\t\t\t\t{\n\t\t\t\t\t\tsession : that,\n\t\t\t\t\t\tplugin : plugin,\n\t\t\t\t\t\tid : handleId,\n\t\t\t\t\t\ttoken : handleToken,\n\t\t\t\t\t\tdetached : false,\n\t\t\t\t\t\twebrtcStuff : {\n\t\t\t\t\t\t\tstarted : false,\n\t\t\t\t\t\t\tmyStream : null,\n\t\t\t\t\t\t\tstreamExternal : false,\n\t\t\t\t\t\t\tremoteStream : null,\n\t\t\t\t\t\t\tmySdp : null,\n\t\t\t\t\t\t\tmediaConstraints : null,\n\t\t\t\t\t\t\tpc : null,\n\t\t\t\t\t\t\tdataChannel : {},\n\t\t\t\t\t\t\tdtmfSender : null,\n\t\t\t\t\t\t\ttrickle : true,\n\t\t\t\t\t\t\ticeDone : false,\n\t\t\t\t\t\t\tvolume : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbitrate : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\tbsnow : null,\n\t\t\t\t\t\t\t\tbsbefore : null,\n\t\t\t\t\t\t\t\ttsnow : null,\n\t\t\t\t\t\t\t\ttsbefore : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetId : function() { return handleId; },\n\t\t\t\t\t\tgetPlugin : function() { return plugin; },\n\t\t\t\t\t\tgetVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetRemoteVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetLocalVolume : function() { return getVolume(handleId, false); },\n\t\t\t\t\t\tisAudioMuted : function() { return isMuted(handleId, false); },\n\t\t\t\t\t\tmuteAudio : function() { return mute(handleId, false, true); },\n\t\t\t\t\t\tunmuteAudio : function() { return mute(handleId, false, false); },\n\t\t\t\t\t\tisVideoMuted : function() { return isMuted(handleId, true); },\n\t\t\t\t\t\tmuteVideo : function() { return mute(handleId, true, true); },\n\t\t\t\t\t\tunmuteVideo : function() { return mute(handleId, true, false); },\n\t\t\t\t\t\tgetBitrate : function() { return getBitrate(handleId); },\n\t\t\t\t\t\tsend : function(callbacks) { sendMessage(handleId, callbacks); },\n\t\t\t\t\t\tdata : function(callbacks) { sendData(handleId, callbacks); },\n\t\t\t\t\t\tdtmf : function(callbacks) { sendDtmf(handleId, callbacks); },\n\t\t\t\t\t\tconsentDialog : callbacks.consentDialog,\n\t\t\t\t\t\ticeState : callbacks.iceState,\n\t\t\t\t\t\tmediaState : callbacks.mediaState,\n\t\t\t\t\t\twebrtcState : callbacks.webrtcState,\n\t\t\t\t\t\tslowLink : callbacks.slowLink,\n\t\t\t\t\t\tonmessage : callbacks.onmessage,\n\t\t\t\t\t\tcreateOffer : function(callbacks) { prepareWebrtc(handleId, true, callbacks); },\n\t\t\t\t\t\tcreateAnswer : function(callbacks) { prepareWebrtc(handleId, false, callbacks); },\n\t\t\t\t\t\thandleRemoteJsep : function(callbacks) { prepareWebrtcPeer(handleId, callbacks); },\n\t\t\t\t\t\tonlocalstream : callbacks.onlocalstream,\n\t\t\t\t\t\tonremotestream : callbacks.onremotestream,\n\t\t\t\t\t\tondata : callbacks.ondata,\n\t\t\t\t\t\tondataopen : callbacks.ondataopen,\n\t\t\t\t\t\toncleanup : callbacks.oncleanup,\n\t\t\t\t\t\tondetached : callbacks.ondetached,\n\t\t\t\t\t\thangup : function(sendRequest) { cleanupWebrtc(handleId, sendRequest === true); },\n\t\t\t\t\t\tdetach : function(callbacks) { destroyHandle(handleId, callbacks); }\n\t\t\t\t\t}\n\t\t\t\tpluginHandles[handleId] = pluginHandle;\n\t\t\t\tcallbacks.success(pluginHandle);\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to send a message\n\tfunction sendMessage(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar message = callbacks.message;\n\t\tvar jsep = callbacks.jsep;\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"message\", \"body\": message, \"transaction\": transaction };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(jsep) {\n\t\t\trequest.jsep = {\n\t\t\t\ttype: jsep.type,\n\t\t\t\tsdp: jsep.sdp\n\t\t\t};\n\t\t\tif(jsep.e2ee)\n\t\t\t\trequest.jsep.e2ee = true;\n\t\t\tif(jsep.rid_order === \"hml\" || jsep.rid_order === \"lmh\")\n\t\t\t\trequest.jsep.rid_order = jsep.rid_order;\n\t\t}\n\t\tJanus.debug(\"Sending message to plugin (handle=\" + handleId + \"):\");\n\t\tJanus.debug(request);\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.debug(\"Message sent!\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] === \"success\") {\n\t\t\t\t\t// We got a success, must have been a synchronous transaction\n\t\t\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\t\t\tif(!plugindata) {\n\t\t\t\t\t\tJanus.warn(\"Request succeeded, but missing plugindata...\");\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Synchronous transaction successful (\" + plugindata[\"plugin\"] + \")\");\n\t\t\t\t\tvar data = plugindata[\"data\"];\n\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\tcallbacks.success(data);\n\t\t\t\t\treturn;\n\t\t\t\t} else if(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\t// Not a success and not an ack, must be an error\n\t\t\t\t\tif(json[\"error\"]) {\n\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\tcallbacks.error(json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.error(\"Unknown error\");\t// FIXME\n\t\t\t\t\t\tcallbacks.error(\"Unknown error\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If we got here, the plugin decided to handle the request asynchronously\n\t\t\t\tcallbacks.success();\n\t\t\t};\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(\"Message sent!\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] === \"success\") {\n\t\t\t\t\t// We got a success, must have been a synchronous transaction\n\t\t\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\t\t\tif(!plugindata) {\n\t\t\t\t\t\tJanus.warn(\"Request succeeded, but missing plugindata...\");\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Synchronous transaction successful (\" + plugindata[\"plugin\"] + \")\");\n\t\t\t\t\tvar data = plugindata[\"data\"];\n\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\tcallbacks.success(data);\n\t\t\t\t\treturn;\n\t\t\t\t} else if(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\t// Not a success and not an ack, must be an error\n\t\t\t\t\tif(json[\"error\"]) {\n\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\tcallbacks.error(json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.error(\"Unknown error\");\t// FIXME\n\t\t\t\t\t\tcallbacks.error(\"Unknown error\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If we got here, the plugin decided to handle the request asynchronously\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to send a trickle candidate\n\tfunction sendTrickleCandidate(handleId, candidate) {\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = { \"janus\": \"trickle\", \"candidate\": candidate, \"transaction\": Janus.randomString(12) };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tJanus.vdebug(\"Sending trickle candidate (handle=\" + handleId + \"):\");\n\t\tJanus.vdebug(request);\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.vdebug(\"Candidate sent!\");\n\t\t\t\tJanus.vdebug(json);\n\t\t\t\tif(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to create a data channel\n\tfunction createDataChannel(handleId, dclabel, dcprotocol, incoming, pendingData) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn;\n\t\t}\n\t\tvar onDataChannelMessage = function(event) {\n\t\t\tJanus.log('Received message on data channel:', event);\n\t\t\tvar label = event.target.label;\n\t\t\tpluginHandle.ondata(event.data, label);\n\t\t};\n\t\tvar onDataChannelStateChange = function(event) {\n\t\t\tJanus.log('Received state change on data channel:', event);\n\t\t\tvar label = event.target.label;\n\t\t\tvar protocol = event.target.protocol;\n\t\t\tvar dcState = config.dataChannel[label] ? config.dataChannel[label].readyState : \"null\";\n\t\t\tJanus.log('State change on <' + label + '> data channel: ' + dcState);\n\t\t\tif(dcState === 'open') {\n\t\t\t\t// Any pending messages to send?\n\t\t\t\tif(config.dataChannel[label].pending && config.dataChannel[label].pending.length > 0) {\n\t\t\t\t\tJanus.log(\"Sending pending messages on <\" + label + \">:\", config.dataChannel[label].pending.length);\n\t\t\t\t\tfor(var data of config.dataChannel[label].pending) {\n\t\t\t\t\t\tJanus.log(\"Sending data on data channel <\" + label + \">\");\n\t\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\t\tconfig.dataChannel[label].send(data);\n\t\t\t\t\t}\n\t\t\t\t\tconfig.dataChannel[label].pending = [];\n\t\t\t\t}\n\t\t\t\t// Notify the open data channel\n\t\t\t\tpluginHandle.ondataopen(label, protocol);\n\t\t\t}\n\t\t};\n\t\tvar onDataChannelError = function(error) {\n\t\t\tJanus.error('Got error on data channel:', error);\n\t\t\t// TODO\n\t\t};\n\t\tif(!incoming) {\n\t\t\t// FIXME Add options (ordered, maxRetransmits, etc.)\n\t\t\tvar dcoptions = { ordered: true };\n\t\t\tif(dcprotocol)\n\t\t\t\tdcoptions.protocol = dcprotocol;\n\t\t\tconfig.dataChannel[dclabel] = config.pc.createDataChannel(dclabel, dcoptions);\n\t\t} else {\n\t\t\t// The channel was created by Janus\n\t\t\tconfig.dataChannel[dclabel] = incoming;\n\t\t}\n\t\tconfig.dataChannel[dclabel].onmessage = onDataChannelMessage;\n\t\tconfig.dataChannel[dclabel].onopen = onDataChannelStateChange;\n\t\tconfig.dataChannel[dclabel].onclose = onDataChannelStateChange;\n\t\tconfig.dataChannel[dclabel].onerror = onDataChannelError;\n\t\tconfig.dataChannel[dclabel].pending = [];\n\t\tif(pendingData)\n\t\t\tconfig.dataChannel[dclabel].pending.push(pendingData);\n\t}\n\n\t// Private method to send a data channel message\n\tfunction sendData(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar data = callbacks.text || callbacks.data;\n\t\tif(!data) {\n\t\t\tJanus.warn(\"Invalid data\");\n\t\t\tcallbacks.error(\"Invalid data\");\n\t\t\treturn;\n\t\t}\n\t\tvar label = callbacks.label ? callbacks.label : Janus.dataChanDefaultLabel;\n\t\tif(!config.dataChannel[label]) {\n\t\t\t// Create new data channel and wait for it to open\n\t\t\tcreateDataChannel(handleId, label, callbacks.protocol, false, data, callbacks.protocol);\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(config.dataChannel[label].readyState !== \"open\") {\n\t\t\tconfig.dataChannel[label].pending.push(data);\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tJanus.log(\"Sending data on data channel <\" + label + \">\");\n\t\tJanus.debug(data);\n\t\tconfig.dataChannel[label].send(data);\n\t\tcallbacks.success();\n\t}\n\n\t// Private method to send a DTMF tone\n\tfunction sendDtmf(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.dtmfSender) {\n\t\t\t// Create the DTMF sender the proper way, if possible\n\t\t\tif(config.pc) {\n\t\t\t\tvar senders = config.pc.getSenders();\n\t\t\t\tvar audioSender = senders.find(function(sender) {\n\t\t\t\t\treturn sender.track && sender.track.kind === 'audio';\n\t\t\t\t});\n\t\t\t\tif(!audioSender) {\n\t\t\t\t\tJanus.warn(\"Invalid DTMF configuration (no audio track)\");\n\t\t\t\t\tcallbacks.error(\"Invalid DTMF configuration (no audio track)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconfig.dtmfSender = audioSender.dtmf;\n\t\t\t\tif(config.dtmfSender) {\n\t\t\t\t\tJanus.log(\"Created DTMF Sender\");\n\t\t\t\t\tconfig.dtmfSender.ontonechange = function(tone) { Janus.debug(\"Sent DTMF tone: \" + tone.tone); };\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!config.dtmfSender) {\n\t\t\t\tJanus.warn(\"Invalid DTMF configuration\");\n\t\t\t\tcallbacks.error(\"Invalid DTMF configuration\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tvar dtmf = callbacks.dtmf;\n\t\tif(!dtmf) {\n\t\t\tJanus.warn(\"Invalid DTMF parameters\");\n\t\t\tcallbacks.error(\"Invalid DTMF parameters\");\n\t\t\treturn;\n\t\t}\n\t\tvar tones = dtmf.tones;\n\t\tif(!tones) {\n\t\t\tJanus.warn(\"Invalid DTMF string\");\n\t\t\tcallbacks.error(\"Invalid DTMF string\");\n\t\t\treturn;\n\t\t}\n\t\tvar duration = (typeof dtmf.duration === 'number') ? dtmf.duration : 500; // We choose 500ms as the default duration for a tone\n\t\tvar gap = (typeof dtmf.gap === 'number') ? dtmf.gap : 50; // We choose 50ms as the default gap between tones\n\t\tJanus.debug(\"Sending DTMF string \" + tones + \" (duration \" + duration + \"ms, gap \" + gap + \"ms)\");\n\t\tconfig.dtmfSender.insertDTMF(tones, duration, gap);\n\t\tcallbacks.success();\n\t}\n\n\t// Private method to destroy a plugin handle\n\tfunction destroyHandle(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar noRequest = (callbacks.noRequest === true);\n\t\tJanus.log(\"Destroying handle \" + handleId + \" (only-locally=\" + noRequest + \")\");\n\t\tcleanupWebrtc(handleId);\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || pluginHandle.detached) {\n\t\t\t// Plugin was already detached by Janus, calling detach again will return a handle not found error, so just exit here\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tpluginHandle.detached = true;\n\t\tif(noRequest) {\n\t\t\t// We're only removing the handle locally\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = { \"janus\": \"detach\", \"transaction\": Janus.randomString(12) };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Destroyed handle:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tdelete pluginHandles[handleId];\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\t// We cleanup anyway\n\t\t\t\tdelete pluginHandles[handleId];\n\t\t\t\tcallbacks.success();\n\t\t\t}\n\t\t});\n\t}\n\n\t// WebRTC stuff\n\tfunction streamsDone(handleId, jsep, media, callbacks, stream) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\t// Close all tracks if the given stream has been created internally\n\t\t\tif(!callbacks.stream) {\n\t\t\t\tJanus.stopAllTracks(stream);\n\t\t\t}\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tJanus.debug(\"streamsDone:\", stream);\n\t\tif(stream) {\n\t\t\tJanus.debug(\"  -- Audio tracks:\", stream.getAudioTracks());\n\t\t\tJanus.debug(\"  -- Video tracks:\", stream.getVideoTracks());\n\t\t}\n\t\t// We're now capturing the new stream: check if we're updating or if it's a new thing\n\t\tvar addTracks = false;\n\t\tif(!config.myStream || !media.update || (config.streamExternal && !media.replaceAudio && !media.replaceVideo)) {\n\t\t\tconfig.myStream = stream;\n\t\t\taddTracks = true;\n\t\t} else {\n\t\t\t// We only need to update the existing stream\n\t\t\tif(((!media.update && isAudioSendEnabled(media)) || (media.update && (media.addAudio || media.replaceAudio))) &&\n\t\t\t\t\tstream.getAudioTracks() && stream.getAudioTracks().length) {\n\t\t\t\tconfig.myStream.addTrack(stream.getAudioTracks()[0]);\n\t\t\t\tif(Janus.unifiedPlan) {\n\t\t\t\t\t// Use Transceivers\n\t\t\t\t\tJanus.log((media.replaceAudio ? \"Replacing\" : \"Adding\") + \" audio track:\", stream.getAudioTracks()[0]);\n\t\t\t\t\tvar audioTransceiver = null;\n\t\t\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(audioTransceiver && audioTransceiver.sender) {\n\t\t\t\t\t\taudioTransceiver.sender.replaceTrack(stream.getAudioTracks()[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.pc.addTrack(stream.getAudioTracks()[0], stream);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log((media.replaceAudio ? \"Replacing\" : \"Adding\") + \" audio track:\", stream.getAudioTracks()[0]);\n\t\t\t\t\tconfig.pc.addTrack(stream.getAudioTracks()[0], stream);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(((!media.update && isVideoSendEnabled(media)) || (media.update && (media.addVideo || media.replaceVideo))) &&\n\t\t\t\t\tstream.getVideoTracks() && stream.getVideoTracks().length) {\n\t\t\t\tconfig.myStream.addTrack(stream.getVideoTracks()[0]);\n\t\t\t\tif(Janus.unifiedPlan) {\n\t\t\t\t\t// Use Transceivers\n\t\t\t\t\tJanus.log((media.replaceVideo ? \"Replacing\" : \"Adding\") + \" video track:\", stream.getVideoTracks()[0]);\n\t\t\t\t\tvar videoTransceiver = null;\n\t\t\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(videoTransceiver && videoTransceiver.sender) {\n\t\t\t\t\t\tvideoTransceiver.sender.replaceTrack(stream.getVideoTracks()[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.pc.addTrack(stream.getVideoTracks()[0], stream);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log((media.replaceVideo ? \"Replacing\" : \"Adding\") + \" video track:\", stream.getVideoTracks()[0]);\n\t\t\t\t\tconfig.pc.addTrack(stream.getVideoTracks()[0], stream);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// If we still need to create a PeerConnection, let's do that\n\t\tif(!config.pc) {\n\t\t\tvar pc_config = {\"iceServers\": iceServers, \"iceTransportPolicy\": iceTransportPolicy, \"bundlePolicy\": bundlePolicy};\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\") {\n\t\t\t\t// For Chrome versions before 72, we force a plan-b semantic, and unified-plan otherwise\n\t\t\t\tpc_config[\"sdpSemantics\"] = (Janus.webRTCAdapter.browserDetails.version < 72) ? \"plan-b\" : \"unified-plan\";\n\t\t\t}\n\t\t\tvar pc_constraints = {\n\t\t\t\t\"optional\": [{\"DtlsSrtpKeyAgreement\": true}]\n\t\t\t};\n\t\t\tif(ipv6Support) {\n\t\t\t\tpc_constraints.optional.push({\"googIPv6\":true});\n\t\t\t}\n\t\t\t// Any custom constraint to add?\n\t\t\tif(callbacks.rtcConstraints && typeof callbacks.rtcConstraints === 'object') {\n\t\t\t\tJanus.debug(\"Adding custom PeerConnection constraints:\", callbacks.rtcConstraints);\n\t\t\t\tfor(var i in callbacks.rtcConstraints) {\n\t\t\t\t\tpc_constraints.optional.push(callbacks.rtcConstraints[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\t\t// This is Edge, enable BUNDLE explicitly\n\t\t\t\tpc_config.bundlePolicy = \"max-bundle\";\n\t\t\t}\n\t\t\t// Check if a sender or receiver transform has been provided\n\t\t\tif(RTCRtpSender && (RTCRtpSender.prototype.createEncodedStreams ||\n\t\t\t\t\t(RTCRtpSender.prototype.createEncodedAudioStreams &&\n\t\t\t\t\tRTCRtpSender.prototype.createEncodedVideoStreams)) &&\n\t\t\t\t\t(callbacks.senderTransforms || callbacks.receiverTransforms)) {\n\t\t\t\tconfig.senderTransforms = callbacks.senderTransforms;\n\t\t\t\tconfig.receiverTransforms = callbacks.receiverTransforms;\n\t\t\t\tpc_config[\"forceEncodedAudioInsertableStreams\"] = true;\n\t\t\t\tpc_config[\"forceEncodedVideoInsertableStreams\"] = true;\n\t\t\t\tpc_config[\"encodedInsertableStreams\"] = true;\n\t\t\t}\n\t\t\tJanus.log(\"Creating PeerConnection\");\n\t\t\tJanus.debug(pc_constraints);\n\t\t\tconfig.pc = new RTCPeerConnection(pc_config, pc_constraints);\n\t\t\tJanus.debug(config.pc);\n\t\t\tif(config.pc.getStats) {\t// FIXME\n\t\t\t\tconfig.volume = {};\n\t\t\t\tconfig.bitrate.value = \"0 kbits/sec\";\n\t\t\t}\n\t\t\tJanus.log(\"Preparing local SDP and gathering candidates (trickle=\" + config.trickle + \")\");\n\t\t\tconfig.pc.oniceconnectionstatechange = function(e) {\n\t\t\t\tif(config.pc)\n\t\t\t\t\tpluginHandle.iceState(config.pc.iceConnectionState);\n\t\t\t};\n\t\t\tconfig.pc.onicecandidate = function(event) {\n\t\t\t\tif (!event.candidate ||\n\t\t\t\t\t\t(Janus.webRTCAdapter.browserDetails.browser === 'edge' && event.candidate.candidate.indexOf('endOfCandidates') > 0)) {\n\t\t\t\t\tJanus.log(\"End of candidates.\");\n\t\t\t\t\tconfig.iceDone = true;\n\t\t\t\t\tif(config.trickle === true) {\n\t\t\t\t\t\t// Notify end of candidates\n\t\t\t\t\t\tsendTrickleCandidate(handleId, {\"completed\": true});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// No trickle, time to send the complete SDP (including all candidates)\n\t\t\t\t\t\tsendSDP(handleId, callbacks);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\t\tvar candidate = {\n\t\t\t\t\t\t\"candidate\": event.candidate.candidate,\n\t\t\t\t\t\t\"sdpMid\": event.candidate.sdpMid,\n\t\t\t\t\t\t\"sdpMLineIndex\": event.candidate.sdpMLineIndex\n\t\t\t\t\t};\n\t\t\t\t\tif(config.trickle === true) {\n\t\t\t\t\t\t// Send candidate\n\t\t\t\t\t\tsendTrickleCandidate(handleId, candidate);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconfig.pc.ontrack = function(event) {\n\t\t\t\tJanus.log(\"Handling Remote Track\");\n\t\t\t\tJanus.debug(event);\n\t\t\t\tif(!event.streams)\n\t\t\t\t\treturn;\n\t\t\t\tconfig.remoteStream = event.streams[0];\n\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\tif(event.track.onended)\n\t\t\t\t\treturn;\n\t\t\t\tif(config.receiverTransforms) {\n\t\t\t\t\tvar receiverStreams = null;\n\t\t\t\t\tif(RTCRtpSender.prototype.createEncodedStreams) {\n\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedStreams();\n\t\t\t\t\t} else if(RTCRtpSender.prototype.createAudioEncodedStreams || RTCRtpSender.prototype.createEncodedVideoStreams) {\n\t\t\t\t\t\tif(event.track.kind === \"audio\" && config.receiverTransforms[\"audio\"]) {\n\t\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedAudioStreams();\n\t\t\t\t\t\t} else if(event.track.kind === \"video\" && config.receiverTransforms[\"video\"]) {\n\t\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedVideoStreams();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(receiverStreams) {\n\t\t\t\t\t\tconsole.log(receiverStreams);\n\t\t\t\t\t\tif(receiverStreams.readableStream && receiverStreams.writableStream) {\n\t\t\t\t\t\t\treceiverStreams.readableStream\n\t\t\t\t\t\t\t\t.pipeThrough(config.receiverTransforms[event.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(receiverStreams.writableStream);\n\t\t\t\t\t\t} else if(receiverStreams.readable && receiverStreams.writable) {\n\t\t\t\t\t\t\treceiverStreams.readable\n\t\t\t\t\t\t\t\t.pipeThrough(config.receiverTransforms[event.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(receiverStreams.writable);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar trackMutedTimeoutId = null;\n\t\t\t\tJanus.log(\"Adding onended callback to track:\", event.track);\n\t\t\t\tevent.track.onended = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track removed:\", ev);\n\t\t\t\t\tif(config.remoteStream) {\n\t\t\t\t\t\tclearTimeout(trackMutedTimeoutId);\n\t\t\t\t\t\tconfig.remoteStream.removeTrack(ev.target);\n\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tevent.track.onmute = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track muted:\", ev);\n\t\t\t\t\tif(config.remoteStream && trackMutedTimeoutId == null) {\n\t\t\t\t\t\ttrackMutedTimeoutId = setTimeout(function() {\n\t\t\t\t\t\t\tJanus.log(\"Removing remote track\");\n\t\t\t\t\t\t\tif (config.remoteStream) {\n\t\t\t\t\t\t\t\tconfig.remoteStream.removeTrack(ev.target);\n\t\t\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttrackMutedTimeoutId = null;\n\t\t\t\t\t\t// Chrome seems to raise mute events only at multiples of 834ms;\n\t\t\t\t\t\t// we set the timeout to three times this value (rounded to 840ms)\n\t\t\t\t\t\t}, 3 * 840);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tevent.track.onunmute = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track flowing again:\", ev);\n\t\t\t\t\tif(trackMutedTimeoutId != null) {\n\t\t\t\t\t\tclearTimeout(trackMutedTimeoutId);\n\t\t\t\t\t\ttrackMutedTimeoutId = null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconfig.remoteStream.addTrack(ev.target);\n\t\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\t\tif(addTracks && stream) {\n\t\t\tJanus.log('Adding local stream');\n\t\t\tvar simulcast2 = (callbacks.simulcast2 === true);\n\t\t\tstream.getTracks().forEach(function(track) {\n\t\t\t\tJanus.log('Adding local track:', track);\n\t\t\t\tvar sender = null;\n\t\t\t\tif(!simulcast2 || track.kind === 'audio') {\n\t\t\t\t\tsender = config.pc.addTrack(track, stream);\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log('Enabling rid-based simulcasting:', track);\n\t\t\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\t\t\tvar tr = config.pc.addTransceiver(track, {\n\t\t\t\t\t\tdirection: \"sendrecv\",\n\t\t\t\t\t\tstreams: [stream],\n\t\t\t\t\t\tsendEncodings: callbacks.sendEncodings || [\n\t\t\t\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2 },\n\t\t\t\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4 }\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t\tif(tr)\n\t\t\t\t\t\tsender = tr.sender;\n\t\t\t\t}\n\t\t\t\t// Check if insertable streams are involved\n\t\t\t\tif(sender && config.senderTransforms) {\n\t\t\t\t\tvar senderStreams = null;\n\t\t\t\t\tif(RTCRtpSender.prototype.createEncodedStreams) {\n\t\t\t\t\t\tsenderStreams = sender.createEncodedStreams();\n\t\t\t\t\t} else if(RTCRtpSender.prototype.createAudioEncodedStreams || RTCRtpSender.prototype.createEncodedVideoStreams) {\n\t\t\t\t\t\tif(sender.track.kind === \"audio\" && config.senderTransforms[\"audio\"]) {\n\t\t\t\t\t\t\tsenderStreams = sender.createEncodedAudioStreams();\n\t\t\t\t\t\t} else if(sender.track.kind === \"video\" && config.senderTransforms[\"video\"]) {\n\t\t\t\t\t\t\tsenderStreams = sender.createEncodedVideoStreams();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(senderStreams) {\n\t\t\t\t\t\tconsole.log(senderStreams);\n\t\t\t\t\t\tif(senderStreams.readableStream && senderStreams.writableStream) {\n\t\t\t\t\t\t\tsenderStreams.readableStream\n\t\t\t\t\t\t\t\t.pipeThrough(config.senderTransforms[sender.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(senderStreams.writableStream);\n\t\t\t\t\t\t} else if(senderStreams.readable && senderStreams.writable) {\n\t\t\t\t\t\t\tsenderStreams.readable\n\t\t\t\t\t\t\t\t.pipeThrough(config.senderTransforms[sender.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(senderStreams.writable);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Any data channel to create?\n\t\tif(isDataEnabled(media) && !config.dataChannel[Janus.dataChanDefaultLabel]) {\n\t\t\tJanus.log(\"Creating default data channel\");\n\t\t\tcreateDataChannel(handleId, Janus.dataChanDefaultLabel, null, false);\n\t\t\tconfig.pc.ondatachannel = function(event) {\n\t\t\t\tJanus.log(\"Data channel created by Janus:\", event);\n\t\t\t\tcreateDataChannel(handleId, event.channel.label, event.channel.protocol, event.channel);\n\t\t\t};\n\t\t}\n\t\t// If there's a new local stream, let's notify the application\n\t\tif(config.myStream) {\n\t\t\tpluginHandle.onlocalstream(config.myStream);\n\t\t}\n\t\t// Create offer/answer now\n\t\tif(!jsep) {\n\t\t\tcreateOffer(handleId, media, callbacks);\n\t\t} else {\n\t\t\tconfig.pc.setRemoteDescription(jsep)\n\t\t\t\t.then(function() {\n\t\t\t\t\tJanus.log(\"Remote description accepted!\");\n\t\t\t\t\tconfig.remoteSdp = jsep.sdp;\n\t\t\t\t\t// Any trickle candidate we cached?\n\t\t\t\t\tif(config.candidates && config.candidates.length > 0) {\n\t\t\t\t\t\tfor(var i = 0; i< config.candidates.length; i++) {\n\t\t\t\t\t\t\tvar candidate = config.candidates[i];\n\t\t\t\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t\t\t\t// end-of-candidates\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// New candidate\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.candidates = [];\n\t\t\t\t\t}\n\t\t\t\t\t// Create the answer now\n\t\t\t\t\tcreateAnswer(handleId, media, callbacks);\n\t\t\t\t}, callbacks.error);\n\t\t}\n\t}\n\n\tfunction prepareWebrtc(handleId, offer, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : webrtcError;\n\t\tvar jsep = callbacks.jsep;\n\t\tif(offer && jsep) {\n\t\t\tJanus.error(\"Provided a JSEP to a createOffer\");\n\t\t\tcallbacks.error(\"Provided a JSEP to a createOffer\");\n\t\t\treturn;\n\t\t} else if(!offer && (!jsep || !jsep.type || !jsep.sdp)) {\n\t\t\tJanus.error(\"A valid JSEP is required for createAnswer\");\n\t\t\tcallbacks.error(\"A valid JSEP is required for createAnswer\");\n\t\t\treturn;\n\t\t}\n\t\t/* Check that callbacks.media is a (not null) Object */\n\t\tcallbacks.media = (typeof callbacks.media === 'object' && callbacks.media) ? callbacks.media : { audio: true, video: true };\n\t\tvar media = callbacks.media;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tconfig.trickle = isTrickleEnabled(callbacks.trickle);\n\t\t// Are we updating a session?\n\t\tif(!config.pc) {\n\t\t\t// Nope, new PeerConnection\n\t\t\tmedia.update = false;\n\t\t\tmedia.keepAudio = false;\n\t\t\tmedia.keepVideo = false;\n\t\t} else {\n\t\t\tJanus.log(\"Updating existing media session\");\n\t\t\tmedia.update = true;\n\t\t\t// Check if there's anything to add/remove/replace, or if we\n\t\t\t// can go directly to preparing the new SDP offer or answer\n\t\t\tif(callbacks.stream) {\n\t\t\t\t// External stream: is this the same as the one we were using before?\n\t\t\t\tif(callbacks.stream !== config.myStream) {\n\t\t\t\t\tJanus.log(\"Renegotiation involves a new external stream\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Check if there are changes on audio\n\t\t\t\tif(media.addAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\tmedia.removeAudio = false;\n\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\tif(config.myStream && config.myStream.getAudioTracks() && config.myStream.getAudioTracks().length) {\n\t\t\t\t\t\tJanus.error(\"Can't add audio stream, there already is one\");\n\t\t\t\t\t\tcallbacks.error(\"Can't add audio stream, there already is one\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if(media.removeAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\tmedia.addAudio = false;\n\t\t\t\t\tmedia.audioSend = false;\n\t\t\t\t} else if(media.replaceAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.addAudio = false;\n\t\t\t\t\tmedia.removeAudio = false;\n\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t}\n\t\t\t\tif(!config.myStream) {\n\t\t\t\t\t// No media stream: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\tif(media.replaceAudio) {\n\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(isAudioSendEnabled(media)) {\n\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\t\t\t// No audio track: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\t\tif(media.replaceAudio) {\n\t\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isAudioSendEnabled(media)) {\n\t\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We have an audio track: should we keep it as it is?\n\t\t\t\t\t\tif(isAudioSendEnabled(media) &&\n\t\t\t\t\t\t\t\t!media.removeAudio && !media.replaceAudio) {\n\t\t\t\t\t\t\tmedia.keepAudio = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Check if there are changes on video\n\t\t\t\tif(media.addVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\tmedia.removeVideo = false;\n\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\tif(config.myStream && config.myStream.getVideoTracks() && config.myStream.getVideoTracks().length) {\n\t\t\t\t\t\tJanus.error(\"Can't add video stream, there already is one\");\n\t\t\t\t\t\tcallbacks.error(\"Can't add video stream, there already is one\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if(media.removeVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\tmedia.addVideo = false;\n\t\t\t\t\tmedia.videoSend = false;\n\t\t\t\t} else if(media.replaceVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.addVideo = false;\n\t\t\t\t\tmedia.removeVideo = false;\n\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t}\n\t\t\t\tif(!config.myStream) {\n\t\t\t\t\t// No media stream: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\tif(media.replaceVideo) {\n\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(isVideoSendEnabled(media)) {\n\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\t\t\t// No video track: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\t\tif(media.replaceVideo) {\n\t\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isVideoSendEnabled(media)) {\n\t\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We have a video track: should we keep it as it is?\n\t\t\t\t\t\tif(isVideoSendEnabled(media) && !media.removeVideo && !media.replaceVideo) {\n\t\t\t\t\t\t\tmedia.keepVideo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Data channels can only be added\n\t\t\t\tif(media.addData) {\n\t\t\t\t\tmedia.data = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we're updating and keeping all tracks, let's skip the getUserMedia part\n\t\t\tif((isAudioSendEnabled(media) && media.keepAudio) &&\n\t\t\t\t\t(isVideoSendEnabled(media) && media.keepVideo)) {\n\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, config.myStream);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t// If we're updating, check if we need to remove/replace one of the tracks\n\t\tif(media.update && (!config.streamExternal || (config.streamExternal && (media.replaceAudio || media.replaceVideo)))) {\n\t\t\tif(media.removeAudio || media.replaceAudio) {\n\t\t\t\tif(config.myStream && config.myStream.getAudioTracks() && config.myStream.getAudioTracks().length) {\n\t\t\t\t\tvar at = config.myStream.getAudioTracks()[0];\n\t\t\t\t\tJanus.log(\"Removing audio track:\", at);\n\t\t\t\t\tconfig.myStream.removeTrack(at);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tat.stop();\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\tif(config.pc.getSenders() && config.pc.getSenders().length) {\n\t\t\t\t\tvar ra = true;\n\t\t\t\t\tif(media.replaceAudio && Janus.unifiedPlan) {\n\t\t\t\t\t\t// We can use replaceTrack\n\t\t\t\t\t\tra = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(ra) {\n\t\t\t\t\t\tfor(var asnd of config.pc.getSenders()) {\n\t\t\t\t\t\t\tif(asnd && asnd.track && asnd.track.kind === \"audio\") {\n\t\t\t\t\t\t\t\tJanus.log(\"Removing audio sender:\", asnd);\n\t\t\t\t\t\t\t\tconfig.pc.removeTrack(asnd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(media.removeVideo || media.replaceVideo) {\n\t\t\t\tif(config.myStream && config.myStream.getVideoTracks() && config.myStream.getVideoTracks().length) {\n\t\t\t\t\tvar vt = config.myStream.getVideoTracks()[0];\n\t\t\t\t\tJanus.log(\"Removing video track:\", vt);\n\t\t\t\t\tconfig.myStream.removeTrack(vt);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvt.stop();\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\tif(config.pc.getSenders() && config.pc.getSenders().length) {\n\t\t\t\t\tvar rv = true;\n\t\t\t\t\tif(media.replaceVideo && Janus.unifiedPlan) {\n\t\t\t\t\t\t// We can use replaceTrack\n\t\t\t\t\t\trv = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(rv) {\n\t\t\t\t\t\tfor(var vsnd of config.pc.getSenders()) {\n\t\t\t\t\t\t\tif(vsnd && vsnd.track && vsnd.track.kind === \"video\") {\n\t\t\t\t\t\t\t\tJanus.log(\"Removing video sender:\", vsnd);\n\t\t\t\t\t\t\t\tconfig.pc.removeTrack(vsnd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Was a MediaStream object passed, or do we need to take care of that?\n\t\tif(callbacks.stream) {\n\t\t\tvar stream = callbacks.stream;\n\t\t\tJanus.log(\"MediaStream provided by the application\");\n\t\t\tJanus.debug(stream);\n\t\t\t// If this is an update, let's check if we need to release the previous stream\n\t\t\tif(media.update && config.myStream && config.myStream !== callbacks.stream && !config.streamExternal && !media.replaceAudio && !media.replaceVideo) {\n\t\t\t\t// We're replacing a stream we captured ourselves with an external one\n\t\t\t\tJanus.stopAllTracks(config.myStream);\n\t\t\t\tconfig.myStream = null;\n\t\t\t}\n\t\t\t// Skip the getUserMedia part\n\t\t\tconfig.streamExternal = true;\n\t\t\tpluginHandle.consentDialog(false);\n\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\treturn;\n\t\t}\n\t\tif(isAudioSendEnabled(media) || isVideoSendEnabled(media)) {\n\t\t\tif(!Janus.isGetUserMediaAvailable()) {\n\t\t\t\tcallbacks.error(\"getUserMedia not available\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar constraints = { mandatory: {}, optional: []};\n\t\t\tpluginHandle.consentDialog(true);\n\t\t\tvar audioSupport = isAudioSendEnabled(media);\n\t\t\tif(audioSupport && media && typeof media.audio === 'object')\n\t\t\t\taudioSupport = media.audio;\n\t\t\tvar videoSupport = isVideoSendEnabled(media);\n\t\t\tif(videoSupport && media) {\n\t\t\t\tvar simulcast = (callbacks.simulcast === true);\n\t\t\t\tvar simulcast2 = (callbacks.simulcast2 === true);\n\t\t\t\tif((simulcast || simulcast2) && !jsep && !media.video)\n\t\t\t\t\tmedia.video = \"hires\";\n\t\t\t\tif(media.video && media.video != 'screen' && media.video != 'window') {\n\t\t\t\t\tif(typeof media.video === 'object') {\n\t\t\t\t\t\tvideoSupport = media.video;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar width = 0;\n\t\t\t\t\t\tvar height = 0, maxHeight = 0;\n\t\t\t\t\t\tif(media.video === 'lowres') {\n\t\t\t\t\t\t\t// Small resolution, 4:3\n\t\t\t\t\t\t\theight = 240;\n\t\t\t\t\t\t\tmaxHeight = 240;\n\t\t\t\t\t\t\twidth = 320;\n\t\t\t\t\t\t} else if(media.video === 'lowres-16:9') {\n\t\t\t\t\t\t\t// Small resolution, 16:9\n\t\t\t\t\t\t\theight = 180;\n\t\t\t\t\t\t\tmaxHeight = 180;\n\t\t\t\t\t\t\twidth = 320;\n\t\t\t\t\t\t} else if(media.video === 'hires' || media.video === 'hires-16:9' || media.video === 'hdres') {\n\t\t\t\t\t\t\t// High(HD) resolution is only 16:9\n\t\t\t\t\t\t\theight = 720;\n\t\t\t\t\t\t\tmaxHeight = 720;\n\t\t\t\t\t\t\twidth = 1280;\n\t\t\t\t\t\t} else if(media.video === 'fhdres') {\n\t\t\t\t\t\t\t// Full HD resolution is only 16:9\n\t\t\t\t\t\t\theight = 1080;\n\t\t\t\t\t\t\tmaxHeight = 1080;\n\t\t\t\t\t\t\twidth = 1920;\n\t\t\t\t\t\t} else if(media.video === '4kres') {\n\t\t\t\t\t\t\t// 4K resolution is only 16:9\n\t\t\t\t\t\t\theight = 2160;\n\t\t\t\t\t\t\tmaxHeight = 2160;\n\t\t\t\t\t\t\twidth = 3840;\n\t\t\t\t\t\t} else if(media.video === 'stdres') {\n\t\t\t\t\t\t\t// Normal resolution, 4:3\n\t\t\t\t\t\t\theight = 480;\n\t\t\t\t\t\t\tmaxHeight = 480;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t} else if(media.video === 'stdres-16:9') {\n\t\t\t\t\t\t\t// Normal resolution, 16:9\n\t\t\t\t\t\t\theight = 360;\n\t\t\t\t\t\t\tmaxHeight = 360;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tJanus.log(\"Default video setting is stdres 4:3\");\n\t\t\t\t\t\t\theight = 480;\n\t\t\t\t\t\t\tmaxHeight = 480;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Adding media constraint:\", media.video);\n\t\t\t\t\t\tvideoSupport = {\n\t\t\t\t\t\t\t'height': {'ideal': height},\n\t\t\t\t\t\t\t'width': {'ideal': width}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tJanus.log(\"Adding video constraint:\", videoSupport);\n\t\t\t\t\t}\n\t\t\t\t} else if(media.video === 'screen' || media.video === 'window') {\n\t\t\t\t\tif(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\n\t\t\t\t\t\t// The new experimental getDisplayMedia API is available, let's use that\n\t\t\t\t\t\t// https://groups.google.com/forum/#!topic/discuss-webrtc/Uf0SrR4uxzk\n\t\t\t\t\t\t// https://webrtchacks.com/chrome-screensharing-getdisplaymedia/\n\t\t\t\t\t\tconstraints.video = {};\n\t\t\t\t\t\tif(media.screenshareFrameRate) {\n\t\t\t\t\t\t\tconstraints.video.frameRate = media.screenshareFrameRate;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(media.screenshareHeight) {\n\t\t\t\t\t\t\tconstraints.video.height = media.screenshareHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(media.screenshareWidth) {\n\t\t\t\t\t\t\tconstraints.video.width = media.screenshareWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconstraints.audio = media.captureDesktopAudio;\n\t\t\t\t\t\tnavigator.mediaDevices.getDisplayMedia(constraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tif(isAudioSendEnabled(media) && !media.keepAudio) {\n\t\t\t\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\t\t\t\t\t\t\t\t\t.then(function (audioStream) {\n\t\t\t\t\t\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, function (error) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// We're going to try and use the extension for Chrome 34+, the old approach\n\t\t\t\t\t// for older versions of Chrome, or the experimental support in Firefox 33+\n\t\t\t\t\tfunction callbackUserMedia (error, stream) {\n\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\tif(error) {\n\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction getScreenMedia(constraints, gsmCallback, useAudio) {\n\t\t\t\t\t\tJanus.log(\"Adding media constraint (screen capture)\");\n\t\t\t\t\t\tJanus.debug(constraints);\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tif(useAudio) {\n\t\t\t\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\t\t\t\t\t\t\t\t\t.then(function (audioStream) {\n\t\t\t\t\t\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t\t\t\t\t\t\tgsmCallback(null, stream);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tgsmCallback(null, stream);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(function(error) { pluginHandle.consentDialog(false); gsmCallback(error); });\n\t\t\t\t\t}\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'chrome') {\n\t\t\t\t\t\tvar chromever = Janus.webRTCAdapter.browserDetails.version;\n\t\t\t\t\t\tvar maxver = 33;\n\t\t\t\t\t\tif(window.navigator.userAgent.match('Linux'))\n\t\t\t\t\t\t\tmaxver = 35;\t// \"known\" crash in chrome 34 and 35 on linux\n\t\t\t\t\t\tif(chromever >= 26 && chromever <= maxver) {\n\t\t\t\t\t\t\t// Chrome 26->33 requires some awkward chrome://flags manipulation\n\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\t\t\tgoogLeakyBucket: true,\n\t\t\t\t\t\t\t\t\t\tmaxWidth: window.screen.width,\n\t\t\t\t\t\t\t\t\t\tmaxHeight: window.screen.height,\n\t\t\t\t\t\t\t\t\t\tminFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\tmaxFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\tchromeMediaSource: 'screen'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taudio: isAudioSendEnabled(media) && !media.keepAudio\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tgetScreenMedia(constraints, callbackUserMedia);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Chrome 34+ requires an extension\n\t\t\t\t\t\t\tJanus.extension.getScreen(function (error, sourceId) {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\t\treturn callbacks.error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\t\taudio: false,\n\t\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\t\t\t\tchromeMediaSource: 'desktop',\n\t\t\t\t\t\t\t\t\t\t\tmaxWidth: window.screen.width,\n\t\t\t\t\t\t\t\t\t\t\tmaxHeight: window.screen.height,\n\t\t\t\t\t\t\t\t\t\t\tminFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\t\tmaxFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\toptional: [\n\t\t\t\t\t\t\t\t\t\t\t{googLeakyBucket: true},\n\t\t\t\t\t\t\t\t\t\t\t{googTemporalLayeredScreencast: true}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tconstraints.video.mandatory.chromeMediaSourceId = sourceId;\n\t\t\t\t\t\t\t\tgetScreenMedia(constraints, callbackUserMedia,\n\t\t\t\t\t\t\t\t\tisAudioSendEnabled(media) && !media.keepAudio);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser === 'firefox') {\n\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.version >= 33) {\n\t\t\t\t\t\t\t// Firefox 33+ has experimental support for screen sharing\n\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\tmozMediaSource: media.video,\n\t\t\t\t\t\t\t\t\tmediaSource: media.video\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taudio: isAudioSendEnabled(media) && !media.keepAudio\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tgetScreenMedia(constraints, function (err, stream) {\n\t\t\t\t\t\t\t\tcallbackUserMedia(err, stream);\n\t\t\t\t\t\t\t\t// Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1045810\n\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\tvar lastTime = stream.currentTime;\n\t\t\t\t\t\t\t\t\tvar polly = window.setInterval(function () {\n\t\t\t\t\t\t\t\t\t\tif(!stream)\n\t\t\t\t\t\t\t\t\t\t\twindow.clearInterval(polly);\n\t\t\t\t\t\t\t\t\t\tif(stream.currentTime == lastTime) {\n\t\t\t\t\t\t\t\t\t\t\twindow.clearInterval(polly);\n\t\t\t\t\t\t\t\t\t\t\tif(stream.onended) {\n\t\t\t\t\t\t\t\t\t\t\t\tstream.onended();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tlastTime = stream.currentTime;\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\t\t\t\t\terror.name = 'Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)';\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we got here, we're not screensharing\n\t\t\tif(!media || media.video !== 'screen') {\n\t\t\t\t// Check whether all media sources are actually available or not\n\t\t\t\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n\t\t\t\t\tvar audioExist = devices.some(function(device) {\n\t\t\t\t\t\treturn device.kind === 'audioinput';\n\t\t\t\t\t}),\n\t\t\t\t\tvideoExist = isScreenSendEnabled(media) || devices.some(function(device) {\n\t\t\t\t\t\treturn device.kind === 'videoinput';\n\t\t\t\t\t});\n\n\t\t\t\t\t// Check whether a missing device is really a problem\n\t\t\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\t\t\tvar needAudioDevice = isAudioSendRequired(media);\n\t\t\t\t\tvar needVideoDevice = isVideoSendRequired(media);\n\t\t\t\t\tif(audioSend || videoSend || needAudioDevice || needVideoDevice) {\n\t\t\t\t\t\t// We need to send either audio or video\n\t\t\t\t\t\tvar haveAudioDevice = audioSend ? audioExist : false;\n\t\t\t\t\t\tvar haveVideoDevice = videoSend ? videoExist : false;\n\t\t\t\t\t\tif(!haveAudioDevice && !haveVideoDevice) {\n\t\t\t\t\t\t\t// FIXME Should we really give up, or just assume recvonly for both?\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('No capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if(!haveAudioDevice && needAudioDevice) {\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('Audio capture is required, but no capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if(!haveVideoDevice && needVideoDevice) {\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('Video capture is required, but no capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar gumConstraints = {\n\t\t\t\t\t\taudio: (audioExist && !media.keepAudio) ? audioSupport : false,\n\t\t\t\t\t\tvideo: (videoExist && !media.keepVideo) ? videoSupport : false\n\t\t\t\t\t};\n\t\t\t\t\tJanus.debug(\"getUserMedia constraints\", gumConstraints);\n\t\t\t\t\tif (!gumConstraints.audio && !gumConstraints.video) {\n\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia(gumConstraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tcallbacks.error({code: error.code, name: error.name, message: error.message});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function(error) {\n\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\t// No need to do a getUserMedia, create offer/answer right away\n\t\t\tstreamsDone(handleId, jsep, media, callbacks);\n\t\t}\n\t}\n\n\tfunction prepareWebrtcPeer(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : webrtcError;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar jsep = callbacks.jsep;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(jsep) {\n\t\t\tif(!config.pc) {\n\t\t\t\tJanus.warn(\"Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep\");\n\t\t\t\tcallbacks.error(\"No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\tconfig.pc.setRemoteDescription(jsep)\n\t\t\t\t.then(function() {\n\t\t\t\t\tJanus.log(\"Remote description accepted!\");\n\t\t\t\t\tconfig.remoteSdp = jsep.sdp;\n\t\t\t\t\t// Any trickle candidate we cached?\n\t\t\t\t\tif(config.candidates && config.candidates.length > 0) {\n\t\t\t\t\t\tfor(var i = 0; i< config.candidates.length; i++) {\n\t\t\t\t\t\t\tvar candidate = config.candidates[i];\n\t\t\t\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t\t\t\t// end-of-candidates\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// New candidate\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.candidates = [];\n\t\t\t\t\t}\n\t\t\t\t\t// Done\n\t\t\t\t\tcallbacks.success();\n\t\t\t\t}, callbacks.error);\n\t\t} else {\n\t\t\tcallbacks.error(\"Invalid JSEP\");\n\t\t}\n\t}\n\n\tfunction createOffer(handleId, media, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar simulcast = (callbacks.simulcast === true);\n\t\tif(!simulcast) {\n\t\t\tJanus.log(\"Creating offer (iceDone=\" + config.iceDone + \")\");\n\t\t} else {\n\t\t\tJanus.log(\"Creating offer (iceDone=\" + config.iceDone + \", simulcast=\" + simulcast + \")\");\n\t\t}\n\t\t// https://code.google.com/p/webrtc/issues/detail?id=3508\n\t\tvar mediaConstraints = {};\n\t\tif(Janus.unifiedPlan) {\n\t\t\t// We can use Transceivers\n\t\t\tvar audioTransceiver = null, videoTransceiver = null;\n\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\tif(!audioTransceiver) {\n\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\tif(!videoTransceiver) {\n\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle audio (and related changes, if any)\n\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\tvar audioRecv = isAudioRecvEnabled(media);\n\t\t\tif(!audioSend && !audioRecv) {\n\t\t\t\t// Audio disabled: have we removed it?\n\t\t\t\tif(media.removeAudio && audioTransceiver) {\n\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\taudioTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\taudioTransceiver.direction = \"inactive\";\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Setting audio transceiver to inactive:\", audioTransceiver);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of audio m-line\n\t\t\t\tif(audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendrecv:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(audioSend && !audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendonly:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(!audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to recvonly:\", audioTransceiver);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\taudioTransceiver = config.pc.addTransceiver(\"audio\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly audio transceiver:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle video (and related changes, if any)\n\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\tvar videoRecv = isVideoRecvEnabled(media);\n\t\t\tif(!videoSend && !videoRecv) {\n\t\t\t\t// Video disabled: have we removed it?\n\t\t\t\tif(media.removeVideo && videoTransceiver) {\n\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\tvideoTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvideoTransceiver.direction = \"inactive\";\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Setting video transceiver to inactive:\", videoTransceiver);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of video m-line\n\t\t\t\tif(videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendrecv:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(videoSend && !videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendonly:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(!videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to recvonly:\", videoTransceiver);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\tvideoTransceiver = config.pc.addTransceiver(\"video\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly video transceiver:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tmediaConstraints[\"offerToReceiveAudio\"] = isAudioRecvEnabled(media);\n\t\t\tmediaConstraints[\"offerToReceiveVideo\"] = isVideoRecvEnabled(media);\n\t\t}\n\t\tvar iceRestart = (callbacks.iceRestart === true);\n\t\tif(iceRestart) {\n\t\t\tmediaConstraints[\"iceRestart\"] = true;\n\t\t}\n\t\tJanus.debug(mediaConstraints);\n\t\t// Check if this is Firefox and we've been asked to do simulcasting\n\t\tvar sendVideo = isVideoSendEnabled(media);\n\t\tif(sendVideo && simulcast && Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n\t\t\t// FIXME Based on https://gist.github.com/voluntas/088bc3cc62094730647b\n\t\t\tJanus.log(\"Enabling Simulcasting for Firefox (RID)\");\n\t\t\tvar sender = config.pc.getSenders().find(function(s) {return s.track && s.track.kind === \"video\"});\n\t\t\tif(sender) {\n\t\t\t\tvar parameters = sender.getParameters();\n\t\t\t\tif(!parameters) {\n\t\t\t\t\tparameters = {};\n\t\t\t\t}\n\t\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\t\tparameters.encodings = callbacks.sendEncodings || [\n\t\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2 },\n\t\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4 }\n\t\t\t\t];\n\t\t\t\tsender.setParameters(parameters);\n\t\t\t}\n\t\t}\n\t\tconfig.pc.createOffer(mediaConstraints)\n\t\t\t.then(function(offer) {\n\t\t\t\tJanus.debug(offer);\n\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\tvar jsep = {\n\t\t\t\t\t\"type\": offer.type,\n\t\t\t\t\t\"sdp\": offer.sdp\n\t\t\t\t};\n\t\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\t\toffer.sdp = jsep.sdp;\n\t\t\t\tJanus.log(\"Setting local description\");\n\t\t\t\tif(sendVideo && simulcast) {\n\t\t\t\t\t// This SDP munging only works with Chrome (Safari STP may support it too)\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n\t\t\t\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\") {\n\t\t\t\t\t\tJanus.log(\"Enabling Simulcasting for Chrome (SDP munging)\");\n\t\t\t\t\t\toffer.sdp = mungeSdpForSimulcasting(offer.sdp);\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser !== \"firefox\") {\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is not Chrome nor Firefox, ignoring\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconfig.mySdp = {\n\t\t\t\t\ttype: \"offer\",\n\t\t\t\t\tsdp: offer.sdp\n\t\t\t\t};\n\t\t\t\tconfig.pc.setLocalDescription(offer)\n\t\t\t\t\t.catch(callbacks.error);\n\t\t\t\tconfig.mediaConstraints = mediaConstraints;\n\t\t\t\tif(!config.iceDone && !config.trickle) {\n\t\t\t\t\t// Don't do anything until we have all candidates\n\t\t\t\t\tJanus.log(\"Waiting for all candidates...\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If transforms are present, notify Janus that the media is end-to-end encrypted\n\t\t\t\tif(config.senderTransforms || config.receiverTransforms) {\n\t\t\t\t\toffer[\"e2ee\"] = true;\n\t\t\t\t}\n\t\t\t\tcallbacks.success(offer);\n\t\t\t}, callbacks.error);\n\t}\n\n\tfunction createAnswer(handleId, media, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar simulcast = (callbacks.simulcast === true);\n\t\tif(!simulcast) {\n\t\t\tJanus.log(\"Creating answer (iceDone=\" + config.iceDone + \")\");\n\t\t} else {\n\t\t\tJanus.log(\"Creating answer (iceDone=\" + config.iceDone + \", simulcast=\" + simulcast + \")\");\n\t\t}\n\t\tvar mediaConstraints = null;\n\t\tif(Janus.unifiedPlan) {\n\t\t\t// We can use Transceivers\n\t\t\tmediaConstraints = {};\n\t\t\tvar audioTransceiver = null, videoTransceiver = null;\n\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\tif(!audioTransceiver)\n\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\tif(!videoTransceiver)\n\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle audio (and related changes, if any)\n\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\tvar audioRecv = isAudioRecvEnabled(media);\n\t\t\tif(!audioSend && !audioRecv) {\n\t\t\t\t// Audio disabled: have we removed it?\n\t\t\t\tif(media.removeAudio && audioTransceiver) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"inactive\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to inactive:\", audioTransceiver);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of audio m-line\n\t\t\t\tif(audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendrecv:\", audioTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(audioSend && !audioRecv) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendonly:\", audioTransceiver);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t} else if(!audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to recvonly:\", audioTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\taudioTransceiver = config.pc.addTransceiver(\"audio\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly audio transceiver:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle video (and related changes, if any)\n\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\tvar videoRecv = isVideoRecvEnabled(media);\n\t\t\tif(!videoSend && !videoRecv) {\n\t\t\t\t// Video disabled: have we removed it?\n\t\t\t\tif(media.removeVideo && videoTransceiver) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"inactive\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to inactive:\", videoTransceiver);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of video m-line\n\t\t\t\tif(videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendrecv:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(videoSend && !videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendonly:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(!videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to recvonly:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\tvideoTransceiver = config.pc.addTransceiver(\"video\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly video transceiver:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"firefox\" || Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\t\tmediaConstraints = {\n\t\t\t\t\tofferToReceiveAudio: isAudioRecvEnabled(media),\n\t\t\t\t\tofferToReceiveVideo: isVideoRecvEnabled(media)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tmediaConstraints = {\n\t\t\t\t\tmandatory: {\n\t\t\t\t\t\tOfferToReceiveAudio: isAudioRecvEnabled(media),\n\t\t\t\t\t\tOfferToReceiveVideo: isVideoRecvEnabled(media)\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tJanus.debug(mediaConstraints);\n\t\t// Check if this is Firefox and we've been asked to do simulcasting\n\t\tvar sendVideo = isVideoSendEnabled(media);\n\t\tif(sendVideo && simulcast && Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n\t\t\t// FIXME Based on https://gist.github.com/voluntas/088bc3cc62094730647b\n\t\t\tJanus.log(\"Enabling Simulcasting for Firefox (RID)\");\n\t\t\tvar sender = config.pc.getSenders()[1];\n\t\t\tJanus.log(sender);\n\t\t\tvar parameters = sender.getParameters();\n\t\t\tJanus.log(parameters);\n\n\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\tsender.setParameters({encodings: callbacks.sendEncodings || [\n\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2},\n\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4}\n\t\t\t]});\n\t\t}\n\t\tconfig.pc.createAnswer(mediaConstraints)\n\t\t\t.then(function(answer) {\n\t\t\t\tJanus.debug(answer);\n\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\tvar jsep = {\n\t\t\t\t\t\"type\": answer.type,\n\t\t\t\t\t\"sdp\": answer.sdp\n\t\t\t\t};\n\t\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\t\tanswer.sdp = jsep.sdp;\n\t\t\t\tJanus.log(\"Setting local description\");\n\t\t\t\tif(sendVideo && simulcast) {\n\t\t\t\t\t// This SDP munging only works with Chrome\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\") {\n\t\t\t\t\t\t// FIXME Apparently trying to simulcast when answering breaks video in Chrome...\n\t\t\t\t\t\t//~ Janus.log(\"Enabling Simulcasting for Chrome (SDP munging)\");\n\t\t\t\t\t\t//~ answer.sdp = mungeSdpForSimulcasting(answer.sdp);\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is an answer, and video breaks in Chrome if we enable it\");\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser !== \"firefox\") {\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is not Chrome nor Firefox, ignoring\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconfig.mySdp = {\n\t\t\t\t\ttype: \"answer\",\n\t\t\t\t\tsdp: answer.sdp\n\t\t\t\t};\n\t\t\t\tconfig.pc.setLocalDescription(answer)\n\t\t\t\t\t.catch(callbacks.error);\n\t\t\t\tconfig.mediaConstraints = mediaConstraints;\n\t\t\t\tif(!config.iceDone && !config.trickle) {\n\t\t\t\t\t// Don't do anything until we have all candidates\n\t\t\t\t\tJanus.log(\"Waiting for all candidates...\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If transforms are present, notify Janus that the media is end-to-end encrypted\n\t\t\t\tif(config.senderTransforms || config.receiverTransforms) {\n\t\t\t\t\tanswer[\"e2ee\"] = true;\n\t\t\t\t}\n\t\t\t\tcallbacks.success(answer);\n\t\t\t}, callbacks.error);\n\t}\n\n\tfunction sendSDP(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle, not sending anything\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tJanus.log(\"Sending offer/answer SDP...\");\n\t\tif(!config.mySdp) {\n\t\t\tJanus.warn(\"Local SDP instance is invalid, not sending anything...\");\n\t\t\treturn;\n\t\t}\n\t\tconfig.mySdp = {\n\t\t\t\"type\": config.pc.localDescription.type,\n\t\t\t\"sdp\": config.pc.localDescription.sdp\n\t\t};\n\t\tif(config.trickle === false)\n\t\t\tconfig.mySdp[\"trickle\"] = false;\n\t\tJanus.debug(callbacks);\n\t\tconfig.sdpSent = true;\n\t\tcallbacks.success(config.mySdp);\n\t}\n\n\tfunction getVolume(handleId, remote) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn 0;\n\t\t}\n\t\tvar stream = remote ? \"remote\" : \"local\";\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.volume[stream])\n\t\t\tconfig.volume[stream] = { value: 0 };\n\t\t// Start getting the volume, if audioLevel in getStats is supported (apparently\n\t\t// they're only available in Chrome/Safari right now: https://webrtc-stats.callstats.io/)\n\t\tif(config.pc.getStats && (Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\")) {\n\t\t\tif(remote && !config.remoteStream) {\n\t\t\t\tJanus.warn(\"Remote stream unavailable\");\n\t\t\t\treturn 0;\n\t\t\t} else if(!remote && !config.myStream) {\n\t\t\t\tJanus.warn(\"Local stream unavailable\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(!config.volume[stream].timer) {\n\t\t\t\tJanus.log(\"Starting \" + stream + \" volume monitor\");\n\t\t\t\tconfig.volume[stream].timer = setInterval(function() {\n\t\t\t\t\tconfig.pc.getStats()\n\t\t\t\t\t\t.then(function(stats) {\n\t\t\t\t\t\t\tstats.forEach(function (res) {\n\t\t\t\t\t\t\t\tif(!res || res.kind !== \"audio\")\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tif((remote && !res.remoteSource) || (!remote && res.type !== \"media-source\"))\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tconfig.volume[stream].value = (res.audioLevel ? res.audioLevel : 0);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}, 200);\n\t\t\t\treturn 0;\t// We don't have a volume to return yet\n\t\t\t}\n\t\t\treturn config.volume[stream].value;\n\t\t} else {\n\t\t\t// audioInputLevel and audioOutputLevel seem only available in Chrome? audioLevel\n\t\t\t// seems to be available on Chrome and Firefox, but they don't seem to work\n\t\t\tJanus.warn(\"Getting the \" + stream + \" volume unsupported by browser\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tfunction isMuted(handleId, video) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn true;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn true;\n\t\t}\n\t\tif(!config.myStream) {\n\t\t\tJanus.warn(\"Invalid local MediaStream\");\n\t\t\treturn true;\n\t\t}\n\t\tif(video) {\n\t\t\t// Check video track\n\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No video track\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !config.myStream.getVideoTracks()[0].enabled;\n\t\t} else {\n\t\t\t// Check audio track\n\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No audio track\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !config.myStream.getAudioTracks()[0].enabled;\n\t\t}\n\t}\n\n\tfunction mute(handleId, video, mute) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn false;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn false;\n\t\t}\n\t\tif(!config.myStream) {\n\t\t\tJanus.warn(\"Invalid local MediaStream\");\n\t\t\treturn false;\n\t\t}\n\t\tif(video) {\n\t\t\t// Mute/unmute video track\n\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No video track\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconfig.myStream.getVideoTracks()[0].enabled = !mute;\n\t\t\treturn true;\n\t\t} else {\n\t\t\t// Mute/unmute audio track\n\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No audio track\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconfig.myStream.getAudioTracks()[0].enabled = !mute;\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tfunction getBitrate(handleId) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn \"Invalid handle\";\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc)\n\t\t\treturn \"Invalid PeerConnection\";\n\t\t// Start getting the bitrate, if getStats is supported\n\t\tif(config.pc.getStats) {\n\t\t\tif(!config.bitrate.timer) {\n\t\t\t\tJanus.log(\"Starting bitrate timer (via getStats)\");\n\t\t\t\tconfig.bitrate.timer = setInterval(function() {\n\t\t\t\t\tconfig.pc.getStats()\n\t\t\t\t\t\t.then(function(stats) {\n\t\t\t\t\t\t\tstats.forEach(function (res) {\n\t\t\t\t\t\t\t\tif(!res)\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tvar inStats = false;\n\t\t\t\t\t\t\t\t// Check if these are statistics on incoming media\n\t\t\t\t\t\t\t\tif((res.mediaType === \"video\" || res.id.toLowerCase().indexOf(\"video\") > -1) &&\n\t\t\t\t\t\t\t\t\t\tres.type === \"inbound-rtp\" && res.id.indexOf(\"rtcp\") < 0) {\n\t\t\t\t\t\t\t\t\t// New stats\n\t\t\t\t\t\t\t\t\tinStats = true;\n\t\t\t\t\t\t\t\t} else if(res.type == 'ssrc' && res.bytesReceived &&\n\t\t\t\t\t\t\t\t\t\t(res.googCodecName === \"VP8\" || res.googCodecName === \"\")) {\n\t\t\t\t\t\t\t\t\t// Older Chromer versions\n\t\t\t\t\t\t\t\t\tinStats = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Parse stats now\n\t\t\t\t\t\t\t\tif(inStats) {\n\t\t\t\t\t\t\t\t\tconfig.bitrate.bsnow = res.bytesReceived;\n\t\t\t\t\t\t\t\t\tconfig.bitrate.tsnow = res.timestamp;\n\t\t\t\t\t\t\t\t\tif(config.bitrate.bsbefore === null || config.bitrate.tsbefore === null) {\n\t\t\t\t\t\t\t\t\t\t// Skip this round\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.bsbefore = config.bitrate.bsnow;\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.tsbefore = config.bitrate.tsnow;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Calculate bitrate\n\t\t\t\t\t\t\t\t\t\tvar timePassed = config.bitrate.tsnow - config.bitrate.tsbefore;\n\t\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"safari\")\n\t\t\t\t\t\t\t\t\t\t\ttimePassed = timePassed/1000;\t// Apparently the timestamp is in microseconds, in Safari\n\t\t\t\t\t\t\t\t\t\tvar bitRate = Math.round((config.bitrate.bsnow - config.bitrate.bsbefore) * 8 / timePassed);\n\t\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"safari\")\n\t\t\t\t\t\t\t\t\t\t\tbitRate = parseInt(bitRate/1000);\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.value = bitRate + ' kbits/sec';\n\t\t\t\t\t\t\t\t\t\t//~ Janus.log(\"Estimated bitrate is \" + config.bitrate.value);\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.bsbefore = config.bitrate.bsnow;\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.tsbefore = config.bitrate.tsnow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}, 1000);\n\t\t\t\treturn \"0 kbits/sec\";\t// We don't have a bitrate value yet\n\t\t\t}\n\t\t\treturn config.bitrate.value;\n\t\t} else {\n\t\t\tJanus.warn(\"Getting the video bitrate unsupported by browser\");\n\t\t\treturn \"Feature unsupported by browser\";\n\t\t}\n\t}\n\n\tfunction webrtcError(error) {\n\t\tJanus.error(\"WebRTC error:\", error);\n\t}\n\n\tfunction cleanupWebrtc(handleId, hangupRequest) {\n\t\tJanus.log(\"Cleaning WebRTC stuff\");\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle) {\n\t\t\t// Nothing to clean\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(config) {\n\t\t\tif(hangupRequest === true) {\n\t\t\t\t// Send a hangup request (we don't really care about the response)\n\t\t\t\tvar request = { \"janus\": \"hangup\", \"transaction\": Janus.randomString(12) };\n\t\t\t\tif(pluginHandle.token)\n\t\t\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\t\t\tif(apisecret)\n\t\t\t\t\trequest[\"apisecret\"] = apisecret;\n\t\t\t\tJanus.debug(\"Sending hangup request (handle=\" + handleId + \"):\");\n\t\t\t\tJanus.debug(request);\n\t\t\t\tif(websockets) {\n\t\t\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t\t} else {\n\t\t\t\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\t\t\t\tverb: 'POST',\n\t\t\t\t\t\twithCredentials: withCredentials,\n\t\t\t\t\t\tbody: request\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Cleanup stack\n\t\t\tconfig.remoteStream = null;\n\t\t\tif(config.volume) {\n\t\t\t\tif(config.volume[\"local\"] && config.volume[\"local\"].timer)\n\t\t\t\t\tclearInterval(config.volume[\"local\"].timer);\n\t\t\t\tif(config.volume[\"remote\"] && config.volume[\"remote\"].timer)\n\t\t\t\t\tclearInterval(config.volume[\"remote\"].timer);\n\t\t\t}\n\t\t\tconfig.volume = {};\n\t\t\tif(config.bitrate.timer)\n\t\t\t\tclearInterval(config.bitrate.timer);\n\t\t\tconfig.bitrate.timer = null;\n\t\t\tconfig.bitrate.bsnow = null;\n\t\t\tconfig.bitrate.bsbefore = null;\n\t\t\tconfig.bitrate.tsnow = null;\n\t\t\tconfig.bitrate.tsbefore = null;\n\t\t\tconfig.bitrate.value = null;\n\t\t\tif(!config.streamExternal && config.myStream) {\n\t\t\t\tJanus.log(\"Stopping local stream tracks\");\n\t\t\t\tJanus.stopAllTracks(config.myStream);\n\t\t\t}\n\t\t\tconfig.streamExternal = false;\n\t\t\tconfig.myStream = null;\n\t\t\t// Close PeerConnection\n\t\t\ttry {\n\t\t\t\tconfig.pc.close();\n\t\t\t} catch(e) {\n\t\t\t\t// Do nothing\n\t\t\t}\n\t\t\tconfig.pc = null;\n\t\t\tconfig.candidates = null;\n\t\t\tconfig.mySdp = null;\n\t\t\tconfig.remoteSdp = null;\n\t\t\tconfig.iceDone = false;\n\t\t\tconfig.dataChannel = {};\n\t\t\tconfig.dtmfSender = null;\n\t\t\tconfig.senderTransforms = null;\n\t\t\tconfig.receiverTransforms = null;\n\t\t}\n\t\tpluginHandle.oncleanup();\n\t}\n\n\t// Helper method to munge an SDP to enable simulcasting (Chrome only)\n\tfunction mungeSdpForSimulcasting(sdp) {\n\t\t// Let's munge the SDP to add the attributes for enabling simulcasting\n\t\t// (based on https://gist.github.com/ggarber/a19b4c33510028b9c657)\n\t\tvar lines = sdp.split(\"\\r\\n\");\n\t\tvar video = false;\n\t\tvar ssrc = [ -1 ], ssrc_fid = [ -1 ];\n\t\tvar cname = null, msid = null, mslabel = null, label = null;\n\t\tvar insertAt = -1;\n\t\tfor(var i=0; i<lines.length; i++) {\n\t\t\tvar mline = lines[i].match(/m=(\\w+) */);\n\t\t\tif(mline) {\n\t\t\t\tvar medium = mline[1];\n\t\t\t\tif(medium === \"video\") {\n\t\t\t\t\t// New video m-line: make sure it's the first one\n\t\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\t\tvideo = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// New non-video m-line: do we have what we were looking for?\n\t\t\t\t\tif(ssrc[0] > -1) {\n\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!video)\n\t\t\t\tcontinue;\n\t\t\tvar sim = lines[i].match(/a=ssrc-group:SIM (\\d+) (\\d+) (\\d+)/);\n\t\t\tif(sim) {\n\t\t\t\tJanus.warn(\"The SDP already contains a SIM attribute, munging will be skipped\");\n\t\t\t\treturn sdp;\n\t\t\t}\n\t\t\tvar fid = lines[i].match(/a=ssrc-group:FID (\\d+) (\\d+)/);\n\t\t\tif(fid) {\n\t\t\t\tssrc[0] = fid[1];\n\t\t\t\tssrc_fid[0] = fid[2];\n\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(ssrc[0]) {\n\t\t\t\tvar match = lines[i].match('a=ssrc:' + ssrc[0] + ' cname:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tcname = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' msid:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tmsid = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' mslabel:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tmslabel = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' label:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tlabel = match[1];\n\t\t\t\t}\n\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc_fid[0]) === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc[0]) === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(lines[i].length == 0) {\n\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(ssrc[0] < 0) {\n\t\t\t// Couldn't find a FID attribute, let's just take the first video SSRC we find\n\t\t\tinsertAt = -1;\n\t\t\tvideo = false;\n\t\t\tfor(var i=0; i<lines.length; i++) {\n\t\t\t\tvar mline = lines[i].match(/m=(\\w+) */);\n\t\t\t\tif(mline) {\n\t\t\t\t\tvar medium = mline[1];\n\t\t\t\t\tif(medium === \"video\") {\n\t\t\t\t\t\t// New video m-line: make sure it's the first one\n\t\t\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\t\t\tvideo = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// New non-video m-line: do we have what we were looking for?\n\t\t\t\t\t\tif(ssrc[0] > -1) {\n\t\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(!video)\n\t\t\t\t\tcontinue;\n\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\tvar value = lines[i].match(/a=ssrc:(\\d+)/);\n\t\t\t\t\tif(value) {\n\t\t\t\t\t\tssrc[0] = value[1];\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar match = lines[i].match('a=ssrc:' + ssrc[0] + ' cname:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tcname = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' msid:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tmsid = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' mslabel:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tmslabel = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' label:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tlabel = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc_fid[0]) === 0) {\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc[0]) === 0) {\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(lines[i].length === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(ssrc[0] < 0) {\n\t\t\t// Still nothing, let's just return the SDP we were asked to munge\n\t\t\tJanus.warn(\"Couldn't find the video SSRC, simulcasting NOT enabled\");\n\t\t\treturn sdp;\n\t\t}\n\t\tif(insertAt < 0) {\n\t\t\t// Append at the end\n\t\t\tinsertAt = lines.length;\n\t\t}\n\t\t// Generate a couple of SSRCs (for retransmissions too)\n\t\t// Note: should we check if there are conflicts, here?\n\t\tssrc[1] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc[2] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc_fid[1] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc_fid[2] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\t// Add attributes to the SDP\n\t\tfor(var i=0; i<ssrc.length; i++) {\n\t\t\tif(cname) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' cname:' + cname);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(msid) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' msid:' + msid);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(mslabel) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' mslabel:' + mslabel);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(label) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' label:' + label);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\t// Add the same info for the retransmission SSRC\n\t\t\tif(cname) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' cname:' + cname);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(msid) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' msid:' + msid);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(mslabel) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' mslabel:' + mslabel);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(label) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' label:' + label);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t}\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[2] + ' ' + ssrc_fid[2]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[1] + ' ' + ssrc_fid[1]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[0] + ' ' + ssrc_fid[0]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:SIM ' + ssrc[0] + ' ' + ssrc[1] + ' ' + ssrc[2]);\n\t\tsdp = lines.join(\"\\r\\n\");\n\t\tif(!sdp.endsWith(\"\\r\\n\"))\n\t\t\tsdp += \"\\r\\n\";\n\t\treturn sdp;\n\t}\n\n\t// Helper methods to parse a media object\n\tfunction isAudioSendEnabled(media) {\n\t\tJanus.debug(\"isAudioSendEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.audio === false)\n\t\t\treturn false;\t// Generic audio has precedence\n\t\tif(media.audioSend === undefined || media.audioSend === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.audioSend === true);\n\t}\n\n\tfunction isAudioSendRequired(media) {\n\t\tJanus.debug(\"isAudioSendRequired:\", media);\n\t\tif(!media)\n\t\t\treturn false;\t// Default\n\t\tif(media.audio === false || media.audioSend === false)\n\t\t\treturn false;\t// If we're not asking to capture audio, it's not required\n\t\tif(media.failIfNoAudio === undefined || media.failIfNoAudio === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.failIfNoAudio === true);\n\t}\n\n\tfunction isAudioRecvEnabled(media) {\n\t\tJanus.debug(\"isAudioRecvEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.audio === false)\n\t\t\treturn false;\t// Generic audio has precedence\n\t\tif(media.audioRecv === undefined || media.audioRecv === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.audioRecv === true);\n\t}\n\n\tfunction isVideoSendEnabled(media) {\n\t\tJanus.debug(\"isVideoSendEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.video === false)\n\t\t\treturn false;\t// Generic video has precedence\n\t\tif(media.videoSend === undefined || media.videoSend === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.videoSend === true);\n\t}\n\n\tfunction isVideoSendRequired(media) {\n\t\tJanus.debug(\"isVideoSendRequired:\", media);\n\t\tif(!media)\n\t\t\treturn false;\t// Default\n\t\tif(media.video === false || media.videoSend === false)\n\t\t\treturn false;\t// If we're not asking to capture video, it's not required\n\t\tif(media.failIfNoVideo === undefined || media.failIfNoVideo === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.failIfNoVideo === true);\n\t}\n\n\tfunction isVideoRecvEnabled(media) {\n\t\tJanus.debug(\"isVideoRecvEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.video === false)\n\t\t\treturn false;\t// Generic video has precedence\n\t\tif(media.videoRecv === undefined || media.videoRecv === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.videoRecv === true);\n\t}\n\n\tfunction isScreenSendEnabled(media) {\n\t\tJanus.debug(\"isScreenSendEnabled:\", media);\n\t\tif (!media)\n\t\t\treturn false;\n\t\tif (typeof media.video !== 'object' || typeof media.video.mandatory !== 'object')\n\t\t\treturn false;\n\t\tvar constraints = media.video.mandatory;\n\t\tif (constraints.chromeMediaSource)\n\t\t\treturn constraints.chromeMediaSource === 'desktop' || constraints.chromeMediaSource === 'screen';\n\t\telse if (constraints.mozMediaSource)\n\t\t\treturn constraints.mozMediaSource === 'window' || constraints.mozMediaSource === 'screen';\n\t\telse if (constraints.mediaSource)\n\t\t\treturn constraints.mediaSource === 'window' || constraints.mediaSource === 'screen';\n\t\treturn false;\n\t}\n\n\tfunction isDataEnabled(media) {\n\t\tJanus.debug(\"isDataEnabled:\", media);\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\tJanus.warn(\"Edge doesn't support data channels yet\");\n\t\t\treturn false;\n\t\t}\n\t\tif(media === undefined || media === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.data === true);\n\t}\n\n\tfunction isTrickleEnabled(trickle) {\n\t\tJanus.debug(\"isTrickleEnabled:\", trickle);\n\t\treturn (trickle === false) ? false : true;\n\t}\n}\n\nexport default Janus;","import Janus from \"../../janus-2021.js\";\nimport React, { Component } from \"react\";\nimport $ from \"jquery\";\nimport { socket } from \"../../socket.js\";\n\nexport function vsessionCreate(room) {\n  var self = this;\n  Janus.init({\n    debug: \"none\",\n    callback: function () {\n      // Create session\n      var janus = new Janus({\n        server: self.state.server,\n        success: function () {\n          // Attach to VideoRoom plugin\n          janus.attach({\n            plugin: \"janus.plugin.videoroom\",\n            opaqueId: self.state.opaqueId,\n            success: function (pluginHandle) {\n              //sfutest = pluginHandle;\n              self.setState({ janus: janus });\n              self.setState({ sfutest: pluginHandle });\n              Janus.log(\n                \"Plugin attached! (\" +\n                  self.state.sfutest.getPlugin() +\n                  \", id=\" +\n                  self.state.sfutest.getId() +\n                  \")\"\n              );\n              Janus.log(\"  -- This is a publisher/manager\");\n              self.vregisterUsername(room);\n              initDevices()\n              // Prepare the username registration\n            },\n            error: function (error) {\n              Janus.error(\"  -- Error attaching plugin...\", error);\n            },\n            consentDialog: function (on) {\n              Janus.debug(\n                \"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\"\n              );\n            },\n            iceState: function (state) {\n              Janus.log(\"ICE state changed to \" + state);\n            },\n            mediaState: function (medium, on) {\n              Janus.log(\n                \"Janus \" +\n                  (on ? \"started\" : \"stopped\") +\n                  \" receiving our \" +\n                  medium\n              );\n            },\n            webrtcState: function (on) {\n              Janus.log(\n                \"Janus says our WebRTC PeerConnection is \" +\n                  (on ? \"up\" : \"down\") +\n                  \" now\"\n              );\n            },\n            onmessage: function (msg, jsep) {\n              Janus.debug(\" ::: Got a message (publisher) :::\", msg);\n              var event = msg[\"videoroom\"];\n              Janus.debug(\"Event: \" + event);\n              if (event) {\n                if (event === \"joined\") {\n                  // Publisher/manager created, negotiate WebRTC and attach to existing feeds, if any\n                  //myid = msg[\"id\"];\n                  //mypvtid = msg[\"private_id\"];\n                  self.setState({\n                    myVroomId: msg[\"id\"],\n                    vJoined: true,\n                  });\n                  Janus.log(\n                    \"Successfully joined room \" +\n                      msg[\"room\"] +\n                      \" with ID \" +\n                      msg[\"id\"]\n                  );\n                  self.addParticipant(\n                    msg[\"id\"],\n                    self.state.fullname + \"§\" + self.state.userUUID\n                  );\n                  if (\n                    self.state.reloadParams &&\n                    self.state.reloadParams[\"cam\"]\n                  ) {\n                    self.ionRequestRoom();\n                  }\n                  //publishOwnFeed(true);\n                  //}\n                  // Any new feed to attach to?\n                  if (msg[\"publishers\"]) {\n                    var list = msg[\"publishers\"];\n                    Janus.debug(\n                      \"Got a list of available publishers/feeds:\",\n                      list\n                    );\n                    for (var f in list) {\n                      console.log(\"List >>\", list);\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var audio = list[f][\"audio_codec\"];\n                      var video = list[f][\"video_codec\"];\n                      Janus.debug(\n                        \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (audio: \" +\n                          audio +\n                          \", video: \" +\n                          video +\n                          \")\"\n                      );\n                      self.vAddParticipant(list[f][\"id\"], list[f][\"display\"]);\n                      self.vNewRemoteFeed(id, '' ,display, audio, video);\n                    }\n                  }\n                } else if (event === \"destroyed\") {\n                  // The room has been destroyed\n                  Janus.warn(\"The room has been destroyed!\");\n                } else if (event === \"event\") {\n                  // Any new feed to attach to?\n                  if (msg[\"publishers\"]) {\n                    var list = msg[\"publishers\"];\n                    Janus.debug(\n                      \"Got a list of available publishers/feeds:\",\n                      list\n                    );\n                    for (var f in list) {\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var audio = list[f][\"audio_codec\"];\n                      var video = list[f][\"video_codec\"];\n                      console.log(list);\n                      Janus.debug(\n                        \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (audio: \" +\n                          audio +\n                          \", video: \" +\n                          video +\n                          \")\"\n                      );\n                      self.vAddParticipant(list[f][\"id\"], list[f][\"display\"]);\n                      self.vNewRemoteFeed(id, '' ,display, audio, video);\n                    }\n                  } else if (msg[\"leaving\"]) {\n                    // One of the publishers has gone away?\n                    var leaving = msg[\"leaving\"];\n                    console.log(\"Publisher leaving: \" + leaving);\n                    self.setState(\n                      {\n                        feeds: self.state.feeds.filter(\n                          (item) => item.rfid != leaving\n                        ),\n                      },\n                      () => console.log(\"feeds: >>>>\", self.state.feeds)\n                    );\n                    var unPublishedFeed = self.state.feeds.filter(\n                      (item) => item.rfid === leaving\n                    );\n                    var remoteFeed = unPublishedFeed.shift();\n                    if (remoteFeed != null) {\n                      remoteFeed.detach();\n                    }\n                    self.removeParticipant(leaving);\n                  } else if (msg[\"unpublished\"]) {\n                    // One of the publishers has unpublished?\n                    var unpublished = msg[\"unpublished\"];\n                    console.log(\"Publisher left: \" + unpublished);\n                    if (unpublished === \"ok\") {\n                      self.state.sfutest.hangup();\n                      self.vStreamDettacher(self.state.sfutest);\n                      return;\n                    }\n                    var unPublishedFeed = self.state.feeds.filter(\n                      (item) => item.rfid === unpublished\n                    );\n                    var remoteFeed = unPublishedFeed.shift();\n                    if (remoteFeed != null) {\n                      remoteFeed.detach();\n                      self.vStreamDettacher(remoteFeed);\n                    }\n                    self.removeParticipant(unpublished);\n\n                    self.setState({\n                      feeds: self.state.feeds.filter(\n                        (item) => item.rfid != unpublished\n                      ),\n                    });\n                  } else if (msg[\"error\"]) {\n                    if (msg[\"error_code\"] === 426) {\n                      // This is a \"no such room\" error: give a more meaningful description\n                    } else {\n                    }\n                  }\n                }\n              }\n              if (jsep) {\n                Janus.debug(\"Handling SDP as well...\", jsep);\n                self.state.sfutest.handleRemoteJsep({ jsep: jsep });\n              }\n            },\n            onlocalstream: function (stream) {\n              Janus.debug(\" ::: Got a local stream :::\", stream);\n              console.log(\" ::: Got a local stream :::\", stream);\n              console.log(self.state.sfutest.id);\n              var exisiting = self.state.feeds.filter(\n                (item) => item.id === self.state.sfutest.id\n              );\n              if (exisiting.length === 0) {\n                self.state.sfutest.rfid = self.state.myVroomId;\n                self.setState({\n                  feeds: self.state.feeds.concat(self.state.sfutest),\n                });\n              }\n\n              var videoTracks = stream.getVideoTracks();\n              console.log('onlocalstream', videoTracks)\n              if (!videoTracks || videoTracks.length === 0) {\n                self.vStreamDettacher(self.state.sfutest);\n              } else {\n                console.log(self.state.vparticipants);\n                self.vStreamAttacher(self.state.sfutest, self.state.name);\n              }\n            },\n            onremotestream: function (stream) {\n              // The publisher stream is sendonly, we don't expect anything here\n            },\n            oncleanup: function () {\n              Janus.log(\n                \" ::: Got a cleanup notification: we are unpublished now :::\"\n              );\n            },\n          });\n        },\n        error: function (error) {\n          Janus.error(error);\n          //bootbox.alert(error, function() {\n          var params = \"\";\n          if (self.state.publishedCamera) {\n            params = params + \"?cam=true&roomId=\" + self.state.slot;\n          }\n          if (!self.state.muted) {\n            params = params + \"&mic=true\";\n          }\n          if (params === \"\") {\n            var bar = self.getJsonFromUrl(self.$f7.view[0].history[0]);\n            params = params + \"?cam=\" + bar[\"cam\"] + \"&mic=\" + bar[\"mic\"];\n          }\n          //console.log('%%%%%%%%%%%%%%%', params)\n          window.location.replace(\"http://localhost:3000/\" + params);\n          //});\n        },\n        destroyed: function () {\n          window.location.reload();\n        },\n      });\n    },\n  });\n}\n\nexport function vNewRemoteFeed(id, feeds, display, audio, video) {\n  var self = this;\n  var name = display.split(\"§\")[0];\n  // A new feed has been published, create a new plugin handle and attach to it as a subscriber\n  var remoteFeed = null;\n  self.state.janus.attach({\n    plugin: \"janus.plugin.videoroom\",\n    opaqueId: this.state.opaqueId,\n    success: function (pluginHandle) {\n      remoteFeed = pluginHandle;\n      remoteFeed.simulcastStarted = false;\n      Janus.log(\n        \"Plugin attached! (\" +\n          remoteFeed.getPlugin() +\n          \", id=\" +\n          remoteFeed.getId() +\n          \")\"\n      );\n      Janus.log(\"  -- This is a subscriber\");\n      // We wait for the plugin to send us an offer\n      var subscribe = {\n        request: \"join\",\n        room: 1234,\n        ptype: \"subscriber\",\n        pin: self.state.pin,\n        feed: id,\n        private_id: self.state.mypvtid,\n      };\n      // In case you don't want to receive audio, video or data, even if the\n      // publisher is sending them, set the 'offer_audio', 'offer_video' or\n      // 'offer_data' properties to false (they're true by default), e.g.:\n      // \t\tsubscribe[\"offer_video\"] = false;\n      // For example, if the publisher is VP8 and this is Safari, let's avoid video\n      if (\n        Janus.webRTCAdapter.browserDetails.browser === \"safari\" &&\n        (video === \"vp9\" || (video === \"vp8\" && !Janus.safariVp8))\n      ) {\n        if (video) video = video.toUpperCase();\n        console.log(\n          \"Publisher is using \" +\n            video +\n            \", but Safari doesn't support it: disabling video\"\n        );\n        subscribe[\"offer_video\"] = false;\n      }\n      //subscribe[\"offer_video\"] = false;\n      remoteFeed.videoCodec = video;\n      remoteFeed.send({ message: subscribe });\n    },\n    error: function (error) {\n      Janus.error(\"  -- Error attaching plugin...\", error);\n      window.alert(\"Error attaching plugin... \" + error);\n    },\n    onmessage: function (msg, jsep) {\n      Janus.debug(\" ::: Got a message (subscriber) :::\", msg);\n      var event = msg[\"videoroom\"];\n      Janus.log(\"Event: \" + event);\n\n      if (msg[\"error\"]) {\n        window.alert(msg[\"error\"]);\n      } else if (event) {\n        if (event === \"attached\") {\n          remoteFeed.rfid = msg[\"id\"];\n          remoteFeed.rfdisplay = msg[\"display\"];\n          self.setState({ feeds: self.state.feeds.concat(remoteFeed) }, () =>\n            console.log(\"@@@@\", self.state.feeds)\n          );\n\n          if (!video) {\n            self.vStreamDettacher(remoteFeed);\n          }\n\n          Janus.log(\n            \"Successfully attached to feed \" +\n              remoteFeed.rfid +\n              \" (\" +\n              remoteFeed.rfdisplay +\n              \") in room \" +\n              msg[\"room\"]\n          );\n        } else if (event === \"event\") {\n        } else {\n          // What has just happened?\n        }\n      }\n      if (jsep) {\n        Janus.log(\"Handling SDP as well...\", jsep);\n        remoteFeed.createAnswer({\n          jsep: jsep,\n          // Add data:true here if you want to subscribe to datachannels as well\n          // (obviously only works if the publisher offered them in the first place)\n          media: { audioSend: false, videoSend: false, data: false }, // We want recvonly audio/video\n          success: function (jsep) {\n            Janus.log(\"Got SDP!\", jsep);\n            var body = { request: \"start\", room: self.state.roomId };\n            remoteFeed.send({ message: body, jsep: jsep });\n          },\n          error: function (error) {\n            Janus.log(\"WebRTC error:\", error);\n            window.alert(\"WebRTC error... \" + error.message);\n          },\n        });\n      }\n    },\n    iceState: function (state) {\n      Janus.log(\n        \"ICE state of this WebRTC PeerConnection (feed #\" +\n          remoteFeed.rfid +\n          \") changed to \" +\n          state\n      );\n    },\n    webrtcState: function (on) {\n      Janus.log(\n        \"Janus says this WebRTC PeerConnection (feed #\" +\n          remoteFeed.rfid +\n          \") is \" +\n          (on ? \"up\" : \"down\") +\n          \" now\"\n      );\n      if (on === \"down\") {\n        self.vremoveParticipant(remoteFeed.rfid);\n      }\n    },\n    onlocalstream: function (stream) {\n      console.log(\">>>>>>>>>>>\", stream);\n    },\n    onremotestream: function (stream) {\n      console.log(\">>>>>>>>>>>\", stream);\n      self.vStreamAttacher(remoteFeed, name);\n    },\n    ondata: function (data) {},\n    oncleanup: function () {\n      Janus.log(\" ::: Got a cleanup notification (remote feed \" + id + \") :::\");\n    },\n  });\n}\n\nexport function vregisterUsername(room) {\n  var self = this;\n  var register = {\n    request: \"join\",\n    room: 1234,\n    ptype: \"publisher\",\n    //pin: self.state.pin,\n    display:\n      self.state.fullname +\n      \" §\" +\n      self.state.userUUID +\n      \"§\" +\n      self.state.userColor +\n      \"§\" +\n      self.state.slot,\n  };\n  self.state.sfutest.send({ message: register });\n  //self.setState({ myVroomId: self.state.mixertest.id });\n}\n\nexport function vChangeUsername(room) {\n  var self = this;\n  var register = {\n    request: \"configure\",\n    room: 1234,\n    ptype: \"publisher\",\n    //pin: self.state.pin,\n    display:\n      self.state.fullname +\n      \" §\" +\n      self.state.userUUID +\n      \"§\" +\n      self.state.userColor +\n      \"§\" +\n      self.state.slot,\n  };\n  self.state.sfutest.send({ message: register });\n  //self.setState({ myVroomId: self.state.mixertest.id });\n}\n\nexport function vStreamAttacher(feed, display='') {\n  var self = this;\n  console.log(\"Attaching \" + feed);\n  console.log($(\"#video-\" + feed.id));\n  if ($(\"#video-\" + feed.id).length == 0) {\n    var localVideo = document.createElement(\"video\");\n    localVideo.autoplay = true;\n    localVideo.muted = true;\n    //localVideo.width = \"initial\";\n    localVideo.id = \"video-\" + feed.id;\n    $('#Dish').append(\"<div id='d-\"+ feed.id +\"' class='Camera' data-content='\"+ display +\"'></div>\");  \n     \n  }\n  \n  \n  //$(\"#video-\" + feed.id).show();\n  if (localVideo) $(\"#d-\"+ feed.id).append(localVideo);\n  if (feed.id && feed.webrtcStuff && feed.webrtcStuff.remoteStream) {\n    self.setState({ vActive: true });\n    //if (localVideo) $(\"#remoteVideos\").append(localVideo);\n    Janus.attachMediaStream(\n      document.getElementById(\"video-\" + feed.id),\n      feed.webrtcStuff.remoteStream\n    );\n    self.disher();\n  }\n  if (feed.id && feed.webrtcStuff && feed.webrtcStuff.myStream) {\n    //if (localVideo) $(\"#selfVideos\").append(localVideo);\n    $(\"#videoLoaderIcon\").hide();\n    $(\"#videoLoaderIcon2\").hide();\n    \n    $(\"#disableVideo\").show();\n    Janus.attachMediaStream(\n      document.getElementById(\"video-\" + feed.id),\n      feed.webrtcStuff.myStream\n    );\n    self.disher();\n    \n  }\n  $(\"#video-\" + feed.id).css('width', 'inherit'); \n}\n\nexport function vStreamDettacher(feed) {\n  if (feed.id) {\n    //console.log(\"Dettaching \" + feed.id);\n    $(\"#video-\" + feed.id).remove();\n    $(\"#d-\" + feed.id).remove();\n    this.disher();\n  }\n}\n\nexport function vremoveParticipant(id) {\n  var self = this;\n  self.setState({\n    vparticipants: self.state.vparticipants.filter((item) => item.id !== id),\n  });\n}\n\nexport function vAddParticipant(id, p) {\n  //console.log(\"Adding Participants ...\", id, p);\n  var self = this;\n  var participant = p.split(\"§\");\n  if (this.exisitingParticipant(participant[1])) {\n    self.setState({\n      vparticipants: self.state.vparticipants.concat({\n        id: id,\n        display: participant[0],\n        uuid: participant[1],\n        userColor: participant[2],\n        role: \"listener\",\n        current: \"stopped-talking\",\n      }),\n    });\n  }\n  //console.log(\"participant added:\", participant[1]);\n}\n\nexport function publishCamera(bitrate = 16, deviceId = null) {\n  var self = this;\n  var video = true;\n  var device = true;\n  if (!self.state.isAdmin) {\n    video = { width: 180, height: 151 };\n    \n  } \n  if (self.state.slot === '0') {\n    video = \"hires-16:9\"\n  }\n  if(deviceId){\n    device = {deviceId: { exact: deviceId}}\n  }\n  self.state.sfutest.createOffer({\n    media: {\n      audioRecv: false,\n      videoRecv: false,\n      data: false,\n      videoSend: true,\n      audioSend: false,\n      video: video,\n      video: device,\n    },\n\n    success: function (jsep) {\n      Janus.debug(\"********* Got publisher SDP!\", jsep);\n      console.log(\"switching to \" + bitrate);\n      if (jsep) {\n        var publish = {\n          request: \"configure\",\n          audio: false,\n          video: true,\n          //video:{width: 180, height: 180},\n          data: false,\n          bitrate: bitrate * 8000,\n          bitrate_cap: true,\n          //videocodec: \"vp8\",\n        };\n        self.state.sfutest.send({ message: publish, jsep: jsep });\n      }\n      self.setState({ publishedCamera: true });\n      $(\"#camera-spinner\").hide();\n      $(\"#camera-off\").show();\n      $(\"#camera-off\").css('color', 'black');\n      console.log(\"ID: >>>\", self.state.sfutest.id);\n      socket.emit(\"ionSetSlot\", {\n        slot: self.state.slot,\n        stream: self.state.sfutest.id,\n      });\n      var tracks = self.state.sfutest.webrtcStuff.myStream.getTracks();\n      console.log(tracks);\n    },\n    error: function (error) {\n      Janus.error(\"***** WebRTC error:\", error);\n    },\n  });\n}\n\nexport function unPublishCamera() {\n  var self = this;\n  console.log(\"unPublishing ..\");\n  var unpublish = { request: \"unpublish\" };\n  self.state.sfutest.send({ message: unpublish });\n  self.vStreamDettacher(self.state.sfutest);\n  $(\"#camera-spinner\").hide();\n  $(\"#camera-on\").show();\n  $(\"#camera-off\").css('color', 'initial');\n  self.setState({ publishedCamera: false, videoState: \"initial\", slot: null });\n}\n\nexport function toggleVideoDevice(deviceId){\n  var self = this;\n  if (self.state.publishedCamera) {\n    self.unPublishCamera();\n  }\n  self.publishCamera(16, deviceId)\n}\n\nexport function vexisitingParticipant(participantId) {\n  var self = this;\n  var exisiting = self.state.vparticipants.filter(\n    (item) => item.uuid === participantId\n  );\n  if (exisiting.length === 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function vparticipantDisplay(participantId) {\n  var self = this;\n  var exisiting = self.state.vparticipants.filter(\n    (item) => item.uuid === participantId\n  );\n  if (exisiting.length === 0) {\n    return \"\";\n  } else {\n    return exisiting[0].display;\n  }\n}\n\nexport function vparticipantChangeStatus(participantId, status) {\n  this.setState((prevState) => ({\n    talking: {\n      ...prevState.talking,\n      [participantId]: status,\n    },\n  }));\n}\n\nexport function vparticipantChangeRoom(participantId, room) {\n  this.setState((prevState) => ({\n    participantRoom: {\n      ...prevState.participantRoom,\n      [participantId]: room,\n    },\n  }));\n}\n\nexport function exitVideoRoom() {\n  var self = this;\n  if (this.state.sfutest) {\n    self.unPublishCamera();\n   // this.state.sfutest.send({ message: { request: \"unpublish\" } });\n    this.state.sfutest.send({ message: { request: \"leave\" } });\n  }\n}\n\n\nexport function toggleCamera() {\n  var self = this;\n  $(\"#camera-spinner\").show();\n  $(\"#camera-off\").hide();\n  $(\"#camera-on\").hide();\n  if (!self.state.publishedCamera) {\n    self.publishCamera();\n  } else {\n    self.unPublishCamera();\n  }\n}\n\nfunction initDevices(devices) {\n  var self = this;\n  navigator.mediaDevices.enumerateDevices()\n  .then(function(devices) {\n    devices.forEach(function(device) {\n      console.log(device.kind)\n      if(device.kind === 'audiooutput') {\n        $('#speakerSelect').append(\"<option value='\"+device.deviceId+\"'>\"+device.label+\"</option>\")\n       }\n       if(device.kind === 'audioinput') {\n        $('#audioSourceSelect').append(\"<option value='\"+device.deviceId+\"'>\"+device.label+\"</option>\")\n       }\n       if(device.kind === 'videoinput') {\n        $('#videoSourceSelect').append(\"<option value='\"+device.deviceId+\"'>\"+device.label+\"</option>\")\n       }\n    });\n  })\n  .catch(function(err) {\n    console.log(err.name + \": \" + err.message);\n  });\n}\n","// Area:\nexport function dishArea(Increment, Count, Width, Height, Margin = 10) {\n    let i =  0;\n    let w = 0;\n    let h = Increment * 0.75 + (Margin * 2);\n    while (i < (Count)) {\n        if ((w + Increment) > Width) {\n            w = 0;\n            h = h + (Increment * 0.75) + (Margin * 2);\n        }\n        w = w + Increment + (Margin * 2);\n        i++;\n    }\n    if (h > Height) return false;\n    else return Increment;\n}\n// Dish:\nexport function disher() {\n\n    // variables:\n        let Margin = 2;\n        let Scenary = document.getElementById('Dish');\n        let Width = 0;\n        let Height = 0;\n        if (Scenary) {\n             Width = Scenary.offsetWidth - (Margin * 2);\n             Height = Scenary.offsetHeight - (Margin * 2);\n        }\n\n        let Cameras = document.getElementsByClassName('Camera');\n        let max = 0;\n    \n    // loop (i recommend you optimize this)\n        let i = 1;\n        while (i < 5000) {\n            let w = dishArea(i, Cameras.length, Width, Height, Margin);\n            if (w === false) {\n                max =  i - 1;\n                break;\n            }\n            i++;\n        }\n    \n    // set styles\n        max = max - (Margin * 2);\n        setWidth(max, Margin);\n}\n\n// Set Width and Margin \nexport function setWidth(width, margin) {\n    let Cameras = document.getElementsByClassName('Camera');\n    for (var s = 0; s < Cameras.length; s++) {\n        Cameras[s].style.width = width + \"px\";\n        Cameras[s].style.margin = margin + \"px\";\n        Cameras[s].style.height = (width * 0.75) + \"px\";\n    }\n}\n\n// Load and Resize Event\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport $ from 'jquery';\nimport Header from \"../header/header.jsx\";\nimport Janus from \"../../janus.js\";\nimport { conf } from \"../../conf\";\nimport { socket } from '../../socket.js'\nimport { v4 as uuidv4 } from 'uuid';\n\nimport {\n  sessionCreate, addParticipant, exisitingParticipant, registerUsername,\n  toggleMute, exitAudioRoom, removeParticipant, participantChangeStatus,\n  participantDisplay, forceMute, participantChangeRoom, currentRole,\n} from \"./janus-tools.js\";\n\nimport {\n  vsessionCreate, vregisterUsername, vNewRemoteFeed, publishCamera,\n  toggleCamera, vStreamAttacher, vStreamDettacher, unPublishCamera,\n  vChangeUsername, vAddParticipant, toggleVideoDevice, exitVideoRoom\n} from \"./janus-videoroom.js\";\n\nimport {\n  dishArea, disher, setWidth\n} from \"./dish.js\";\n\nimport {\n  socketHandle, appendChat, chatItems, throttle, send, wsSend, keydownHandler, scrollChat\n} from \"../rooms/chat.js\";\n\nconst t = dict['fa']\n\nexport default class MeetingShow extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n\n\n    this.vsessionCreate = vsessionCreate.bind(this)\n    this.vregisterUsername = vregisterUsername.bind(this)\n    this.vNewRemoteFeed = vNewRemoteFeed.bind(this)\n    this.publishCamera = publishCamera.bind(this)\n    this.toggleCamera = toggleCamera.bind(this)\n    this.vStreamAttacher = vStreamAttacher.bind(this)\n    this.vStreamDettacher = vStreamDettacher.bind(this)\n    this.unPublishCamera = unPublishCamera.bind(this)\n    this.vChangeUsername = vChangeUsername.bind(this)\n    this.vAddParticipant = vAddParticipant.bind(this)\n    this.toggleVideoDevice = toggleVideoDevice.bind(this)\n    this.exitVideoRoom = exitVideoRoom.bind(this);\n\n    this.currentRole = currentRole.bind(this)\n\n    this.sessionCreate = sessionCreate.bind(this);\n    this.registerUsername = registerUsername.bind(this);\n    this.participantChangeStatus = participantChangeStatus.bind(this);\n    this.participantDisplay = participantDisplay.bind(this);\n    this.forceMute = forceMute.bind(this);\n    this.participantChangeRoom = participantChangeRoom.bind(this);\n    this.exitAudioRoom = exitAudioRoom.bind(this);\n    this.removeParticipant = removeParticipant.bind(this);\n    this.addParticipant = addParticipant.bind(this);\n    this.toggleMute = toggleMute.bind(this);\n    this.exisitingParticipant = exisitingParticipant.bind(this);\n\n    this.dishArea = dishArea.bind(this);\n    this.disher = disher.bind(this);\n    this.setWidth = setWidth.bind(this);\n\n    this.socketHandle = socketHandle.bind(this);\n    this.appendChat = appendChat.bind(this);\n    this.chatItems = chatItems.bind(this);\n    this.throttle = throttle.bind(this);\n    this.send = send.bind(this);\n    this.wsSend = wsSend.bind(this);\n    this.keydownHandler = keydownHandler.bind(this);\n    this.scrollChat = scrollChat.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n\n      name: null,\n      fullname: null,\n      userUUID: null,\n      initials: null,\n      is_speaker: false,\n      is_moderator: false,\n      is_presenter: false,\n      role: null,\n      talking: {},\n\n      opaqueId: \"videoroomtest-\" + Janus.randomString(12),\n      mixertest: null,\n      server: conf.janusServer,\n      roomId: null,\n      pin: null,\n\n      participants: [],\n      vparticipants: [],\n\n      muted: true,\n      talking: false,\n      myId: null,\n      vroomId: null,\n      vpin: null,\n\n      janus: null,\n      sfutest: null,\n      feeds: [],\n      propagates: [],\n\n      chats: [],\n      lastTime: Date.now(),\n      content: null,\n      item: null,\n    }\n\n  }\n\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    window.localStorage.setItem(this.state.roomId, 'unchoke')\n    this.exitAll();\n  }\n\n  exitAll() {\n    this.exitAudioRoom();\n    this.exitVideoRoom();\n  }\n\n  componentDidMount() {\n\n    var self = this;\n    if (this.state.token && this.state.token.length > 10) {\n      MyActions.setInstance('users/validate_token', {}, this.state.token);\n    }\n    window.addEventListener(\"load\", function (event) {\n      self.disher();\n      window.onresize = disher;\n    }, false);\n\n    socket.on('connect', function () {\n      if (self.state.roomId) {\n        socket.emit('room', { room: self.state.roomId.toString(), uuid: self.state.userUUID });\n      }\n    });\n\n    socket.on('message', function (data) {\n      if (data['sender'] !== self.state.userUUID) {\n        self.socketHandle(data)\n      }\n    });\n\n    if (!window.localStorage.getItem(this.state.roomId)) {\n      window.localStorage.setItem(this.state.roomId, 'unchoke')\n    }\n\n    window.onunload = window.onbeforeunload = function () {\n      window.localStorage.setItem(this.state.roomId, 'unchoke')\n    }\n  }\n\n\n  handleChange(obj) {\n    this.setState(obj);\n  }\n\n  getInstance() {\n    var klass = ModelStore.getKlass()\n    var model = ModelStore.getIntance()\n    if (klass === 'Room') {\n      this.setState({\n        roomId: model.uuid,\n        pin: model.pin,\n        secret: model.secret,\n        vroomId: model.vuuid,\n        vpin: model.vpin,\n        is_speaker: model.is_speaker,\n        is_moderator: model.is_moderator,\n        is_presenter: model.is_presenter,\n      }, () => {\n        console.log(this.state)\n        this.sessionCreate(this.state.roomId)\n        this.vsessionCreate(this.state.vroomId)\n        if (window.localStorage.getItem(this.state.roomId) === 'unchoke') {\n          window.localStorage.setItem(this.state.roomId, 'choke')\n          console.log('Reloading ....')\n          window.location.reload();\n        }\n\n        this.connectSocketRoom();\n      })\n    }\n  }\n\n  setInstance() {\n    var self = this;\n    var klass = ModelStore.getKlass()\n    var user = ModelStore.getIntance();\n    if (klass === 'Validate') {\n      this.setState({ name: user.name, fullname: user.name, initials: user.initials, userUUID: user.uuid }, () => {\n        console.log(self.state)\n        MyActions.getInstance('rooms', self.props.match.params.id, self.state.token);\n      });\n    }\n  }\n\n  presentBtn() {\n    if (this.state.is_presenter || this.state.is_moderator) {\n      return (\n        <a class=\"m-1\" onClick=''>\n          <span class=\"avatar\" style={{ backgroundColor: '#d7d8da' }}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M21 12v3a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10a1 1 0 0 1 1 -1h9\" /><line x1=\"7\" y1=\"20\" x2=\"17\" y2=\"20\" /><line x1=\"9\" y1=\"16\" x2=\"9\" y2=\"20\" /><line x1=\"15\" y1=\"16\" x2=\"15\" y2=\"20\" /><path d=\"M17 4h4v4\" /><path d=\"M16 9l5 -5\" /></svg>\n          </span>\n        </a>\n      )\n    }\n  }\n\n  cameraBtn() {\n    if (this.state.is_moderator || this.state.is_presenter || this.state.is_speaker) {\n      return (\n        <a class=\"m-1\" onClick={() => this.toggleMute()}>\n          <span class=\"avatar\" style={{ backgroundColor: '#d7d8da' }}>\n            <svg id='microphone-on' style={{ display: 'block' }} xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><rect x=\"9\" y=\"2\" width=\"6\" height=\"11\" rx=\"3\" /><path d=\"M5 10a7 7 0 0 0 14 0\" /><line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" /><line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" /></svg>\n            <svg id='microphone-off' style={{ display: 'none' }} xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"3\" y1=\"3\" x2=\"21\" y2=\"21\" /><path d=\"M9 5a3 3 0 0 1 6 0v5a3 3 0 0 1 -.13 .874m-2 2a3 3 0 0 1 -3.87 -2.872v-1\" /><path d=\"M5 10a7 7 0 0 0 10.846 5.85m2.002 -2a6.967 6.967 0 0 0 1.152 -3.85\" /><line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" /><line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" /></svg>\n          </span>\n        </a>\n      )\n    }\n  }\n\n  microphoneBtn() {\n    if (this.state.is_moderator || this.state.is_presenter || this.state.is_speaker) {\n      return (\n        <a class=\"m-1\" onClick={() => this.toggleCamera()}>\n          <span class=\"avatar\" style={{ backgroundColor: '#d7d8da' }}>\n            <div id='camera-spinner' class=\"spinner-border text-red\" role=\"status\" style={{ display: 'none' }}></div>\n            <svg id='camera-on' style={{ display: 'block' }} xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><circle cx=\"12\" cy=\"10\" r=\"7\" /><circle cx=\"12\" cy=\"10\" r=\"3\" /><path d=\"M8 16l-2.091 3.486a1 1 0 0 0 .857 1.514h10.468a1 1 0 0 0 .857 -1.514l-2.091 -3.486\" /></svg>\n            <svg id='camera-off' style={{ display: 'none' }} xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M6.15 6.153a7 7 0 0 0 9.696 9.696m2.003 -2.001a7 7 0 0 0 -9.699 -9.695\" /><path d=\"M9.13 9.122a3 3 0 0 0 3.743 3.749m2.001 -2.009a3 3 0 0 0 -3.737 -3.736\" /><path d=\"M8 16l-2.091 3.486a1 1 0 0 0 .857 1.514h10.468a1 1 0 0 0 .857 -1.514l-2.091 -3.486\" /><line x1=\"3\" y1=\"3\" x2=\"21\" y2=\"21\" /></svg>\n          </span>\n        </a>\n      )\n    }\n  }\n\n  settingsBtn() {\n    if (this.state.is_moderator || this.state.is_presenter || this.state.is_speaker) {\n      return (\n        <a class=\"m-1\" onClick=''>\n          <span class=\"avatar\" style={{ backgroundColor: '#d7d8da' }}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z\" /><circle cx=\"12\" cy=\"12\" r=\"3\" /></svg>\n          </span>\n        </a>\n      )\n    }\n  }\n\n  exitBtn() {\n    return (\n      <a class=\"m-1\" onClick={() => this.exitAll()}>\n        <span class=\"avatar\" style={{ backgroundColor: '#d7d8da' }}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2\" /><path d=\"M7 12h14l-3 -3m0 6l3 -3\" /></svg>\n        </span>\n      </a>\n    )\n  }\n\n  controls() {\n    return (\n      <div class=\"card card-active mb-3\" >\n        <div class=\"card-body p-1\" style={{ textAlign: 'center' }}>\n          {this.microphoneBtn()}\n          {this.cameraBtn()}\n          {this.presentBtn()}\n          {this.settingsBtn()}\n          {this.exitBtn()}\n        </div>\n      </div>\n    )\n  }\n\n  showControl() {\n    if (this.state.is_moderator || this.state.is_presenter || this.state.is_speaker) {\n      return (this.controls())\n    }\n  }\n\n  talkingIndicator(id) {\n    if (this.state.talking[id]) {\n      return (<span class=\"badge bg-yellow\"></span>)\n    }\n  }\n\n  speakerList() {\n    var result = []\n    this.state.participants.map((participant) => {\n      if (participant.role !== 'listener') {\n        result.push(\n          <div class=\"col-6 mb-1\">\n            <div class=\"row g-3 align-items-center\">\n              <span class=\"avatar avatar-sm\">\n                {participant.initials}\n                {this.talkingIndicator(participant.id)}\n              </span>\n              <div class=\"col text-truncate\">\n                <span class=\"chat-title\">{participant.display}</span>\n                <div class=\"form-hint mt-n1\">{t[participant.role]}</div>\n              </div>\n            </div>\n          </div>\n        )\n      }\n    })\n    return result\n  }\n\n  listenerList() {\n    var result = []\n    this.state.participants.map((participant) => {\n      if (participant.role === 'listener') {\n        result.push(\n          <div class=\"col-6 mb-1\">\n            <div class=\"row g-3 align-items-center\">\n              <a href=\"#\" class=\"col-auto\">\n                <span class=\"avatar avatar-sm\">\n                  {participant.initials}\n                  {this.talkingIndicator(participant.id)}\n                </span>\n              </a>\n              <div class=\"col text-truncate\">\n                <span class=\"chat-title\">{participant.display}</span>\n                <div class=\"form-hint mt-n1\">{t[participant.role]}</div>\n              </div>\n            </div>\n          </div>\n        )\n      }\n    })\n    return result\n  }\n\n\n\n\n  connectSocketRoom() {\n    if (this.state.userUUID && this.state.roomId) {\n      socket.emit('room', { room: this.state.roomId, uuid: this.state.userUUID });\n    }\n  }\n\n\n  render() {\n    const t = dict['fa']\n    return (\n      <body className=\"antialiased\">\n        <div className=\"wrapper\">\n          <Header history={this.props.history} />\n          <div className=\"page-wrapper\">\n            <div className=\"page-body pt-2\">\n              <div className=\"container-fluid\">\n                <div className=\"row  row-cards\">\n\n\n                  <div class=\"col-lg-4\">\n                    {this.showControl()}\n                    <div class=\"card mb-3 maxh-250 \">\n                    <div class=\"card-status-top bg-danger\"></div>\n                      <div class=\"card-body pt-2 pb-1\" style={{ overflowY: 'scroll' }}>\n                        <div class=\"row\">\n                          {this.speakerList()}\n                        </div>\n                      </div>\n                    </div>\n\n                    <div class=\"card mb-3 maxh-250\">\n                    <div class=\"card-status-top bg-blue\"></div>\n                      <div class=\"card-body pt-1 pb-1\" style={{ overflowY: 'scroll' }}>\n                        <div class=\"row\">\n                          {this.listenerList()}\n                        </div>\n                      </div>\n                    </div>\n\n                    <div class=\"card mb-3 maxh-350 minh-350\">\n                      <div class=\"list-group list-group-flush overflow-auto\" id='chat-box' style={{ maxHeight: '25rem' }}>\n                        {this.chatItems()}\n                      </div>\n                      <div class=\"card-footer bg-dark\">\n                        <div class=\"row\">\n                          <div class=\"col\">\n                            <textarea id='chat-form' class=\"form-control\" data-bs-toggle=\"autosize\" placeholder={t['write_something']} onChange={(e) => {\n                              this.handleChange({ item: { content: e.target.value, name: this.state.name, initials: this.state.initials, time: Date.now(), uuid: uuidv4() } })\n                            }} />\n                          </div>\n                          <div class=\"col-auto\">\n                            <a onClick={() => this.send()} class=\"btn  btn-icon\" aria-label=\"Button\">\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\" /><path d=\"M21 3l-6.5 18a0.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a0.55 .55 0 0 1 0 -1l18 -6.5\" /></svg>\n                            </a>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"col-lg-8\">\n                    <div class=\"card\">\n                      <div class=\"card-body\" id='content' style={{ height: '500px' }}>\n                        <div id=\"Dish\">\n\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                </div>\n              </div>\n            </div>\n          </div>\n          <div id='mixedaudio' style={{ display: 'block' }}></div>\n        </div>\n\n      </body >\n    )\n  }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\nimport queryString from 'query-string'\nconst t = dict['fa']\nexport default class AttendanceCreate extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.setInstance = this.setInstance.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n        this.getInstance = this.getInstance.bind(this);\n        this.getMultipleList = this.getMultipleList.bind(this);\n        this.search = this.search.bind(this);\n\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            title: null,\n            attendances: null,\n            users: null,\n            attendable_type: '',\n            attendable_id: 0,\n            q: '',\n            selectedUser: null,\n        }\n\n    }\n    componentWillMount() {\n        ModelStore.on(\"got_multiple_list\", this.getMultipleList);\n        ModelStore.on(\"set_instance\", this.setInstance);\n        ModelStore.on(\"deleted_instance\", this.getInstance);\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_multiple_list\", this.getMultipleList);\n        ModelStore.removeListener(\"set_instance\", this.setInstance);\n        ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    }\n\n    componentDidMount() {\n        const value = queryString.parse(this.props.location.search);\n        var attendable_type = '';\n        var attendable_id = 0;\n        Object.keys(value).map((key) => {\n            var splited = key.split(\"_\")\n            if (splited[0]) {\n                attendable_type = splited[0].charAt(0).toUpperCase() + splited[0].slice(1);\n                attendable_id = value[key]\n            }\n        })\n        this.setState({ attendable_type: attendable_type, attendable_id: attendable_id }, () => {\n            MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token);\n        })\n\n    }\n\n\n    getMultipleList() {\n        var multiple = ModelStore.getMutipleList()\n        var klass = ModelStore.getKlass()\n        console.log(multiple)\n        if (multiple && klass === 'Attendance') {\n            this.setState({\n                users: multiple.users,\n                attendances: multiple.attendances,\n            });\n        }\n    }\n\n\n    getInstance() {\n        MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token);\n    }\n\n\n\n    handleChange(obj) {\n        this.setState(obj);\n    }\n\n    search(q) {\n        if (q.length > 3) {\n            this.setState({ q: q }, () =>\n                MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token)\n            );\n        } else {\n            this.setState({ q: '' }, () =>\n                MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token)\n            );\n        }\n    }\n\n    setInstance() {\n        MyActions.getMultipleList('attendances', this.state.page, this.state, this.state.token);\n    }\n\n    addParticipant(user_id) {\n        if (this.state.attendable_type !== '') {\n            var data = { attendable_id: this.state.attendable_id, attendable_type: this.state.attendable_type, user_id: user_id }\n            MyActions.setInstance('attendances', data, this.state.token);\n        }\n    }\n\n    removeParticipant(id) {\n        var data = { id: id, attendable_id: this.state.attendable_id, attendable_type: this.state.attendable_type }\n        MyActions.removeInstance('attendances', data, this.state.token);\n    }\n\n    userItems(users) {\n        var result = []\n        if (users) {\n            users.map((user) => {\n                result.push(\n                    <div class=\"list-group-item\" style={{ border: 'none' }}>\n                        <div class=\"row align-items-center\">\n                            <div class=\"col-auto\">\n                                <a onClick={() => this.addParticipant(user.user_id)}>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                                </a>\n                            </div>\n                            <div class=\"col-auto\">\n                                <a href=\"#\">\n                                    <span class=\"avatar\" >{user.initials}</span>\n                                </a>\n                            </div>\n                            <div class=\"col text-truncate\">\n                                <a href=\"#\" class=\"text-body d-block\">{user.name}</a>\n                                <small class=\"d-block text-muted text-truncate mt-n1\">{user.bio}</small>\n                            </div>\n                            <div class=\"col-auto\">\n                            </div>\n\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n    changeDuty(id, value) {\n        console.log(id, value)\n        MyActions.setInstance('attendances/change_duty', { id: id, duty: value }, this.state.token);\n        //MyActions.updateInstance('')\n    }\n\n    dutyOptions(attendance) {\n        if (this.props.duties) {\n            var options = []\n            this.props.duties.map((duty) => {\n                options.push(\n                    <option value={duty} selected={attendance.duty === duty ? true : false}>{t[duty]}</option>\n                )\n                return (\n                    <select class=\"form-select\" onChange={(e) => this.changeDuty(attendance.id, e.target.value)}>\n                        {options}\n                    </select>\n                )\n            })\n\n        } else {\n            return (\n                <select class=\"form-select\" onChange={(e) => this.changeDuty(attendance.id, e.target.value)}>\n                    <option value='moderator' selected={attendance.duty === 'moderator' ? true : false}>{t['moderator']}</option>\n                    <option value='presenter' selected={attendance.duty === 'presenter' ? true : false}>{t['presenter']}</option>\n                    <option value='speaker' selected={attendance.duty === 'speaker' ? true : false}>{t['speaker']}</option>\n                    <option value='listener' selected={attendance.duty === 'listener' ? true : false}>{t['listener']}</option>\n                </select>\n            )\n        }\n    }\n\n    attendanceItems(attendances) {\n        var result = []\n        if (attendances) {\n            attendances.map((attendance) => {\n                console.log(attendance)\n                var user = attendance.profile\n                result.push(\n                    <div class=\"list-group-item\" style={{ border: 'none' }}>\n                        <div class=\"row align-items-center\">\n                            <div class=\"col-auto\">\n                                <a onClick={() => this.removeParticipant(attendance.id)}>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" /><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\" /></svg>\n                                </a>\n                            </div>\n                            <div class=\"col-auto\">\n                                <a href=\"#\">\n                                    <span class=\"avatar\" >{user.initials}</span>\n                                </a>\n                            </div>\n                            <div class=\"col text-truncate\">\n                                <a href=\"#\" class=\"text-body d-block\">{user.name}</a>\n                                <small class=\"d-block text-muted text-truncate mt-n1\">{user.bio}</small>\n                            </div>\n                            <div class=\"col-auto\" >\n                                {this.dutyOptions(attendance)}\n                            </div>\n\n                        </div>\n                    </div>\n                )\n            })\n        }\n        return result\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history} />\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\"></div>\n                                <div className=\"col\">\n                                    <div className=\"page-pretitle\">{t['add_participants']}</div>\n                                    <h2 className=\"page-title\">{t['choose_participants']}</h2>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n                                    <div className=\"col-md-6\">\n                                        <div class=\"card mb-3\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">{t['all_users']}</h3>\n                                            </div>\n                                            <div class=\"list-group list-group-flush list-group-hoverable\">\n                                                <div class=\"list-group-item\">\n                                                    <div class=\"input-icon \">\n                                                        <input type=\"text\" class=\"form-control\" placeholder={t['search_placeholder']} onInput={(e) => { this.search(e.target.value) }} />\n                                                        <span class=\"input-icon-addon\">\n\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><line x1=\"21\" y1=\"21\" x2=\"15\" y2=\"15\"></line></svg>\n                                                        </span>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            {this.userItems(this.state.users)}\n                                        </div>\n                                    </div>\n\n                                    <div className=\"col-md-6\">\n                                        <div class=\"card mb-3\">\n                                            <div class=\"card-header\">\n                                                <h3 class=\"card-title\">{t['participants']}</h3>\n                                            </div>\n                                            <div class=\"list-group list-group-flush list-group-hoverable\">\n                                                {this.attendanceItems(this.state.attendances)}\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import React from 'react'\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from '../../Dict';\nimport Header from \"../header/header.jsx\";\n\nexport default class ProfileIndex extends React.Component {\n\n    constructor(props) {\n        super(props);\n        //this.submit = this.submit.bind(this);\n        this.getList = this.getList.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n\n        this.state = {\n            token: window.localStorage.getItem('token'),\n            profiles: [],\n        }\n\n    }\n\n\n\n    componentWillMount() {\n        ModelStore.on(\"got_list\", this.getList);\n\n    }\n\n    componentWillUnmount() {\n        ModelStore.removeListener(\"got_list\", this.getList);\n    }\n\n    componentDidMount() {\n        MyActions.getList('profiles', this.state.page, {}, this.state.token);\n    }\n\n\n\n    handleChange(obj) {\n\n    }\n\n    getList() {\n        var list = ModelStore.getList()\n        var klass = ModelStore.getKlass()\n        if (list && klass === 'Profile') {\n            this.setState({\n                profiles: list,\n            });\n        }\n        console.log(list)\n    }\n\n    tags(profile) {\n        var result = []\n        profile.tags.map((tag) => {\n            result.push( <span class=\"badge bg-lime-lt\" style={{margin: '2px'}}>{tag.title}</span>)\n        })\n        return result\n    }\n\n    items() {\n        var result = []\n        this.state.profiles.map((profile) => {\n            result.push(\n                <div class=\"col-md-6 col-lg-3\">\n                    <div class=\"card\">\n                        <div class=\"card-body p-4 text-center\">\n                            <span class=\"avatar avatar-xl mb-3 avatar-rounded\" >{profile.initials}</span>\n                            <h3 class=\"m-0 mb-1\"><a href=\"#\">{profile.name}</a></h3>\n                            <div class=\"text-muted\">{profile.short_bio}</div>\n                            <div class=\"mt-3\">\n                                <div className='example-content'>\n                               {this.tags(profile)}\n                               </div>\n                            </div>\n                        </div>\n                        <div class=\"d-flex\">\n                            <a href=\"#\" class=\"card-btn\">\n                           \n\t<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 21v-13a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-9l-4 4\" /><line x1=\"12\" y1=\"11\" x2=\"12\" y2=\"11.01\" /><line x1=\"8\" y1=\"11\" x2=\"8\" y2=\"11.01\" /><line x1=\"16\" y1=\"11\" x2=\"16\" y2=\"11.01\" /></svg>\n                                Message</a>\n                            <a href=\"#\" class=\"card-btn\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"icon me-2 text-muted\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2\"></path></svg>\n                                Call</a>\n                        </div>\n                    </div>\n                </div>\n            )\n        })\n        return result\n    }\n\n\n    render() {\n\n        return (\n            <body className=\"antialiased\">\n                <div className=\"wrapper\">\n                    <Header history={this.props.history}/>\n                    <div className=\"page-wrapper\">\n                        <div className=\"container-xl\">\n                            <div className=\"page-header d-print-none\">\n                                <div className=\"row align-items-center\"></div>\n                                <div className=\"col\">\n                                    <div className=\"page-pretitle\">Overview</div>\n                                    <h2 className=\"page-title\">Profiles</h2>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"page-body\">\n                            <div className=\"container-xl\">\n                                <div className=\"row row-deck row-cards\">\n                                {this.items()}\n\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </body>\n        )\n    }\n}\n\n\n\n\n","import logo from \"./logo.svg\";\nimport \"./App.css\";\nimport React from \"react\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  HashRouter,\n  useParams,\n  Link,\n  Redirect,\n  withRouter,\n} from \"react-router-dom\";\n\nimport Dashboard from \"./components/dashboard/index.jsx\";\nimport UserWizard from \"./components/users/wizard.jsx\";\nimport UserLogin from \"./components/users/login.jsx\";\n\nimport EventIndex from \"./components/events/index.jsx\";\nimport EventShow from \"./components/events/show.jsx\";\nimport EventCreate from \"./components/events/create.jsx\";\nimport EventAttendance from \"./components/events/attendance.jsx\";\nimport EventEdit from \"./components/events/create.jsx\";\nimport EventDetail from \"./components/events/detail.jsx\";\n\nimport MeetingIndex from \"./components/meetings/index.jsx\";\nimport MeetingShow from \"./components/meetings/show.jsx\";\nimport MeetingCreate from \"./components/meetings/create.jsx\";\nimport MeetingAttendance from \"./components/meetings/attendance.jsx\";\nimport MeetingEdit from \"./components/meetings/create.jsx\";\n\nimport ExhibitionIndex from \"./components/exhibitions/index.jsx\";\nimport ExhibitionShow from \"./components/exhibitions/show.jsx\";\nimport ExhibitionCreate from \"./components/exhibitions/create.jsx\";\nimport ExhibitionEdit from \"./components/exhibitions/create.jsx\";\n\nimport DiscussionIndex from \"./components/discussions/index.jsx\";\n\nimport CropperShow from \"./components/uploads/cropper.jsx\";\nimport UploadCreate from \"./components/uploads/create.jsx\";\n\nimport FlyerCreate from \"./components/flyers/create.jsx\";\nimport FlyerEdit from \"./components/flyers/create.jsx\";\n\nimport LoginJwt from \"./components/users/loginJwt.jsx\";\n\nimport QuestionCreate from \"./components/questions/create.jsx\";\n\nimport RoomShow from \"./components/rooms/show.jsx\";\nimport AttendanceCreate from \"./components/attendances/create.jsx\";\n\nimport ProfileIndex from \"./components/profiles/index.jsx\";\nimport { createBrowserHistory } from 'history';\nconst history = createBrowserHistory();\nexport default class App extends React.Component {\n  componentWillMount() {\n    history.listen((location) => {\n      console.log(location)\n    });\n  }\n\n  render() {\n    return (\n      <HashRouter history={history}>\n        <Switch>\n          <Route path=\"/\" exact component={EventIndex} />\n          <Route path=\"/wizard\" exact component={UserWizard} />\n          <Route path=\"/login\" exact component={UserLogin} />\n          <Route path=\"/login_jwt/:id\" exact component={LoginJwt} />\n\n          <Route path=\"/uploads/:id\" exact component={UploadCreate} />\n          <Route path=\"/uploads/cropper/:id\" exact component={CropperShow} />\n\n          <Route path=\"/events\" exact component={EventIndex} />\n          <Route path=\"/events/create\" exact component={EventCreate} />\n          <Route path=\"/events/attendance\" exact component={EventAttendance} />\n          <Route path=\"/events/:id\" exact component={EventShow} />\n          <Route path=\"/events/detail/:id\" exact component={EventDetail} />\n          <Route path=\"/events/edit/:id\" exact component={EventEdit} />\n\n          <Route path=\"/exhibitions\" exact component={ExhibitionIndex} />\n          <Route path=\"/exhibitions/create\" exact component={ExhibitionCreate} />\n          <Route path=\"/exhibitions/:id\" exact component={ExhibitionShow} />\n          <Route path=\"/exhibitions/edit/:id\" exact component={ExhibitionEdit} />\n\n\n          <Route path=\"/meetings\" exact component={MeetingIndex} />\n          <Route path=\"/meetings/create\" exact component={MeetingCreate} />\n          <Route\n            path=\"/meetings/attendance\"\n            exact\n            component={MeetingAttendance}\n          />\n          <Route path=\"/meetings/:id\" exact component={MeetingShow} />\n          <Route path=\"/meetings/edit/:id\" exact component={MeetingEdit} />\n\n          <Route path=\"/flyers/create\" exact component={FlyerCreate} />\n          <Route path=\"/flyers/edit/:id\" exact component={FlyerEdit} />\n\n          <Route path=\"/questions/create\" exact component={QuestionCreate} />\n\n          <Route\n            path=\"/attendances/create\"\n            exact\n            component={AttendanceCreate}\n          />\n\n          <Route path=\"/rooms/:id\" exact component={RoomShow} />\n\n          <Route path=\"/discussions\" exact component={DiscussionIndex} />\n\n          <Route path=\"/profiles\" exact component={ProfileIndex} />\n        </Switch>\n      </HashRouter>\n    );\n  }\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import './css/demo.min.css';\n//import './css/tabler.min.css';\nimport './css/demo.rtl.min.css';\nimport './css/tabler.rtl.min.css';\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport 'react-bootstrap-range-slider/dist/react-bootstrap-range-slider.css';\nimport './css/quill.snow.css';\nimport './css/app.css';\nimport './css/dish.css';\n\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}